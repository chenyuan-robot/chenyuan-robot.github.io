function yR(i,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const n in r)if(n!=="default"&&!(n in i)){const a=Object.getOwnPropertyDescriptor(r,n);a&&Object.defineProperty(i,n,a.get?a:{enumerable:!0,get:()=>r[n]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();function Qg(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var $p={exports:{}},Ac={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g_;function Wx(){if(g_)return Ac;g_=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,n,a){var c=null;if(a!==void 0&&(c=""+a),n.key!==void 0&&(c=""+n.key),"key"in n){a={};for(var l in n)l!=="key"&&(a[l]=n[l])}else a=n;return n=a.ref,{$$typeof:i,type:r,key:c,ref:n!==void 0?n:null,props:a}}return Ac.Fragment=e,Ac.jsx=t,Ac.jsxs=t,Ac}var v_;function Xx(){return v_||(v_=1,$p.exports=Wx()),$p.exports}var ms=Xx(),jp={exports:{}},xc={},zp={exports:{}},Gp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var y_;function Qx(){return y_||(y_=1,function(i){function e(N,U){var V=N.length;N.push(U);e:for(;0<V;){var J=V-1>>>1,j=N[J];if(0<n(j,U))N[J]=U,N[V]=j,V=J;else break e}}function t(N){return N.length===0?null:N[0]}function r(N){if(N.length===0)return null;var U=N[0],V=N.pop();if(V!==U){N[0]=V;e:for(var J=0,j=N.length,q=j>>>1;J<q;){var Z=2*(J+1)-1,X=N[Z],Y=Z+1,re=N[Y];if(0>n(X,V))Y<j&&0>n(re,X)?(N[J]=re,N[Y]=V,J=Y):(N[J]=X,N[Z]=V,J=Z);else if(Y<j&&0>n(re,V))N[J]=re,N[Y]=V,J=Y;else break e}}return U}function n(N,U){var V=N.sortIndex-U.sortIndex;return V!==0?V:N.id-U.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;i.unstable_now=function(){return a.now()}}else{var c=Date,l=c.now();i.unstable_now=function(){return c.now()-l}}var d=[],u=[],f=1,p=null,v=3,E=!1,g=!1,_=!1,m=!1,y=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function T(N){for(var U=t(u);U!==null;){if(U.callback===null)r(u);else if(U.startTime<=N)r(u),U.sortIndex=U.expirationTime,e(d,U);else break;U=t(u)}}function w(N){if(_=!1,T(N),!g)if(t(d)!==null)g=!0,C||(C=!0,M());else{var U=t(u);U!==null&&$(w,U.startTime-N)}}var C=!1,A=-1,L=5,D=-1;function P(){return m?!0:!(i.unstable_now()-D<L)}function k(){if(m=!1,C){var N=i.unstable_now();D=N;var U=!0;try{e:{g=!1,_&&(_=!1,b(A),A=-1),E=!0;var V=v;try{t:{for(T(N),p=t(d);p!==null&&!(p.expirationTime>N&&P());){var J=p.callback;if(typeof J=="function"){p.callback=null,v=p.priorityLevel;var j=J(p.expirationTime<=N);if(N=i.unstable_now(),typeof j=="function"){p.callback=j,T(N),U=!0;break t}p===t(d)&&r(d),T(N)}else r(d);p=t(d)}if(p!==null)U=!0;else{var q=t(u);q!==null&&$(w,q.startTime-N),U=!1}}break e}finally{p=null,v=V,E=!1}U=void 0}}finally{U?M():C=!1}}}var M;if(typeof R=="function")M=function(){R(k)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,F=I.port2;I.port1.onmessage=k,M=function(){F.postMessage(null)}}else M=function(){y(k,0)};function $(N,U){A=y(function(){N(i.unstable_now())},U)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(N){N.callback=null},i.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<N?Math.floor(1e3/N):5},i.unstable_getCurrentPriorityLevel=function(){return v},i.unstable_next=function(N){switch(v){case 1:case 2:case 3:var U=3;break;default:U=v}var V=v;v=U;try{return N()}finally{v=V}},i.unstable_requestPaint=function(){m=!0},i.unstable_runWithPriority=function(N,U){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var V=v;v=N;try{return U()}finally{v=V}},i.unstable_scheduleCallback=function(N,U,V){var J=i.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?J+V:J):V=J,N){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=V+j,N={id:f++,callback:U,priorityLevel:N,startTime:V,expirationTime:j,sortIndex:-1},V>J?(N.sortIndex=V,e(u,N),t(d)===null&&N===t(u)&&(_?(b(A),A=-1):_=!0,$(w,V-J))):(N.sortIndex=j,e(d,N),g||E||(g=!0,C||(C=!0,M()))),N},i.unstable_shouldYield=P,i.unstable_wrapCallback=function(N){var U=v;return function(){var V=v;v=U;try{return N.apply(this,arguments)}finally{v=V}}}}(Gp)),Gp}var b_;function Zx(){return b_||(b_=1,zp.exports=Qx()),zp.exports}var Hp={exports:{}},st={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var __;function Jx(){if(__)return st;__=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.iterator;function v(j){return j===null||typeof j!="object"?null:(j=p&&j[p]||j["@@iterator"],typeof j=="function"?j:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,_={};function m(j,q,Z){this.props=j,this.context=q,this.refs=_,this.updater=Z||E}m.prototype.isReactComponent={},m.prototype.setState=function(j,q){if(typeof j!="object"&&typeof j!="function"&&j!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,j,q,"setState")},m.prototype.forceUpdate=function(j){this.updater.enqueueForceUpdate(this,j,"forceUpdate")};function y(){}y.prototype=m.prototype;function b(j,q,Z){this.props=j,this.context=q,this.refs=_,this.updater=Z||E}var R=b.prototype=new y;R.constructor=b,g(R,m.prototype),R.isPureReactComponent=!0;var T=Array.isArray,w={H:null,A:null,T:null,S:null,V:null},C=Object.prototype.hasOwnProperty;function A(j,q,Z,X,Y,re){return Z=re.ref,{$$typeof:i,type:j,key:q,ref:Z!==void 0?Z:null,props:re}}function L(j,q){return A(j.type,q,void 0,void 0,void 0,j.props)}function D(j){return typeof j=="object"&&j!==null&&j.$$typeof===i}function P(j){var q={"=":"=0",":":"=2"};return"$"+j.replace(/[=:]/g,function(Z){return q[Z]})}var k=/\/+/g;function M(j,q){return typeof j=="object"&&j!==null&&j.key!=null?P(""+j.key):q.toString(36)}function I(){}function F(j){switch(j.status){case"fulfilled":return j.value;case"rejected":throw j.reason;default:switch(typeof j.status=="string"?j.then(I,I):(j.status="pending",j.then(function(q){j.status==="pending"&&(j.status="fulfilled",j.value=q)},function(q){j.status==="pending"&&(j.status="rejected",j.reason=q)})),j.status){case"fulfilled":return j.value;case"rejected":throw j.reason}}throw j}function $(j,q,Z,X,Y){var re=typeof j;(re==="undefined"||re==="boolean")&&(j=null);var oe=!1;if(j===null)oe=!0;else switch(re){case"bigint":case"string":case"number":oe=!0;break;case"object":switch(j.$$typeof){case i:case e:oe=!0;break;case f:return oe=j._init,$(oe(j._payload),q,Z,X,Y)}}if(oe)return Y=Y(j),oe=X===""?"."+M(j,0):X,T(Y)?(Z="",oe!=null&&(Z=oe.replace(k,"$&/")+"/"),$(Y,q,Z,"",function(Oe){return Oe})):Y!=null&&(D(Y)&&(Y=L(Y,Z+(Y.key==null||j&&j.key===Y.key?"":(""+Y.key).replace(k,"$&/")+"/")+oe)),q.push(Y)),1;oe=0;var ve=X===""?".":X+":";if(T(j))for(var be=0;be<j.length;be++)X=j[be],re=ve+M(X,be),oe+=$(X,q,Z,re,Y);else if(be=v(j),typeof be=="function")for(j=be.call(j),be=0;!(X=j.next()).done;)X=X.value,re=ve+M(X,be++),oe+=$(X,q,Z,re,Y);else if(re==="object"){if(typeof j.then=="function")return $(F(j),q,Z,X,Y);throw q=String(j),Error("Objects are not valid as a React child (found: "+(q==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":q)+"). If you meant to render a collection of children, use an array instead.")}return oe}function N(j,q,Z){if(j==null)return j;var X=[],Y=0;return $(j,X,"","",function(re){return q.call(Z,re,Y++)}),X}function U(j){if(j._status===-1){var q=j._result;q=q(),q.then(function(Z){(j._status===0||j._status===-1)&&(j._status=1,j._result=Z)},function(Z){(j._status===0||j._status===-1)&&(j._status=2,j._result=Z)}),j._status===-1&&(j._status=0,j._result=q)}if(j._status===1)return j._result.default;throw j._result}var V=typeof reportError=="function"?reportError:function(j){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof j=="object"&&j!==null&&typeof j.message=="string"?String(j.message):String(j),error:j});if(!window.dispatchEvent(q))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",j);return}console.error(j)};function J(){}return st.Children={map:N,forEach:function(j,q,Z){N(j,function(){q.apply(this,arguments)},Z)},count:function(j){var q=0;return N(j,function(){q++}),q},toArray:function(j){return N(j,function(q){return q})||[]},only:function(j){if(!D(j))throw Error("React.Children.only expected to receive a single React element child.");return j}},st.Component=m,st.Fragment=t,st.Profiler=n,st.PureComponent=b,st.StrictMode=r,st.Suspense=d,st.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=w,st.__COMPILER_RUNTIME={__proto__:null,c:function(j){return w.H.useMemoCache(j)}},st.cache=function(j){return function(){return j.apply(null,arguments)}},st.cloneElement=function(j,q,Z){if(j==null)throw Error("The argument must be a React element, but you passed "+j+".");var X=g({},j.props),Y=j.key,re=void 0;if(q!=null)for(oe in q.ref!==void 0&&(re=void 0),q.key!==void 0&&(Y=""+q.key),q)!C.call(q,oe)||oe==="key"||oe==="__self"||oe==="__source"||oe==="ref"&&q.ref===void 0||(X[oe]=q[oe]);var oe=arguments.length-2;if(oe===1)X.children=Z;else if(1<oe){for(var ve=Array(oe),be=0;be<oe;be++)ve[be]=arguments[be+2];X.children=ve}return A(j.type,Y,void 0,void 0,re,X)},st.createContext=function(j){return j={$$typeof:c,_currentValue:j,_currentValue2:j,_threadCount:0,Provider:null,Consumer:null},j.Provider=j,j.Consumer={$$typeof:a,_context:j},j},st.createElement=function(j,q,Z){var X,Y={},re=null;if(q!=null)for(X in q.key!==void 0&&(re=""+q.key),q)C.call(q,X)&&X!=="key"&&X!=="__self"&&X!=="__source"&&(Y[X]=q[X]);var oe=arguments.length-2;if(oe===1)Y.children=Z;else if(1<oe){for(var ve=Array(oe),be=0;be<oe;be++)ve[be]=arguments[be+2];Y.children=ve}if(j&&j.defaultProps)for(X in oe=j.defaultProps,oe)Y[X]===void 0&&(Y[X]=oe[X]);return A(j,re,void 0,void 0,null,Y)},st.createRef=function(){return{current:null}},st.forwardRef=function(j){return{$$typeof:l,render:j}},st.isValidElement=D,st.lazy=function(j){return{$$typeof:f,_payload:{_status:-1,_result:j},_init:U}},st.memo=function(j,q){return{$$typeof:u,type:j,compare:q===void 0?null:q}},st.startTransition=function(j){var q=w.T,Z={};w.T=Z;try{var X=j(),Y=w.S;Y!==null&&Y(Z,X),typeof X=="object"&&X!==null&&typeof X.then=="function"&&X.then(J,V)}catch(re){V(re)}finally{w.T=q}},st.unstable_useCacheRefresh=function(){return w.H.useCacheRefresh()},st.use=function(j){return w.H.use(j)},st.useActionState=function(j,q,Z){return w.H.useActionState(j,q,Z)},st.useCallback=function(j,q){return w.H.useCallback(j,q)},st.useContext=function(j){return w.H.useContext(j)},st.useDebugValue=function(){},st.useDeferredValue=function(j,q){return w.H.useDeferredValue(j,q)},st.useEffect=function(j,q,Z){var X=w.H;if(typeof Z=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return X.useEffect(j,q)},st.useId=function(){return w.H.useId()},st.useImperativeHandle=function(j,q,Z){return w.H.useImperativeHandle(j,q,Z)},st.useInsertionEffect=function(j,q){return w.H.useInsertionEffect(j,q)},st.useLayoutEffect=function(j,q){return w.H.useLayoutEffect(j,q)},st.useMemo=function(j,q){return w.H.useMemo(j,q)},st.useOptimistic=function(j,q){return w.H.useOptimistic(j,q)},st.useReducer=function(j,q,Z){return w.H.useReducer(j,q,Z)},st.useRef=function(j){return w.H.useRef(j)},st.useState=function(j){return w.H.useState(j)},st.useSyncExternalStore=function(j,q,Z){return w.H.useSyncExternalStore(j,q,Z)},st.useTransition=function(){return w.H.useTransition()},st.version="19.1.0",st}var S_;function Zg(){return S_||(S_=1,Hp.exports=Jx()),Hp.exports}var Vp={exports:{}},Fr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E_;function eD(){if(E_)return Fr;E_=1;var i=Zg();function e(d){var u="https://react.dev/errors/"+d;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)u+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+d+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},n=Symbol.for("react.portal");function a(d,u,f){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:p==null?null:""+p,children:d,containerInfo:u,implementation:f}}var c=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(d,u){if(d==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return Fr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Fr.createPortal=function(d,u){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(e(299));return a(d,u,null,f)},Fr.flushSync=function(d){var u=c.T,f=r.p;try{if(c.T=null,r.p=2,d)return d()}finally{c.T=u,r.p=f,r.d.f()}},Fr.preconnect=function(d,u){typeof d=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,r.d.C(d,u))},Fr.prefetchDNS=function(d){typeof d=="string"&&r.d.D(d)},Fr.preinit=function(d,u){if(typeof d=="string"&&u&&typeof u.as=="string"){var f=u.as,p=l(f,u.crossOrigin),v=typeof u.integrity=="string"?u.integrity:void 0,E=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;f==="style"?r.d.S(d,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:p,integrity:v,fetchPriority:E}):f==="script"&&r.d.X(d,{crossOrigin:p,integrity:v,fetchPriority:E,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},Fr.preinitModule=function(d,u){if(typeof d=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var f=l(u.as,u.crossOrigin);r.d.M(d,{crossOrigin:f,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&r.d.M(d)},Fr.preload=function(d,u){if(typeof d=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var f=u.as,p=l(f,u.crossOrigin);r.d.L(d,f,{crossOrigin:p,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},Fr.preloadModule=function(d,u){if(typeof d=="string")if(u){var f=l(u.as,u.crossOrigin);r.d.m(d,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:f,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else r.d.m(d)},Fr.requestFormReset=function(d){r.d.r(d)},Fr.unstable_batchedUpdates=function(d,u){return d(u)},Fr.useFormState=function(d,u,f){return c.H.useFormState(d,u,f)},Fr.useFormStatus=function(){return c.H.useHostTransitionStatus()},Fr.version="19.1.0",Fr}var R_;function bR(){if(R_)return Vp.exports;R_=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),Vp.exports=eD(),Vp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w_;function tD(){if(w_)return xc;w_=1;var i=Zx(),e=Zg(),t=bR();function r(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)o+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var o=s,h=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(h=o.return),s=o.return;while(s)}return o.tag===3?h:null}function c(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function l(s){if(a(s)!==s)throw Error(r(188))}function d(s){var o=s.alternate;if(!o){if(o=a(s),o===null)throw Error(r(188));return o!==s?null:s}for(var h=s,S=o;;){var x=h.return;if(x===null)break;var O=x.alternate;if(O===null){if(S=x.return,S!==null){h=S;continue}break}if(x.child===O.child){for(O=x.child;O;){if(O===h)return l(x),s;if(O===S)return l(x),o;O=O.sibling}throw Error(r(188))}if(h.return!==S.return)h=x,S=O;else{for(var B=!1,G=x.child;G;){if(G===h){B=!0,h=x,S=O;break}if(G===S){B=!0,S=x,h=O;break}G=G.sibling}if(!B){for(G=O.child;G;){if(G===h){B=!0,h=O,S=x;break}if(G===S){B=!0,S=O,h=x;break}G=G.sibling}if(!B)throw Error(r(189))}}if(h.alternate!==S)throw Error(r(190))}if(h.tag!==3)throw Error(r(188));return h.stateNode.current===h?s:o}function u(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=u(s),o!==null)return o;s=s.sibling}return null}var f=Object.assign,p=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),b=Symbol.for("react.consumer"),R=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),L=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),k=Symbol.iterator;function M(s){return s===null||typeof s!="object"?null:(s=k&&s[k]||s["@@iterator"],typeof s=="function"?s:null)}var I=Symbol.for("react.client.reference");function F(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===I?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case g:return"Fragment";case m:return"Profiler";case _:return"StrictMode";case w:return"Suspense";case C:return"SuspenseList";case D:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case E:return"Portal";case R:return(s.displayName||"Context")+".Provider";case b:return(s._context.displayName||"Context")+".Consumer";case T:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case A:return o=s.displayName||null,o!==null?o:F(s.type)||"Memo";case L:o=s._payload,s=s._init;try{return F(s(o))}catch{}}return null}var $=Array.isArray,N=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V={pending:!1,data:null,method:null,action:null},J=[],j=-1;function q(s){return{current:s}}function Z(s){0>j||(s.current=J[j],J[j]=null,j--)}function X(s,o){j++,J[j]=s.current,s.current=o}var Y=q(null),re=q(null),oe=q(null),ve=q(null);function be(s,o){switch(X(oe,o),X(re,s),X(Y,null),o.nodeType){case 9:case 11:s=(s=o.documentElement)&&(s=s.namespaceURI)?Hb(s):0;break;default:if(s=o.tagName,o=o.namespaceURI)o=Hb(o),s=Vb(o,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}Z(Y),X(Y,s)}function Oe(){Z(Y),Z(re),Z(oe)}function Pe(s){s.memoizedState!==null&&X(ve,s);var o=Y.current,h=Vb(o,s.type);o!==h&&(X(re,s),X(Y,h))}function Se(s){re.current===s&&(Z(Y),Z(re)),ve.current===s&&(Z(ve),Ec._currentValue=V)}var Te=Object.prototype.hasOwnProperty,ge=i.unstable_scheduleCallback,Ue=i.unstable_cancelCallback,je=i.unstable_shouldYield,Ie=i.unstable_requestPaint,De=i.unstable_now,ze=i.unstable_getCurrentPriorityLevel,ut=i.unstable_ImmediatePriority,Ft=i.unstable_UserBlockingPriority,rt=i.unstable_NormalPriority,et=i.unstable_LowPriority,$e=i.unstable_IdlePriority,Ge=i.log,ft=i.unstable_setDisableYieldValue,Wt=null,_t=null;function Ze(s){if(typeof Ge=="function"&&ft(s),_t&&typeof _t.setStrictMode=="function")try{_t.setStrictMode(Wt,s)}catch{}}var Et=Math.clz32?Math.clz32:_e,le=Math.log,pe=Math.LN2;function _e(s){return s>>>=0,s===0?32:31-(le(s)/pe|0)|0}var Ce=256,Ee=4194304;function ke(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Qe(s,o,h){var S=s.pendingLanes;if(S===0)return 0;var x=0,O=s.suspendedLanes,B=s.pingedLanes;s=s.warmLanes;var G=S&134217727;return G!==0?(S=G&~O,S!==0?x=ke(S):(B&=G,B!==0?x=ke(B):h||(h=G&~s,h!==0&&(x=ke(h))))):(G=S&~O,G!==0?x=ke(G):B!==0?x=ke(B):h||(h=S&~s,h!==0&&(x=ke(h)))),x===0?0:o!==0&&o!==x&&(o&O)===0&&(O=x&-x,h=o&-o,O>=h||O===32&&(h&4194048)!==0)?o:x}function Tt(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function pr(s,o){switch(s){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Si(){var s=Ce;return Ce<<=1,(Ce&4194048)===0&&(Ce=256),s}function Is(){var s=Ee;return Ee<<=1,(Ee&62914560)===0&&(Ee=4194304),s}function Ei(s){for(var o=[],h=0;31>h;h++)o.push(s);return o}function ni(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Ps(s,o,h,S,x,O){var B=s.pendingLanes;s.pendingLanes=h,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=h,s.entangledLanes&=h,s.errorRecoveryDisabledLanes&=h,s.shellSuspendCounter=0;var G=s.entanglements,W=s.expirationTimes,se=s.hiddenUpdates;for(h=B&~h;0<h;){var de=31-Et(h),me=1<<de;G[de]=0,W[de]=-1;var ae=se[de];if(ae!==null)for(se[de]=null,de=0;de<ae.length;de++){var ce=ae[de];ce!==null&&(ce.lane&=-536870913)}h&=~me}S!==0&&zn(s,S,0),O!==0&&x===0&&s.tag!==0&&(s.suspendedLanes|=O&~(B&~o))}function zn(s,o,h){s.pendingLanes|=o,s.suspendedLanes&=~o;var S=31-Et(o);s.entangledLanes|=o,s.entanglements[S]=s.entanglements[S]|1073741824|h&4194090}function Zt(s,o){var h=s.entangledLanes|=o;for(s=s.entanglements;h;){var S=31-Et(h),x=1<<S;x&o|s[S]&o&&(s[S]|=o),h&=~x}}function Lr(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Sn(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function $i(){var s=U.p;return s!==0?s:(s=window.event,s===void 0?32:u_(s.type))}function Ri(s,o){var h=U.p;try{return U.p=s,o()}finally{U.p=h}}var ar=Math.random().toString(36).slice(2),Ut="__reactFiber$"+ar,or="__reactProps$"+ar,yt="__reactContainer$"+ar,nn="__reactEvents$"+ar,si="__reactListeners$"+ar,Ot="__reactHandles$"+ar,$t="__reactResources$"+ar,Jt="__reactMarker$"+ar;function _r(s){delete s[Ut],delete s[or],delete s[nn],delete s[si],delete s[Ot]}function cr(s){var o=s[Ut];if(o)return o;for(var h=s.parentNode;h;){if(o=h[yt]||h[Ut]){if(h=o.alternate,o.child!==null||h!==null&&h.child!==null)for(s=Wb(s);s!==null;){if(h=s[Ut])return h;s=Wb(s)}return o}s=h,h=s.parentNode}return null}function ji(s){if(s=s[Ut]||s[yt]){var o=s.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return s}return null}function zi(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(r(33))}function ai(s){var o=s[$t];return o||(o=s[$t]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function jt(s){s[Jt]=!0}var va=new Set,ks={};function lr(s,o){Sr(s,o),Sr(s+"Capture",o)}function Sr(s,o){for(ks[s]=o,s=0;s<o.length;s++)va.add(o[s])}var Gn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ms={},ye={};function xe(s){return Te.call(ye,s)?!0:Te.call(Ms,s)?!1:Gn.test(s)?ye[s]=!0:(Ms[s]=!0,!1)}function Ae(s,o,h){if(xe(o))if(h===null)s.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var S=o.toLowerCase().slice(0,5);if(S!=="data-"&&S!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+h)}}function mt(s,o,h){if(h===null)s.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+h)}}function Me(s,o,h,S){if(S===null)s.removeAttribute(h);else{switch(typeof S){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(h);return}s.setAttributeNS(o,h,""+S)}}var Rt,Fe;function gt(s){if(Rt===void 0)try{throw Error()}catch(h){var o=h.stack.trim().match(/\n( *(at )?)/);Rt=o&&o[1]||"",Fe=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Rt+s+Fe}var it=!1;function Ht(s,o){if(!s||it)return"";it=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var S={DetermineComponentFrameRoot:function(){try{if(o){var me=function(){throw Error()};if(Object.defineProperty(me.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(me,[])}catch(ce){var ae=ce}Reflect.construct(s,[],me)}else{try{me.call()}catch(ce){ae=ce}s.call(me.prototype)}}else{try{throw Error()}catch(ce){ae=ce}(me=s())&&typeof me.catch=="function"&&me.catch(function(){})}}catch(ce){if(ce&&ae&&typeof ce.stack=="string")return[ce.stack,ae.stack]}return[null,null]}};S.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(S.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(S.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var O=S.DetermineComponentFrameRoot(),B=O[0],G=O[1];if(B&&G){var W=B.split(`
`),se=G.split(`
`);for(x=S=0;S<W.length&&!W[S].includes("DetermineComponentFrameRoot");)S++;for(;x<se.length&&!se[x].includes("DetermineComponentFrameRoot");)x++;if(S===W.length||x===se.length)for(S=W.length-1,x=se.length-1;1<=S&&0<=x&&W[S]!==se[x];)x--;for(;1<=S&&0<=x;S--,x--)if(W[S]!==se[x]){if(S!==1||x!==1)do if(S--,x--,0>x||W[S]!==se[x]){var de=`
`+W[S].replace(" at new "," at ");return s.displayName&&de.includes("<anonymous>")&&(de=de.replace("<anonymous>",s.displayName)),de}while(1<=S&&0<=x);break}}}finally{it=!1,Error.prepareStackTrace=h}return(h=s?s.displayName||s.name:"")?gt(h):""}function Gi(s){switch(s.tag){case 26:case 27:case 5:return gt(s.type);case 16:return gt("Lazy");case 13:return gt("Suspense");case 19:return gt("SuspenseList");case 0:case 15:return Ht(s.type,!1);case 11:return Ht(s.type.render,!1);case 1:return Ht(s.type,!0);case 31:return gt("Activity");default:return""}}function Hi(s){try{var o="";do o+=Gi(s),s=s.return;while(s);return o}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}function Er(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Ns(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Fl(s){var o=Ns(s)?"checked":"value",h=Object.getOwnPropertyDescriptor(s.constructor.prototype,o),S=""+s[o];if(!s.hasOwnProperty(o)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var x=h.get,O=h.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return x.call(this)},set:function(B){S=""+B,O.call(this,B)}}),Object.defineProperty(s,o,{enumerable:h.enumerable}),{getValue:function(){return S},setValue:function(B){S=""+B},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function Hn(s){s._valueTracker||(s._valueTracker=Fl(s))}function ya(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var h=o.getValue(),S="";return s&&(S=Ns(s)?s.checked?"true":"false":s.value),s=S,s!==h?(o.setValue(s),!0):!1}function ba(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Bs=/[\n"\\]/g;function qr(s){return s.replace(Bs,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Bf(s,o,h,S,x,O,B,G){s.name="",B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"?s.type=B:s.removeAttribute("type"),o!=null?B==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+Er(o)):s.value!==""+Er(o)&&(s.value=""+Er(o)):B!=="submit"&&B!=="reset"||s.removeAttribute("value"),o!=null?Ff(s,B,Er(o)):h!=null?Ff(s,B,Er(h)):S!=null&&s.removeAttribute("value"),x==null&&O!=null&&(s.defaultChecked=!!O),x!=null&&(s.checked=x&&typeof x!="function"&&typeof x!="symbol"),G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"?s.name=""+Er(G):s.removeAttribute("name")}function jv(s,o,h,S,x,O,B,G){if(O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"&&(s.type=O),o!=null||h!=null){if(!(O!=="submit"&&O!=="reset"||o!=null))return;h=h!=null?""+Er(h):"",o=o!=null?""+Er(o):h,G||o===s.value||(s.value=o),s.defaultValue=o}S=S??x,S=typeof S!="function"&&typeof S!="symbol"&&!!S,s.checked=G?s.checked:!!S,s.defaultChecked=!!S,B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"&&(s.name=B)}function Ff(s,o,h){o==="number"&&ba(s.ownerDocument)===s||s.defaultValue===""+h||(s.defaultValue=""+h)}function _a(s,o,h,S){if(s=s.options,o){o={};for(var x=0;x<h.length;x++)o["$"+h[x]]=!0;for(h=0;h<s.length;h++)x=o.hasOwnProperty("$"+s[h].value),s[h].selected!==x&&(s[h].selected=x),x&&S&&(s[h].defaultSelected=!0)}else{for(h=""+Er(h),o=null,x=0;x<s.length;x++){if(s[x].value===h){s[x].selected=!0,S&&(s[x].defaultSelected=!0);return}o!==null||s[x].disabled||(o=s[x])}o!==null&&(o.selected=!0)}}function zv(s,o,h){if(o!=null&&(o=""+Er(o),o!==s.value&&(s.value=o),h==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=h!=null?""+Er(h):""}function Gv(s,o,h,S){if(o==null){if(S!=null){if(h!=null)throw Error(r(92));if($(S)){if(1<S.length)throw Error(r(93));S=S[0]}h=S}h==null&&(h=""),o=h}h=Er(o),s.defaultValue=h,S=s.textContent,S===h&&S!==""&&S!==null&&(s.value=S)}function Sa(s,o){if(o){var h=s.firstChild;if(h&&h===s.lastChild&&h.nodeType===3){h.nodeValue=o;return}}s.textContent=o}var KC=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Hv(s,o,h){var S=o.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?S?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":S?s.setProperty(o,h):typeof h!="number"||h===0||KC.has(o)?o==="float"?s.cssFloat=h:s[o]=(""+h).trim():s[o]=h+"px"}function Vv(s,o,h){if(o!=null&&typeof o!="object")throw Error(r(62));if(s=s.style,h!=null){for(var S in h)!h.hasOwnProperty(S)||o!=null&&o.hasOwnProperty(S)||(S.indexOf("--")===0?s.setProperty(S,""):S==="float"?s.cssFloat="":s[S]="");for(var x in o)S=o[x],o.hasOwnProperty(x)&&h[x]!==S&&Hv(s,x,S)}else for(var O in o)o.hasOwnProperty(O)&&Hv(s,O,o[O])}function Uf(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qC=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),YC=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ul(s){return YC.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var $f=null;function jf(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Ea=null,Ra=null;function Kv(s){var o=ji(s);if(o&&(s=o.stateNode)){var h=s[or]||null;e:switch(s=o.stateNode,o.type){case"input":if(Bf(s,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),o=h.name,h.type==="radio"&&o!=null){for(h=s;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+qr(""+o)+'"][type="radio"]'),o=0;o<h.length;o++){var S=h[o];if(S!==s&&S.form===s.form){var x=S[or]||null;if(!x)throw Error(r(90));Bf(S,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(o=0;o<h.length;o++)S=h[o],S.form===s.form&&ya(S)}break e;case"textarea":zv(s,h.value,h.defaultValue);break e;case"select":o=h.value,o!=null&&_a(s,!!h.multiple,o,!1)}}}var zf=!1;function qv(s,o,h){if(zf)return s(o,h);zf=!0;try{var S=s(o);return S}finally{if(zf=!1,(Ea!==null||Ra!==null)&&(wu(),Ea&&(o=Ea,s=Ra,Ra=Ea=null,Kv(o),s)))for(o=0;o<s.length;o++)Kv(s[o])}}function Mo(s,o){var h=s.stateNode;if(h===null)return null;var S=h[or]||null;if(S===null)return null;h=S[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(S=!S.disabled)||(s=s.type,S=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!S;break e;default:s=!1}if(s)return null;if(h&&typeof h!="function")throw Error(r(231,o,typeof h));return h}var En=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gf=!1;if(En)try{var No={};Object.defineProperty(No,"passive",{get:function(){Gf=!0}}),window.addEventListener("test",No,No),window.removeEventListener("test",No,No)}catch{Gf=!1}var Vn=null,Hf=null,$l=null;function Yv(){if($l)return $l;var s,o=Hf,h=o.length,S,x="value"in Vn?Vn.value:Vn.textContent,O=x.length;for(s=0;s<h&&o[s]===x[s];s++);var B=h-s;for(S=1;S<=B&&o[h-S]===x[O-S];S++);return $l=x.slice(s,1<S?1-S:void 0)}function jl(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function zl(){return!0}function Wv(){return!1}function Yr(s){function o(h,S,x,O,B){this._reactName=h,this._targetInst=x,this.type=S,this.nativeEvent=O,this.target=B,this.currentTarget=null;for(var G in s)s.hasOwnProperty(G)&&(h=s[G],this[G]=h?h(O):O[G]);return this.isDefaultPrevented=(O.defaultPrevented!=null?O.defaultPrevented:O.returnValue===!1)?zl:Wv,this.isPropagationStopped=Wv,this}return f(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=zl)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=zl)},persist:function(){},isPersistent:zl}),o}var Fs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gl=Yr(Fs),Bo=f({},Fs,{view:0,detail:0}),WC=Yr(Bo),Vf,Kf,Fo,Hl=f({},Bo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Yf,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Fo&&(Fo&&s.type==="mousemove"?(Vf=s.screenX-Fo.screenX,Kf=s.screenY-Fo.screenY):Kf=Vf=0,Fo=s),Vf)},movementY:function(s){return"movementY"in s?s.movementY:Kf}}),Xv=Yr(Hl),XC=f({},Hl,{dataTransfer:0}),QC=Yr(XC),ZC=f({},Bo,{relatedTarget:0}),qf=Yr(ZC),JC=f({},Fs,{animationName:0,elapsedTime:0,pseudoElement:0}),eA=Yr(JC),tA=f({},Fs,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),rA=Yr(tA),iA=f({},Fs,{data:0}),Qv=Yr(iA),nA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},aA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function oA(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=aA[s])?!!o[s]:!1}function Yf(){return oA}var cA=f({},Bo,{key:function(s){if(s.key){var o=nA[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=jl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?sA[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Yf,charCode:function(s){return s.type==="keypress"?jl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?jl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),lA=Yr(cA),uA=f({},Hl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zv=Yr(uA),dA=f({},Bo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Yf}),fA=Yr(dA),hA=f({},Fs,{propertyName:0,elapsedTime:0,pseudoElement:0}),pA=Yr(hA),mA=f({},Hl,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),gA=Yr(mA),vA=f({},Fs,{newState:0,oldState:0}),yA=Yr(vA),bA=[9,13,27,32],Wf=En&&"CompositionEvent"in window,Uo=null;En&&"documentMode"in document&&(Uo=document.documentMode);var _A=En&&"TextEvent"in window&&!Uo,Jv=En&&(!Wf||Uo&&8<Uo&&11>=Uo),ey=" ",ty=!1;function ry(s,o){switch(s){case"keyup":return bA.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function iy(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var wa=!1;function SA(s,o){switch(s){case"compositionend":return iy(o);case"keypress":return o.which!==32?null:(ty=!0,ey);case"textInput":return s=o.data,s===ey&&ty?null:s;default:return null}}function EA(s,o){if(wa)return s==="compositionend"||!Wf&&ry(s,o)?(s=Yv(),$l=Hf=Vn=null,wa=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Jv&&o.locale!=="ko"?null:o.data;default:return null}}var RA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ny(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!RA[s.type]:o==="textarea"}function sy(s,o,h,S){Ea?Ra?Ra.push(S):Ra=[S]:Ea=S,o=Lu(o,"onChange"),0<o.length&&(h=new Gl("onChange","change",null,h,S),s.push({event:h,listeners:o}))}var $o=null,jo=null;function wA(s){Ub(s,0)}function Vl(s){var o=zi(s);if(ya(o))return s}function ay(s,o){if(s==="change")return o}var oy=!1;if(En){var Xf;if(En){var Qf="oninput"in document;if(!Qf){var cy=document.createElement("div");cy.setAttribute("oninput","return;"),Qf=typeof cy.oninput=="function"}Xf=Qf}else Xf=!1;oy=Xf&&(!document.documentMode||9<document.documentMode)}function ly(){$o&&($o.detachEvent("onpropertychange",uy),jo=$o=null)}function uy(s){if(s.propertyName==="value"&&Vl(jo)){var o=[];sy(o,jo,s,jf(s)),qv(wA,o)}}function TA(s,o,h){s==="focusin"?(ly(),$o=o,jo=h,$o.attachEvent("onpropertychange",uy)):s==="focusout"&&ly()}function CA(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Vl(jo)}function AA(s,o){if(s==="click")return Vl(o)}function xA(s,o){if(s==="input"||s==="change")return Vl(o)}function DA(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var oi=typeof Object.is=="function"?Object.is:DA;function zo(s,o){if(oi(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var h=Object.keys(s),S=Object.keys(o);if(h.length!==S.length)return!1;for(S=0;S<h.length;S++){var x=h[S];if(!Te.call(o,x)||!oi(s[x],o[x]))return!1}return!0}function dy(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function fy(s,o){var h=dy(s);s=0;for(var S;h;){if(h.nodeType===3){if(S=s+h.textContent.length,s<=o&&S>=o)return{node:h,offset:o-s};s=S}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=dy(h)}}function hy(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?hy(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function py(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=ba(s.document);o instanceof s.HTMLIFrameElement;){try{var h=typeof o.contentWindow.location.href=="string"}catch{h=!1}if(h)s=o.contentWindow;else break;o=ba(s.document)}return o}function Zf(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}var LA=En&&"documentMode"in document&&11>=document.documentMode,Ta=null,Jf=null,Go=null,eh=!1;function my(s,o,h){var S=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;eh||Ta==null||Ta!==ba(S)||(S=Ta,"selectionStart"in S&&Zf(S)?S={start:S.selectionStart,end:S.selectionEnd}:(S=(S.ownerDocument&&S.ownerDocument.defaultView||window).getSelection(),S={anchorNode:S.anchorNode,anchorOffset:S.anchorOffset,focusNode:S.focusNode,focusOffset:S.focusOffset}),Go&&zo(Go,S)||(Go=S,S=Lu(Jf,"onSelect"),0<S.length&&(o=new Gl("onSelect","select",null,o,h),s.push({event:o,listeners:S}),o.target=Ta)))}function Us(s,o){var h={};return h[s.toLowerCase()]=o.toLowerCase(),h["Webkit"+s]="webkit"+o,h["Moz"+s]="moz"+o,h}var Ca={animationend:Us("Animation","AnimationEnd"),animationiteration:Us("Animation","AnimationIteration"),animationstart:Us("Animation","AnimationStart"),transitionrun:Us("Transition","TransitionRun"),transitionstart:Us("Transition","TransitionStart"),transitioncancel:Us("Transition","TransitionCancel"),transitionend:Us("Transition","TransitionEnd")},th={},gy={};En&&(gy=document.createElement("div").style,"AnimationEvent"in window||(delete Ca.animationend.animation,delete Ca.animationiteration.animation,delete Ca.animationstart.animation),"TransitionEvent"in window||delete Ca.transitionend.transition);function $s(s){if(th[s])return th[s];if(!Ca[s])return s;var o=Ca[s],h;for(h in o)if(o.hasOwnProperty(h)&&h in gy)return th[s]=o[h];return s}var vy=$s("animationend"),yy=$s("animationiteration"),by=$s("animationstart"),OA=$s("transitionrun"),IA=$s("transitionstart"),PA=$s("transitioncancel"),_y=$s("transitionend"),Sy=new Map,rh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");rh.push("scrollEnd");function Vi(s,o){Sy.set(s,o),lr(o,[s])}var Ey=new WeakMap;function wi(s,o){if(typeof s=="object"&&s!==null){var h=Ey.get(s);return h!==void 0?h:(o={value:s,source:o,stack:Hi(o)},Ey.set(s,o),o)}return{value:s,source:o,stack:Hi(o)}}var Ti=[],Aa=0,ih=0;function Kl(){for(var s=Aa,o=ih=Aa=0;o<s;){var h=Ti[o];Ti[o++]=null;var S=Ti[o];Ti[o++]=null;var x=Ti[o];Ti[o++]=null;var O=Ti[o];if(Ti[o++]=null,S!==null&&x!==null){var B=S.pending;B===null?x.next=x:(x.next=B.next,B.next=x),S.pending=x}O!==0&&Ry(h,x,O)}}function ql(s,o,h,S){Ti[Aa++]=s,Ti[Aa++]=o,Ti[Aa++]=h,Ti[Aa++]=S,ih|=S,s.lanes|=S,s=s.alternate,s!==null&&(s.lanes|=S)}function nh(s,o,h,S){return ql(s,o,h,S),Yl(s)}function xa(s,o){return ql(s,null,null,o),Yl(s)}function Ry(s,o,h){s.lanes|=h;var S=s.alternate;S!==null&&(S.lanes|=h);for(var x=!1,O=s.return;O!==null;)O.childLanes|=h,S=O.alternate,S!==null&&(S.childLanes|=h),O.tag===22&&(s=O.stateNode,s===null||s._visibility&1||(x=!0)),s=O,O=O.return;return s.tag===3?(O=s.stateNode,x&&o!==null&&(x=31-Et(h),s=O.hiddenUpdates,S=s[x],S===null?s[x]=[o]:S.push(o),o.lane=h|536870912),O):null}function Yl(s){if(50<pc)throw pc=0,up=null,Error(r(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var Da={};function kA(s,o,h,S){this.tag=s,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=S,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ci(s,o,h,S){return new kA(s,o,h,S)}function sh(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Rn(s,o){var h=s.alternate;return h===null?(h=ci(s.tag,o,s.key,s.mode),h.elementType=s.elementType,h.type=s.type,h.stateNode=s.stateNode,h.alternate=s,s.alternate=h):(h.pendingProps=o,h.type=s.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=s.flags&65011712,h.childLanes=s.childLanes,h.lanes=s.lanes,h.child=s.child,h.memoizedProps=s.memoizedProps,h.memoizedState=s.memoizedState,h.updateQueue=s.updateQueue,o=s.dependencies,h.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},h.sibling=s.sibling,h.index=s.index,h.ref=s.ref,h.refCleanup=s.refCleanup,h}function wy(s,o){s.flags&=65011714;var h=s.alternate;return h===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=h.childLanes,s.lanes=h.lanes,s.child=h.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=h.memoizedProps,s.memoizedState=h.memoizedState,s.updateQueue=h.updateQueue,s.type=h.type,o=h.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function Wl(s,o,h,S,x,O){var B=0;if(S=s,typeof s=="function")sh(s)&&(B=1);else if(typeof s=="string")B=Nx(s,h,Y.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case D:return s=ci(31,h,o,x),s.elementType=D,s.lanes=O,s;case g:return js(h.children,x,O,o);case _:B=8,x|=24;break;case m:return s=ci(12,h,o,x|2),s.elementType=m,s.lanes=O,s;case w:return s=ci(13,h,o,x),s.elementType=w,s.lanes=O,s;case C:return s=ci(19,h,o,x),s.elementType=C,s.lanes=O,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case y:case R:B=10;break e;case b:B=9;break e;case T:B=11;break e;case A:B=14;break e;case L:B=16,S=null;break e}B=29,h=Error(r(130,s===null?"null":typeof s,"")),S=null}return o=ci(B,h,o,x),o.elementType=s,o.type=S,o.lanes=O,o}function js(s,o,h,S){return s=ci(7,s,S,o),s.lanes=h,s}function ah(s,o,h){return s=ci(6,s,null,o),s.lanes=h,s}function oh(s,o,h){return o=ci(4,s.children!==null?s.children:[],s.key,o),o.lanes=h,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}var La=[],Oa=0,Xl=null,Ql=0,Ci=[],Ai=0,zs=null,wn=1,Tn="";function Gs(s,o){La[Oa++]=Ql,La[Oa++]=Xl,Xl=s,Ql=o}function Ty(s,o,h){Ci[Ai++]=wn,Ci[Ai++]=Tn,Ci[Ai++]=zs,zs=s;var S=wn;s=Tn;var x=32-Et(S)-1;S&=~(1<<x),h+=1;var O=32-Et(o)+x;if(30<O){var B=x-x%5;O=(S&(1<<B)-1).toString(32),S>>=B,x-=B,wn=1<<32-Et(o)+x|h<<x|S,Tn=O+s}else wn=1<<O|h<<x|S,Tn=s}function ch(s){s.return!==null&&(Gs(s,1),Ty(s,1,0))}function lh(s){for(;s===Xl;)Xl=La[--Oa],La[Oa]=null,Ql=La[--Oa],La[Oa]=null;for(;s===zs;)zs=Ci[--Ai],Ci[Ai]=null,Tn=Ci[--Ai],Ci[Ai]=null,wn=Ci[--Ai],Ci[Ai]=null}var Vr=null,er=null,wt=!1,Hs=null,sn=!1,uh=Error(r(519));function Vs(s){var o=Error(r(418,""));throw Ko(wi(o,s)),uh}function Cy(s){var o=s.stateNode,h=s.type,S=s.memoizedProps;switch(o[Ut]=s,o[or]=S,h){case"dialog":pt("cancel",o),pt("close",o);break;case"iframe":case"object":case"embed":pt("load",o);break;case"video":case"audio":for(h=0;h<gc.length;h++)pt(gc[h],o);break;case"source":pt("error",o);break;case"img":case"image":case"link":pt("error",o),pt("load",o);break;case"details":pt("toggle",o);break;case"input":pt("invalid",o),jv(o,S.value,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name,!0),Hn(o);break;case"select":pt("invalid",o);break;case"textarea":pt("invalid",o),Gv(o,S.value,S.defaultValue,S.children),Hn(o)}h=S.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||o.textContent===""+h||S.suppressHydrationWarning===!0||Gb(o.textContent,h)?(S.popover!=null&&(pt("beforetoggle",o),pt("toggle",o)),S.onScroll!=null&&pt("scroll",o),S.onScrollEnd!=null&&pt("scrollend",o),S.onClick!=null&&(o.onclick=Ou),o=!0):o=!1,o||Vs(s)}function Ay(s){for(Vr=s.return;Vr;)switch(Vr.tag){case 5:case 13:sn=!1;return;case 27:case 3:sn=!0;return;default:Vr=Vr.return}}function Ho(s){if(s!==Vr)return!1;if(!wt)return Ay(s),wt=!0,!1;var o=s.tag,h;if((h=o!==3&&o!==27)&&((h=o===5)&&(h=s.type,h=!(h!=="form"&&h!=="button")||Cp(s.type,s.memoizedProps)),h=!h),h&&er&&Vs(s),Ay(s),o===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));e:{for(s=s.nextSibling,o=0;s;){if(s.nodeType===8)if(h=s.data,h==="/$"){if(o===0){er=qi(s.nextSibling);break e}o--}else h!=="$"&&h!=="$!"&&h!=="$?"||o++;s=s.nextSibling}er=null}}else o===27?(o=er,os(s.type)?(s=Lp,Lp=null,er=s):er=o):er=Vr?qi(s.stateNode.nextSibling):null;return!0}function Vo(){er=Vr=null,wt=!1}function xy(){var s=Hs;return s!==null&&(Qr===null?Qr=s:Qr.push.apply(Qr,s),Hs=null),s}function Ko(s){Hs===null?Hs=[s]:Hs.push(s)}var dh=q(null),Ks=null,Cn=null;function Kn(s,o,h){X(dh,o._currentValue),o._currentValue=h}function An(s){s._currentValue=dh.current,Z(dh)}function fh(s,o,h){for(;s!==null;){var S=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,S!==null&&(S.childLanes|=o)):S!==null&&(S.childLanes&o)!==o&&(S.childLanes|=o),s===h)break;s=s.return}}function hh(s,o,h,S){var x=s.child;for(x!==null&&(x.return=s);x!==null;){var O=x.dependencies;if(O!==null){var B=x.child;O=O.firstContext;e:for(;O!==null;){var G=O;O=x;for(var W=0;W<o.length;W++)if(G.context===o[W]){O.lanes|=h,G=O.alternate,G!==null&&(G.lanes|=h),fh(O.return,h,s),S||(B=null);break e}O=G.next}}else if(x.tag===18){if(B=x.return,B===null)throw Error(r(341));B.lanes|=h,O=B.alternate,O!==null&&(O.lanes|=h),fh(B,h,s),B=null}else B=x.child;if(B!==null)B.return=x;else for(B=x;B!==null;){if(B===s){B=null;break}if(x=B.sibling,x!==null){x.return=B.return,B=x;break}B=B.return}x=B}}function qo(s,o,h,S){s=null;for(var x=o,O=!1;x!==null;){if(!O){if((x.flags&524288)!==0)O=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var B=x.alternate;if(B===null)throw Error(r(387));if(B=B.memoizedProps,B!==null){var G=x.type;oi(x.pendingProps.value,B.value)||(s!==null?s.push(G):s=[G])}}else if(x===ve.current){if(B=x.alternate,B===null)throw Error(r(387));B.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(s!==null?s.push(Ec):s=[Ec])}x=x.return}s!==null&&hh(o,s,h,S),o.flags|=262144}function Zl(s){for(s=s.firstContext;s!==null;){if(!oi(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function qs(s){Ks=s,Cn=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Br(s){return Dy(Ks,s)}function Jl(s,o){return Ks===null&&qs(s),Dy(s,o)}function Dy(s,o){var h=o._currentValue;if(o={context:o,memoizedValue:h,next:null},Cn===null){if(s===null)throw Error(r(308));Cn=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else Cn=Cn.next=o;return h}var MA=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(h,S){s.push(S)}};this.abort=function(){o.aborted=!0,s.forEach(function(h){return h()})}},NA=i.unstable_scheduleCallback,BA=i.unstable_NormalPriority,mr={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ph(){return{controller:new MA,data:new Map,refCount:0}}function Yo(s){s.refCount--,s.refCount===0&&NA(BA,function(){s.controller.abort()})}var Wo=null,mh=0,Ia=0,Pa=null;function FA(s,o){if(Wo===null){var h=Wo=[];mh=0,Ia=vp(),Pa={status:"pending",value:void 0,then:function(S){h.push(S)}}}return mh++,o.then(Ly,Ly),o}function Ly(){if(--mh===0&&Wo!==null){Pa!==null&&(Pa.status="fulfilled");var s=Wo;Wo=null,Ia=0,Pa=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function UA(s,o){var h=[],S={status:"pending",value:null,reason:null,then:function(x){h.push(x)}};return s.then(function(){S.status="fulfilled",S.value=o;for(var x=0;x<h.length;x++)(0,h[x])(o)},function(x){for(S.status="rejected",S.reason=x,x=0;x<h.length;x++)(0,h[x])(void 0)}),S}var Oy=N.S;N.S=function(s,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&FA(s,o),Oy!==null&&Oy(s,o)};var Ys=q(null);function gh(){var s=Ys.current;return s!==null?s:zt.pooledCache}function eu(s,o){o===null?X(Ys,Ys.current):X(Ys,o.pool)}function Iy(){var s=gh();return s===null?null:{parent:mr._currentValue,pool:s}}var Xo=Error(r(460)),Py=Error(r(474)),tu=Error(r(542)),vh={then:function(){}};function ky(s){return s=s.status,s==="fulfilled"||s==="rejected"}function ru(){}function My(s,o,h){switch(h=s[h],h===void 0?s.push(o):h!==o&&(o.then(ru,ru),o=h),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,By(s),s;default:if(typeof o.status=="string")o.then(ru,ru);else{if(s=zt,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=o,s.status="pending",s.then(function(S){if(o.status==="pending"){var x=o;x.status="fulfilled",x.value=S}},function(S){if(o.status==="pending"){var x=o;x.status="rejected",x.reason=S}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,By(s),s}throw Qo=o,Xo}}var Qo=null;function Ny(){if(Qo===null)throw Error(r(459));var s=Qo;return Qo=null,s}function By(s){if(s===Xo||s===tu)throw Error(r(483))}var qn=!1;function yh(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function bh(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Yn(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Wn(s,o,h){var S=s.updateQueue;if(S===null)return null;if(S=S.shared,(xt&2)!==0){var x=S.pending;return x===null?o.next=o:(o.next=x.next,x.next=o),S.pending=o,o=Yl(s),Ry(s,null,h),o}return ql(s,S,o,h),Yl(s)}function Zo(s,o,h){if(o=o.updateQueue,o!==null&&(o=o.shared,(h&4194048)!==0)){var S=o.lanes;S&=s.pendingLanes,h|=S,o.lanes=h,Zt(s,h)}}function _h(s,o){var h=s.updateQueue,S=s.alternate;if(S!==null&&(S=S.updateQueue,h===S)){var x=null,O=null;if(h=h.firstBaseUpdate,h!==null){do{var B={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};O===null?x=O=B:O=O.next=B,h=h.next}while(h!==null);O===null?x=O=o:O=O.next=o}else x=O=o;h={baseState:S.baseState,firstBaseUpdate:x,lastBaseUpdate:O,shared:S.shared,callbacks:S.callbacks},s.updateQueue=h;return}s=h.lastBaseUpdate,s===null?h.firstBaseUpdate=o:s.next=o,h.lastBaseUpdate=o}var Sh=!1;function Jo(){if(Sh){var s=Pa;if(s!==null)throw s}}function ec(s,o,h,S){Sh=!1;var x=s.updateQueue;qn=!1;var O=x.firstBaseUpdate,B=x.lastBaseUpdate,G=x.shared.pending;if(G!==null){x.shared.pending=null;var W=G,se=W.next;W.next=null,B===null?O=se:B.next=se,B=W;var de=s.alternate;de!==null&&(de=de.updateQueue,G=de.lastBaseUpdate,G!==B&&(G===null?de.firstBaseUpdate=se:G.next=se,de.lastBaseUpdate=W))}if(O!==null){var me=x.baseState;B=0,de=se=W=null,G=O;do{var ae=G.lane&-536870913,ce=ae!==G.lane;if(ce?(bt&ae)===ae:(S&ae)===ae){ae!==0&&ae===Ia&&(Sh=!0),de!==null&&(de=de.next={lane:0,tag:G.tag,payload:G.payload,callback:null,next:null});e:{var We=s,Ve=G;ae=o;var kt=h;switch(Ve.tag){case 1:if(We=Ve.payload,typeof We=="function"){me=We.call(kt,me,ae);break e}me=We;break e;case 3:We.flags=We.flags&-65537|128;case 0:if(We=Ve.payload,ae=typeof We=="function"?We.call(kt,me,ae):We,ae==null)break e;me=f({},me,ae);break e;case 2:qn=!0}}ae=G.callback,ae!==null&&(s.flags|=64,ce&&(s.flags|=8192),ce=x.callbacks,ce===null?x.callbacks=[ae]:ce.push(ae))}else ce={lane:ae,tag:G.tag,payload:G.payload,callback:G.callback,next:null},de===null?(se=de=ce,W=me):de=de.next=ce,B|=ae;if(G=G.next,G===null){if(G=x.shared.pending,G===null)break;ce=G,G=ce.next,ce.next=null,x.lastBaseUpdate=ce,x.shared.pending=null}}while(!0);de===null&&(W=me),x.baseState=W,x.firstBaseUpdate=se,x.lastBaseUpdate=de,O===null&&(x.shared.lanes=0),is|=B,s.lanes=B,s.memoizedState=me}}function Fy(s,o){if(typeof s!="function")throw Error(r(191,s));s.call(o)}function Uy(s,o){var h=s.callbacks;if(h!==null)for(s.callbacks=null,s=0;s<h.length;s++)Fy(h[s],o)}var ka=q(null),iu=q(0);function $y(s,o){s=kn,X(iu,s),X(ka,o),kn=s|o.baseLanes}function Eh(){X(iu,kn),X(ka,ka.current)}function Rh(){kn=iu.current,Z(ka),Z(iu)}var Xn=0,ct=null,It=null,ur=null,nu=!1,Ma=!1,Ws=!1,su=0,tc=0,Na=null,$A=0;function rr(){throw Error(r(321))}function wh(s,o){if(o===null)return!1;for(var h=0;h<o.length&&h<s.length;h++)if(!oi(s[h],o[h]))return!1;return!0}function Th(s,o,h,S,x,O){return Xn=O,ct=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,N.H=s===null||s.memoizedState===null?R0:w0,Ws=!1,O=h(S,x),Ws=!1,Ma&&(O=zy(o,h,S,x)),jy(s),O}function jy(s){N.H=du;var o=It!==null&&It.next!==null;if(Xn=0,ur=It=ct=null,nu=!1,tc=0,Na=null,o)throw Error(r(300));s===null||Rr||(s=s.dependencies,s!==null&&Zl(s)&&(Rr=!0))}function zy(s,o,h,S){ct=s;var x=0;do{if(Ma&&(Na=null),tc=0,Ma=!1,25<=x)throw Error(r(301));if(x+=1,ur=It=null,s.updateQueue!=null){var O=s.updateQueue;O.lastEffect=null,O.events=null,O.stores=null,O.memoCache!=null&&(O.memoCache.index=0)}N.H=qA,O=o(h,S)}while(Ma);return O}function jA(){var s=N.H,o=s.useState()[0];return o=typeof o.then=="function"?rc(o):o,s=s.useState()[0],(It!==null?It.memoizedState:null)!==s&&(ct.flags|=1024),o}function Ch(){var s=su!==0;return su=0,s}function Ah(s,o,h){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~h}function xh(s){if(nu){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}nu=!1}Xn=0,ur=It=ct=null,Ma=!1,tc=su=0,Na=null}function Wr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ur===null?ct.memoizedState=ur=s:ur=ur.next=s,ur}function dr(){if(It===null){var s=ct.alternate;s=s!==null?s.memoizedState:null}else s=It.next;var o=ur===null?ct.memoizedState:ur.next;if(o!==null)ur=o,It=s;else{if(s===null)throw ct.alternate===null?Error(r(467)):Error(r(310));It=s,s={memoizedState:It.memoizedState,baseState:It.baseState,baseQueue:It.baseQueue,queue:It.queue,next:null},ur===null?ct.memoizedState=ur=s:ur=ur.next=s}return ur}function Dh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function rc(s){var o=tc;return tc+=1,Na===null&&(Na=[]),s=My(Na,s,o),o=ct,(ur===null?o.memoizedState:ur.next)===null&&(o=o.alternate,N.H=o===null||o.memoizedState===null?R0:w0),s}function au(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return rc(s);if(s.$$typeof===R)return Br(s)}throw Error(r(438,String(s)))}function Lh(s){var o=null,h=ct.updateQueue;if(h!==null&&(o=h.memoCache),o==null){var S=ct.alternate;S!==null&&(S=S.updateQueue,S!==null&&(S=S.memoCache,S!=null&&(o={data:S.data.map(function(x){return x.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),h===null&&(h=Dh(),ct.updateQueue=h),h.memoCache=o,h=o.data[o.index],h===void 0)for(h=o.data[o.index]=Array(s),S=0;S<s;S++)h[S]=P;return o.index++,h}function xn(s,o){return typeof o=="function"?o(s):o}function ou(s){var o=dr();return Oh(o,It,s)}function Oh(s,o,h){var S=s.queue;if(S===null)throw Error(r(311));S.lastRenderedReducer=h;var x=s.baseQueue,O=S.pending;if(O!==null){if(x!==null){var B=x.next;x.next=O.next,O.next=B}o.baseQueue=x=O,S.pending=null}if(O=s.baseState,x===null)s.memoizedState=O;else{o=x.next;var G=B=null,W=null,se=o,de=!1;do{var me=se.lane&-536870913;if(me!==se.lane?(bt&me)===me:(Xn&me)===me){var ae=se.revertLane;if(ae===0)W!==null&&(W=W.next={lane:0,revertLane:0,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),me===Ia&&(de=!0);else if((Xn&ae)===ae){se=se.next,ae===Ia&&(de=!0);continue}else me={lane:0,revertLane:se.revertLane,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},W===null?(G=W=me,B=O):W=W.next=me,ct.lanes|=ae,is|=ae;me=se.action,Ws&&h(O,me),O=se.hasEagerState?se.eagerState:h(O,me)}else ae={lane:me,revertLane:se.revertLane,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},W===null?(G=W=ae,B=O):W=W.next=ae,ct.lanes|=me,is|=me;se=se.next}while(se!==null&&se!==o);if(W===null?B=O:W.next=G,!oi(O,s.memoizedState)&&(Rr=!0,de&&(h=Pa,h!==null)))throw h;s.memoizedState=O,s.baseState=B,s.baseQueue=W,S.lastRenderedState=O}return x===null&&(S.lanes=0),[s.memoizedState,S.dispatch]}function Ih(s){var o=dr(),h=o.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=s;var S=h.dispatch,x=h.pending,O=o.memoizedState;if(x!==null){h.pending=null;var B=x=x.next;do O=s(O,B.action),B=B.next;while(B!==x);oi(O,o.memoizedState)||(Rr=!0),o.memoizedState=O,o.baseQueue===null&&(o.baseState=O),h.lastRenderedState=O}return[O,S]}function Gy(s,o,h){var S=ct,x=dr(),O=wt;if(O){if(h===void 0)throw Error(r(407));h=h()}else h=o();var B=!oi((It||x).memoizedState,h);B&&(x.memoizedState=h,Rr=!0),x=x.queue;var G=Ky.bind(null,S,x,s);if(ic(2048,8,G,[s]),x.getSnapshot!==o||B||ur!==null&&ur.memoizedState.tag&1){if(S.flags|=2048,Ba(9,cu(),Vy.bind(null,S,x,h,o),null),zt===null)throw Error(r(349));O||(Xn&124)!==0||Hy(S,o,h)}return h}function Hy(s,o,h){s.flags|=16384,s={getSnapshot:o,value:h},o=ct.updateQueue,o===null?(o=Dh(),ct.updateQueue=o,o.stores=[s]):(h=o.stores,h===null?o.stores=[s]:h.push(s))}function Vy(s,o,h,S){o.value=h,o.getSnapshot=S,qy(o)&&Yy(s)}function Ky(s,o,h){return h(function(){qy(o)&&Yy(s)})}function qy(s){var o=s.getSnapshot;s=s.value;try{var h=o();return!oi(s,h)}catch{return!0}}function Yy(s){var o=xa(s,2);o!==null&&hi(o,s,2)}function Ph(s){var o=Wr();if(typeof s=="function"){var h=s;if(s=h(),Ws){Ze(!0);try{h()}finally{Ze(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xn,lastRenderedState:s},o}function Wy(s,o,h,S){return s.baseState=h,Oh(s,It,typeof S=="function"?S:xn)}function zA(s,o,h,S,x){if(uu(s))throw Error(r(485));if(s=o.action,s!==null){var O={payload:x,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(B){O.listeners.push(B)}};N.T!==null?h(!0):O.isTransition=!1,S(O),h=o.pending,h===null?(O.next=o.pending=O,Xy(o,O)):(O.next=h.next,o.pending=h.next=O)}}function Xy(s,o){var h=o.action,S=o.payload,x=s.state;if(o.isTransition){var O=N.T,B={};N.T=B;try{var G=h(x,S),W=N.S;W!==null&&W(B,G),Qy(s,o,G)}catch(se){kh(s,o,se)}finally{N.T=O}}else try{O=h(x,S),Qy(s,o,O)}catch(se){kh(s,o,se)}}function Qy(s,o,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(S){Zy(s,o,S)},function(S){return kh(s,o,S)}):Zy(s,o,h)}function Zy(s,o,h){o.status="fulfilled",o.value=h,Jy(o),s.state=h,o=s.pending,o!==null&&(h=o.next,h===o?s.pending=null:(h=h.next,o.next=h,Xy(s,h)))}function kh(s,o,h){var S=s.pending;if(s.pending=null,S!==null){S=S.next;do o.status="rejected",o.reason=h,Jy(o),o=o.next;while(o!==S)}s.action=null}function Jy(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function e0(s,o){return o}function t0(s,o){if(wt){var h=zt.formState;if(h!==null){e:{var S=ct;if(wt){if(er){t:{for(var x=er,O=sn;x.nodeType!==8;){if(!O){x=null;break t}if(x=qi(x.nextSibling),x===null){x=null;break t}}O=x.data,x=O==="F!"||O==="F"?x:null}if(x){er=qi(x.nextSibling),S=x.data==="F!";break e}}Vs(S)}S=!1}S&&(o=h[0])}}return h=Wr(),h.memoizedState=h.baseState=o,S={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e0,lastRenderedState:o},h.queue=S,h=_0.bind(null,ct,S),S.dispatch=h,S=Ph(!1),O=Uh.bind(null,ct,!1,S.queue),S=Wr(),x={state:o,dispatch:null,action:s,pending:null},S.queue=x,h=zA.bind(null,ct,x,O,h),x.dispatch=h,S.memoizedState=s,[o,h,!1]}function r0(s){var o=dr();return i0(o,It,s)}function i0(s,o,h){if(o=Oh(s,o,e0)[0],s=ou(xn)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var S=rc(o)}catch(B){throw B===Xo?tu:B}else S=o;o=dr();var x=o.queue,O=x.dispatch;return h!==o.memoizedState&&(ct.flags|=2048,Ba(9,cu(),GA.bind(null,x,h),null)),[S,O,s]}function GA(s,o){s.action=o}function n0(s){var o=dr(),h=It;if(h!==null)return i0(o,h,s);dr(),o=o.memoizedState,h=dr();var S=h.queue.dispatch;return h.memoizedState=s,[o,S,!1]}function Ba(s,o,h,S){return s={tag:s,create:h,deps:S,inst:o,next:null},o=ct.updateQueue,o===null&&(o=Dh(),ct.updateQueue=o),h=o.lastEffect,h===null?o.lastEffect=s.next=s:(S=h.next,h.next=s,s.next=S,o.lastEffect=s),s}function cu(){return{destroy:void 0,resource:void 0}}function s0(){return dr().memoizedState}function lu(s,o,h,S){var x=Wr();S=S===void 0?null:S,ct.flags|=s,x.memoizedState=Ba(1|o,cu(),h,S)}function ic(s,o,h,S){var x=dr();S=S===void 0?null:S;var O=x.memoizedState.inst;It!==null&&S!==null&&wh(S,It.memoizedState.deps)?x.memoizedState=Ba(o,O,h,S):(ct.flags|=s,x.memoizedState=Ba(1|o,O,h,S))}function a0(s,o){lu(8390656,8,s,o)}function o0(s,o){ic(2048,8,s,o)}function c0(s,o){return ic(4,2,s,o)}function l0(s,o){return ic(4,4,s,o)}function u0(s,o){if(typeof o=="function"){s=s();var h=o(s);return function(){typeof h=="function"?h():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function d0(s,o,h){h=h!=null?h.concat([s]):null,ic(4,4,u0.bind(null,o,s),h)}function Mh(){}function f0(s,o){var h=dr();o=o===void 0?null:o;var S=h.memoizedState;return o!==null&&wh(o,S[1])?S[0]:(h.memoizedState=[s,o],s)}function h0(s,o){var h=dr();o=o===void 0?null:o;var S=h.memoizedState;if(o!==null&&wh(o,S[1]))return S[0];if(S=s(),Ws){Ze(!0);try{s()}finally{Ze(!1)}}return h.memoizedState=[S,o],S}function Nh(s,o,h){return h===void 0||(Xn&1073741824)!==0?s.memoizedState=o:(s.memoizedState=h,s=gb(),ct.lanes|=s,is|=s,h)}function p0(s,o,h,S){return oi(h,o)?h:ka.current!==null?(s=Nh(s,h,S),oi(s,o)||(Rr=!0),s):(Xn&42)===0?(Rr=!0,s.memoizedState=h):(s=gb(),ct.lanes|=s,is|=s,o)}function m0(s,o,h,S,x){var O=U.p;U.p=O!==0&&8>O?O:8;var B=N.T,G={};N.T=G,Uh(s,!1,o,h);try{var W=x(),se=N.S;if(se!==null&&se(G,W),W!==null&&typeof W=="object"&&typeof W.then=="function"){var de=UA(W,S);nc(s,o,de,fi(s))}else nc(s,o,S,fi(s))}catch(me){nc(s,o,{then:function(){},status:"rejected",reason:me},fi())}finally{U.p=O,N.T=B}}function HA(){}function Bh(s,o,h,S){if(s.tag!==5)throw Error(r(476));var x=g0(s).queue;m0(s,x,o,V,h===null?HA:function(){return v0(s),h(S)})}function g0(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:V,baseState:V,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:xn,lastRenderedState:V},next:null};var h={};return o.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:xn,lastRenderedState:h},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function v0(s){var o=g0(s).next.queue;nc(s,o,{},fi())}function Fh(){return Br(Ec)}function y0(){return dr().memoizedState}function b0(){return dr().memoizedState}function VA(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var h=fi();s=Yn(h);var S=Wn(o,s,h);S!==null&&(hi(S,o,h),Zo(S,o,h)),o={cache:ph()},s.payload=o;return}o=o.return}}function KA(s,o,h){var S=fi();h={lane:S,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null},uu(s)?S0(o,h):(h=nh(s,o,h,S),h!==null&&(hi(h,s,S),E0(h,o,S)))}function _0(s,o,h){var S=fi();nc(s,o,h,S)}function nc(s,o,h,S){var x={lane:S,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null};if(uu(s))S0(o,x);else{var O=s.alternate;if(s.lanes===0&&(O===null||O.lanes===0)&&(O=o.lastRenderedReducer,O!==null))try{var B=o.lastRenderedState,G=O(B,h);if(x.hasEagerState=!0,x.eagerState=G,oi(G,B))return ql(s,o,x,0),zt===null&&Kl(),!1}catch{}finally{}if(h=nh(s,o,x,S),h!==null)return hi(h,s,S),E0(h,o,S),!0}return!1}function Uh(s,o,h,S){if(S={lane:2,revertLane:vp(),action:S,hasEagerState:!1,eagerState:null,next:null},uu(s)){if(o)throw Error(r(479))}else o=nh(s,h,S,2),o!==null&&hi(o,s,2)}function uu(s){var o=s.alternate;return s===ct||o!==null&&o===ct}function S0(s,o){Ma=nu=!0;var h=s.pending;h===null?o.next=o:(o.next=h.next,h.next=o),s.pending=o}function E0(s,o,h){if((h&4194048)!==0){var S=o.lanes;S&=s.pendingLanes,h|=S,o.lanes=h,Zt(s,h)}}var du={readContext:Br,use:au,useCallback:rr,useContext:rr,useEffect:rr,useImperativeHandle:rr,useLayoutEffect:rr,useInsertionEffect:rr,useMemo:rr,useReducer:rr,useRef:rr,useState:rr,useDebugValue:rr,useDeferredValue:rr,useTransition:rr,useSyncExternalStore:rr,useId:rr,useHostTransitionStatus:rr,useFormState:rr,useActionState:rr,useOptimistic:rr,useMemoCache:rr,useCacheRefresh:rr},R0={readContext:Br,use:au,useCallback:function(s,o){return Wr().memoizedState=[s,o===void 0?null:o],s},useContext:Br,useEffect:a0,useImperativeHandle:function(s,o,h){h=h!=null?h.concat([s]):null,lu(4194308,4,u0.bind(null,o,s),h)},useLayoutEffect:function(s,o){return lu(4194308,4,s,o)},useInsertionEffect:function(s,o){lu(4,2,s,o)},useMemo:function(s,o){var h=Wr();o=o===void 0?null:o;var S=s();if(Ws){Ze(!0);try{s()}finally{Ze(!1)}}return h.memoizedState=[S,o],S},useReducer:function(s,o,h){var S=Wr();if(h!==void 0){var x=h(o);if(Ws){Ze(!0);try{h(o)}finally{Ze(!1)}}}else x=o;return S.memoizedState=S.baseState=x,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:x},S.queue=s,s=s.dispatch=KA.bind(null,ct,s),[S.memoizedState,s]},useRef:function(s){var o=Wr();return s={current:s},o.memoizedState=s},useState:function(s){s=Ph(s);var o=s.queue,h=_0.bind(null,ct,o);return o.dispatch=h,[s.memoizedState,h]},useDebugValue:Mh,useDeferredValue:function(s,o){var h=Wr();return Nh(h,s,o)},useTransition:function(){var s=Ph(!1);return s=m0.bind(null,ct,s.queue,!0,!1),Wr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,h){var S=ct,x=Wr();if(wt){if(h===void 0)throw Error(r(407));h=h()}else{if(h=o(),zt===null)throw Error(r(349));(bt&124)!==0||Hy(S,o,h)}x.memoizedState=h;var O={value:h,getSnapshot:o};return x.queue=O,a0(Ky.bind(null,S,O,s),[s]),S.flags|=2048,Ba(9,cu(),Vy.bind(null,S,O,h,o),null),h},useId:function(){var s=Wr(),o=zt.identifierPrefix;if(wt){var h=Tn,S=wn;h=(S&~(1<<32-Et(S)-1)).toString(32)+h,o="«"+o+"R"+h,h=su++,0<h&&(o+="H"+h.toString(32)),o+="»"}else h=$A++,o="«"+o+"r"+h.toString(32)+"»";return s.memoizedState=o},useHostTransitionStatus:Fh,useFormState:t0,useActionState:t0,useOptimistic:function(s){var o=Wr();o.memoizedState=o.baseState=s;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=h,o=Uh.bind(null,ct,!0,h),h.dispatch=o,[s,o]},useMemoCache:Lh,useCacheRefresh:function(){return Wr().memoizedState=VA.bind(null,ct)}},w0={readContext:Br,use:au,useCallback:f0,useContext:Br,useEffect:o0,useImperativeHandle:d0,useInsertionEffect:c0,useLayoutEffect:l0,useMemo:h0,useReducer:ou,useRef:s0,useState:function(){return ou(xn)},useDebugValue:Mh,useDeferredValue:function(s,o){var h=dr();return p0(h,It.memoizedState,s,o)},useTransition:function(){var s=ou(xn)[0],o=dr().memoizedState;return[typeof s=="boolean"?s:rc(s),o]},useSyncExternalStore:Gy,useId:y0,useHostTransitionStatus:Fh,useFormState:r0,useActionState:r0,useOptimistic:function(s,o){var h=dr();return Wy(h,It,s,o)},useMemoCache:Lh,useCacheRefresh:b0},qA={readContext:Br,use:au,useCallback:f0,useContext:Br,useEffect:o0,useImperativeHandle:d0,useInsertionEffect:c0,useLayoutEffect:l0,useMemo:h0,useReducer:Ih,useRef:s0,useState:function(){return Ih(xn)},useDebugValue:Mh,useDeferredValue:function(s,o){var h=dr();return It===null?Nh(h,s,o):p0(h,It.memoizedState,s,o)},useTransition:function(){var s=Ih(xn)[0],o=dr().memoizedState;return[typeof s=="boolean"?s:rc(s),o]},useSyncExternalStore:Gy,useId:y0,useHostTransitionStatus:Fh,useFormState:n0,useActionState:n0,useOptimistic:function(s,o){var h=dr();return It!==null?Wy(h,It,s,o):(h.baseState=s,[s,h.queue.dispatch])},useMemoCache:Lh,useCacheRefresh:b0},Fa=null,sc=0;function fu(s){var o=sc;return sc+=1,Fa===null&&(Fa=[]),My(Fa,s,o)}function ac(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function hu(s,o){throw o.$$typeof===p?Error(r(525)):(s=Object.prototype.toString.call(o),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function T0(s){var o=s._init;return o(s._payload)}function C0(s){function o(ee,Q){if(s){var ne=ee.deletions;ne===null?(ee.deletions=[Q],ee.flags|=16):ne.push(Q)}}function h(ee,Q){if(!s)return null;for(;Q!==null;)o(ee,Q),Q=Q.sibling;return null}function S(ee){for(var Q=new Map;ee!==null;)ee.key!==null?Q.set(ee.key,ee):Q.set(ee.index,ee),ee=ee.sibling;return Q}function x(ee,Q){return ee=Rn(ee,Q),ee.index=0,ee.sibling=null,ee}function O(ee,Q,ne){return ee.index=ne,s?(ne=ee.alternate,ne!==null?(ne=ne.index,ne<Q?(ee.flags|=67108866,Q):ne):(ee.flags|=67108866,Q)):(ee.flags|=1048576,Q)}function B(ee){return s&&ee.alternate===null&&(ee.flags|=67108866),ee}function G(ee,Q,ne,fe){return Q===null||Q.tag!==6?(Q=ah(ne,ee.mode,fe),Q.return=ee,Q):(Q=x(Q,ne),Q.return=ee,Q)}function W(ee,Q,ne,fe){var Le=ne.type;return Le===g?de(ee,Q,ne.props.children,fe,ne.key):Q!==null&&(Q.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===L&&T0(Le)===Q.type)?(Q=x(Q,ne.props),ac(Q,ne),Q.return=ee,Q):(Q=Wl(ne.type,ne.key,ne.props,null,ee.mode,fe),ac(Q,ne),Q.return=ee,Q)}function se(ee,Q,ne,fe){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==ne.containerInfo||Q.stateNode.implementation!==ne.implementation?(Q=oh(ne,ee.mode,fe),Q.return=ee,Q):(Q=x(Q,ne.children||[]),Q.return=ee,Q)}function de(ee,Q,ne,fe,Le){return Q===null||Q.tag!==7?(Q=js(ne,ee.mode,fe,Le),Q.return=ee,Q):(Q=x(Q,ne),Q.return=ee,Q)}function me(ee,Q,ne){if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Q=ah(""+Q,ee.mode,ne),Q.return=ee,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case v:return ne=Wl(Q.type,Q.key,Q.props,null,ee.mode,ne),ac(ne,Q),ne.return=ee,ne;case E:return Q=oh(Q,ee.mode,ne),Q.return=ee,Q;case L:var fe=Q._init;return Q=fe(Q._payload),me(ee,Q,ne)}if($(Q)||M(Q))return Q=js(Q,ee.mode,ne,null),Q.return=ee,Q;if(typeof Q.then=="function")return me(ee,fu(Q),ne);if(Q.$$typeof===R)return me(ee,Jl(ee,Q),ne);hu(ee,Q)}return null}function ae(ee,Q,ne,fe){var Le=Q!==null?Q.key:null;if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return Le!==null?null:G(ee,Q,""+ne,fe);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case v:return ne.key===Le?W(ee,Q,ne,fe):null;case E:return ne.key===Le?se(ee,Q,ne,fe):null;case L:return Le=ne._init,ne=Le(ne._payload),ae(ee,Q,ne,fe)}if($(ne)||M(ne))return Le!==null?null:de(ee,Q,ne,fe,null);if(typeof ne.then=="function")return ae(ee,Q,fu(ne),fe);if(ne.$$typeof===R)return ae(ee,Q,Jl(ee,ne),fe);hu(ee,ne)}return null}function ce(ee,Q,ne,fe,Le){if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return ee=ee.get(ne)||null,G(Q,ee,""+fe,Le);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case v:return ee=ee.get(fe.key===null?ne:fe.key)||null,W(Q,ee,fe,Le);case E:return ee=ee.get(fe.key===null?ne:fe.key)||null,se(Q,ee,fe,Le);case L:var dt=fe._init;return fe=dt(fe._payload),ce(ee,Q,ne,fe,Le)}if($(fe)||M(fe))return ee=ee.get(ne)||null,de(Q,ee,fe,Le,null);if(typeof fe.then=="function")return ce(ee,Q,ne,fu(fe),Le);if(fe.$$typeof===R)return ce(ee,Q,ne,Jl(Q,fe),Le);hu(Q,fe)}return null}function We(ee,Q,ne,fe){for(var Le=null,dt=null,Ne=Q,Ke=Q=0,Tr=null;Ne!==null&&Ke<ne.length;Ke++){Ne.index>Ke?(Tr=Ne,Ne=null):Tr=Ne.sibling;var St=ae(ee,Ne,ne[Ke],fe);if(St===null){Ne===null&&(Ne=Tr);break}s&&Ne&&St.alternate===null&&o(ee,Ne),Q=O(St,Q,Ke),dt===null?Le=St:dt.sibling=St,dt=St,Ne=Tr}if(Ke===ne.length)return h(ee,Ne),wt&&Gs(ee,Ke),Le;if(Ne===null){for(;Ke<ne.length;Ke++)Ne=me(ee,ne[Ke],fe),Ne!==null&&(Q=O(Ne,Q,Ke),dt===null?Le=Ne:dt.sibling=Ne,dt=Ne);return wt&&Gs(ee,Ke),Le}for(Ne=S(Ne);Ke<ne.length;Ke++)Tr=ce(Ne,ee,Ke,ne[Ke],fe),Tr!==null&&(s&&Tr.alternate!==null&&Ne.delete(Tr.key===null?Ke:Tr.key),Q=O(Tr,Q,Ke),dt===null?Le=Tr:dt.sibling=Tr,dt=Tr);return s&&Ne.forEach(function(fs){return o(ee,fs)}),wt&&Gs(ee,Ke),Le}function Ve(ee,Q,ne,fe){if(ne==null)throw Error(r(151));for(var Le=null,dt=null,Ne=Q,Ke=Q=0,Tr=null,St=ne.next();Ne!==null&&!St.done;Ke++,St=ne.next()){Ne.index>Ke?(Tr=Ne,Ne=null):Tr=Ne.sibling;var fs=ae(ee,Ne,St.value,fe);if(fs===null){Ne===null&&(Ne=Tr);break}s&&Ne&&fs.alternate===null&&o(ee,Ne),Q=O(fs,Q,Ke),dt===null?Le=fs:dt.sibling=fs,dt=fs,Ne=Tr}if(St.done)return h(ee,Ne),wt&&Gs(ee,Ke),Le;if(Ne===null){for(;!St.done;Ke++,St=ne.next())St=me(ee,St.value,fe),St!==null&&(Q=O(St,Q,Ke),dt===null?Le=St:dt.sibling=St,dt=St);return wt&&Gs(ee,Ke),Le}for(Ne=S(Ne);!St.done;Ke++,St=ne.next())St=ce(Ne,ee,Ke,St.value,fe),St!==null&&(s&&St.alternate!==null&&Ne.delete(St.key===null?Ke:St.key),Q=O(St,Q,Ke),dt===null?Le=St:dt.sibling=St,dt=St);return s&&Ne.forEach(function(Yx){return o(ee,Yx)}),wt&&Gs(ee,Ke),Le}function kt(ee,Q,ne,fe){if(typeof ne=="object"&&ne!==null&&ne.type===g&&ne.key===null&&(ne=ne.props.children),typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case v:e:{for(var Le=ne.key;Q!==null;){if(Q.key===Le){if(Le=ne.type,Le===g){if(Q.tag===7){h(ee,Q.sibling),fe=x(Q,ne.props.children),fe.return=ee,ee=fe;break e}}else if(Q.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===L&&T0(Le)===Q.type){h(ee,Q.sibling),fe=x(Q,ne.props),ac(fe,ne),fe.return=ee,ee=fe;break e}h(ee,Q);break}else o(ee,Q);Q=Q.sibling}ne.type===g?(fe=js(ne.props.children,ee.mode,fe,ne.key),fe.return=ee,ee=fe):(fe=Wl(ne.type,ne.key,ne.props,null,ee.mode,fe),ac(fe,ne),fe.return=ee,ee=fe)}return B(ee);case E:e:{for(Le=ne.key;Q!==null;){if(Q.key===Le)if(Q.tag===4&&Q.stateNode.containerInfo===ne.containerInfo&&Q.stateNode.implementation===ne.implementation){h(ee,Q.sibling),fe=x(Q,ne.children||[]),fe.return=ee,ee=fe;break e}else{h(ee,Q);break}else o(ee,Q);Q=Q.sibling}fe=oh(ne,ee.mode,fe),fe.return=ee,ee=fe}return B(ee);case L:return Le=ne._init,ne=Le(ne._payload),kt(ee,Q,ne,fe)}if($(ne))return We(ee,Q,ne,fe);if(M(ne)){if(Le=M(ne),typeof Le!="function")throw Error(r(150));return ne=Le.call(ne),Ve(ee,Q,ne,fe)}if(typeof ne.then=="function")return kt(ee,Q,fu(ne),fe);if(ne.$$typeof===R)return kt(ee,Q,Jl(ee,ne),fe);hu(ee,ne)}return typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint"?(ne=""+ne,Q!==null&&Q.tag===6?(h(ee,Q.sibling),fe=x(Q,ne),fe.return=ee,ee=fe):(h(ee,Q),fe=ah(ne,ee.mode,fe),fe.return=ee,ee=fe),B(ee)):h(ee,Q)}return function(ee,Q,ne,fe){try{sc=0;var Le=kt(ee,Q,ne,fe);return Fa=null,Le}catch(Ne){if(Ne===Xo||Ne===tu)throw Ne;var dt=ci(29,Ne,null,ee.mode);return dt.lanes=fe,dt.return=ee,dt}finally{}}}var Ua=C0(!0),A0=C0(!1),xi=q(null),an=null;function Qn(s){var o=s.alternate;X(gr,gr.current&1),X(xi,s),an===null&&(o===null||ka.current!==null||o.memoizedState!==null)&&(an=s)}function x0(s){if(s.tag===22){if(X(gr,gr.current),X(xi,s),an===null){var o=s.alternate;o!==null&&o.memoizedState!==null&&(an=s)}}else Zn()}function Zn(){X(gr,gr.current),X(xi,xi.current)}function Dn(s){Z(xi),an===s&&(an=null),Z(gr)}var gr=q(0);function pu(s){for(var o=s;o!==null;){if(o.tag===13){var h=o.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||Dp(h)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function $h(s,o,h,S){o=s.memoizedState,h=h(S,o),h=h==null?o:f({},o,h),s.memoizedState=h,s.lanes===0&&(s.updateQueue.baseState=h)}var jh={enqueueSetState:function(s,o,h){s=s._reactInternals;var S=fi(),x=Yn(S);x.payload=o,h!=null&&(x.callback=h),o=Wn(s,x,S),o!==null&&(hi(o,s,S),Zo(o,s,S))},enqueueReplaceState:function(s,o,h){s=s._reactInternals;var S=fi(),x=Yn(S);x.tag=1,x.payload=o,h!=null&&(x.callback=h),o=Wn(s,x,S),o!==null&&(hi(o,s,S),Zo(o,s,S))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var h=fi(),S=Yn(h);S.tag=2,o!=null&&(S.callback=o),o=Wn(s,S,h),o!==null&&(hi(o,s,h),Zo(o,s,h))}};function D0(s,o,h,S,x,O,B){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(S,O,B):o.prototype&&o.prototype.isPureReactComponent?!zo(h,S)||!zo(x,O):!0}function L0(s,o,h,S){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(h,S),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(h,S),o.state!==s&&jh.enqueueReplaceState(o,o.state,null)}function Xs(s,o){var h=o;if("ref"in o){h={};for(var S in o)S!=="ref"&&(h[S]=o[S])}if(s=s.defaultProps){h===o&&(h=f({},h));for(var x in s)h[x]===void 0&&(h[x]=s[x])}return h}var mu=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function O0(s){mu(s)}function I0(s){console.error(s)}function P0(s){mu(s)}function gu(s,o){try{var h=s.onUncaughtError;h(o.value,{componentStack:o.stack})}catch(S){setTimeout(function(){throw S})}}function k0(s,o,h){try{var S=s.onCaughtError;S(h.value,{componentStack:h.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function zh(s,o,h){return h=Yn(h),h.tag=3,h.payload={element:null},h.callback=function(){gu(s,o)},h}function M0(s){return s=Yn(s),s.tag=3,s}function N0(s,o,h,S){var x=h.type.getDerivedStateFromError;if(typeof x=="function"){var O=S.value;s.payload=function(){return x(O)},s.callback=function(){k0(o,h,S)}}var B=h.stateNode;B!==null&&typeof B.componentDidCatch=="function"&&(s.callback=function(){k0(o,h,S),typeof x!="function"&&(ns===null?ns=new Set([this]):ns.add(this));var G=S.stack;this.componentDidCatch(S.value,{componentStack:G!==null?G:""})})}function YA(s,o,h,S,x){if(h.flags|=32768,S!==null&&typeof S=="object"&&typeof S.then=="function"){if(o=h.alternate,o!==null&&qo(o,h,x,!0),h=xi.current,h!==null){switch(h.tag){case 13:return an===null?fp():h.alternate===null&&tr===0&&(tr=3),h.flags&=-257,h.flags|=65536,h.lanes=x,S===vh?h.flags|=16384:(o=h.updateQueue,o===null?h.updateQueue=new Set([S]):o.add(S),pp(s,S,x)),!1;case 22:return h.flags|=65536,S===vh?h.flags|=16384:(o=h.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([S])},h.updateQueue=o):(h=o.retryQueue,h===null?o.retryQueue=new Set([S]):h.add(S)),pp(s,S,x)),!1}throw Error(r(435,h.tag))}return pp(s,S,x),fp(),!1}if(wt)return o=xi.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=x,S!==uh&&(s=Error(r(422),{cause:S}),Ko(wi(s,h)))):(S!==uh&&(o=Error(r(423),{cause:S}),Ko(wi(o,h))),s=s.current.alternate,s.flags|=65536,x&=-x,s.lanes|=x,S=wi(S,h),x=zh(s.stateNode,S,x),_h(s,x),tr!==4&&(tr=2)),!1;var O=Error(r(520),{cause:S});if(O=wi(O,h),hc===null?hc=[O]:hc.push(O),tr!==4&&(tr=2),o===null)return!0;S=wi(S,h),h=o;do{switch(h.tag){case 3:return h.flags|=65536,s=x&-x,h.lanes|=s,s=zh(h.stateNode,S,s),_h(h,s),!1;case 1:if(o=h.type,O=h.stateNode,(h.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||O!==null&&typeof O.componentDidCatch=="function"&&(ns===null||!ns.has(O))))return h.flags|=65536,x&=-x,h.lanes|=x,x=M0(x),N0(x,s,h,S),_h(h,x),!1}h=h.return}while(h!==null);return!1}var B0=Error(r(461)),Rr=!1;function Or(s,o,h,S){o.child=s===null?A0(o,null,h,S):Ua(o,s.child,h,S)}function F0(s,o,h,S,x){h=h.render;var O=o.ref;if("ref"in S){var B={};for(var G in S)G!=="ref"&&(B[G]=S[G])}else B=S;return qs(o),S=Th(s,o,h,B,O,x),G=Ch(),s!==null&&!Rr?(Ah(s,o,x),Ln(s,o,x)):(wt&&G&&ch(o),o.flags|=1,Or(s,o,S,x),o.child)}function U0(s,o,h,S,x){if(s===null){var O=h.type;return typeof O=="function"&&!sh(O)&&O.defaultProps===void 0&&h.compare===null?(o.tag=15,o.type=O,$0(s,o,O,S,x)):(s=Wl(h.type,null,S,o,o.mode,x),s.ref=o.ref,s.return=o,o.child=s)}if(O=s.child,!Xh(s,x)){var B=O.memoizedProps;if(h=h.compare,h=h!==null?h:zo,h(B,S)&&s.ref===o.ref)return Ln(s,o,x)}return o.flags|=1,s=Rn(O,S),s.ref=o.ref,s.return=o,o.child=s}function $0(s,o,h,S,x){if(s!==null){var O=s.memoizedProps;if(zo(O,S)&&s.ref===o.ref)if(Rr=!1,o.pendingProps=S=O,Xh(s,x))(s.flags&131072)!==0&&(Rr=!0);else return o.lanes=s.lanes,Ln(s,o,x)}return Gh(s,o,h,S,x)}function j0(s,o,h){var S=o.pendingProps,x=S.children,O=s!==null?s.memoizedState:null;if(S.mode==="hidden"){if((o.flags&128)!==0){if(S=O!==null?O.baseLanes|h:h,s!==null){for(x=o.child=s.child,O=0;x!==null;)O=O|x.lanes|x.childLanes,x=x.sibling;o.childLanes=O&~S}else o.childLanes=0,o.child=null;return z0(s,o,S,h)}if((h&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&eu(o,O!==null?O.cachePool:null),O!==null?$y(o,O):Eh(),x0(o);else return o.lanes=o.childLanes=536870912,z0(s,o,O!==null?O.baseLanes|h:h,h)}else O!==null?(eu(o,O.cachePool),$y(o,O),Zn(),o.memoizedState=null):(s!==null&&eu(o,null),Eh(),Zn());return Or(s,o,x,h),o.child}function z0(s,o,h,S){var x=gh();return x=x===null?null:{parent:mr._currentValue,pool:x},o.memoizedState={baseLanes:h,cachePool:x},s!==null&&eu(o,null),Eh(),x0(o),s!==null&&qo(s,o,S,!0),null}function vu(s,o){var h=o.ref;if(h===null)s!==null&&s.ref!==null&&(o.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(r(284));(s===null||s.ref!==h)&&(o.flags|=4194816)}}function Gh(s,o,h,S,x){return qs(o),h=Th(s,o,h,S,void 0,x),S=Ch(),s!==null&&!Rr?(Ah(s,o,x),Ln(s,o,x)):(wt&&S&&ch(o),o.flags|=1,Or(s,o,h,x),o.child)}function G0(s,o,h,S,x,O){return qs(o),o.updateQueue=null,h=zy(o,S,h,x),jy(s),S=Ch(),s!==null&&!Rr?(Ah(s,o,O),Ln(s,o,O)):(wt&&S&&ch(o),o.flags|=1,Or(s,o,h,O),o.child)}function H0(s,o,h,S,x){if(qs(o),o.stateNode===null){var O=Da,B=h.contextType;typeof B=="object"&&B!==null&&(O=Br(B)),O=new h(S,O),o.memoizedState=O.state!==null&&O.state!==void 0?O.state:null,O.updater=jh,o.stateNode=O,O._reactInternals=o,O=o.stateNode,O.props=S,O.state=o.memoizedState,O.refs={},yh(o),B=h.contextType,O.context=typeof B=="object"&&B!==null?Br(B):Da,O.state=o.memoizedState,B=h.getDerivedStateFromProps,typeof B=="function"&&($h(o,h,B,S),O.state=o.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof O.getSnapshotBeforeUpdate=="function"||typeof O.UNSAFE_componentWillMount!="function"&&typeof O.componentWillMount!="function"||(B=O.state,typeof O.componentWillMount=="function"&&O.componentWillMount(),typeof O.UNSAFE_componentWillMount=="function"&&O.UNSAFE_componentWillMount(),B!==O.state&&jh.enqueueReplaceState(O,O.state,null),ec(o,S,O,x),Jo(),O.state=o.memoizedState),typeof O.componentDidMount=="function"&&(o.flags|=4194308),S=!0}else if(s===null){O=o.stateNode;var G=o.memoizedProps,W=Xs(h,G);O.props=W;var se=O.context,de=h.contextType;B=Da,typeof de=="object"&&de!==null&&(B=Br(de));var me=h.getDerivedStateFromProps;de=typeof me=="function"||typeof O.getSnapshotBeforeUpdate=="function",G=o.pendingProps!==G,de||typeof O.UNSAFE_componentWillReceiveProps!="function"&&typeof O.componentWillReceiveProps!="function"||(G||se!==B)&&L0(o,O,S,B),qn=!1;var ae=o.memoizedState;O.state=ae,ec(o,S,O,x),Jo(),se=o.memoizedState,G||ae!==se||qn?(typeof me=="function"&&($h(o,h,me,S),se=o.memoizedState),(W=qn||D0(o,h,W,S,ae,se,B))?(de||typeof O.UNSAFE_componentWillMount!="function"&&typeof O.componentWillMount!="function"||(typeof O.componentWillMount=="function"&&O.componentWillMount(),typeof O.UNSAFE_componentWillMount=="function"&&O.UNSAFE_componentWillMount()),typeof O.componentDidMount=="function"&&(o.flags|=4194308)):(typeof O.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=S,o.memoizedState=se),O.props=S,O.state=se,O.context=B,S=W):(typeof O.componentDidMount=="function"&&(o.flags|=4194308),S=!1)}else{O=o.stateNode,bh(s,o),B=o.memoizedProps,de=Xs(h,B),O.props=de,me=o.pendingProps,ae=O.context,se=h.contextType,W=Da,typeof se=="object"&&se!==null&&(W=Br(se)),G=h.getDerivedStateFromProps,(se=typeof G=="function"||typeof O.getSnapshotBeforeUpdate=="function")||typeof O.UNSAFE_componentWillReceiveProps!="function"&&typeof O.componentWillReceiveProps!="function"||(B!==me||ae!==W)&&L0(o,O,S,W),qn=!1,ae=o.memoizedState,O.state=ae,ec(o,S,O,x),Jo();var ce=o.memoizedState;B!==me||ae!==ce||qn||s!==null&&s.dependencies!==null&&Zl(s.dependencies)?(typeof G=="function"&&($h(o,h,G,S),ce=o.memoizedState),(de=qn||D0(o,h,de,S,ae,ce,W)||s!==null&&s.dependencies!==null&&Zl(s.dependencies))?(se||typeof O.UNSAFE_componentWillUpdate!="function"&&typeof O.componentWillUpdate!="function"||(typeof O.componentWillUpdate=="function"&&O.componentWillUpdate(S,ce,W),typeof O.UNSAFE_componentWillUpdate=="function"&&O.UNSAFE_componentWillUpdate(S,ce,W)),typeof O.componentDidUpdate=="function"&&(o.flags|=4),typeof O.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof O.componentDidUpdate!="function"||B===s.memoizedProps&&ae===s.memoizedState||(o.flags|=4),typeof O.getSnapshotBeforeUpdate!="function"||B===s.memoizedProps&&ae===s.memoizedState||(o.flags|=1024),o.memoizedProps=S,o.memoizedState=ce),O.props=S,O.state=ce,O.context=W,S=de):(typeof O.componentDidUpdate!="function"||B===s.memoizedProps&&ae===s.memoizedState||(o.flags|=4),typeof O.getSnapshotBeforeUpdate!="function"||B===s.memoizedProps&&ae===s.memoizedState||(o.flags|=1024),S=!1)}return O=S,vu(s,o),S=(o.flags&128)!==0,O||S?(O=o.stateNode,h=S&&typeof h.getDerivedStateFromError!="function"?null:O.render(),o.flags|=1,s!==null&&S?(o.child=Ua(o,s.child,null,x),o.child=Ua(o,null,h,x)):Or(s,o,h,x),o.memoizedState=O.state,s=o.child):s=Ln(s,o,x),s}function V0(s,o,h,S){return Vo(),o.flags|=256,Or(s,o,h,S),o.child}var Hh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Vh(s){return{baseLanes:s,cachePool:Iy()}}function Kh(s,o,h){return s=s!==null?s.childLanes&~h:0,o&&(s|=Di),s}function K0(s,o,h){var S=o.pendingProps,x=!1,O=(o.flags&128)!==0,B;if((B=O)||(B=s!==null&&s.memoizedState===null?!1:(gr.current&2)!==0),B&&(x=!0,o.flags&=-129),B=(o.flags&32)!==0,o.flags&=-33,s===null){if(wt){if(x?Qn(o):Zn(),wt){var G=er,W;if(W=G){e:{for(W=G,G=sn;W.nodeType!==8;){if(!G){G=null;break e}if(W=qi(W.nextSibling),W===null){G=null;break e}}G=W}G!==null?(o.memoizedState={dehydrated:G,treeContext:zs!==null?{id:wn,overflow:Tn}:null,retryLane:536870912,hydrationErrors:null},W=ci(18,null,null,0),W.stateNode=G,W.return=o,o.child=W,Vr=o,er=null,W=!0):W=!1}W||Vs(o)}if(G=o.memoizedState,G!==null&&(G=G.dehydrated,G!==null))return Dp(G)?o.lanes=32:o.lanes=536870912,null;Dn(o)}return G=S.children,S=S.fallback,x?(Zn(),x=o.mode,G=yu({mode:"hidden",children:G},x),S=js(S,x,h,null),G.return=o,S.return=o,G.sibling=S,o.child=G,x=o.child,x.memoizedState=Vh(h),x.childLanes=Kh(s,B,h),o.memoizedState=Hh,S):(Qn(o),qh(o,G))}if(W=s.memoizedState,W!==null&&(G=W.dehydrated,G!==null)){if(O)o.flags&256?(Qn(o),o.flags&=-257,o=Yh(s,o,h)):o.memoizedState!==null?(Zn(),o.child=s.child,o.flags|=128,o=null):(Zn(),x=S.fallback,G=o.mode,S=yu({mode:"visible",children:S.children},G),x=js(x,G,h,null),x.flags|=2,S.return=o,x.return=o,S.sibling=x,o.child=S,Ua(o,s.child,null,h),S=o.child,S.memoizedState=Vh(h),S.childLanes=Kh(s,B,h),o.memoizedState=Hh,o=x);else if(Qn(o),Dp(G)){if(B=G.nextSibling&&G.nextSibling.dataset,B)var se=B.dgst;B=se,S=Error(r(419)),S.stack="",S.digest=B,Ko({value:S,source:null,stack:null}),o=Yh(s,o,h)}else if(Rr||qo(s,o,h,!1),B=(h&s.childLanes)!==0,Rr||B){if(B=zt,B!==null&&(S=h&-h,S=(S&42)!==0?1:Lr(S),S=(S&(B.suspendedLanes|h))!==0?0:S,S!==0&&S!==W.retryLane))throw W.retryLane=S,xa(s,S),hi(B,s,S),B0;G.data==="$?"||fp(),o=Yh(s,o,h)}else G.data==="$?"?(o.flags|=192,o.child=s.child,o=null):(s=W.treeContext,er=qi(G.nextSibling),Vr=o,wt=!0,Hs=null,sn=!1,s!==null&&(Ci[Ai++]=wn,Ci[Ai++]=Tn,Ci[Ai++]=zs,wn=s.id,Tn=s.overflow,zs=o),o=qh(o,S.children),o.flags|=4096);return o}return x?(Zn(),x=S.fallback,G=o.mode,W=s.child,se=W.sibling,S=Rn(W,{mode:"hidden",children:S.children}),S.subtreeFlags=W.subtreeFlags&65011712,se!==null?x=Rn(se,x):(x=js(x,G,h,null),x.flags|=2),x.return=o,S.return=o,S.sibling=x,o.child=S,S=x,x=o.child,G=s.child.memoizedState,G===null?G=Vh(h):(W=G.cachePool,W!==null?(se=mr._currentValue,W=W.parent!==se?{parent:se,pool:se}:W):W=Iy(),G={baseLanes:G.baseLanes|h,cachePool:W}),x.memoizedState=G,x.childLanes=Kh(s,B,h),o.memoizedState=Hh,S):(Qn(o),h=s.child,s=h.sibling,h=Rn(h,{mode:"visible",children:S.children}),h.return=o,h.sibling=null,s!==null&&(B=o.deletions,B===null?(o.deletions=[s],o.flags|=16):B.push(s)),o.child=h,o.memoizedState=null,h)}function qh(s,o){return o=yu({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function yu(s,o){return s=ci(22,s,null,o),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Yh(s,o,h){return Ua(o,s.child,null,h),s=qh(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function q0(s,o,h){s.lanes|=o;var S=s.alternate;S!==null&&(S.lanes|=o),fh(s.return,o,h)}function Wh(s,o,h,S,x){var O=s.memoizedState;O===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:S,tail:h,tailMode:x}:(O.isBackwards=o,O.rendering=null,O.renderingStartTime=0,O.last=S,O.tail=h,O.tailMode=x)}function Y0(s,o,h){var S=o.pendingProps,x=S.revealOrder,O=S.tail;if(Or(s,o,S.children,h),S=gr.current,(S&2)!==0)S=S&1|2,o.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&q0(s,h,o);else if(s.tag===19)q0(s,h,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}S&=1}switch(X(gr,S),x){case"forwards":for(h=o.child,x=null;h!==null;)s=h.alternate,s!==null&&pu(s)===null&&(x=h),h=h.sibling;h=x,h===null?(x=o.child,o.child=null):(x=h.sibling,h.sibling=null),Wh(o,!1,x,h,O);break;case"backwards":for(h=null,x=o.child,o.child=null;x!==null;){if(s=x.alternate,s!==null&&pu(s)===null){o.child=x;break}s=x.sibling,x.sibling=h,h=x,x=s}Wh(o,!0,h,null,O);break;case"together":Wh(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Ln(s,o,h){if(s!==null&&(o.dependencies=s.dependencies),is|=o.lanes,(h&o.childLanes)===0)if(s!==null){if(qo(s,o,h,!1),(h&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(r(153));if(o.child!==null){for(s=o.child,h=Rn(s,s.pendingProps),o.child=h,h.return=o;s.sibling!==null;)s=s.sibling,h=h.sibling=Rn(s,s.pendingProps),h.return=o;h.sibling=null}return o.child}function Xh(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&Zl(s)))}function WA(s,o,h){switch(o.tag){case 3:be(o,o.stateNode.containerInfo),Kn(o,mr,s.memoizedState.cache),Vo();break;case 27:case 5:Pe(o);break;case 4:be(o,o.stateNode.containerInfo);break;case 10:Kn(o,o.type,o.memoizedProps.value);break;case 13:var S=o.memoizedState;if(S!==null)return S.dehydrated!==null?(Qn(o),o.flags|=128,null):(h&o.child.childLanes)!==0?K0(s,o,h):(Qn(o),s=Ln(s,o,h),s!==null?s.sibling:null);Qn(o);break;case 19:var x=(s.flags&128)!==0;if(S=(h&o.childLanes)!==0,S||(qo(s,o,h,!1),S=(h&o.childLanes)!==0),x){if(S)return Y0(s,o,h);o.flags|=128}if(x=o.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),X(gr,gr.current),S)break;return null;case 22:case 23:return o.lanes=0,j0(s,o,h);case 24:Kn(o,mr,s.memoizedState.cache)}return Ln(s,o,h)}function W0(s,o,h){if(s!==null)if(s.memoizedProps!==o.pendingProps)Rr=!0;else{if(!Xh(s,h)&&(o.flags&128)===0)return Rr=!1,WA(s,o,h);Rr=(s.flags&131072)!==0}else Rr=!1,wt&&(o.flags&1048576)!==0&&Ty(o,Ql,o.index);switch(o.lanes=0,o.tag){case 16:e:{s=o.pendingProps;var S=o.elementType,x=S._init;if(S=x(S._payload),o.type=S,typeof S=="function")sh(S)?(s=Xs(S,s),o.tag=1,o=H0(null,o,S,s,h)):(o.tag=0,o=Gh(null,o,S,s,h));else{if(S!=null){if(x=S.$$typeof,x===T){o.tag=11,o=F0(null,o,S,s,h);break e}else if(x===A){o.tag=14,o=U0(null,o,S,s,h);break e}}throw o=F(S)||S,Error(r(306,o,""))}}return o;case 0:return Gh(s,o,o.type,o.pendingProps,h);case 1:return S=o.type,x=Xs(S,o.pendingProps),H0(s,o,S,x,h);case 3:e:{if(be(o,o.stateNode.containerInfo),s===null)throw Error(r(387));S=o.pendingProps;var O=o.memoizedState;x=O.element,bh(s,o),ec(o,S,null,h);var B=o.memoizedState;if(S=B.cache,Kn(o,mr,S),S!==O.cache&&hh(o,[mr],h,!0),Jo(),S=B.element,O.isDehydrated)if(O={element:S,isDehydrated:!1,cache:B.cache},o.updateQueue.baseState=O,o.memoizedState=O,o.flags&256){o=V0(s,o,S,h);break e}else if(S!==x){x=wi(Error(r(424)),o),Ko(x),o=V0(s,o,S,h);break e}else{switch(s=o.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(er=qi(s.firstChild),Vr=o,wt=!0,Hs=null,sn=!0,h=A0(o,null,S,h),o.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(Vo(),S===x){o=Ln(s,o,h);break e}Or(s,o,S,h)}o=o.child}return o;case 26:return vu(s,o),s===null?(h=Jb(o.type,null,o.pendingProps,null))?o.memoizedState=h:wt||(h=o.type,s=o.pendingProps,S=Iu(oe.current).createElement(h),S[Ut]=o,S[or]=s,Pr(S,h,s),jt(S),o.stateNode=S):o.memoizedState=Jb(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return Pe(o),s===null&&wt&&(S=o.stateNode=Xb(o.type,o.pendingProps,oe.current),Vr=o,sn=!0,x=er,os(o.type)?(Lp=x,er=qi(S.firstChild)):er=x),Or(s,o,o.pendingProps.children,h),vu(s,o),s===null&&(o.flags|=4194304),o.child;case 5:return s===null&&wt&&((x=S=er)&&(S=Rx(S,o.type,o.pendingProps,sn),S!==null?(o.stateNode=S,Vr=o,er=qi(S.firstChild),sn=!1,x=!0):x=!1),x||Vs(o)),Pe(o),x=o.type,O=o.pendingProps,B=s!==null?s.memoizedProps:null,S=O.children,Cp(x,O)?S=null:B!==null&&Cp(x,B)&&(o.flags|=32),o.memoizedState!==null&&(x=Th(s,o,jA,null,null,h),Ec._currentValue=x),vu(s,o),Or(s,o,S,h),o.child;case 6:return s===null&&wt&&((s=h=er)&&(h=wx(h,o.pendingProps,sn),h!==null?(o.stateNode=h,Vr=o,er=null,s=!0):s=!1),s||Vs(o)),null;case 13:return K0(s,o,h);case 4:return be(o,o.stateNode.containerInfo),S=o.pendingProps,s===null?o.child=Ua(o,null,S,h):Or(s,o,S,h),o.child;case 11:return F0(s,o,o.type,o.pendingProps,h);case 7:return Or(s,o,o.pendingProps,h),o.child;case 8:return Or(s,o,o.pendingProps.children,h),o.child;case 12:return Or(s,o,o.pendingProps.children,h),o.child;case 10:return S=o.pendingProps,Kn(o,o.type,S.value),Or(s,o,S.children,h),o.child;case 9:return x=o.type._context,S=o.pendingProps.children,qs(o),x=Br(x),S=S(x),o.flags|=1,Or(s,o,S,h),o.child;case 14:return U0(s,o,o.type,o.pendingProps,h);case 15:return $0(s,o,o.type,o.pendingProps,h);case 19:return Y0(s,o,h);case 31:return S=o.pendingProps,h=o.mode,S={mode:S.mode,children:S.children},s===null?(h=yu(S,h),h.ref=o.ref,o.child=h,h.return=o,o=h):(h=Rn(s.child,S),h.ref=o.ref,o.child=h,h.return=o,o=h),o;case 22:return j0(s,o,h);case 24:return qs(o),S=Br(mr),s===null?(x=gh(),x===null&&(x=zt,O=ph(),x.pooledCache=O,O.refCount++,O!==null&&(x.pooledCacheLanes|=h),x=O),o.memoizedState={parent:S,cache:x},yh(o),Kn(o,mr,x)):((s.lanes&h)!==0&&(bh(s,o),ec(o,null,null,h),Jo()),x=s.memoizedState,O=o.memoizedState,x.parent!==S?(x={parent:S,cache:S},o.memoizedState=x,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=x),Kn(o,mr,S)):(S=O.cache,Kn(o,mr,S),S!==x.cache&&hh(o,[mr],h,!0))),Or(s,o,o.pendingProps.children,h),o.child;case 29:throw o.pendingProps}throw Error(r(156,o.tag))}function On(s){s.flags|=4}function X0(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!n_(o)){if(o=xi.current,o!==null&&((bt&4194048)===bt?an!==null:(bt&62914560)!==bt&&(bt&536870912)===0||o!==an))throw Qo=vh,Py;s.flags|=8192}}function bu(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?Is():536870912,s.lanes|=o,Ga|=o)}function oc(s,o){if(!wt)switch(s.tailMode){case"hidden":o=s.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?s.tail=null:h.sibling=null;break;case"collapsed":h=s.tail;for(var S=null;h!==null;)h.alternate!==null&&(S=h),h=h.sibling;S===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:S.sibling=null}}function Xt(s){var o=s.alternate!==null&&s.alternate.child===s.child,h=0,S=0;if(o)for(var x=s.child;x!==null;)h|=x.lanes|x.childLanes,S|=x.subtreeFlags&65011712,S|=x.flags&65011712,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)h|=x.lanes|x.childLanes,S|=x.subtreeFlags,S|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=S,s.childLanes=h,o}function XA(s,o,h){var S=o.pendingProps;switch(lh(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xt(o),null;case 1:return Xt(o),null;case 3:return h=o.stateNode,S=null,s!==null&&(S=s.memoizedState.cache),o.memoizedState.cache!==S&&(o.flags|=2048),An(mr),Oe(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(s===null||s.child===null)&&(Ho(o)?On(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,xy())),Xt(o),null;case 26:return h=o.memoizedState,s===null?(On(o),h!==null?(Xt(o),X0(o,h)):(Xt(o),o.flags&=-16777217)):h?h!==s.memoizedState?(On(o),Xt(o),X0(o,h)):(Xt(o),o.flags&=-16777217):(s.memoizedProps!==S&&On(o),Xt(o),o.flags&=-16777217),null;case 27:Se(o),h=oe.current;var x=o.type;if(s!==null&&o.stateNode!=null)s.memoizedProps!==S&&On(o);else{if(!S){if(o.stateNode===null)throw Error(r(166));return Xt(o),null}s=Y.current,Ho(o)?Cy(o):(s=Xb(x,S,h),o.stateNode=s,On(o))}return Xt(o),null;case 5:if(Se(o),h=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==S&&On(o);else{if(!S){if(o.stateNode===null)throw Error(r(166));return Xt(o),null}if(s=Y.current,Ho(o))Cy(o);else{switch(x=Iu(oe.current),s){case 1:s=x.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:s=x.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":s=x.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":s=x.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":s=x.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof S.is=="string"?x.createElement("select",{is:S.is}):x.createElement("select"),S.multiple?s.multiple=!0:S.size&&(s.size=S.size);break;default:s=typeof S.is=="string"?x.createElement(h,{is:S.is}):x.createElement(h)}}s[Ut]=o,s[or]=S;e:for(x=o.child;x!==null;){if(x.tag===5||x.tag===6)s.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===o)break e;for(;x.sibling===null;){if(x.return===null||x.return===o)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}o.stateNode=s;e:switch(Pr(s,h,S),h){case"button":case"input":case"select":case"textarea":s=!!S.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&On(o)}}return Xt(o),o.flags&=-16777217,null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==S&&On(o);else{if(typeof S!="string"&&o.stateNode===null)throw Error(r(166));if(s=oe.current,Ho(o)){if(s=o.stateNode,h=o.memoizedProps,S=null,x=Vr,x!==null)switch(x.tag){case 27:case 5:S=x.memoizedProps}s[Ut]=o,s=!!(s.nodeValue===h||S!==null&&S.suppressHydrationWarning===!0||Gb(s.nodeValue,h)),s||Vs(o)}else s=Iu(s).createTextNode(S),s[Ut]=o,o.stateNode=s}return Xt(o),null;case 13:if(S=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(x=Ho(o),S!==null&&S.dehydrated!==null){if(s===null){if(!x)throw Error(r(318));if(x=o.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));x[Ut]=o}else Vo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Xt(o),x=!1}else x=xy(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=x),x=!0;if(!x)return o.flags&256?(Dn(o),o):(Dn(o),null)}if(Dn(o),(o.flags&128)!==0)return o.lanes=h,o;if(h=S!==null,s=s!==null&&s.memoizedState!==null,h){S=o.child,x=null,S.alternate!==null&&S.alternate.memoizedState!==null&&S.alternate.memoizedState.cachePool!==null&&(x=S.alternate.memoizedState.cachePool.pool);var O=null;S.memoizedState!==null&&S.memoizedState.cachePool!==null&&(O=S.memoizedState.cachePool.pool),O!==x&&(S.flags|=2048)}return h!==s&&h&&(o.child.flags|=8192),bu(o,o.updateQueue),Xt(o),null;case 4:return Oe(),s===null&&Sp(o.stateNode.containerInfo),Xt(o),null;case 10:return An(o.type),Xt(o),null;case 19:if(Z(gr),x=o.memoizedState,x===null)return Xt(o),null;if(S=(o.flags&128)!==0,O=x.rendering,O===null)if(S)oc(x,!1);else{if(tr!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(O=pu(s),O!==null){for(o.flags|=128,oc(x,!1),s=O.updateQueue,o.updateQueue=s,bu(o,s),o.subtreeFlags=0,s=h,h=o.child;h!==null;)wy(h,s),h=h.sibling;return X(gr,gr.current&1|2),o.child}s=s.sibling}x.tail!==null&&De()>Eu&&(o.flags|=128,S=!0,oc(x,!1),o.lanes=4194304)}else{if(!S)if(s=pu(O),s!==null){if(o.flags|=128,S=!0,s=s.updateQueue,o.updateQueue=s,bu(o,s),oc(x,!0),x.tail===null&&x.tailMode==="hidden"&&!O.alternate&&!wt)return Xt(o),null}else 2*De()-x.renderingStartTime>Eu&&h!==536870912&&(o.flags|=128,S=!0,oc(x,!1),o.lanes=4194304);x.isBackwards?(O.sibling=o.child,o.child=O):(s=x.last,s!==null?s.sibling=O:o.child=O,x.last=O)}return x.tail!==null?(o=x.tail,x.rendering=o,x.tail=o.sibling,x.renderingStartTime=De(),o.sibling=null,s=gr.current,X(gr,S?s&1|2:s&1),o):(Xt(o),null);case 22:case 23:return Dn(o),Rh(),S=o.memoizedState!==null,s!==null?s.memoizedState!==null!==S&&(o.flags|=8192):S&&(o.flags|=8192),S?(h&536870912)!==0&&(o.flags&128)===0&&(Xt(o),o.subtreeFlags&6&&(o.flags|=8192)):Xt(o),h=o.updateQueue,h!==null&&bu(o,h.retryQueue),h=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),S=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(S=o.memoizedState.cachePool.pool),S!==h&&(o.flags|=2048),s!==null&&Z(Ys),null;case 24:return h=null,s!==null&&(h=s.memoizedState.cache),o.memoizedState.cache!==h&&(o.flags|=2048),An(mr),Xt(o),null;case 25:return null;case 30:return null}throw Error(r(156,o.tag))}function QA(s,o){switch(lh(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return An(mr),Oe(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return Se(o),null;case 13:if(Dn(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(r(340));Vo()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return Z(gr),null;case 4:return Oe(),null;case 10:return An(o.type),null;case 22:case 23:return Dn(o),Rh(),s!==null&&Z(Ys),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return An(mr),null;case 25:return null;default:return null}}function Q0(s,o){switch(lh(o),o.tag){case 3:An(mr),Oe();break;case 26:case 27:case 5:Se(o);break;case 4:Oe();break;case 13:Dn(o);break;case 19:Z(gr);break;case 10:An(o.type);break;case 22:case 23:Dn(o),Rh(),s!==null&&Z(Ys);break;case 24:An(mr)}}function cc(s,o){try{var h=o.updateQueue,S=h!==null?h.lastEffect:null;if(S!==null){var x=S.next;h=x;do{if((h.tag&s)===s){S=void 0;var O=h.create,B=h.inst;S=O(),B.destroy=S}h=h.next}while(h!==x)}}catch(G){Nt(o,o.return,G)}}function Jn(s,o,h){try{var S=o.updateQueue,x=S!==null?S.lastEffect:null;if(x!==null){var O=x.next;S=O;do{if((S.tag&s)===s){var B=S.inst,G=B.destroy;if(G!==void 0){B.destroy=void 0,x=o;var W=h,se=G;try{se()}catch(de){Nt(x,W,de)}}}S=S.next}while(S!==O)}}catch(de){Nt(o,o.return,de)}}function Z0(s){var o=s.updateQueue;if(o!==null){var h=s.stateNode;try{Uy(o,h)}catch(S){Nt(s,s.return,S)}}}function J0(s,o,h){h.props=Xs(s.type,s.memoizedProps),h.state=s.memoizedState;try{h.componentWillUnmount()}catch(S){Nt(s,o,S)}}function lc(s,o){try{var h=s.ref;if(h!==null){switch(s.tag){case 26:case 27:case 5:var S=s.stateNode;break;case 30:S=s.stateNode;break;default:S=s.stateNode}typeof h=="function"?s.refCleanup=h(S):h.current=S}}catch(x){Nt(s,o,x)}}function on(s,o){var h=s.ref,S=s.refCleanup;if(h!==null)if(typeof S=="function")try{S()}catch(x){Nt(s,o,x)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(x){Nt(s,o,x)}else h.current=null}function eb(s){var o=s.type,h=s.memoizedProps,S=s.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":h.autoFocus&&S.focus();break e;case"img":h.src?S.src=h.src:h.srcSet&&(S.srcset=h.srcSet)}}catch(x){Nt(s,s.return,x)}}function Qh(s,o,h){try{var S=s.stateNode;yx(S,s.type,h,o),S[or]=o}catch(x){Nt(s,s.return,x)}}function tb(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&os(s.type)||s.tag===4}function Zh(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||tb(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&os(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Jh(s,o,h){var S=s.tag;if(S===5||S===6)s=s.stateNode,o?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(s,o):(o=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,o.appendChild(s),h=h._reactRootContainer,h!=null||o.onclick!==null||(o.onclick=Ou));else if(S!==4&&(S===27&&os(s.type)&&(h=s.stateNode,o=null),s=s.child,s!==null))for(Jh(s,o,h),s=s.sibling;s!==null;)Jh(s,o,h),s=s.sibling}function _u(s,o,h){var S=s.tag;if(S===5||S===6)s=s.stateNode,o?h.insertBefore(s,o):h.appendChild(s);else if(S!==4&&(S===27&&os(s.type)&&(h=s.stateNode),s=s.child,s!==null))for(_u(s,o,h),s=s.sibling;s!==null;)_u(s,o,h),s=s.sibling}function rb(s){var o=s.stateNode,h=s.memoizedProps;try{for(var S=s.type,x=o.attributes;x.length;)o.removeAttributeNode(x[0]);Pr(o,S,h),o[Ut]=s,o[or]=h}catch(O){Nt(s,s.return,O)}}var In=!1,ir=!1,ep=!1,ib=typeof WeakSet=="function"?WeakSet:Set,wr=null;function ZA(s,o){if(s=s.containerInfo,wp=Fu,s=py(s),Zf(s)){if("selectionStart"in s)var h={start:s.selectionStart,end:s.selectionEnd};else e:{h=(h=s.ownerDocument)&&h.defaultView||window;var S=h.getSelection&&h.getSelection();if(S&&S.rangeCount!==0){h=S.anchorNode;var x=S.anchorOffset,O=S.focusNode;S=S.focusOffset;try{h.nodeType,O.nodeType}catch{h=null;break e}var B=0,G=-1,W=-1,se=0,de=0,me=s,ae=null;t:for(;;){for(var ce;me!==h||x!==0&&me.nodeType!==3||(G=B+x),me!==O||S!==0&&me.nodeType!==3||(W=B+S),me.nodeType===3&&(B+=me.nodeValue.length),(ce=me.firstChild)!==null;)ae=me,me=ce;for(;;){if(me===s)break t;if(ae===h&&++se===x&&(G=B),ae===O&&++de===S&&(W=B),(ce=me.nextSibling)!==null)break;me=ae,ae=me.parentNode}me=ce}h=G===-1||W===-1?null:{start:G,end:W}}else h=null}h=h||{start:0,end:0}}else h=null;for(Tp={focusedElem:s,selectionRange:h},Fu=!1,wr=o;wr!==null;)if(o=wr,s=o.child,(o.subtreeFlags&1024)!==0&&s!==null)s.return=o,wr=s;else for(;wr!==null;){switch(o=wr,O=o.alternate,s=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&O!==null){s=void 0,h=o,x=O.memoizedProps,O=O.memoizedState,S=h.stateNode;try{var We=Xs(h.type,x,h.elementType===h.type);s=S.getSnapshotBeforeUpdate(We,O),S.__reactInternalSnapshotBeforeUpdate=s}catch(Ve){Nt(h,h.return,Ve)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,h=s.nodeType,h===9)xp(s);else if(h===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":xp(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=o.sibling,s!==null){s.return=o.return,wr=s;break}wr=o.return}}function nb(s,o,h){var S=h.flags;switch(h.tag){case 0:case 11:case 15:es(s,h),S&4&&cc(5,h);break;case 1:if(es(s,h),S&4)if(s=h.stateNode,o===null)try{s.componentDidMount()}catch(B){Nt(h,h.return,B)}else{var x=Xs(h.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(x,o,s.__reactInternalSnapshotBeforeUpdate)}catch(B){Nt(h,h.return,B)}}S&64&&Z0(h),S&512&&lc(h,h.return);break;case 3:if(es(s,h),S&64&&(s=h.updateQueue,s!==null)){if(o=null,h.child!==null)switch(h.child.tag){case 27:case 5:o=h.child.stateNode;break;case 1:o=h.child.stateNode}try{Uy(s,o)}catch(B){Nt(h,h.return,B)}}break;case 27:o===null&&S&4&&rb(h);case 26:case 5:es(s,h),o===null&&S&4&&eb(h),S&512&&lc(h,h.return);break;case 12:es(s,h);break;case 13:es(s,h),S&4&&ob(s,h),S&64&&(s=h.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(h=ox.bind(null,h),Tx(s,h))));break;case 22:if(S=h.memoizedState!==null||In,!S){o=o!==null&&o.memoizedState!==null||ir,x=In;var O=ir;In=S,(ir=o)&&!O?ts(s,h,(h.subtreeFlags&8772)!==0):es(s,h),In=x,ir=O}break;case 30:break;default:es(s,h)}}function sb(s){var o=s.alternate;o!==null&&(s.alternate=null,sb(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&_r(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Kt=null,Xr=!1;function Pn(s,o,h){for(h=h.child;h!==null;)ab(s,o,h),h=h.sibling}function ab(s,o,h){if(_t&&typeof _t.onCommitFiberUnmount=="function")try{_t.onCommitFiberUnmount(Wt,h)}catch{}switch(h.tag){case 26:ir||on(h,o),Pn(s,o,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:ir||on(h,o);var S=Kt,x=Xr;os(h.type)&&(Kt=h.stateNode,Xr=!1),Pn(s,o,h),yc(h.stateNode),Kt=S,Xr=x;break;case 5:ir||on(h,o);case 6:if(S=Kt,x=Xr,Kt=null,Pn(s,o,h),Kt=S,Xr=x,Kt!==null)if(Xr)try{(Kt.nodeType===9?Kt.body:Kt.nodeName==="HTML"?Kt.ownerDocument.body:Kt).removeChild(h.stateNode)}catch(O){Nt(h,o,O)}else try{Kt.removeChild(h.stateNode)}catch(O){Nt(h,o,O)}break;case 18:Kt!==null&&(Xr?(s=Kt,Yb(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,h.stateNode),Cc(s)):Yb(Kt,h.stateNode));break;case 4:S=Kt,x=Xr,Kt=h.stateNode.containerInfo,Xr=!0,Pn(s,o,h),Kt=S,Xr=x;break;case 0:case 11:case 14:case 15:ir||Jn(2,h,o),ir||Jn(4,h,o),Pn(s,o,h);break;case 1:ir||(on(h,o),S=h.stateNode,typeof S.componentWillUnmount=="function"&&J0(h,o,S)),Pn(s,o,h);break;case 21:Pn(s,o,h);break;case 22:ir=(S=ir)||h.memoizedState!==null,Pn(s,o,h),ir=S;break;default:Pn(s,o,h)}}function ob(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Cc(s)}catch(h){Nt(o,o.return,h)}}function JA(s){switch(s.tag){case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new ib),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new ib),o;default:throw Error(r(435,s.tag))}}function tp(s,o){var h=JA(s);o.forEach(function(S){var x=cx.bind(null,s,S);h.has(S)||(h.add(S),S.then(x,x))})}function li(s,o){var h=o.deletions;if(h!==null)for(var S=0;S<h.length;S++){var x=h[S],O=s,B=o,G=B;e:for(;G!==null;){switch(G.tag){case 27:if(os(G.type)){Kt=G.stateNode,Xr=!1;break e}break;case 5:Kt=G.stateNode,Xr=!1;break e;case 3:case 4:Kt=G.stateNode.containerInfo,Xr=!0;break e}G=G.return}if(Kt===null)throw Error(r(160));ab(O,B,x),Kt=null,Xr=!1,O=x.alternate,O!==null&&(O.return=null),x.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)cb(o,s),o=o.sibling}var Ki=null;function cb(s,o){var h=s.alternate,S=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:li(o,s),ui(s),S&4&&(Jn(3,s,s.return),cc(3,s),Jn(5,s,s.return));break;case 1:li(o,s),ui(s),S&512&&(ir||h===null||on(h,h.return)),S&64&&In&&(s=s.updateQueue,s!==null&&(S=s.callbacks,S!==null&&(h=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=h===null?S:h.concat(S))));break;case 26:var x=Ki;if(li(o,s),ui(s),S&512&&(ir||h===null||on(h,h.return)),S&4){var O=h!==null?h.memoizedState:null;if(S=s.memoizedState,h===null)if(S===null)if(s.stateNode===null){e:{S=s.type,h=s.memoizedProps,x=x.ownerDocument||x;t:switch(S){case"title":O=x.getElementsByTagName("title")[0],(!O||O[Jt]||O[Ut]||O.namespaceURI==="http://www.w3.org/2000/svg"||O.hasAttribute("itemprop"))&&(O=x.createElement(S),x.head.insertBefore(O,x.querySelector("head > title"))),Pr(O,S,h),O[Ut]=s,jt(O),S=O;break e;case"link":var B=r_("link","href",x).get(S+(h.href||""));if(B){for(var G=0;G<B.length;G++)if(O=B[G],O.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&O.getAttribute("rel")===(h.rel==null?null:h.rel)&&O.getAttribute("title")===(h.title==null?null:h.title)&&O.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){B.splice(G,1);break t}}O=x.createElement(S),Pr(O,S,h),x.head.appendChild(O);break;case"meta":if(B=r_("meta","content",x).get(S+(h.content||""))){for(G=0;G<B.length;G++)if(O=B[G],O.getAttribute("content")===(h.content==null?null:""+h.content)&&O.getAttribute("name")===(h.name==null?null:h.name)&&O.getAttribute("property")===(h.property==null?null:h.property)&&O.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&O.getAttribute("charset")===(h.charSet==null?null:h.charSet)){B.splice(G,1);break t}}O=x.createElement(S),Pr(O,S,h),x.head.appendChild(O);break;default:throw Error(r(468,S))}O[Ut]=s,jt(O),S=O}s.stateNode=S}else i_(x,s.type,s.stateNode);else s.stateNode=t_(x,S,s.memoizedProps);else O!==S?(O===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):O.count--,S===null?i_(x,s.type,s.stateNode):t_(x,S,s.memoizedProps)):S===null&&s.stateNode!==null&&Qh(s,s.memoizedProps,h.memoizedProps)}break;case 27:li(o,s),ui(s),S&512&&(ir||h===null||on(h,h.return)),h!==null&&S&4&&Qh(s,s.memoizedProps,h.memoizedProps);break;case 5:if(li(o,s),ui(s),S&512&&(ir||h===null||on(h,h.return)),s.flags&32){x=s.stateNode;try{Sa(x,"")}catch(ce){Nt(s,s.return,ce)}}S&4&&s.stateNode!=null&&(x=s.memoizedProps,Qh(s,x,h!==null?h.memoizedProps:x)),S&1024&&(ep=!0);break;case 6:if(li(o,s),ui(s),S&4){if(s.stateNode===null)throw Error(r(162));S=s.memoizedProps,h=s.stateNode;try{h.nodeValue=S}catch(ce){Nt(s,s.return,ce)}}break;case 3:if(Mu=null,x=Ki,Ki=Pu(o.containerInfo),li(o,s),Ki=x,ui(s),S&4&&h!==null&&h.memoizedState.isDehydrated)try{Cc(o.containerInfo)}catch(ce){Nt(s,s.return,ce)}ep&&(ep=!1,lb(s));break;case 4:S=Ki,Ki=Pu(s.stateNode.containerInfo),li(o,s),ui(s),Ki=S;break;case 12:li(o,s),ui(s);break;case 13:li(o,s),ui(s),s.child.flags&8192&&s.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(op=De()),S&4&&(S=s.updateQueue,S!==null&&(s.updateQueue=null,tp(s,S)));break;case 22:x=s.memoizedState!==null;var W=h!==null&&h.memoizedState!==null,se=In,de=ir;if(In=se||x,ir=de||W,li(o,s),ir=de,In=se,ui(s),S&8192)e:for(o=s.stateNode,o._visibility=x?o._visibility&-2:o._visibility|1,x&&(h===null||W||In||ir||Qs(s)),h=null,o=s;;){if(o.tag===5||o.tag===26){if(h===null){W=h=o;try{if(O=W.stateNode,x)B=O.style,typeof B.setProperty=="function"?B.setProperty("display","none","important"):B.display="none";else{G=W.stateNode;var me=W.memoizedProps.style,ae=me!=null&&me.hasOwnProperty("display")?me.display:null;G.style.display=ae==null||typeof ae=="boolean"?"":(""+ae).trim()}}catch(ce){Nt(W,W.return,ce)}}}else if(o.tag===6){if(h===null){W=o;try{W.stateNode.nodeValue=x?"":W.memoizedProps}catch(ce){Nt(W,W.return,ce)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;h===o&&(h=null),o=o.return}h===o&&(h=null),o.sibling.return=o.return,o=o.sibling}S&4&&(S=s.updateQueue,S!==null&&(h=S.retryQueue,h!==null&&(S.retryQueue=null,tp(s,h))));break;case 19:li(o,s),ui(s),S&4&&(S=s.updateQueue,S!==null&&(s.updateQueue=null,tp(s,S)));break;case 30:break;case 21:break;default:li(o,s),ui(s)}}function ui(s){var o=s.flags;if(o&2){try{for(var h,S=s.return;S!==null;){if(tb(S)){h=S;break}S=S.return}if(h==null)throw Error(r(160));switch(h.tag){case 27:var x=h.stateNode,O=Zh(s);_u(s,O,x);break;case 5:var B=h.stateNode;h.flags&32&&(Sa(B,""),h.flags&=-33);var G=Zh(s);_u(s,G,B);break;case 3:case 4:var W=h.stateNode.containerInfo,se=Zh(s);Jh(s,se,W);break;default:throw Error(r(161))}}catch(de){Nt(s,s.return,de)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function lb(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;lb(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function es(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)nb(s,o.alternate,o),o=o.sibling}function Qs(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:Jn(4,o,o.return),Qs(o);break;case 1:on(o,o.return);var h=o.stateNode;typeof h.componentWillUnmount=="function"&&J0(o,o.return,h),Qs(o);break;case 27:yc(o.stateNode);case 26:case 5:on(o,o.return),Qs(o);break;case 22:o.memoizedState===null&&Qs(o);break;case 30:Qs(o);break;default:Qs(o)}s=s.sibling}}function ts(s,o,h){for(h=h&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var S=o.alternate,x=s,O=o,B=O.flags;switch(O.tag){case 0:case 11:case 15:ts(x,O,h),cc(4,O);break;case 1:if(ts(x,O,h),S=O,x=S.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(se){Nt(S,S.return,se)}if(S=O,x=S.updateQueue,x!==null){var G=S.stateNode;try{var W=x.shared.hiddenCallbacks;if(W!==null)for(x.shared.hiddenCallbacks=null,x=0;x<W.length;x++)Fy(W[x],G)}catch(se){Nt(S,S.return,se)}}h&&B&64&&Z0(O),lc(O,O.return);break;case 27:rb(O);case 26:case 5:ts(x,O,h),h&&S===null&&B&4&&eb(O),lc(O,O.return);break;case 12:ts(x,O,h);break;case 13:ts(x,O,h),h&&B&4&&ob(x,O);break;case 22:O.memoizedState===null&&ts(x,O,h),lc(O,O.return);break;case 30:break;default:ts(x,O,h)}o=o.sibling}}function rp(s,o){var h=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==h&&(s!=null&&s.refCount++,h!=null&&Yo(h))}function ip(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Yo(s))}function cn(s,o,h,S){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)ub(s,o,h,S),o=o.sibling}function ub(s,o,h,S){var x=o.flags;switch(o.tag){case 0:case 11:case 15:cn(s,o,h,S),x&2048&&cc(9,o);break;case 1:cn(s,o,h,S);break;case 3:cn(s,o,h,S),x&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Yo(s)));break;case 12:if(x&2048){cn(s,o,h,S),s=o.stateNode;try{var O=o.memoizedProps,B=O.id,G=O.onPostCommit;typeof G=="function"&&G(B,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(W){Nt(o,o.return,W)}}else cn(s,o,h,S);break;case 13:cn(s,o,h,S);break;case 23:break;case 22:O=o.stateNode,B=o.alternate,o.memoizedState!==null?O._visibility&2?cn(s,o,h,S):uc(s,o):O._visibility&2?cn(s,o,h,S):(O._visibility|=2,$a(s,o,h,S,(o.subtreeFlags&10256)!==0)),x&2048&&rp(B,o);break;case 24:cn(s,o,h,S),x&2048&&ip(o.alternate,o);break;default:cn(s,o,h,S)}}function $a(s,o,h,S,x){for(x=x&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var O=s,B=o,G=h,W=S,se=B.flags;switch(B.tag){case 0:case 11:case 15:$a(O,B,G,W,x),cc(8,B);break;case 23:break;case 22:var de=B.stateNode;B.memoizedState!==null?de._visibility&2?$a(O,B,G,W,x):uc(O,B):(de._visibility|=2,$a(O,B,G,W,x)),x&&se&2048&&rp(B.alternate,B);break;case 24:$a(O,B,G,W,x),x&&se&2048&&ip(B.alternate,B);break;default:$a(O,B,G,W,x)}o=o.sibling}}function uc(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var h=s,S=o,x=S.flags;switch(S.tag){case 22:uc(h,S),x&2048&&rp(S.alternate,S);break;case 24:uc(h,S),x&2048&&ip(S.alternate,S);break;default:uc(h,S)}o=o.sibling}}var dc=8192;function ja(s){if(s.subtreeFlags&dc)for(s=s.child;s!==null;)db(s),s=s.sibling}function db(s){switch(s.tag){case 26:ja(s),s.flags&dc&&s.memoizedState!==null&&Fx(Ki,s.memoizedState,s.memoizedProps);break;case 5:ja(s);break;case 3:case 4:var o=Ki;Ki=Pu(s.stateNode.containerInfo),ja(s),Ki=o;break;case 22:s.memoizedState===null&&(o=s.alternate,o!==null&&o.memoizedState!==null?(o=dc,dc=16777216,ja(s),dc=o):ja(s));break;default:ja(s)}}function fb(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function fc(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var h=0;h<o.length;h++){var S=o[h];wr=S,pb(S,s)}fb(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)hb(s),s=s.sibling}function hb(s){switch(s.tag){case 0:case 11:case 15:fc(s),s.flags&2048&&Jn(9,s,s.return);break;case 3:fc(s);break;case 12:fc(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&2&&(s.return===null||s.return.tag!==13)?(o._visibility&=-3,Su(s)):fc(s);break;default:fc(s)}}function Su(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var h=0;h<o.length;h++){var S=o[h];wr=S,pb(S,s)}fb(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:Jn(8,o,o.return),Su(o);break;case 22:h=o.stateNode,h._visibility&2&&(h._visibility&=-3,Su(o));break;default:Su(o)}s=s.sibling}}function pb(s,o){for(;wr!==null;){var h=wr;switch(h.tag){case 0:case 11:case 15:Jn(8,h,o);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var S=h.memoizedState.cachePool.pool;S!=null&&S.refCount++}break;case 24:Yo(h.memoizedState.cache)}if(S=h.child,S!==null)S.return=h,wr=S;else e:for(h=s;wr!==null;){S=wr;var x=S.sibling,O=S.return;if(sb(S),S===h){wr=null;break e}if(x!==null){x.return=O,wr=x;break e}wr=O}}}var ex={getCacheForType:function(s){var o=Br(mr),h=o.data.get(s);return h===void 0&&(h=s(),o.data.set(s,h)),h}},tx=typeof WeakMap=="function"?WeakMap:Map,xt=0,zt=null,ht=null,bt=0,Dt=0,di=null,rs=!1,za=!1,np=!1,kn=0,tr=0,is=0,Zs=0,sp=0,Di=0,Ga=0,hc=null,Qr=null,ap=!1,op=0,Eu=1/0,Ru=null,ns=null,Ir=0,ss=null,Ha=null,Va=0,cp=0,lp=null,mb=null,pc=0,up=null;function fi(){if((xt&2)!==0&&bt!==0)return bt&-bt;if(N.T!==null){var s=Ia;return s!==0?s:vp()}return $i()}function gb(){Di===0&&(Di=(bt&536870912)===0||wt?Si():536870912);var s=xi.current;return s!==null&&(s.flags|=32),Di}function hi(s,o,h){(s===zt&&(Dt===2||Dt===9)||s.cancelPendingCommit!==null)&&(Ka(s,0),as(s,bt,Di,!1)),ni(s,h),((xt&2)===0||s!==zt)&&(s===zt&&((xt&2)===0&&(Zs|=h),tr===4&&as(s,bt,Di,!1)),ln(s))}function vb(s,o,h){if((xt&6)!==0)throw Error(r(327));var S=!h&&(o&124)===0&&(o&s.expiredLanes)===0||Tt(s,o),x=S?nx(s,o):hp(s,o,!0),O=S;do{if(x===0){za&&!S&&as(s,o,0,!1);break}else{if(h=s.current.alternate,O&&!rx(h)){x=hp(s,o,!1),O=!1;continue}if(x===2){if(O=o,s.errorRecoveryDisabledLanes&O)var B=0;else B=s.pendingLanes&-536870913,B=B!==0?B:B&536870912?536870912:0;if(B!==0){o=B;e:{var G=s;x=hc;var W=G.current.memoizedState.isDehydrated;if(W&&(Ka(G,B).flags|=256),B=hp(G,B,!1),B!==2){if(np&&!W){G.errorRecoveryDisabledLanes|=O,Zs|=O,x=4;break e}O=Qr,Qr=x,O!==null&&(Qr===null?Qr=O:Qr.push.apply(Qr,O))}x=B}if(O=!1,x!==2)continue}}if(x===1){Ka(s,0),as(s,o,0,!0);break}e:{switch(S=s,O=x,O){case 0:case 1:throw Error(r(345));case 4:if((o&4194048)!==o)break;case 6:as(S,o,Di,!rs);break e;case 2:Qr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((o&62914560)===o&&(x=op+300-De(),10<x)){if(as(S,o,Di,!rs),Qe(S,0,!0)!==0)break e;S.timeoutHandle=Kb(yb.bind(null,S,h,Qr,Ru,ap,o,Di,Zs,Ga,rs,O,2,-0,0),x);break e}yb(S,h,Qr,Ru,ap,o,Di,Zs,Ga,rs,O,0,-0,0)}}break}while(!0);ln(s)}function yb(s,o,h,S,x,O,B,G,W,se,de,me,ae,ce){if(s.timeoutHandle=-1,me=o.subtreeFlags,(me&8192||(me&16785408)===16785408)&&(Sc={stylesheets:null,count:0,unsuspend:Bx},db(o),me=Ux(),me!==null)){s.cancelPendingCommit=me(Tb.bind(null,s,o,O,h,S,x,B,G,W,de,1,ae,ce)),as(s,O,B,!se);return}Tb(s,o,O,h,S,x,B,G,W)}function rx(s){for(var o=s;;){var h=o.tag;if((h===0||h===11||h===15)&&o.flags&16384&&(h=o.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var S=0;S<h.length;S++){var x=h[S],O=x.getSnapshot;x=x.value;try{if(!oi(O(),x))return!1}catch{return!1}}if(h=o.child,o.subtreeFlags&16384&&h!==null)h.return=o,o=h;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function as(s,o,h,S){o&=~sp,o&=~Zs,s.suspendedLanes|=o,s.pingedLanes&=~o,S&&(s.warmLanes|=o),S=s.expirationTimes;for(var x=o;0<x;){var O=31-Et(x),B=1<<O;S[O]=-1,x&=~B}h!==0&&zn(s,h,o)}function wu(){return(xt&6)===0?(mc(0),!1):!0}function dp(){if(ht!==null){if(Dt===0)var s=ht.return;else s=ht,Cn=Ks=null,xh(s),Fa=null,sc=0,s=ht;for(;s!==null;)Q0(s.alternate,s),s=s.return;ht=null}}function Ka(s,o){var h=s.timeoutHandle;h!==-1&&(s.timeoutHandle=-1,_x(h)),h=s.cancelPendingCommit,h!==null&&(s.cancelPendingCommit=null,h()),dp(),zt=s,ht=h=Rn(s.current,null),bt=o,Dt=0,di=null,rs=!1,za=Tt(s,o),np=!1,Ga=Di=sp=Zs=is=tr=0,Qr=hc=null,ap=!1,(o&8)!==0&&(o|=o&32);var S=s.entangledLanes;if(S!==0)for(s=s.entanglements,S&=o;0<S;){var x=31-Et(S),O=1<<x;o|=s[x],S&=~O}return kn=o,Kl(),h}function bb(s,o){ct=null,N.H=du,o===Xo||o===tu?(o=Ny(),Dt=3):o===Py?(o=Ny(),Dt=4):Dt=o===B0?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,di=o,ht===null&&(tr=1,gu(s,wi(o,s.current)))}function _b(){var s=N.H;return N.H=du,s===null?du:s}function Sb(){var s=N.A;return N.A=ex,s}function fp(){tr=4,rs||(bt&4194048)!==bt&&xi.current!==null||(za=!0),(is&134217727)===0&&(Zs&134217727)===0||zt===null||as(zt,bt,Di,!1)}function hp(s,o,h){var S=xt;xt|=2;var x=_b(),O=Sb();(zt!==s||bt!==o)&&(Ru=null,Ka(s,o)),o=!1;var B=tr;e:do try{if(Dt!==0&&ht!==null){var G=ht,W=di;switch(Dt){case 8:dp(),B=6;break e;case 3:case 2:case 9:case 6:xi.current===null&&(o=!0);var se=Dt;if(Dt=0,di=null,qa(s,G,W,se),h&&za){B=0;break e}break;default:se=Dt,Dt=0,di=null,qa(s,G,W,se)}}ix(),B=tr;break}catch(de){bb(s,de)}while(!0);return o&&s.shellSuspendCounter++,Cn=Ks=null,xt=S,N.H=x,N.A=O,ht===null&&(zt=null,bt=0,Kl()),B}function ix(){for(;ht!==null;)Eb(ht)}function nx(s,o){var h=xt;xt|=2;var S=_b(),x=Sb();zt!==s||bt!==o?(Ru=null,Eu=De()+500,Ka(s,o)):za=Tt(s,o);e:do try{if(Dt!==0&&ht!==null){o=ht;var O=di;t:switch(Dt){case 1:Dt=0,di=null,qa(s,o,O,1);break;case 2:case 9:if(ky(O)){Dt=0,di=null,Rb(o);break}o=function(){Dt!==2&&Dt!==9||zt!==s||(Dt=7),ln(s)},O.then(o,o);break e;case 3:Dt=7;break e;case 4:Dt=5;break e;case 7:ky(O)?(Dt=0,di=null,Rb(o)):(Dt=0,di=null,qa(s,o,O,7));break;case 5:var B=null;switch(ht.tag){case 26:B=ht.memoizedState;case 5:case 27:var G=ht;if(!B||n_(B)){Dt=0,di=null;var W=G.sibling;if(W!==null)ht=W;else{var se=G.return;se!==null?(ht=se,Tu(se)):ht=null}break t}}Dt=0,di=null,qa(s,o,O,5);break;case 6:Dt=0,di=null,qa(s,o,O,6);break;case 8:dp(),tr=6;break e;default:throw Error(r(462))}}sx();break}catch(de){bb(s,de)}while(!0);return Cn=Ks=null,N.H=S,N.A=x,xt=h,ht!==null?0:(zt=null,bt=0,Kl(),tr)}function sx(){for(;ht!==null&&!je();)Eb(ht)}function Eb(s){var o=W0(s.alternate,s,kn);s.memoizedProps=s.pendingProps,o===null?Tu(s):ht=o}function Rb(s){var o=s,h=o.alternate;switch(o.tag){case 15:case 0:o=G0(h,o,o.pendingProps,o.type,void 0,bt);break;case 11:o=G0(h,o,o.pendingProps,o.type.render,o.ref,bt);break;case 5:xh(o);default:Q0(h,o),o=ht=wy(o,kn),o=W0(h,o,kn)}s.memoizedProps=s.pendingProps,o===null?Tu(s):ht=o}function qa(s,o,h,S){Cn=Ks=null,xh(o),Fa=null,sc=0;var x=o.return;try{if(YA(s,x,o,h,bt)){tr=1,gu(s,wi(h,s.current)),ht=null;return}}catch(O){if(x!==null)throw ht=x,O;tr=1,gu(s,wi(h,s.current)),ht=null;return}o.flags&32768?(wt||S===1?s=!0:za||(bt&536870912)!==0?s=!1:(rs=s=!0,(S===2||S===9||S===3||S===6)&&(S=xi.current,S!==null&&S.tag===13&&(S.flags|=16384))),wb(o,s)):Tu(o)}function Tu(s){var o=s;do{if((o.flags&32768)!==0){wb(o,rs);return}s=o.return;var h=XA(o.alternate,o,kn);if(h!==null){ht=h;return}if(o=o.sibling,o!==null){ht=o;return}ht=o=s}while(o!==null);tr===0&&(tr=5)}function wb(s,o){do{var h=QA(s.alternate,s);if(h!==null){h.flags&=32767,ht=h;return}if(h=s.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!o&&(s=s.sibling,s!==null)){ht=s;return}ht=s=h}while(s!==null);tr=6,ht=null}function Tb(s,o,h,S,x,O,B,G,W){s.cancelPendingCommit=null;do Cu();while(Ir!==0);if((xt&6)!==0)throw Error(r(327));if(o!==null){if(o===s.current)throw Error(r(177));if(O=o.lanes|o.childLanes,O|=ih,Ps(s,h,O,B,G,W),s===zt&&(ht=zt=null,bt=0),Ha=o,ss=s,Va=h,cp=O,lp=x,mb=S,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,lx(rt,function(){return Lb(),null})):(s.callbackNode=null,s.callbackPriority=0),S=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||S){S=N.T,N.T=null,x=U.p,U.p=2,B=xt,xt|=4;try{ZA(s,o,h)}finally{xt=B,U.p=x,N.T=S}}Ir=1,Cb(),Ab(),xb()}}function Cb(){if(Ir===1){Ir=0;var s=ss,o=Ha,h=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||h){h=N.T,N.T=null;var S=U.p;U.p=2;var x=xt;xt|=4;try{cb(o,s);var O=Tp,B=py(s.containerInfo),G=O.focusedElem,W=O.selectionRange;if(B!==G&&G&&G.ownerDocument&&hy(G.ownerDocument.documentElement,G)){if(W!==null&&Zf(G)){var se=W.start,de=W.end;if(de===void 0&&(de=se),"selectionStart"in G)G.selectionStart=se,G.selectionEnd=Math.min(de,G.value.length);else{var me=G.ownerDocument||document,ae=me&&me.defaultView||window;if(ae.getSelection){var ce=ae.getSelection(),We=G.textContent.length,Ve=Math.min(W.start,We),kt=W.end===void 0?Ve:Math.min(W.end,We);!ce.extend&&Ve>kt&&(B=kt,kt=Ve,Ve=B);var ee=fy(G,Ve),Q=fy(G,kt);if(ee&&Q&&(ce.rangeCount!==1||ce.anchorNode!==ee.node||ce.anchorOffset!==ee.offset||ce.focusNode!==Q.node||ce.focusOffset!==Q.offset)){var ne=me.createRange();ne.setStart(ee.node,ee.offset),ce.removeAllRanges(),Ve>kt?(ce.addRange(ne),ce.extend(Q.node,Q.offset)):(ne.setEnd(Q.node,Q.offset),ce.addRange(ne))}}}}for(me=[],ce=G;ce=ce.parentNode;)ce.nodeType===1&&me.push({element:ce,left:ce.scrollLeft,top:ce.scrollTop});for(typeof G.focus=="function"&&G.focus(),G=0;G<me.length;G++){var fe=me[G];fe.element.scrollLeft=fe.left,fe.element.scrollTop=fe.top}}Fu=!!wp,Tp=wp=null}finally{xt=x,U.p=S,N.T=h}}s.current=o,Ir=2}}function Ab(){if(Ir===2){Ir=0;var s=ss,o=Ha,h=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||h){h=N.T,N.T=null;var S=U.p;U.p=2;var x=xt;xt|=4;try{nb(s,o.alternate,o)}finally{xt=x,U.p=S,N.T=h}}Ir=3}}function xb(){if(Ir===4||Ir===3){Ir=0,Ie();var s=ss,o=Ha,h=Va,S=mb;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Ir=5:(Ir=0,Ha=ss=null,Db(s,s.pendingLanes));var x=s.pendingLanes;if(x===0&&(ns=null),Sn(h),o=o.stateNode,_t&&typeof _t.onCommitFiberRoot=="function")try{_t.onCommitFiberRoot(Wt,o,void 0,(o.current.flags&128)===128)}catch{}if(S!==null){o=N.T,x=U.p,U.p=2,N.T=null;try{for(var O=s.onRecoverableError,B=0;B<S.length;B++){var G=S[B];O(G.value,{componentStack:G.stack})}}finally{N.T=o,U.p=x}}(Va&3)!==0&&Cu(),ln(s),x=s.pendingLanes,(h&4194090)!==0&&(x&42)!==0?s===up?pc++:(pc=0,up=s):pc=0,mc(0)}}function Db(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,Yo(o)))}function Cu(s){return Cb(),Ab(),xb(),Lb()}function Lb(){if(Ir!==5)return!1;var s=ss,o=cp;cp=0;var h=Sn(Va),S=N.T,x=U.p;try{U.p=32>h?32:h,N.T=null,h=lp,lp=null;var O=ss,B=Va;if(Ir=0,Ha=ss=null,Va=0,(xt&6)!==0)throw Error(r(331));var G=xt;if(xt|=4,hb(O.current),ub(O,O.current,B,h),xt=G,mc(0,!1),_t&&typeof _t.onPostCommitFiberRoot=="function")try{_t.onPostCommitFiberRoot(Wt,O)}catch{}return!0}finally{U.p=x,N.T=S,Db(s,o)}}function Ob(s,o,h){o=wi(h,o),o=zh(s.stateNode,o,2),s=Wn(s,o,2),s!==null&&(ni(s,2),ln(s))}function Nt(s,o,h){if(s.tag===3)Ob(s,s,h);else for(;o!==null;){if(o.tag===3){Ob(o,s,h);break}else if(o.tag===1){var S=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof S.componentDidCatch=="function"&&(ns===null||!ns.has(S))){s=wi(h,s),h=M0(2),S=Wn(o,h,2),S!==null&&(N0(h,S,o,s),ni(S,2),ln(S));break}}o=o.return}}function pp(s,o,h){var S=s.pingCache;if(S===null){S=s.pingCache=new tx;var x=new Set;S.set(o,x)}else x=S.get(o),x===void 0&&(x=new Set,S.set(o,x));x.has(h)||(np=!0,x.add(h),s=ax.bind(null,s,o,h),o.then(s,s))}function ax(s,o,h){var S=s.pingCache;S!==null&&S.delete(o),s.pingedLanes|=s.suspendedLanes&h,s.warmLanes&=~h,zt===s&&(bt&h)===h&&(tr===4||tr===3&&(bt&62914560)===bt&&300>De()-op?(xt&2)===0&&Ka(s,0):sp|=h,Ga===bt&&(Ga=0)),ln(s)}function Ib(s,o){o===0&&(o=Is()),s=xa(s,o),s!==null&&(ni(s,o),ln(s))}function ox(s){var o=s.memoizedState,h=0;o!==null&&(h=o.retryLane),Ib(s,h)}function cx(s,o){var h=0;switch(s.tag){case 13:var S=s.stateNode,x=s.memoizedState;x!==null&&(h=x.retryLane);break;case 19:S=s.stateNode;break;case 22:S=s.stateNode._retryCache;break;default:throw Error(r(314))}S!==null&&S.delete(o),Ib(s,h)}function lx(s,o){return ge(s,o)}var Au=null,Ya=null,mp=!1,xu=!1,gp=!1,Js=0;function ln(s){s!==Ya&&s.next===null&&(Ya===null?Au=Ya=s:Ya=Ya.next=s),xu=!0,mp||(mp=!0,dx())}function mc(s,o){if(!gp&&xu){gp=!0;do for(var h=!1,S=Au;S!==null;){if(s!==0){var x=S.pendingLanes;if(x===0)var O=0;else{var B=S.suspendedLanes,G=S.pingedLanes;O=(1<<31-Et(42|s)+1)-1,O&=x&~(B&~G),O=O&201326741?O&201326741|1:O?O|2:0}O!==0&&(h=!0,Nb(S,O))}else O=bt,O=Qe(S,S===zt?O:0,S.cancelPendingCommit!==null||S.timeoutHandle!==-1),(O&3)===0||Tt(S,O)||(h=!0,Nb(S,O));S=S.next}while(h);gp=!1}}function ux(){Pb()}function Pb(){xu=mp=!1;var s=0;Js!==0&&(bx()&&(s=Js),Js=0);for(var o=De(),h=null,S=Au;S!==null;){var x=S.next,O=kb(S,o);O===0?(S.next=null,h===null?Au=x:h.next=x,x===null&&(Ya=h)):(h=S,(s!==0||(O&3)!==0)&&(xu=!0)),S=x}mc(s)}function kb(s,o){for(var h=s.suspendedLanes,S=s.pingedLanes,x=s.expirationTimes,O=s.pendingLanes&-62914561;0<O;){var B=31-Et(O),G=1<<B,W=x[B];W===-1?((G&h)===0||(G&S)!==0)&&(x[B]=pr(G,o)):W<=o&&(s.expiredLanes|=G),O&=~G}if(o=zt,h=bt,h=Qe(s,s===o?h:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),S=s.callbackNode,h===0||s===o&&(Dt===2||Dt===9)||s.cancelPendingCommit!==null)return S!==null&&S!==null&&Ue(S),s.callbackNode=null,s.callbackPriority=0;if((h&3)===0||Tt(s,h)){if(o=h&-h,o===s.callbackPriority)return o;switch(S!==null&&Ue(S),Sn(h)){case 2:case 8:h=Ft;break;case 32:h=rt;break;case 268435456:h=$e;break;default:h=rt}return S=Mb.bind(null,s),h=ge(h,S),s.callbackPriority=o,s.callbackNode=h,o}return S!==null&&S!==null&&Ue(S),s.callbackPriority=2,s.callbackNode=null,2}function Mb(s,o){if(Ir!==0&&Ir!==5)return s.callbackNode=null,s.callbackPriority=0,null;var h=s.callbackNode;if(Cu()&&s.callbackNode!==h)return null;var S=bt;return S=Qe(s,s===zt?S:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),S===0?null:(vb(s,S,o),kb(s,De()),s.callbackNode!=null&&s.callbackNode===h?Mb.bind(null,s):null)}function Nb(s,o){if(Cu())return null;vb(s,o,!0)}function dx(){Sx(function(){(xt&6)!==0?ge(ut,ux):Pb()})}function vp(){return Js===0&&(Js=Si()),Js}function Bb(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Ul(""+s)}function Fb(s,o){var h=o.ownerDocument.createElement("input");return h.name=o.name,h.value=o.value,s.id&&h.setAttribute("form",s.id),o.parentNode.insertBefore(h,o),s=new FormData(s),h.parentNode.removeChild(h),s}function fx(s,o,h,S,x){if(o==="submit"&&h&&h.stateNode===x){var O=Bb((x[or]||null).action),B=S.submitter;B&&(o=(o=B[or]||null)?Bb(o.formAction):B.getAttribute("formAction"),o!==null&&(O=o,B=null));var G=new Gl("action","action",null,S,x);s.push({event:G,listeners:[{instance:null,listener:function(){if(S.defaultPrevented){if(Js!==0){var W=B?Fb(x,B):new FormData(x);Bh(h,{pending:!0,data:W,method:x.method,action:O},null,W)}}else typeof O=="function"&&(G.preventDefault(),W=B?Fb(x,B):new FormData(x),Bh(h,{pending:!0,data:W,method:x.method,action:O},O,W))},currentTarget:x}]})}}for(var yp=0;yp<rh.length;yp++){var bp=rh[yp],hx=bp.toLowerCase(),px=bp[0].toUpperCase()+bp.slice(1);Vi(hx,"on"+px)}Vi(vy,"onAnimationEnd"),Vi(yy,"onAnimationIteration"),Vi(by,"onAnimationStart"),Vi("dblclick","onDoubleClick"),Vi("focusin","onFocus"),Vi("focusout","onBlur"),Vi(OA,"onTransitionRun"),Vi(IA,"onTransitionStart"),Vi(PA,"onTransitionCancel"),Vi(_y,"onTransitionEnd"),Sr("onMouseEnter",["mouseout","mouseover"]),Sr("onMouseLeave",["mouseout","mouseover"]),Sr("onPointerEnter",["pointerout","pointerover"]),Sr("onPointerLeave",["pointerout","pointerover"]),lr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),lr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),lr("onBeforeInput",["compositionend","keypress","textInput","paste"]),lr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),lr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),lr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mx=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(gc));function Ub(s,o){o=(o&4)!==0;for(var h=0;h<s.length;h++){var S=s[h],x=S.event;S=S.listeners;e:{var O=void 0;if(o)for(var B=S.length-1;0<=B;B--){var G=S[B],W=G.instance,se=G.currentTarget;if(G=G.listener,W!==O&&x.isPropagationStopped())break e;O=G,x.currentTarget=se;try{O(x)}catch(de){mu(de)}x.currentTarget=null,O=W}else for(B=0;B<S.length;B++){if(G=S[B],W=G.instance,se=G.currentTarget,G=G.listener,W!==O&&x.isPropagationStopped())break e;O=G,x.currentTarget=se;try{O(x)}catch(de){mu(de)}x.currentTarget=null,O=W}}}}function pt(s,o){var h=o[nn];h===void 0&&(h=o[nn]=new Set);var S=s+"__bubble";h.has(S)||($b(o,s,2,!1),h.add(S))}function _p(s,o,h){var S=0;o&&(S|=4),$b(h,s,S,o)}var Du="_reactListening"+Math.random().toString(36).slice(2);function Sp(s){if(!s[Du]){s[Du]=!0,va.forEach(function(h){h!=="selectionchange"&&(mx.has(h)||_p(h,!1,s),_p(h,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[Du]||(o[Du]=!0,_p("selectionchange",!1,o))}}function $b(s,o,h,S){switch(u_(o)){case 2:var x=zx;break;case 8:x=Gx;break;default:x=Mp}h=x.bind(null,o,h,s),x=void 0,!Gf||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(x=!0),S?x!==void 0?s.addEventListener(o,h,{capture:!0,passive:x}):s.addEventListener(o,h,!0):x!==void 0?s.addEventListener(o,h,{passive:x}):s.addEventListener(o,h,!1)}function Ep(s,o,h,S,x){var O=S;if((o&1)===0&&(o&2)===0&&S!==null)e:for(;;){if(S===null)return;var B=S.tag;if(B===3||B===4){var G=S.stateNode.containerInfo;if(G===x)break;if(B===4)for(B=S.return;B!==null;){var W=B.tag;if((W===3||W===4)&&B.stateNode.containerInfo===x)return;B=B.return}for(;G!==null;){if(B=cr(G),B===null)return;if(W=B.tag,W===5||W===6||W===26||W===27){S=O=B;continue e}G=G.parentNode}}S=S.return}qv(function(){var se=O,de=jf(h),me=[];e:{var ae=Sy.get(s);if(ae!==void 0){var ce=Gl,We=s;switch(s){case"keypress":if(jl(h)===0)break e;case"keydown":case"keyup":ce=lA;break;case"focusin":We="focus",ce=qf;break;case"focusout":We="blur",ce=qf;break;case"beforeblur":case"afterblur":ce=qf;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ce=Xv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ce=QC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ce=fA;break;case vy:case yy:case by:ce=eA;break;case _y:ce=pA;break;case"scroll":case"scrollend":ce=WC;break;case"wheel":ce=gA;break;case"copy":case"cut":case"paste":ce=rA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ce=Zv;break;case"toggle":case"beforetoggle":ce=yA}var Ve=(o&4)!==0,kt=!Ve&&(s==="scroll"||s==="scrollend"),ee=Ve?ae!==null?ae+"Capture":null:ae;Ve=[];for(var Q=se,ne;Q!==null;){var fe=Q;if(ne=fe.stateNode,fe=fe.tag,fe!==5&&fe!==26&&fe!==27||ne===null||ee===null||(fe=Mo(Q,ee),fe!=null&&Ve.push(vc(Q,fe,ne))),kt)break;Q=Q.return}0<Ve.length&&(ae=new ce(ae,We,null,h,de),me.push({event:ae,listeners:Ve}))}}if((o&7)===0){e:{if(ae=s==="mouseover"||s==="pointerover",ce=s==="mouseout"||s==="pointerout",ae&&h!==$f&&(We=h.relatedTarget||h.fromElement)&&(cr(We)||We[yt]))break e;if((ce||ae)&&(ae=de.window===de?de:(ae=de.ownerDocument)?ae.defaultView||ae.parentWindow:window,ce?(We=h.relatedTarget||h.toElement,ce=se,We=We?cr(We):null,We!==null&&(kt=a(We),Ve=We.tag,We!==kt||Ve!==5&&Ve!==27&&Ve!==6)&&(We=null)):(ce=null,We=se),ce!==We)){if(Ve=Xv,fe="onMouseLeave",ee="onMouseEnter",Q="mouse",(s==="pointerout"||s==="pointerover")&&(Ve=Zv,fe="onPointerLeave",ee="onPointerEnter",Q="pointer"),kt=ce==null?ae:zi(ce),ne=We==null?ae:zi(We),ae=new Ve(fe,Q+"leave",ce,h,de),ae.target=kt,ae.relatedTarget=ne,fe=null,cr(de)===se&&(Ve=new Ve(ee,Q+"enter",We,h,de),Ve.target=ne,Ve.relatedTarget=kt,fe=Ve),kt=fe,ce&&We)t:{for(Ve=ce,ee=We,Q=0,ne=Ve;ne;ne=Wa(ne))Q++;for(ne=0,fe=ee;fe;fe=Wa(fe))ne++;for(;0<Q-ne;)Ve=Wa(Ve),Q--;for(;0<ne-Q;)ee=Wa(ee),ne--;for(;Q--;){if(Ve===ee||ee!==null&&Ve===ee.alternate)break t;Ve=Wa(Ve),ee=Wa(ee)}Ve=null}else Ve=null;ce!==null&&jb(me,ae,ce,Ve,!1),We!==null&&kt!==null&&jb(me,kt,We,Ve,!0)}}e:{if(ae=se?zi(se):window,ce=ae.nodeName&&ae.nodeName.toLowerCase(),ce==="select"||ce==="input"&&ae.type==="file")var Le=ay;else if(ny(ae))if(oy)Le=xA;else{Le=CA;var dt=TA}else ce=ae.nodeName,!ce||ce.toLowerCase()!=="input"||ae.type!=="checkbox"&&ae.type!=="radio"?se&&Uf(se.elementType)&&(Le=ay):Le=AA;if(Le&&(Le=Le(s,se))){sy(me,Le,h,de);break e}dt&&dt(s,ae,se),s==="focusout"&&se&&ae.type==="number"&&se.memoizedProps.value!=null&&Ff(ae,"number",ae.value)}switch(dt=se?zi(se):window,s){case"focusin":(ny(dt)||dt.contentEditable==="true")&&(Ta=dt,Jf=se,Go=null);break;case"focusout":Go=Jf=Ta=null;break;case"mousedown":eh=!0;break;case"contextmenu":case"mouseup":case"dragend":eh=!1,my(me,h,de);break;case"selectionchange":if(LA)break;case"keydown":case"keyup":my(me,h,de)}var Ne;if(Wf)e:{switch(s){case"compositionstart":var Ke="onCompositionStart";break e;case"compositionend":Ke="onCompositionEnd";break e;case"compositionupdate":Ke="onCompositionUpdate";break e}Ke=void 0}else wa?ry(s,h)&&(Ke="onCompositionEnd"):s==="keydown"&&h.keyCode===229&&(Ke="onCompositionStart");Ke&&(Jv&&h.locale!=="ko"&&(wa||Ke!=="onCompositionStart"?Ke==="onCompositionEnd"&&wa&&(Ne=Yv()):(Vn=de,Hf="value"in Vn?Vn.value:Vn.textContent,wa=!0)),dt=Lu(se,Ke),0<dt.length&&(Ke=new Qv(Ke,s,null,h,de),me.push({event:Ke,listeners:dt}),Ne?Ke.data=Ne:(Ne=iy(h),Ne!==null&&(Ke.data=Ne)))),(Ne=_A?SA(s,h):EA(s,h))&&(Ke=Lu(se,"onBeforeInput"),0<Ke.length&&(dt=new Qv("onBeforeInput","beforeinput",null,h,de),me.push({event:dt,listeners:Ke}),dt.data=Ne)),fx(me,s,se,h,de)}Ub(me,o)})}function vc(s,o,h){return{instance:s,listener:o,currentTarget:h}}function Lu(s,o){for(var h=o+"Capture",S=[];s!==null;){var x=s,O=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||O===null||(x=Mo(s,h),x!=null&&S.unshift(vc(s,x,O)),x=Mo(s,o),x!=null&&S.push(vc(s,x,O))),s.tag===3)return S;s=s.return}return[]}function Wa(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function jb(s,o,h,S,x){for(var O=o._reactName,B=[];h!==null&&h!==S;){var G=h,W=G.alternate,se=G.stateNode;if(G=G.tag,W!==null&&W===S)break;G!==5&&G!==26&&G!==27||se===null||(W=se,x?(se=Mo(h,O),se!=null&&B.unshift(vc(h,se,W))):x||(se=Mo(h,O),se!=null&&B.push(vc(h,se,W)))),h=h.return}B.length!==0&&s.push({event:o,listeners:B})}var gx=/\r\n?/g,vx=/\u0000|\uFFFD/g;function zb(s){return(typeof s=="string"?s:""+s).replace(gx,`
`).replace(vx,"")}function Gb(s,o){return o=zb(o),zb(s)===o}function Ou(){}function Pt(s,o,h,S,x,O){switch(h){case"children":typeof S=="string"?o==="body"||o==="textarea"&&S===""||Sa(s,S):(typeof S=="number"||typeof S=="bigint")&&o!=="body"&&Sa(s,""+S);break;case"className":mt(s,"class",S);break;case"tabIndex":mt(s,"tabindex",S);break;case"dir":case"role":case"viewBox":case"width":case"height":mt(s,h,S);break;case"style":Vv(s,S,O);break;case"data":if(o!=="object"){mt(s,"data",S);break}case"src":case"href":if(S===""&&(o!=="a"||h!=="href")){s.removeAttribute(h);break}if(S==null||typeof S=="function"||typeof S=="symbol"||typeof S=="boolean"){s.removeAttribute(h);break}S=Ul(""+S),s.setAttribute(h,S);break;case"action":case"formAction":if(typeof S=="function"){s.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof O=="function"&&(h==="formAction"?(o!=="input"&&Pt(s,o,"name",x.name,x,null),Pt(s,o,"formEncType",x.formEncType,x,null),Pt(s,o,"formMethod",x.formMethod,x,null),Pt(s,o,"formTarget",x.formTarget,x,null)):(Pt(s,o,"encType",x.encType,x,null),Pt(s,o,"method",x.method,x,null),Pt(s,o,"target",x.target,x,null)));if(S==null||typeof S=="symbol"||typeof S=="boolean"){s.removeAttribute(h);break}S=Ul(""+S),s.setAttribute(h,S);break;case"onClick":S!=null&&(s.onclick=Ou);break;case"onScroll":S!=null&&pt("scroll",s);break;case"onScrollEnd":S!=null&&pt("scrollend",s);break;case"dangerouslySetInnerHTML":if(S!=null){if(typeof S!="object"||!("__html"in S))throw Error(r(61));if(h=S.__html,h!=null){if(x.children!=null)throw Error(r(60));s.innerHTML=h}}break;case"multiple":s.multiple=S&&typeof S!="function"&&typeof S!="symbol";break;case"muted":s.muted=S&&typeof S!="function"&&typeof S!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(S==null||typeof S=="function"||typeof S=="boolean"||typeof S=="symbol"){s.removeAttribute("xlink:href");break}h=Ul(""+S),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":S!=null&&typeof S!="function"&&typeof S!="symbol"?s.setAttribute(h,""+S):s.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":S&&typeof S!="function"&&typeof S!="symbol"?s.setAttribute(h,""):s.removeAttribute(h);break;case"capture":case"download":S===!0?s.setAttribute(h,""):S!==!1&&S!=null&&typeof S!="function"&&typeof S!="symbol"?s.setAttribute(h,S):s.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":S!=null&&typeof S!="function"&&typeof S!="symbol"&&!isNaN(S)&&1<=S?s.setAttribute(h,S):s.removeAttribute(h);break;case"rowSpan":case"start":S==null||typeof S=="function"||typeof S=="symbol"||isNaN(S)?s.removeAttribute(h):s.setAttribute(h,S);break;case"popover":pt("beforetoggle",s),pt("toggle",s),Ae(s,"popover",S);break;case"xlinkActuate":Me(s,"http://www.w3.org/1999/xlink","xlink:actuate",S);break;case"xlinkArcrole":Me(s,"http://www.w3.org/1999/xlink","xlink:arcrole",S);break;case"xlinkRole":Me(s,"http://www.w3.org/1999/xlink","xlink:role",S);break;case"xlinkShow":Me(s,"http://www.w3.org/1999/xlink","xlink:show",S);break;case"xlinkTitle":Me(s,"http://www.w3.org/1999/xlink","xlink:title",S);break;case"xlinkType":Me(s,"http://www.w3.org/1999/xlink","xlink:type",S);break;case"xmlBase":Me(s,"http://www.w3.org/XML/1998/namespace","xml:base",S);break;case"xmlLang":Me(s,"http://www.w3.org/XML/1998/namespace","xml:lang",S);break;case"xmlSpace":Me(s,"http://www.w3.org/XML/1998/namespace","xml:space",S);break;case"is":Ae(s,"is",S);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=qC.get(h)||h,Ae(s,h,S))}}function Rp(s,o,h,S,x,O){switch(h){case"style":Vv(s,S,O);break;case"dangerouslySetInnerHTML":if(S!=null){if(typeof S!="object"||!("__html"in S))throw Error(r(61));if(h=S.__html,h!=null){if(x.children!=null)throw Error(r(60));s.innerHTML=h}}break;case"children":typeof S=="string"?Sa(s,S):(typeof S=="number"||typeof S=="bigint")&&Sa(s,""+S);break;case"onScroll":S!=null&&pt("scroll",s);break;case"onScrollEnd":S!=null&&pt("scrollend",s);break;case"onClick":S!=null&&(s.onclick=Ou);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ks.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(x=h.endsWith("Capture"),o=h.slice(2,x?h.length-7:void 0),O=s[or]||null,O=O!=null?O[h]:null,typeof O=="function"&&s.removeEventListener(o,O,x),typeof S=="function")){typeof O!="function"&&O!==null&&(h in s?s[h]=null:s.hasAttribute(h)&&s.removeAttribute(h)),s.addEventListener(o,S,x);break e}h in s?s[h]=S:S===!0?s.setAttribute(h,""):Ae(s,h,S)}}}function Pr(s,o,h){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":pt("error",s),pt("load",s);var S=!1,x=!1,O;for(O in h)if(h.hasOwnProperty(O)){var B=h[O];if(B!=null)switch(O){case"src":S=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:Pt(s,o,O,B,h,null)}}x&&Pt(s,o,"srcSet",h.srcSet,h,null),S&&Pt(s,o,"src",h.src,h,null);return;case"input":pt("invalid",s);var G=O=B=x=null,W=null,se=null;for(S in h)if(h.hasOwnProperty(S)){var de=h[S];if(de!=null)switch(S){case"name":x=de;break;case"type":B=de;break;case"checked":W=de;break;case"defaultChecked":se=de;break;case"value":O=de;break;case"defaultValue":G=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(r(137,o));break;default:Pt(s,o,S,de,h,null)}}jv(s,O,G,W,se,B,x,!1),Hn(s);return;case"select":pt("invalid",s),S=B=O=null;for(x in h)if(h.hasOwnProperty(x)&&(G=h[x],G!=null))switch(x){case"value":O=G;break;case"defaultValue":B=G;break;case"multiple":S=G;default:Pt(s,o,x,G,h,null)}o=O,h=B,s.multiple=!!S,o!=null?_a(s,!!S,o,!1):h!=null&&_a(s,!!S,h,!0);return;case"textarea":pt("invalid",s),O=x=S=null;for(B in h)if(h.hasOwnProperty(B)&&(G=h[B],G!=null))switch(B){case"value":S=G;break;case"defaultValue":x=G;break;case"children":O=G;break;case"dangerouslySetInnerHTML":if(G!=null)throw Error(r(91));break;default:Pt(s,o,B,G,h,null)}Gv(s,S,x,O),Hn(s);return;case"option":for(W in h)if(h.hasOwnProperty(W)&&(S=h[W],S!=null))switch(W){case"selected":s.selected=S&&typeof S!="function"&&typeof S!="symbol";break;default:Pt(s,o,W,S,h,null)}return;case"dialog":pt("beforetoggle",s),pt("toggle",s),pt("cancel",s),pt("close",s);break;case"iframe":case"object":pt("load",s);break;case"video":case"audio":for(S=0;S<gc.length;S++)pt(gc[S],s);break;case"image":pt("error",s),pt("load",s);break;case"details":pt("toggle",s);break;case"embed":case"source":case"link":pt("error",s),pt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(se in h)if(h.hasOwnProperty(se)&&(S=h[se],S!=null))switch(se){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:Pt(s,o,se,S,h,null)}return;default:if(Uf(o)){for(de in h)h.hasOwnProperty(de)&&(S=h[de],S!==void 0&&Rp(s,o,de,S,h,void 0));return}}for(G in h)h.hasOwnProperty(G)&&(S=h[G],S!=null&&Pt(s,o,G,S,h,null))}function yx(s,o,h,S){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,O=null,B=null,G=null,W=null,se=null,de=null;for(ce in h){var me=h[ce];if(h.hasOwnProperty(ce)&&me!=null)switch(ce){case"checked":break;case"value":break;case"defaultValue":W=me;default:S.hasOwnProperty(ce)||Pt(s,o,ce,null,S,me)}}for(var ae in S){var ce=S[ae];if(me=h[ae],S.hasOwnProperty(ae)&&(ce!=null||me!=null))switch(ae){case"type":O=ce;break;case"name":x=ce;break;case"checked":se=ce;break;case"defaultChecked":de=ce;break;case"value":B=ce;break;case"defaultValue":G=ce;break;case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(r(137,o));break;default:ce!==me&&Pt(s,o,ae,ce,S,me)}}Bf(s,B,G,W,se,de,O,x);return;case"select":ce=B=G=ae=null;for(O in h)if(W=h[O],h.hasOwnProperty(O)&&W!=null)switch(O){case"value":break;case"multiple":ce=W;default:S.hasOwnProperty(O)||Pt(s,o,O,null,S,W)}for(x in S)if(O=S[x],W=h[x],S.hasOwnProperty(x)&&(O!=null||W!=null))switch(x){case"value":ae=O;break;case"defaultValue":G=O;break;case"multiple":B=O;default:O!==W&&Pt(s,o,x,O,S,W)}o=G,h=B,S=ce,ae!=null?_a(s,!!h,ae,!1):!!S!=!!h&&(o!=null?_a(s,!!h,o,!0):_a(s,!!h,h?[]:"",!1));return;case"textarea":ce=ae=null;for(G in h)if(x=h[G],h.hasOwnProperty(G)&&x!=null&&!S.hasOwnProperty(G))switch(G){case"value":break;case"children":break;default:Pt(s,o,G,null,S,x)}for(B in S)if(x=S[B],O=h[B],S.hasOwnProperty(B)&&(x!=null||O!=null))switch(B){case"value":ae=x;break;case"defaultValue":ce=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(r(91));break;default:x!==O&&Pt(s,o,B,x,S,O)}zv(s,ae,ce);return;case"option":for(var We in h)if(ae=h[We],h.hasOwnProperty(We)&&ae!=null&&!S.hasOwnProperty(We))switch(We){case"selected":s.selected=!1;break;default:Pt(s,o,We,null,S,ae)}for(W in S)if(ae=S[W],ce=h[W],S.hasOwnProperty(W)&&ae!==ce&&(ae!=null||ce!=null))switch(W){case"selected":s.selected=ae&&typeof ae!="function"&&typeof ae!="symbol";break;default:Pt(s,o,W,ae,S,ce)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ve in h)ae=h[Ve],h.hasOwnProperty(Ve)&&ae!=null&&!S.hasOwnProperty(Ve)&&Pt(s,o,Ve,null,S,ae);for(se in S)if(ae=S[se],ce=h[se],S.hasOwnProperty(se)&&ae!==ce&&(ae!=null||ce!=null))switch(se){case"children":case"dangerouslySetInnerHTML":if(ae!=null)throw Error(r(137,o));break;default:Pt(s,o,se,ae,S,ce)}return;default:if(Uf(o)){for(var kt in h)ae=h[kt],h.hasOwnProperty(kt)&&ae!==void 0&&!S.hasOwnProperty(kt)&&Rp(s,o,kt,void 0,S,ae);for(de in S)ae=S[de],ce=h[de],!S.hasOwnProperty(de)||ae===ce||ae===void 0&&ce===void 0||Rp(s,o,de,ae,S,ce);return}}for(var ee in h)ae=h[ee],h.hasOwnProperty(ee)&&ae!=null&&!S.hasOwnProperty(ee)&&Pt(s,o,ee,null,S,ae);for(me in S)ae=S[me],ce=h[me],!S.hasOwnProperty(me)||ae===ce||ae==null&&ce==null||Pt(s,o,me,ae,S,ce)}var wp=null,Tp=null;function Iu(s){return s.nodeType===9?s:s.ownerDocument}function Hb(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Vb(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function Cp(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Ap=null;function bx(){var s=window.event;return s&&s.type==="popstate"?s===Ap?!1:(Ap=s,!0):(Ap=null,!1)}var Kb=typeof setTimeout=="function"?setTimeout:void 0,_x=typeof clearTimeout=="function"?clearTimeout:void 0,qb=typeof Promise=="function"?Promise:void 0,Sx=typeof queueMicrotask=="function"?queueMicrotask:typeof qb<"u"?function(s){return qb.resolve(null).then(s).catch(Ex)}:Kb;function Ex(s){setTimeout(function(){throw s})}function os(s){return s==="head"}function Yb(s,o){var h=o,S=0,x=0;do{var O=h.nextSibling;if(s.removeChild(h),O&&O.nodeType===8)if(h=O.data,h==="/$"){if(0<S&&8>S){h=S;var B=s.ownerDocument;if(h&1&&yc(B.documentElement),h&2&&yc(B.body),h&4)for(h=B.head,yc(h),B=h.firstChild;B;){var G=B.nextSibling,W=B.nodeName;B[Jt]||W==="SCRIPT"||W==="STYLE"||W==="LINK"&&B.rel.toLowerCase()==="stylesheet"||h.removeChild(B),B=G}}if(x===0){s.removeChild(O),Cc(o);return}x--}else h==="$"||h==="$?"||h==="$!"?x++:S=h.charCodeAt(0)-48;else S=0;h=O}while(h);Cc(o)}function xp(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var h=o;switch(o=o.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":xp(h),_r(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}s.removeChild(h)}}function Rx(s,o,h,S){for(;s.nodeType===1;){var x=h;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!S&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(S){if(!s[Jt])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(O=s.getAttribute("rel"),O==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(O!==x.rel||s.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||s.getAttribute("title")!==(x.title==null?null:x.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(O=s.getAttribute("src"),(O!==(x.src==null?null:x.src)||s.getAttribute("type")!==(x.type==null?null:x.type)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&O&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var O=x.name==null?null:""+x.name;if(x.type==="hidden"&&s.getAttribute("name")===O)return s}else return s;if(s=qi(s.nextSibling),s===null)break}return null}function wx(s,o,h){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!h||(s=qi(s.nextSibling),s===null))return null;return s}function Dp(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function Tx(s,o){var h=s.ownerDocument;if(s.data!=="$?"||h.readyState==="complete")o();else{var S=function(){o(),h.removeEventListener("DOMContentLoaded",S)};h.addEventListener("DOMContentLoaded",S),s._reactRetry=S}}function qi(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return s}var Lp=null;function Wb(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var h=s.data;if(h==="$"||h==="$!"||h==="$?"){if(o===0)return s;o--}else h==="/$"&&o++}s=s.previousSibling}return null}function Xb(s,o,h){switch(o=Iu(h),s){case"html":if(s=o.documentElement,!s)throw Error(r(452));return s;case"head":if(s=o.head,!s)throw Error(r(453));return s;case"body":if(s=o.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function yc(s){for(var o=s.attributes;o.length;)s.removeAttributeNode(o[0]);_r(s)}var Li=new Map,Qb=new Set;function Pu(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Mn=U.d;U.d={f:Cx,r:Ax,D:xx,C:Dx,L:Lx,m:Ox,X:Px,S:Ix,M:kx};function Cx(){var s=Mn.f(),o=wu();return s||o}function Ax(s){var o=ji(s);o!==null&&o.tag===5&&o.type==="form"?v0(o):Mn.r(s)}var Xa=typeof document>"u"?null:document;function Zb(s,o,h){var S=Xa;if(S&&typeof o=="string"&&o){var x=qr(o);x='link[rel="'+s+'"][href="'+x+'"]',typeof h=="string"&&(x+='[crossorigin="'+h+'"]'),Qb.has(x)||(Qb.add(x),s={rel:s,crossOrigin:h,href:o},S.querySelector(x)===null&&(o=S.createElement("link"),Pr(o,"link",s),jt(o),S.head.appendChild(o)))}}function xx(s){Mn.D(s),Zb("dns-prefetch",s,null)}function Dx(s,o){Mn.C(s,o),Zb("preconnect",s,o)}function Lx(s,o,h){Mn.L(s,o,h);var S=Xa;if(S&&s&&o){var x='link[rel="preload"][as="'+qr(o)+'"]';o==="image"&&h&&h.imageSrcSet?(x+='[imagesrcset="'+qr(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(x+='[imagesizes="'+qr(h.imageSizes)+'"]')):x+='[href="'+qr(s)+'"]';var O=x;switch(o){case"style":O=Qa(s);break;case"script":O=Za(s)}Li.has(O)||(s=f({rel:"preload",href:o==="image"&&h&&h.imageSrcSet?void 0:s,as:o},h),Li.set(O,s),S.querySelector(x)!==null||o==="style"&&S.querySelector(bc(O))||o==="script"&&S.querySelector(_c(O))||(o=S.createElement("link"),Pr(o,"link",s),jt(o),S.head.appendChild(o)))}}function Ox(s,o){Mn.m(s,o);var h=Xa;if(h&&s){var S=o&&typeof o.as=="string"?o.as:"script",x='link[rel="modulepreload"][as="'+qr(S)+'"][href="'+qr(s)+'"]',O=x;switch(S){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":O=Za(s)}if(!Li.has(O)&&(s=f({rel:"modulepreload",href:s},o),Li.set(O,s),h.querySelector(x)===null)){switch(S){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(_c(O)))return}S=h.createElement("link"),Pr(S,"link",s),jt(S),h.head.appendChild(S)}}}function Ix(s,o,h){Mn.S(s,o,h);var S=Xa;if(S&&s){var x=ai(S).hoistableStyles,O=Qa(s);o=o||"default";var B=x.get(O);if(!B){var G={loading:0,preload:null};if(B=S.querySelector(bc(O)))G.loading=5;else{s=f({rel:"stylesheet",href:s,"data-precedence":o},h),(h=Li.get(O))&&Op(s,h);var W=B=S.createElement("link");jt(W),Pr(W,"link",s),W._p=new Promise(function(se,de){W.onload=se,W.onerror=de}),W.addEventListener("load",function(){G.loading|=1}),W.addEventListener("error",function(){G.loading|=2}),G.loading|=4,ku(B,o,S)}B={type:"stylesheet",instance:B,count:1,state:G},x.set(O,B)}}}function Px(s,o){Mn.X(s,o);var h=Xa;if(h&&s){var S=ai(h).hoistableScripts,x=Za(s),O=S.get(x);O||(O=h.querySelector(_c(x)),O||(s=f({src:s,async:!0},o),(o=Li.get(x))&&Ip(s,o),O=h.createElement("script"),jt(O),Pr(O,"link",s),h.head.appendChild(O)),O={type:"script",instance:O,count:1,state:null},S.set(x,O))}}function kx(s,o){Mn.M(s,o);var h=Xa;if(h&&s){var S=ai(h).hoistableScripts,x=Za(s),O=S.get(x);O||(O=h.querySelector(_c(x)),O||(s=f({src:s,async:!0,type:"module"},o),(o=Li.get(x))&&Ip(s,o),O=h.createElement("script"),jt(O),Pr(O,"link",s),h.head.appendChild(O)),O={type:"script",instance:O,count:1,state:null},S.set(x,O))}}function Jb(s,o,h,S){var x=(x=oe.current)?Pu(x):null;if(!x)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(o=Qa(h.href),h=ai(x).hoistableStyles,S=h.get(o),S||(S={type:"style",instance:null,count:0,state:null},h.set(o,S)),S):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){s=Qa(h.href);var O=ai(x).hoistableStyles,B=O.get(s);if(B||(x=x.ownerDocument||x,B={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},O.set(s,B),(O=x.querySelector(bc(s)))&&!O._p&&(B.instance=O,B.state.loading=5),Li.has(s)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},Li.set(s,h),O||Mx(x,s,h,B.state))),o&&S===null)throw Error(r(528,""));return B}if(o&&S!==null)throw Error(r(529,""));return null;case"script":return o=h.async,h=h.src,typeof h=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Za(h),h=ai(x).hoistableScripts,S=h.get(o),S||(S={type:"script",instance:null,count:0,state:null},h.set(o,S)),S):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function Qa(s){return'href="'+qr(s)+'"'}function bc(s){return'link[rel="stylesheet"]['+s+"]"}function e_(s){return f({},s,{"data-precedence":s.precedence,precedence:null})}function Mx(s,o,h,S){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?S.loading=1:(o=s.createElement("link"),S.preload=o,o.addEventListener("load",function(){return S.loading|=1}),o.addEventListener("error",function(){return S.loading|=2}),Pr(o,"link",h),jt(o),s.head.appendChild(o))}function Za(s){return'[src="'+qr(s)+'"]'}function _c(s){return"script[async]"+s}function t_(s,o,h){if(o.count++,o.instance===null)switch(o.type){case"style":var S=s.querySelector('style[data-href~="'+qr(h.href)+'"]');if(S)return o.instance=S,jt(S),S;var x=f({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return S=(s.ownerDocument||s).createElement("style"),jt(S),Pr(S,"style",x),ku(S,h.precedence,s),o.instance=S;case"stylesheet":x=Qa(h.href);var O=s.querySelector(bc(x));if(O)return o.state.loading|=4,o.instance=O,jt(O),O;S=e_(h),(x=Li.get(x))&&Op(S,x),O=(s.ownerDocument||s).createElement("link"),jt(O);var B=O;return B._p=new Promise(function(G,W){B.onload=G,B.onerror=W}),Pr(O,"link",S),o.state.loading|=4,ku(O,h.precedence,s),o.instance=O;case"script":return O=Za(h.src),(x=s.querySelector(_c(O)))?(o.instance=x,jt(x),x):(S=h,(x=Li.get(O))&&(S=f({},h),Ip(S,x)),s=s.ownerDocument||s,x=s.createElement("script"),jt(x),Pr(x,"link",S),s.head.appendChild(x),o.instance=x);case"void":return null;default:throw Error(r(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(S=o.instance,o.state.loading|=4,ku(S,h.precedence,s));return o.instance}function ku(s,o,h){for(var S=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=S.length?S[S.length-1]:null,O=x,B=0;B<S.length;B++){var G=S[B];if(G.dataset.precedence===o)O=G;else if(O!==x)break}O?O.parentNode.insertBefore(s,O.nextSibling):(o=h.nodeType===9?h.head:h,o.insertBefore(s,o.firstChild))}function Op(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function Ip(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var Mu=null;function r_(s,o,h){if(Mu===null){var S=new Map,x=Mu=new Map;x.set(h,S)}else x=Mu,S=x.get(h),S||(S=new Map,x.set(h,S));if(S.has(s))return S;for(S.set(s,null),h=h.getElementsByTagName(s),x=0;x<h.length;x++){var O=h[x];if(!(O[Jt]||O[Ut]||s==="link"&&O.getAttribute("rel")==="stylesheet")&&O.namespaceURI!=="http://www.w3.org/2000/svg"){var B=O.getAttribute(o)||"";B=s+B;var G=S.get(B);G?G.push(O):S.set(B,[O])}}return S}function i_(s,o,h){s=s.ownerDocument||s,s.head.insertBefore(h,o==="title"?s.querySelector("head > title"):null)}function Nx(s,o,h){if(h===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return s=o.disabled,typeof o.precedence=="string"&&s==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function n_(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var Sc=null;function Bx(){}function Fx(s,o,h){if(Sc===null)throw Error(r(475));var S=Sc;if(o.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var x=Qa(h.href),O=s.querySelector(bc(x));if(O){s=O._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(S.count++,S=Nu.bind(S),s.then(S,S)),o.state.loading|=4,o.instance=O,jt(O);return}O=s.ownerDocument||s,h=e_(h),(x=Li.get(x))&&Op(h,x),O=O.createElement("link"),jt(O);var B=O;B._p=new Promise(function(G,W){B.onload=G,B.onerror=W}),Pr(O,"link",h),o.instance=O}S.stylesheets===null&&(S.stylesheets=new Map),S.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(S.count++,o=Nu.bind(S),s.addEventListener("load",o),s.addEventListener("error",o))}}function Ux(){if(Sc===null)throw Error(r(475));var s=Sc;return s.stylesheets&&s.count===0&&Pp(s,s.stylesheets),0<s.count?function(o){var h=setTimeout(function(){if(s.stylesheets&&Pp(s,s.stylesheets),s.unsuspend){var S=s.unsuspend;s.unsuspend=null,S()}},6e4);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(h)}}:null}function Nu(){if(this.count--,this.count===0){if(this.stylesheets)Pp(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Bu=null;function Pp(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Bu=new Map,o.forEach($x,s),Bu=null,Nu.call(s))}function $x(s,o){if(!(o.state.loading&4)){var h=Bu.get(s);if(h)var S=h.get(null);else{h=new Map,Bu.set(s,h);for(var x=s.querySelectorAll("link[data-precedence],style[data-precedence]"),O=0;O<x.length;O++){var B=x[O];(B.nodeName==="LINK"||B.getAttribute("media")!=="not all")&&(h.set(B.dataset.precedence,B),S=B)}S&&h.set(null,S)}x=o.instance,B=x.getAttribute("data-precedence"),O=h.get(B)||S,O===S&&h.set(null,x),h.set(B,x),this.count++,S=Nu.bind(this),x.addEventListener("load",S),x.addEventListener("error",S),O?O.parentNode.insertBefore(x,O.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(x,s.firstChild)),o.state.loading|=4}}var Ec={$$typeof:R,Provider:null,Consumer:null,_currentValue:V,_currentValue2:V,_threadCount:0};function jx(s,o,h,S,x,O,B,G){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ei(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ei(0),this.hiddenUpdates=Ei(null),this.identifierPrefix=S,this.onUncaughtError=x,this.onCaughtError=O,this.onRecoverableError=B,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=G,this.incompleteTransitions=new Map}function s_(s,o,h,S,x,O,B,G,W,se,de,me){return s=new jx(s,o,h,B,G,W,se,me),o=1,O===!0&&(o|=24),O=ci(3,null,null,o),s.current=O,O.stateNode=s,o=ph(),o.refCount++,s.pooledCache=o,o.refCount++,O.memoizedState={element:S,isDehydrated:h,cache:o},yh(O),s}function a_(s){return s?(s=Da,s):Da}function o_(s,o,h,S,x,O){x=a_(x),S.context===null?S.context=x:S.pendingContext=x,S=Yn(o),S.payload={element:h},O=O===void 0?null:O,O!==null&&(S.callback=O),h=Wn(s,S,o),h!==null&&(hi(h,s,o),Zo(h,s,o))}function c_(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var h=s.retryLane;s.retryLane=h!==0&&h<o?h:o}}function kp(s,o){c_(s,o),(s=s.alternate)&&c_(s,o)}function l_(s){if(s.tag===13){var o=xa(s,67108864);o!==null&&hi(o,s,67108864),kp(s,67108864)}}var Fu=!0;function zx(s,o,h,S){var x=N.T;N.T=null;var O=U.p;try{U.p=2,Mp(s,o,h,S)}finally{U.p=O,N.T=x}}function Gx(s,o,h,S){var x=N.T;N.T=null;var O=U.p;try{U.p=8,Mp(s,o,h,S)}finally{U.p=O,N.T=x}}function Mp(s,o,h,S){if(Fu){var x=Np(S);if(x===null)Ep(s,o,S,Uu,h),d_(s,S);else if(Vx(x,s,o,h,S))S.stopPropagation();else if(d_(s,S),o&4&&-1<Hx.indexOf(s)){for(;x!==null;){var O=ji(x);if(O!==null)switch(O.tag){case 3:if(O=O.stateNode,O.current.memoizedState.isDehydrated){var B=ke(O.pendingLanes);if(B!==0){var G=O;for(G.pendingLanes|=2,G.entangledLanes|=2;B;){var W=1<<31-Et(B);G.entanglements[1]|=W,B&=~W}ln(O),(xt&6)===0&&(Eu=De()+500,mc(0))}}break;case 13:G=xa(O,2),G!==null&&hi(G,O,2),wu(),kp(O,2)}if(O=Np(S),O===null&&Ep(s,o,S,Uu,h),O===x)break;x=O}x!==null&&S.stopPropagation()}else Ep(s,o,S,null,h)}}function Np(s){return s=jf(s),Bp(s)}var Uu=null;function Bp(s){if(Uu=null,s=cr(s),s!==null){var o=a(s);if(o===null)s=null;else{var h=o.tag;if(h===13){if(s=c(o),s!==null)return s;s=null}else if(h===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return Uu=s,null}function u_(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ze()){case ut:return 2;case Ft:return 8;case rt:case et:return 32;case $e:return 268435456;default:return 32}default:return 32}}var Fp=!1,cs=null,ls=null,us=null,Rc=new Map,wc=new Map,ds=[],Hx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function d_(s,o){switch(s){case"focusin":case"focusout":cs=null;break;case"dragenter":case"dragleave":ls=null;break;case"mouseover":case"mouseout":us=null;break;case"pointerover":case"pointerout":Rc.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":wc.delete(o.pointerId)}}function Tc(s,o,h,S,x,O){return s===null||s.nativeEvent!==O?(s={blockedOn:o,domEventName:h,eventSystemFlags:S,nativeEvent:O,targetContainers:[x]},o!==null&&(o=ji(o),o!==null&&l_(o)),s):(s.eventSystemFlags|=S,o=s.targetContainers,x!==null&&o.indexOf(x)===-1&&o.push(x),s)}function Vx(s,o,h,S,x){switch(o){case"focusin":return cs=Tc(cs,s,o,h,S,x),!0;case"dragenter":return ls=Tc(ls,s,o,h,S,x),!0;case"mouseover":return us=Tc(us,s,o,h,S,x),!0;case"pointerover":var O=x.pointerId;return Rc.set(O,Tc(Rc.get(O)||null,s,o,h,S,x)),!0;case"gotpointercapture":return O=x.pointerId,wc.set(O,Tc(wc.get(O)||null,s,o,h,S,x)),!0}return!1}function f_(s){var o=cr(s.target);if(o!==null){var h=a(o);if(h!==null){if(o=h.tag,o===13){if(o=c(h),o!==null){s.blockedOn=o,Ri(s.priority,function(){if(h.tag===13){var S=fi();S=Lr(S);var x=xa(h,S);x!==null&&hi(x,h,S),kp(h,S)}});return}}else if(o===3&&h.stateNode.current.memoizedState.isDehydrated){s.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}s.blockedOn=null}function $u(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var h=Np(s.nativeEvent);if(h===null){h=s.nativeEvent;var S=new h.constructor(h.type,h);$f=S,h.target.dispatchEvent(S),$f=null}else return o=ji(h),o!==null&&l_(o),s.blockedOn=h,!1;o.shift()}return!0}function h_(s,o,h){$u(s)&&h.delete(o)}function Kx(){Fp=!1,cs!==null&&$u(cs)&&(cs=null),ls!==null&&$u(ls)&&(ls=null),us!==null&&$u(us)&&(us=null),Rc.forEach(h_),wc.forEach(h_)}function ju(s,o){s.blockedOn===o&&(s.blockedOn=null,Fp||(Fp=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Kx)))}var zu=null;function p_(s){zu!==s&&(zu=s,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){zu===s&&(zu=null);for(var o=0;o<s.length;o+=3){var h=s[o],S=s[o+1],x=s[o+2];if(typeof S!="function"){if(Bp(S||h)===null)continue;break}var O=ji(h);O!==null&&(s.splice(o,3),o-=3,Bh(O,{pending:!0,data:x,method:h.method,action:S},S,x))}}))}function Cc(s){function o(W){return ju(W,s)}cs!==null&&ju(cs,s),ls!==null&&ju(ls,s),us!==null&&ju(us,s),Rc.forEach(o),wc.forEach(o);for(var h=0;h<ds.length;h++){var S=ds[h];S.blockedOn===s&&(S.blockedOn=null)}for(;0<ds.length&&(h=ds[0],h.blockedOn===null);)f_(h),h.blockedOn===null&&ds.shift();if(h=(s.ownerDocument||s).$$reactFormReplay,h!=null)for(S=0;S<h.length;S+=3){var x=h[S],O=h[S+1],B=x[or]||null;if(typeof O=="function")B||p_(h);else if(B){var G=null;if(O&&O.hasAttribute("formAction")){if(x=O,B=O[or]||null)G=B.formAction;else if(Bp(x)!==null)continue}else G=B.action;typeof G=="function"?h[S+1]=G:(h.splice(S,3),S-=3),p_(h)}}}function Up(s){this._internalRoot=s}Gu.prototype.render=Up.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(r(409));var h=o.current,S=fi();o_(h,S,s,o,null,null)},Gu.prototype.unmount=Up.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;o_(s.current,2,null,s,null,null),wu(),o[yt]=null}};function Gu(s){this._internalRoot=s}Gu.prototype.unstable_scheduleHydration=function(s){if(s){var o=$i();s={blockedOn:null,target:s,priority:o};for(var h=0;h<ds.length&&o!==0&&o<ds[h].priority;h++);ds.splice(h,0,s),h===0&&f_(s)}};var m_=e.version;if(m_!=="19.1.0")throw Error(r(527,m_,"19.1.0"));U.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(o),s=s!==null?u(s):null,s=s===null?null:s.stateNode,s};var qx={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:N,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hu.isDisabled&&Hu.supportsFiber)try{Wt=Hu.inject(qx),_t=Hu}catch{}}return xc.createRoot=function(s,o){if(!n(s))throw Error(r(299));var h=!1,S="",x=O0,O=I0,B=P0,G=null;return o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(S=o.identifierPrefix),o.onUncaughtError!==void 0&&(x=o.onUncaughtError),o.onCaughtError!==void 0&&(O=o.onCaughtError),o.onRecoverableError!==void 0&&(B=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(G=o.unstable_transitionCallbacks)),o=s_(s,1,!1,null,null,h,S,x,O,B,G,null),s[yt]=o.current,Sp(s),new Up(o)},xc.hydrateRoot=function(s,o,h){if(!n(s))throw Error(r(299));var S=!1,x="",O=O0,B=I0,G=P0,W=null,se=null;return h!=null&&(h.unstable_strictMode===!0&&(S=!0),h.identifierPrefix!==void 0&&(x=h.identifierPrefix),h.onUncaughtError!==void 0&&(O=h.onUncaughtError),h.onCaughtError!==void 0&&(B=h.onCaughtError),h.onRecoverableError!==void 0&&(G=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(W=h.unstable_transitionCallbacks),h.formState!==void 0&&(se=h.formState)),o=s_(s,1,!0,o,h??null,S,x,O,B,G,W,se),o.context=a_(null),h=o.current,S=fi(),S=Lr(S),x=Yn(S),x.callback=null,Wn(h,x,S),h=S,o.current.lanes=h,ni(o,h),ln(o),s[yt]=o.current,Sp(s),new Gu(o)},xc.version="19.1.0",xc}var T_;function rD(){if(T_)return jp.exports;T_=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),jp.exports=tD(),jp.exports}var iD=rD(),H=Zg();const we=Qg(H),Jg=yR({__proto__:null,default:we},[H]);var Kp={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var C_;function nD(){return C_||(C_=1,function(i){(function(){var e={}.hasOwnProperty;function t(){for(var a="",c=0;c<arguments.length;c++){var l=arguments[c];l&&(a=n(a,r(l)))}return a}function r(a){if(typeof a=="string"||typeof a=="number")return a;if(typeof a!="object")return"";if(Array.isArray(a))return t.apply(null,a);if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]"))return a.toString();var c="";for(var l in a)e.call(a,l)&&a[l]&&(c=n(c,l));return c}function n(a,c){return c?a?a+" "+c:a+c:a}i.exports?(t.default=t,i.exports=t):window.classNames=t})()}(Kp)),Kp.exports}var sD=nD();const tt=Qg(sD);function Dr(){return Dr=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},Dr.apply(null,arguments)}function Xe(i){"@babel/helpers - typeof";return Xe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xe(i)}var aD=Symbol.for("react.element"),oD=Symbol.for("react.transitional.element"),cD=Symbol.for("react.fragment");function _R(i){return i&&Xe(i)==="object"&&(i.$$typeof===aD||i.$$typeof===oD)&&i.type===cD}function zd(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=[];return we.Children.forEach(i,function(r){r==null&&!e.keepEmpty||(Array.isArray(r)?t=t.concat(zd(r)):_R(r)&&r.props?t=t.concat(zd(r.props.children,e)):t.push(r))}),t}var qm={},lD=function(e){};function uD(i,e){}function dD(i,e){}function fD(){qm={}}function SR(i,e,t){!e&&!qm[t]&&(i(!1,t),qm[t]=!0)}function bi(i,e){SR(uD,i,e)}function hD(i,e){SR(dD,i,e)}bi.preMessage=lD;bi.resetWarned=fD;bi.noteOnce=hD;function pD(i,e){if(Xe(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e);if(Xe(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function ER(i){var e=pD(i,"string");return Xe(e)=="symbol"?e:e+""}function ie(i,e,t){return(e=ER(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function A_(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),t.push.apply(t,r)}return t}function ue(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?A_(Object(t),!0).forEach(function(r){ie(i,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):A_(Object(t)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(t,r))})}return i}var RR=bR();const Ym=Qg(RR),mD=yR({__proto__:null,default:Ym},[RR]);function x_(i){return i instanceof HTMLElement||i instanceof SVGElement}function gD(i){return i&&Xe(i)==="object"&&x_(i.nativeElement)?i.nativeElement:x_(i)?i:null}function xd(i){var e=gD(i);if(e)return e;if(i instanceof we.Component){var t;return(t=Ym.findDOMNode)===null||t===void 0?void 0:t.call(Ym,i)}return null}var qp={exports:{}},Ct={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D_;function vD(){if(D_)return Ct;D_=1;var i=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.server_context"),d=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),f=Symbol.for("react.suspense_list"),p=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),E=Symbol.for("react.offscreen"),g;g=Symbol.for("react.module.reference");function _(m){if(typeof m=="object"&&m!==null){var y=m.$$typeof;switch(y){case i:switch(m=m.type,m){case t:case n:case r:case u:case f:return m;default:switch(m=m&&m.$$typeof,m){case l:case c:case d:case v:case p:case a:return m;default:return y}}case e:return y}}}return Ct.ContextConsumer=c,Ct.ContextProvider=a,Ct.Element=i,Ct.ForwardRef=d,Ct.Fragment=t,Ct.Lazy=v,Ct.Memo=p,Ct.Portal=e,Ct.Profiler=n,Ct.StrictMode=r,Ct.Suspense=u,Ct.SuspenseList=f,Ct.isAsyncMode=function(){return!1},Ct.isConcurrentMode=function(){return!1},Ct.isContextConsumer=function(m){return _(m)===c},Ct.isContextProvider=function(m){return _(m)===a},Ct.isElement=function(m){return typeof m=="object"&&m!==null&&m.$$typeof===i},Ct.isForwardRef=function(m){return _(m)===d},Ct.isFragment=function(m){return _(m)===t},Ct.isLazy=function(m){return _(m)===v},Ct.isMemo=function(m){return _(m)===p},Ct.isPortal=function(m){return _(m)===e},Ct.isProfiler=function(m){return _(m)===n},Ct.isStrictMode=function(m){return _(m)===r},Ct.isSuspense=function(m){return _(m)===u},Ct.isSuspenseList=function(m){return _(m)===f},Ct.isValidElementType=function(m){return typeof m=="string"||typeof m=="function"||m===t||m===n||m===r||m===u||m===f||m===E||typeof m=="object"&&m!==null&&(m.$$typeof===v||m.$$typeof===p||m.$$typeof===a||m.$$typeof===c||m.$$typeof===d||m.$$typeof===g||m.getModuleId!==void 0)},Ct.typeOf=_,Ct}var L_;function yD(){return L_||(L_=1,qp.exports=vD()),qp.exports}var Yp=yD();function ev(i,e,t){var r=H.useRef({});return(!("value"in r.current)||t(r.current.condition,e))&&(r.current.value=i(),r.current.condition=e),r.current.value}var bD=Number(H.version.split(".")[0]),wR=function(e,t){typeof e=="function"?e(t):Xe(e)==="object"&&e&&"current"in e&&(e.current=t)},Lo=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.filter(Boolean);return n.length<=1?n[0]:function(a){t.forEach(function(c){wR(c,a)})}},TR=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return ev(function(){return Lo.apply(void 0,t)},t,function(n,a){return n.length!==a.length||n.every(function(c,l){return c!==a[l]})})},tv=function(e){var t,r;if(!e)return!1;if(CR(e)&&bD>=19)return!0;var n=Yp.isMemo(e)?e.type.type:e.type;return!(typeof n=="function"&&!((t=n.prototype)!==null&&t!==void 0&&t.render)&&n.$$typeof!==Yp.ForwardRef||typeof e=="function"&&!((r=e.prototype)!==null&&r!==void 0&&r.render)&&e.$$typeof!==Yp.ForwardRef)};function CR(i){return H.isValidElement(i)&&!_R(i)}var rv=function(e){if(e&&CR(e)){var t=e;return t.props.propertyIsEnumerable("ref")?t.props.ref:t.ref}return null},Wm=H.createContext(null);function _D(i){var e=i.children,t=i.onBatchResize,r=H.useRef(0),n=H.useRef([]),a=H.useContext(Wm),c=H.useCallback(function(l,d,u){r.current+=1;var f=r.current;n.current.push({size:l,element:d,data:u}),Promise.resolve().then(function(){f===r.current&&(t==null||t(n.current),n.current=[])}),a==null||a(l,d,u)},[t,a]);return H.createElement(Wm.Provider,{value:c},e)}var AR=function(){if(typeof Map<"u")return Map;function i(e,t){var r=-1;return e.some(function(n,a){return n[0]===t?(r=a,!0):!1}),r}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(t){var r=i(this.__entries__,t),n=this.__entries__[r];return n&&n[1]},e.prototype.set=function(t,r){var n=i(this.__entries__,t);~n?this.__entries__[n][1]=r:this.__entries__.push([t,r])},e.prototype.delete=function(t){var r=this.__entries__,n=i(r,t);~n&&r.splice(n,1)},e.prototype.has=function(t){return!!~i(this.__entries__,t)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,r){r===void 0&&(r=null);for(var n=0,a=this.__entries__;n<a.length;n++){var c=a[n];t.call(r,c[1],c[0])}},e}()}(),Xm=typeof window<"u"&&typeof document<"u"&&window.document===document,Gd=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),SD=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(Gd):function(i){return setTimeout(function(){return i(Date.now())},1e3/60)}}(),ED=2;function RD(i,e){var t=!1,r=!1,n=0;function a(){t&&(t=!1,i()),r&&l()}function c(){SD(a)}function l(){var d=Date.now();if(t){if(d-n<ED)return;r=!0}else t=!0,r=!1,setTimeout(c,e);n=d}return l}var wD=20,TD=["top","right","bottom","left","width","height","size","weight"],CD=typeof MutationObserver<"u",AD=function(){function i(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=RD(this.refresh.bind(this),wD)}return i.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},i.prototype.removeObserver=function(e){var t=this.observers_,r=t.indexOf(e);~r&&t.splice(r,1),!t.length&&this.connected_&&this.disconnect_()},i.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},i.prototype.updateObservers_=function(){var e=this.observers_.filter(function(t){return t.gatherActive(),t.hasActive()});return e.forEach(function(t){return t.broadcastActive()}),e.length>0},i.prototype.connect_=function(){!Xm||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),CD?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},i.prototype.disconnect_=function(){!Xm||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},i.prototype.onTransitionEnd_=function(e){var t=e.propertyName,r=t===void 0?"":t,n=TD.some(function(a){return!!~r.indexOf(a)});n&&this.refresh()},i.getInstance=function(){return this.instance_||(this.instance_=new i),this.instance_},i.instance_=null,i}(),xR=function(i,e){for(var t=0,r=Object.keys(e);t<r.length;t++){var n=r[t];Object.defineProperty(i,n,{value:e[n],enumerable:!1,writable:!1,configurable:!0})}return i},_o=function(i){var e=i&&i.ownerDocument&&i.ownerDocument.defaultView;return e||Gd},DR=hf(0,0,0,0);function Hd(i){return parseFloat(i)||0}function O_(i){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.reduce(function(r,n){var a=i["border-"+n+"-width"];return r+Hd(a)},0)}function xD(i){for(var e=["top","right","bottom","left"],t={},r=0,n=e;r<n.length;r++){var a=n[r],c=i["padding-"+a];t[a]=Hd(c)}return t}function DD(i){var e=i.getBBox();return hf(0,0,e.width,e.height)}function LD(i){var e=i.clientWidth,t=i.clientHeight;if(!e&&!t)return DR;var r=_o(i).getComputedStyle(i),n=xD(r),a=n.left+n.right,c=n.top+n.bottom,l=Hd(r.width),d=Hd(r.height);if(r.boxSizing==="border-box"&&(Math.round(l+a)!==e&&(l-=O_(r,"left","right")+a),Math.round(d+c)!==t&&(d-=O_(r,"top","bottom")+c)),!ID(i)){var u=Math.round(l+a)-e,f=Math.round(d+c)-t;Math.abs(u)!==1&&(l-=u),Math.abs(f)!==1&&(d-=f)}return hf(n.left,n.top,l,d)}var OD=function(){return typeof SVGGraphicsElement<"u"?function(i){return i instanceof _o(i).SVGGraphicsElement}:function(i){return i instanceof _o(i).SVGElement&&typeof i.getBBox=="function"}}();function ID(i){return i===_o(i).document.documentElement}function PD(i){return Xm?OD(i)?DD(i):LD(i):DR}function kD(i){var e=i.x,t=i.y,r=i.width,n=i.height,a=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,c=Object.create(a.prototype);return xR(c,{x:e,y:t,width:r,height:n,top:t,right:e+r,bottom:n+t,left:e}),c}function hf(i,e,t,r){return{x:i,y:e,width:t,height:r}}var MD=function(){function i(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=hf(0,0,0,0),this.target=e}return i.prototype.isActive=function(){var e=PD(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},i.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},i}(),ND=function(){function i(e,t){var r=kD(t);xR(this,{target:e,contentRect:r})}return i}(),BD=function(){function i(e,t,r){if(this.activeObservations_=[],this.observations_=new AR,typeof e!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=r}return i.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof _o(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new MD(e)),this.controller_.addObserver(this),this.controller_.refresh())}},i.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof _o(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},i.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},i.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&e.activeObservations_.push(t)})},i.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map(function(r){return new ND(r.target,r.broadcastRect())});this.callback_.call(e,t,e),this.clearActive()}},i.prototype.clearActive=function(){this.activeObservations_.splice(0)},i.prototype.hasActive=function(){return this.activeObservations_.length>0},i}(),LR=typeof WeakMap<"u"?new WeakMap:new AR,OR=function(){function i(e){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var t=AD.getInstance(),r=new BD(e,t,this);LR.set(this,r)}return i}();["observe","unobserve","disconnect"].forEach(function(i){OR.prototype[i]=function(){var e;return(e=LR.get(this))[i].apply(e,arguments)}});var FD=function(){return typeof Gd.ResizeObserver<"u"?Gd.ResizeObserver:OR}(),bs=new Map;function UD(i){i.forEach(function(e){var t,r=e.target;(t=bs.get(r))===null||t===void 0||t.forEach(function(n){return n(r)})})}var IR=new FD(UD);function $D(i,e){bs.has(i)||(bs.set(i,new Set),IR.observe(i)),bs.get(i).add(e)}function jD(i,e){bs.has(i)&&(bs.get(i).delete(e),bs.get(i).size||(IR.unobserve(i),bs.delete(i)))}function Mr(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function I_(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,ER(r.key),r)}}function Nr(i,e,t){return e&&I_(i.prototype,e),t&&I_(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}function yl(i,e){return yl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},yl(i,e)}function Cs(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&yl(i,e)}function bl(i){return bl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},bl(i)}function iv(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(iv=function(){return!!i})()}function lt(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function zD(i,e){if(e&&(Xe(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lt(i)}function As(i){var e=iv();return function(){var t,r=bl(i);if(e){var n=bl(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return zD(this,t)}}var GD=function(i){Cs(t,i);var e=As(t);function t(){return Mr(this,t),e.apply(this,arguments)}return Nr(t,[{key:"render",value:function(){return this.props.children}}]),t}(H.Component);function HD(i,e){var t=i.children,r=i.disabled,n=H.useRef(null),a=H.useRef(null),c=H.useContext(Wm),l=typeof t=="function",d=l?t(n):t,u=H.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),f=!l&&H.isValidElement(d)&&tv(d),p=f?rv(d):null,v=TR(p,n),E=function(){var y;return xd(n.current)||(n.current&&Xe(n.current)==="object"?xd((y=n.current)===null||y===void 0?void 0:y.nativeElement):null)||xd(a.current)};H.useImperativeHandle(e,function(){return E()});var g=H.useRef(i);g.current=i;var _=H.useCallback(function(m){var y=g.current,b=y.onResize,R=y.data,T=m.getBoundingClientRect(),w=T.width,C=T.height,A=m.offsetWidth,L=m.offsetHeight,D=Math.floor(w),P=Math.floor(C);if(u.current.width!==D||u.current.height!==P||u.current.offsetWidth!==A||u.current.offsetHeight!==L){var k={width:D,height:P,offsetWidth:A,offsetHeight:L};u.current=k;var M=A===Math.round(w)?w:A,I=L===Math.round(C)?C:L,F=ue(ue({},k),{},{offsetWidth:M,offsetHeight:I});c==null||c(F,m,R),b&&Promise.resolve().then(function(){b(F,m)})}},[]);return H.useEffect(function(){var m=E();return m&&!r&&$D(m,_),function(){return jD(m,_)}},[n.current,r]),H.createElement(GD,{ref:a},f?H.cloneElement(d,{ref:v}):d)}var VD=H.forwardRef(HD),KD="rc-observer-key";function qD(i,e){var t=i.children,r=typeof t=="function"?[t]:zd(t);return r.map(function(n,a){var c=(n==null?void 0:n.key)||"".concat(KD,"-").concat(a);return H.createElement(VD,Dr({},i,{key:c,ref:a===0?e:void 0}),n)})}var PR=H.forwardRef(qD);PR.Collection=_D;function Qm(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,r=Array(e);t<e;t++)r[t]=i[t];return r}function YD(i){if(Array.isArray(i))return Qm(i)}function kR(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function nv(i,e){if(i){if(typeof i=="string")return Qm(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Qm(i,e):void 0}}function WD(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ye(i){return YD(i)||kR(i)||nv(i)||WD()}var MR=function(e){return+setTimeout(e,16)},NR=function(e){return clearTimeout(e)};typeof window<"u"&&"requestAnimationFrame"in window&&(MR=function(e){return window.requestAnimationFrame(e)},NR=function(e){return window.cancelAnimationFrame(e)});var P_=0,sv=new Map;function BR(i){sv.delete(i)}var yn=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;P_+=1;var r=P_;function n(a){if(a===0)BR(r),e();else{var c=MR(function(){n(a-1)});sv.set(r,c)}}return n(t),r};yn.cancel=function(i){var e=sv.get(i);return BR(i),NR(e)};function FR(i){if(Array.isArray(i))return i}function XD(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var r,n,a,c,l=[],d=!0,u=!1;try{if(a=(t=t.call(i)).next,e===0){if(Object(t)!==t)return;d=!1}else for(;!(d=(r=a.call(t)).done)&&(l.push(r.value),l.length!==e);d=!0);}catch(f){u=!0,n=f}finally{try{if(!d&&t.return!=null&&(c=t.return(),Object(c)!==c))return}finally{if(u)throw n}}return l}}function UR(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Be(i,e){return FR(i)||XD(i,e)||nv(i,e)||UR()}function _l(i){for(var e=0,t,r=0,n=i.length;n>=4;++r,n-=4)t=i.charCodeAt(r)&255|(i.charCodeAt(++r)&255)<<8|(i.charCodeAt(++r)&255)<<16|(i.charCodeAt(++r)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,e=(t&65535)*1540483477+((t>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(n){case 3:e^=(i.charCodeAt(r+2)&255)<<16;case 2:e^=(i.charCodeAt(r+1)&255)<<8;case 1:e^=i.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}function $n(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function QD(i,e){if(!i)return!1;if(i.contains)return i.contains(e);for(var t=e;t;){if(t===i)return!0;t=t.parentNode}return!1}var k_="data-rc-order",M_="data-rc-priority",ZD="rc-util-key",Zm=new Map;function $R(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=i.mark;return e?e.startsWith("data-")?e:"data-".concat(e):ZD}function pf(i){if(i.attachTo)return i.attachTo;var e=document.querySelector("head");return e||document.body}function JD(i){return i==="queue"?"prependQueue":i?"prepend":"append"}function av(i){return Array.from((Zm.get(i)||i).children).filter(function(e){return e.tagName==="STYLE"})}function jR(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!$n())return null;var t=e.csp,r=e.prepend,n=e.priority,a=n===void 0?0:n,c=JD(r),l=c==="prependQueue",d=document.createElement("style");d.setAttribute(k_,c),l&&a&&d.setAttribute(M_,"".concat(a)),t!=null&&t.nonce&&(d.nonce=t==null?void 0:t.nonce),d.innerHTML=i;var u=pf(e),f=u.firstChild;if(r){if(l){var p=(e.styles||av(u)).filter(function(v){if(!["prepend","prependQueue"].includes(v.getAttribute(k_)))return!1;var E=Number(v.getAttribute(M_)||0);return a>=E});if(p.length)return u.insertBefore(d,p[p.length-1].nextSibling),d}u.insertBefore(d,f)}else u.appendChild(d);return d}function zR(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=pf(e);return(e.styles||av(t)).find(function(r){return r.getAttribute($R(e))===i})}function GR(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=zR(i,e);if(t){var r=pf(e);r.removeChild(t)}}function eL(i,e){var t=Zm.get(i);if(!t||!QD(document,t)){var r=jR("",e),n=r.parentNode;Zm.set(i,n),i.removeChild(r)}}function da(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=pf(t),n=av(r),a=ue(ue({},t),{},{styles:n});eL(r,a);var c=zR(e,a);if(c){var l,d;if((l=a.csp)!==null&&l!==void 0&&l.nonce&&c.nonce!==((d=a.csp)===null||d===void 0?void 0:d.nonce)){var u;c.nonce=(u=a.csp)===null||u===void 0?void 0:u.nonce}return c.innerHTML!==i&&(c.innerHTML=i),c}var f=jR(i,a);return f.setAttribute($R(a),e),f}function tL(i,e){if(i==null)return{};var t={};for(var r in i)if({}.hasOwnProperty.call(i,r)){if(e.indexOf(r)!==-1)continue;t[r]=i[r]}return t}function ti(i,e){if(i==null)return{};var t,r,n=tL(i,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);for(r=0;r<a.length;r++)t=a[r],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(i,t)&&(n[t]=i[t])}return n}function Jm(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=new Set;function n(a,c){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,d=r.has(a);if(bi(!d,"Warning: There may be circular references"),d)return!1;if(a===c)return!0;if(t&&l>1)return!1;r.add(a);var u=l+1;if(Array.isArray(a)){if(!Array.isArray(c)||a.length!==c.length)return!1;for(var f=0;f<a.length;f++)if(!n(a[f],c[f],u))return!1;return!0}if(a&&c&&Xe(a)==="object"&&Xe(c)==="object"){var p=Object.keys(a);return p.length!==Object.keys(c).length?!1:p.every(function(v){return n(a[v],c[v],u)})}return!1}return n(i,e)}var rL="%";function eg(i){return i.join(rL)}var iL=function(){function i(e){Mr(this,i),ie(this,"instanceId",void 0),ie(this,"cache",new Map),this.instanceId=e}return Nr(i,[{key:"get",value:function(t){return this.opGet(eg(t))}},{key:"opGet",value:function(t){return this.cache.get(t)||null}},{key:"update",value:function(t,r){return this.opUpdate(eg(t),r)}},{key:"opUpdate",value:function(t,r){var n=this.cache.get(t),a=r(n);a===null?this.cache.delete(t):this.cache.set(t,a)}}]),i}(),So="data-token-hash",Ji="data-css-hash",_s="__cssinjs_instance__";function nL(){var i=Math.random().toString(12).slice(2);if(typeof document<"u"&&document.head&&document.body){var e=document.body.querySelectorAll("style[".concat(Ji,"]"))||[],t=document.head.firstChild;Array.from(e).forEach(function(n){n[_s]=n[_s]||i,n[_s]===i&&document.head.insertBefore(n,t)});var r={};Array.from(document.querySelectorAll("style[".concat(Ji,"]"))).forEach(function(n){var a=n.getAttribute(Ji);if(r[a]){if(n[_s]===i){var c;(c=n.parentNode)===null||c===void 0||c.removeChild(n)}}else r[a]=!0})}return new iL(i)}var Ll=H.createContext({hashPriority:"low",cache:nL(),defaultCache:!0});function sL(i,e){if(i.length!==e.length)return!1;for(var t=0;t<i.length;t++)if(i[t]!==e[t])return!1;return!0}var ov=function(){function i(){Mr(this,i),ie(this,"cache",void 0),ie(this,"keys",void 0),ie(this,"cacheCallTimes",void 0),this.cache=new Map,this.keys=[],this.cacheCallTimes=0}return Nr(i,[{key:"size",value:function(){return this.keys.length}},{key:"internalGet",value:function(t){var r,n,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,c={map:this.cache};return t.forEach(function(l){if(!c)c=void 0;else{var d;c=(d=c)===null||d===void 0||(d=d.map)===null||d===void 0?void 0:d.get(l)}}),(r=c)!==null&&r!==void 0&&r.value&&a&&(c.value[1]=this.cacheCallTimes++),(n=c)===null||n===void 0?void 0:n.value}},{key:"get",value:function(t){var r;return(r=this.internalGet(t,!0))===null||r===void 0?void 0:r[0]}},{key:"has",value:function(t){return!!this.internalGet(t)}},{key:"set",value:function(t,r){var n=this;if(!this.has(t)){if(this.size()+1>i.MAX_CACHE_SIZE+i.MAX_CACHE_OFFSET){var a=this.keys.reduce(function(u,f){var p=Be(u,2),v=p[1];return n.internalGet(f)[1]<v?[f,n.internalGet(f)[1]]:u},[this.keys[0],this.cacheCallTimes]),c=Be(a,1),l=c[0];this.delete(l)}this.keys.push(t)}var d=this.cache;t.forEach(function(u,f){if(f===t.length-1)d.set(u,{value:[r,n.cacheCallTimes++]});else{var p=d.get(u);p?p.map||(p.map=new Map):d.set(u,{map:new Map}),d=d.get(u).map}})}},{key:"deleteByPath",value:function(t,r){var n=t.get(r[0]);if(r.length===1){var a;return n.map?t.set(r[0],{map:n.map}):t.delete(r[0]),(a=n.value)===null||a===void 0?void 0:a[0]}var c=this.deleteByPath(n.map,r.slice(1));return(!n.map||n.map.size===0)&&!n.value&&t.delete(r[0]),c}},{key:"delete",value:function(t){if(this.has(t))return this.keys=this.keys.filter(function(r){return!sL(r,t)}),this.deleteByPath(this.cache,t)}}]),i}();ie(ov,"MAX_CACHE_SIZE",20);ie(ov,"MAX_CACHE_OFFSET",5);var N_=0,HR=function(){function i(e){Mr(this,i),ie(this,"derivatives",void 0),ie(this,"id",void 0),this.derivatives=Array.isArray(e)?e:[e],this.id=N_,e.length===0&&(e.length>0,void 0),N_+=1}return Nr(i,[{key:"getDerivativeToken",value:function(t){return this.derivatives.reduce(function(r,n){return n(t,r)},void 0)}}]),i}(),Wp=new ov;function tg(i){var e=Array.isArray(i)?i:[i];return Wp.has(e)||Wp.set(e,new HR(e)),Wp.get(e)}var aL=new WeakMap,Xp={};function oL(i,e){for(var t=aL,r=0;r<e.length;r+=1){var n=e[r];t.has(n)||t.set(n,new WeakMap),t=t.get(n)}return t.has(Xp)||t.set(Xp,i()),t.get(Xp)}var B_=new WeakMap;function fl(i){var e=B_.get(i)||"";return e||(Object.keys(i).forEach(function(t){var r=i[t];e+=t,r instanceof HR?e+=r.id:r&&Xe(r)==="object"?e+=fl(r):e+=r}),e=_l(e),B_.set(i,e)),e}function F_(i,e){return _l("".concat(e,"_").concat(fl(i)))}var rg=$n();function Bt(i){return typeof i=="number"?"".concat(i,"px"):i}function Vd(i,e,t){var r,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(a)return i;var c=ue(ue({},n),{},(r={},ie(r,So,e),ie(r,Ji,t),r)),l=Object.keys(c).map(function(d){var u=c[d];return u?"".concat(d,'="').concat(u,'"'):null}).filter(function(d){return d}).join(" ");return"<style ".concat(l,">").concat(i,"</style>")}var Dd=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return"--".concat(t?"".concat(t,"-"):"").concat(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z]+)([A-Z][a-z0-9]+)/g,"$1-$2").replace(/([a-z])([A-Z0-9])/g,"$1-$2").toLowerCase()},cL=function(e,t,r){return Object.keys(e).length?".".concat(t).concat(r!=null&&r.scope?".".concat(r.scope):"","{").concat(Object.entries(e).map(function(n){var a=Be(n,2),c=a[0],l=a[1];return"".concat(c,":").concat(l,";")}).join(""),"}"):""},VR=function(e,t,r){var n={},a={};return Object.entries(e).forEach(function(c){var l,d,u=Be(c,2),f=u[0],p=u[1];if(r!=null&&(l=r.preserve)!==null&&l!==void 0&&l[f])a[f]=p;else if((typeof p=="string"||typeof p=="number")&&!(r!=null&&(d=r.ignore)!==null&&d!==void 0&&d[f])){var v,E=Dd(f,r==null?void 0:r.prefix);n[E]=typeof p=="number"&&!(r!=null&&(v=r.unitless)!==null&&v!==void 0&&v[f])?"".concat(p,"px"):String(p),a[f]="var(".concat(E,")")}}),[a,cL(n,t,{scope:r==null?void 0:r.scope})]},U_=$n()?H.useLayoutEffect:H.useEffect,Kd=function(e,t){var r=H.useRef(!0);U_(function(){return e(r.current)},t),U_(function(){return r.current=!1,function(){r.current=!0}},[])},$_=function(e,t){Kd(function(r){if(!r)return e()},t)},lL=ue({},Jg),j_=lL.useInsertionEffect,uL=function(e,t,r){H.useMemo(e,r),Kd(function(){return t(!0)},r)},dL=j_?function(i,e,t){return j_(function(){return i(),e()},t)}:uL,fL=ue({},Jg),hL=fL.useInsertionEffect,pL=function(e){var t=[],r=!1;function n(a){r||t.push(a)}return H.useEffect(function(){return r=!1,function(){r=!0,t.length&&t.forEach(function(a){return a()})}},e),n},mL=function(){return function(e){e()}},gL=typeof hL<"u"?pL:mL;function cv(i,e,t,r,n){var a=H.useContext(Ll),c=a.cache,l=[i].concat(Ye(e)),d=eg(l),u=gL([d]),f=function(g){c.opUpdate(d,function(_){var m=_||[void 0,void 0],y=Be(m,2),b=y[0],R=b===void 0?0:b,T=y[1],w=T,C=w||t(),A=[R,C];return g?g(A):A})};H.useMemo(function(){f()},[d]);var p=c.opGet(d),v=p[1];return dL(function(){n==null||n(v)},function(E){return f(function(g){var _=Be(g,2),m=_[0],y=_[1];return E&&m===0&&(n==null||n(v)),[m+1,y]}),function(){c.opUpdate(d,function(g){var _=g||[],m=Be(_,2),y=m[0],b=y===void 0?0:y,R=m[1],T=b-1;return T===0?(u(function(){(E||!c.opGet(d))&&(r==null||r(R,!1))}),null):[b-1,R]})}},[d]),v}var vL={},yL="css",ca=new Map;function bL(i){ca.set(i,(ca.get(i)||0)+1)}function _L(i,e){if(typeof document<"u"){var t=document.querySelectorAll("style[".concat(So,'="').concat(i,'"]'));t.forEach(function(r){if(r[_s]===e){var n;(n=r.parentNode)===null||n===void 0||n.removeChild(r)}})}}var SL=0;function EL(i,e){ca.set(i,(ca.get(i)||0)-1);var t=Array.from(ca.keys()),r=t.filter(function(n){var a=ca.get(n)||0;return a<=0});t.length-r.length>SL&&r.forEach(function(n){_L(n,e),ca.delete(n)})}var RL=function(e,t,r,n){var a=r.getDerivativeToken(e),c=ue(ue({},a),t);return n&&(c=n(c)),c},KR="token";function wL(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=H.useContext(Ll),n=r.cache.instanceId,a=r.container,c=t.salt,l=c===void 0?"":c,d=t.override,u=d===void 0?vL:d,f=t.formatToken,p=t.getComputedToken,v=t.cssVar,E=oL(function(){return Object.assign.apply(Object,[{}].concat(Ye(e)))},e),g=fl(E),_=fl(u),m=v?fl(v):"",y=cv(KR,[l,i.id,g,_,m],function(){var b,R=p?p(E,u,i):RL(E,u,i,f),T=ue({},R),w="";if(v){var C=VR(R,v.key,{prefix:v.prefix,ignore:v.ignore,unitless:v.unitless,preserve:v.preserve}),A=Be(C,2);R=A[0],w=A[1]}var L=F_(R,l);R._tokenKey=L,T._tokenKey=F_(T,l);var D=(b=v==null?void 0:v.key)!==null&&b!==void 0?b:L;R._themeKey=D,bL(D);var P="".concat(yL,"-").concat(_l(L));return R._hashId=P,[R,P,T,w,(v==null?void 0:v.key)||""]},function(b){EL(b[0]._themeKey,n)},function(b){var R=Be(b,4),T=R[0],w=R[3];if(v&&w){var C=da(w,_l("css-variables-".concat(T._themeKey)),{mark:Ji,prepend:"queue",attachTo:a,priority:-999});C[_s]=n,C.setAttribute(So,T._themeKey)}});return y}var TL=function(e,t,r){var n=Be(e,5),a=n[2],c=n[3],l=n[4],d=r||{},u=d.plain;if(!c)return null;var f=a._tokenKey,p=-999,v={"data-rc-order":"prependQueue","data-rc-priority":"".concat(p)},E=Vd(c,l,f,v,u);return[p,f,E]},CL={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},qR="comm",YR="rule",WR="decl",AL="@import",xL="@namespace",DL="@keyframes",LL="@layer",XR=Math.abs,lv=String.fromCharCode;function QR(i){return i.trim()}function Ld(i,e,t){return i.replace(e,t)}function OL(i,e,t){return i.indexOf(e,t)}function mo(i,e){return i.charCodeAt(e)|0}function Eo(i,e,t){return i.slice(e,t)}function hn(i){return i.length}function IL(i){return i.length}function Vu(i,e){return e.push(i),i}var mf=1,Ro=1,ZR=0,Bi=0,fr=0,Oo="";function uv(i,e,t,r,n,a,c,l){return{value:i,root:e,parent:t,type:r,props:n,children:a,line:mf,column:Ro,length:c,return:"",siblings:l}}function PL(){return fr}function kL(){return fr=Bi>0?mo(Oo,--Bi):0,Ro--,fr===10&&(Ro=1,mf--),fr}function en(){return fr=Bi<ZR?mo(Oo,Bi++):0,Ro++,fr===10&&(Ro=1,mf++),fr}function Ss(){return mo(Oo,Bi)}function Od(){return Bi}function gf(i,e){return Eo(Oo,i,e)}function Sl(i){switch(i){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function ML(i){return mf=Ro=1,ZR=hn(Oo=i),Bi=0,[]}function NL(i){return Oo="",i}function Qp(i){return QR(gf(Bi-1,ig(i===91?i+2:i===40?i+1:i)))}function BL(i){for(;(fr=Ss())&&fr<33;)en();return Sl(i)>2||Sl(fr)>3?"":" "}function FL(i,e){for(;--e&&en()&&!(fr<48||fr>102||fr>57&&fr<65||fr>70&&fr<97););return gf(i,Od()+(e<6&&Ss()==32&&en()==32))}function ig(i){for(;en();)switch(fr){case i:return Bi;case 34:case 39:i!==34&&i!==39&&ig(fr);break;case 40:i===41&&ig(i);break;case 92:en();break}return Bi}function UL(i,e){for(;en()&&i+fr!==57;)if(i+fr===84&&Ss()===47)break;return"/*"+gf(e,Bi-1)+"*"+lv(i===47?i:en())}function $L(i){for(;!Sl(Ss());)en();return gf(i,Bi)}function jL(i){return NL(Id("",null,null,null,[""],i=ML(i),0,[0],i))}function Id(i,e,t,r,n,a,c,l,d){for(var u=0,f=0,p=c,v=0,E=0,g=0,_=1,m=1,y=1,b=0,R="",T=n,w=a,C=r,A=R;m;)switch(g=b,b=en()){case 40:if(g!=108&&mo(A,p-1)==58){OL(A+=Ld(Qp(b),"&","&\f"),"&\f",XR(u?l[u-1]:0))!=-1&&(y=-1);break}case 34:case 39:case 91:A+=Qp(b);break;case 9:case 10:case 13:case 32:A+=BL(g);break;case 92:A+=FL(Od()-1,7);continue;case 47:switch(Ss()){case 42:case 47:Vu(zL(UL(en(),Od()),e,t,d),d),(Sl(g||1)==5||Sl(Ss()||1)==5)&&hn(A)&&Eo(A,-1,void 0)!==" "&&(A+=" ");break;default:A+="/"}break;case 123*_:l[u++]=hn(A)*y;case 125*_:case 59:case 0:switch(b){case 0:case 125:m=0;case 59+f:y==-1&&(A=Ld(A,/\f/g,"")),E>0&&(hn(A)-p||_===0&&g===47)&&Vu(E>32?G_(A+";",r,t,p-1,d):G_(Ld(A," ","")+";",r,t,p-2,d),d);break;case 59:A+=";";default:if(Vu(C=z_(A,e,t,u,f,n,l,R,T=[],w=[],p,a),a),b===123)if(f===0)Id(A,e,C,C,T,a,p,l,w);else{switch(v){case 99:if(mo(A,3)===110)break;case 108:if(mo(A,2)===97)break;default:f=0;case 100:case 109:case 115:}f?Id(i,C,C,r&&Vu(z_(i,C,C,0,0,n,l,R,n,T=[],p,w),w),n,w,p,l,r?T:w):Id(A,C,C,C,[""],w,0,l,w)}}u=f=E=0,_=y=1,R=A="",p=c;break;case 58:p=1+hn(A),E=g;default:if(_<1){if(b==123)--_;else if(b==125&&_++==0&&kL()==125)continue}switch(A+=lv(b),b*_){case 38:y=f>0?1:(A+="\f",-1);break;case 44:l[u++]=(hn(A)-1)*y,y=1;break;case 64:Ss()===45&&(A+=Qp(en())),v=Ss(),f=p=hn(R=A+=$L(Od())),b++;break;case 45:g===45&&hn(A)==2&&(_=0)}}return a}function z_(i,e,t,r,n,a,c,l,d,u,f,p){for(var v=n-1,E=n===0?a:[""],g=IL(E),_=0,m=0,y=0;_<r;++_)for(var b=0,R=Eo(i,v+1,v=XR(m=c[_])),T=i;b<g;++b)(T=QR(m>0?E[b]+" "+R:Ld(R,/&\f/g,E[b])))&&(d[y++]=T);return uv(i,e,t,n===0?YR:l,d,u,f,p)}function zL(i,e,t,r){return uv(i,e,t,qR,lv(PL()),Eo(i,2,-2),0,r)}function G_(i,e,t,r,n){return uv(i,e,t,WR,Eo(i,0,r),Eo(i,r+1,-1),r,n)}function ng(i,e){for(var t="",r=0;r<i.length;r++)t+=e(i[r],r,i,e)||"";return t}function GL(i,e,t,r){switch(i.type){case LL:if(i.children.length)break;case AL:case xL:case WR:return i.return=i.return||i.value;case qR:return"";case DL:return i.return=i.value+"{"+ng(i.children,r)+"}";case YR:if(!hn(i.value=i.props.join(",")))return""}return hn(t=ng(i.children,r))?i.return=i.value+"{"+t+"}":""}var H_="data-ant-cssinjs-cache-path",JR="_FILE_STYLE__",fa,ew=!0;function HL(){if(!fa&&(fa={},$n())){var i=document.createElement("div");i.className=H_,i.style.position="fixed",i.style.visibility="hidden",i.style.top="-9999px",document.body.appendChild(i);var e=getComputedStyle(i).content||"";e=e.replace(/^"/,"").replace(/"$/,""),e.split(";").forEach(function(n){var a=n.split(":"),c=Be(a,2),l=c[0],d=c[1];fa[l]=d});var t=document.querySelector("style[".concat(H_,"]"));if(t){var r;ew=!1,(r=t.parentNode)===null||r===void 0||r.removeChild(t)}document.body.removeChild(i)}}function VL(i){return HL(),!!fa[i]}function KL(i){var e=fa[i],t=null;if(e&&$n())if(ew)t=JR;else{var r=document.querySelector("style[".concat(Ji,'="').concat(fa[i],'"]'));r?t=r.innerHTML:delete fa[i]}return[t,e]}var qL="_skip_check_",tw="_multi_value_";function Pd(i){var e=ng(jL(i),GL);return e.replace(/\{%%%\:[^;];}/g,";")}function YL(i){return Xe(i)==="object"&&i&&(qL in i||tw in i)}function V_(i,e,t){if(!e)return i;var r=".".concat(e),n=t==="low"?":where(".concat(r,")"):r,a=i.split(",").map(function(c){var l,d=c.trim().split(/\s+/),u=d[0]||"",f=((l=u.match(/^\w+/))===null||l===void 0?void 0:l[0])||"";return u="".concat(f).concat(n).concat(u.slice(f.length)),[u].concat(Ye(d.slice(1))).join(" ")});return a.join(",")}var WL=function i(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{root:!0,parentSelectors:[]},n=r.root,a=r.injectHash,c=r.parentSelectors,l=t.hashId,d=t.layer;t.path;var u=t.hashPriority,f=t.transformers,p=f===void 0?[]:f;t.linters;var v="",E={};function g(y){var b=y.getName(l);if(!E[b]){var R=i(y.style,t,{root:!1,parentSelectors:c}),T=Be(R,1),w=T[0];E[b]="@keyframes ".concat(y.getName(l)).concat(w)}}function _(y){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return y.forEach(function(R){Array.isArray(R)?_(R,b):R&&b.push(R)}),b}var m=_(Array.isArray(e)?e:[e]);return m.forEach(function(y){var b=typeof y=="string"&&!n?{}:y;if(typeof b=="string")v+="".concat(b,`
`);else if(b._keyframe)g(b);else{var R=p.reduce(function(T,w){var C;return(w==null||(C=w.visit)===null||C===void 0?void 0:C.call(w,T))||T},b);Object.keys(R).forEach(function(T){var w=R[T];if(Xe(w)==="object"&&w&&(T!=="animationName"||!w._keyframe)&&!YL(w)){var C=!1,A=T.trim(),L=!1;(n||a)&&l?A.startsWith("@")?C=!0:A==="&"?A=V_("",l,u):A=V_(T,l,u):n&&!l&&(A==="&"||A==="")&&(A="",L=!0);var D=i(w,t,{root:L,injectHash:C,parentSelectors:[].concat(Ye(c),[A])}),P=Be(D,2),k=P[0],M=P[1];E=ue(ue({},E),M),v+="".concat(A).concat(k)}else{let $=function(N,U){var V=N.replace(/[A-Z]/g,function(j){return"-".concat(j.toLowerCase())}),J=U;!CL[N]&&typeof J=="number"&&J!==0&&(J="".concat(J,"px")),N==="animationName"&&U!==null&&U!==void 0&&U._keyframe&&(g(U),J=U.getName(l)),v+="".concat(V,":").concat(J,";")};var I,F=(I=w==null?void 0:w.value)!==null&&I!==void 0?I:w;Xe(w)==="object"&&w!==null&&w!==void 0&&w[tw]&&Array.isArray(F)?F.forEach(function(N){$(T,N)}):$(T,F)}})}}),n?d&&(v&&(v="@layer ".concat(d.name," {").concat(v,"}")),d.dependencies&&(E["@layer ".concat(d.name)]=d.dependencies.map(function(y){return"@layer ".concat(y,", ").concat(d.name,";")}).join(`
`))):v="{".concat(v,"}"),[v,E]};function rw(i,e){return _l("".concat(i.join("%")).concat(e))}function XL(){return null}var iw="style";function sg(i,e){var t=i.token,r=i.path,n=i.hashId,a=i.layer,c=i.nonce,l=i.clientOnly,d=i.order,u=d===void 0?0:d,f=H.useContext(Ll),p=f.autoClear;f.mock;var v=f.defaultCache,E=f.hashPriority,g=f.container,_=f.ssrInline,m=f.transformers,y=f.linters,b=f.cache,R=f.layer,T=t._tokenKey,w=[T];R&&w.push("layer"),w.push.apply(w,Ye(r));var C=rg,A=cv(iw,w,function(){var M=w.join("|");if(VL(M)){var I=KL(M),F=Be(I,2),$=F[0],N=F[1];if($)return[$,T,N,{},l,u]}var U=e(),V=WL(U,{hashId:n,hashPriority:E,layer:R?a:void 0,path:r.join("-"),transformers:m,linters:y}),J=Be(V,2),j=J[0],q=J[1],Z=Pd(j),X=rw(w,Z);return[Z,T,X,q,l,u]},function(M,I){var F=Be(M,3),$=F[2];(I||p)&&rg&&GR($,{mark:Ji})},function(M){var I=Be(M,4),F=I[0];I[1];var $=I[2],N=I[3];if(C&&F!==JR){var U={mark:Ji,prepend:R?!1:"queue",attachTo:g,priority:u},V=typeof c=="function"?c():c;V&&(U.csp={nonce:V});var J=[],j=[];Object.keys(N).forEach(function(Z){Z.startsWith("@layer")?J.push(Z):j.push(Z)}),J.forEach(function(Z){da(Pd(N[Z]),"_layer-".concat(Z),ue(ue({},U),{},{prepend:!0}))});var q=da(F,$,U);q[_s]=b.instanceId,q.setAttribute(So,T),j.forEach(function(Z){da(Pd(N[Z]),"_effect-".concat(Z),U)})}}),L=Be(A,3),D=L[0],P=L[1],k=L[2];return function(M){var I;if(!_||C||!v)I=H.createElement(XL,null);else{var F;I=H.createElement("style",Dr({},(F={},ie(F,So,P),ie(F,Ji,k),F),{dangerouslySetInnerHTML:{__html:D}}))}return H.createElement(H.Fragment,null,I,M)}}var QL=function(e,t,r){var n=Be(e,6),a=n[0],c=n[1],l=n[2],d=n[3],u=n[4],f=n[5],p=r||{},v=p.plain;if(u)return null;var E=a,g={"data-rc-order":"prependQueue","data-rc-priority":"".concat(f)};return E=Vd(a,c,l,g,v),d&&Object.keys(d).forEach(function(_){if(!t[_]){t[_]=!0;var m=Pd(d[_]),y=Vd(m,c,"_effect-".concat(_),g,v);_.startsWith("@layer")?E=y+E:E+=y}}),[f,l,E]},nw="cssVar",ZL=function(e,t){var r=e.key,n=e.prefix,a=e.unitless,c=e.ignore,l=e.token,d=e.scope,u=d===void 0?"":d,f=H.useContext(Ll),p=f.cache.instanceId,v=f.container,E=l._tokenKey,g=[].concat(Ye(e.path),[r,u,E]),_=cv(nw,g,function(){var m=t(),y=VR(m,r,{prefix:n,unitless:a,ignore:c,scope:u}),b=Be(y,2),R=b[0],T=b[1],w=rw(g,T);return[R,T,w,r]},function(m){var y=Be(m,3),b=y[2];rg&&GR(b,{mark:Ji})},function(m){var y=Be(m,3),b=y[1],R=y[2];if(b){var T=da(b,R,{mark:Ji,prepend:"queue",attachTo:v,priority:-999});T[_s]=p,T.setAttribute(So,r)}});return _},JL=function(e,t,r){var n=Be(e,4),a=n[1],c=n[2],l=n[3],d=r||{},u=d.plain;if(!a)return null;var f=-999,p={"data-rc-order":"prependQueue","data-rc-priority":"".concat(f)},v=Vd(a,l,c,p,u);return[f,c,v]},Dc;Dc={},ie(Dc,iw,QL),ie(Dc,KR,TL),ie(Dc,nw,JL);function Ja(i){return i.notSplit=!0,i}Ja(["borderTop","borderBottom"]),Ja(["borderTop"]),Ja(["borderBottom"]),Ja(["borderLeft","borderRight"]),Ja(["borderLeft"]),Ja(["borderRight"]);var dv=H.createContext({});function eO(i){return FR(i)||kR(i)||nv(i)||UR()}function gn(i,e){for(var t=i,r=0;r<e.length;r+=1){if(t==null)return;t=t[e[r]]}return t}function sw(i,e,t,r){if(!e.length)return t;var n=eO(e),a=n[0],c=n.slice(1),l;return!i&&typeof a=="number"?l=[]:Array.isArray(i)?l=Ye(i):l=ue({},i),r&&t===void 0&&c.length===1?delete l[a][c[0]]:l[a]=sw(l[a],c,t,r),l}function Qi(i,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return e.length&&r&&t===void 0&&!gn(i,e.slice(0,-1))?i:sw(i,e,t,r)}function tO(i){return Xe(i)==="object"&&i!==null&&Object.getPrototypeOf(i)===Object.prototype}function K_(i){return Array.isArray(i)?[]:{}}var rO=typeof Reflect>"u"?Object.keys:Reflect.ownKeys;function fo(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];var r=K_(e[0]);return e.forEach(function(n){function a(c,l){var d=new Set(l),u=gn(n,c),f=Array.isArray(u);if(f||tO(u)){if(!d.has(u)){d.add(u);var p=gn(r,c);f?r=Qi(r,c,[]):(!p||Xe(p)!=="object")&&(r=Qi(r,c,K_(u))),rO(u).forEach(function(v){a([].concat(Ye(c),[v]),d)})}}else r=Qi(r,c,u)}a([])}),r}const iO=H.createContext({}),nO=H.createContext(void 0),pi="${label} is not a valid ${type}",vf={Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:pi,method:pi,array:pi,object:pi,number:pi,date:pi,boolean:pi,integer:pi,float:pi,regexp:pi,email:pi,url:pi,hex:pi},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}}};Object.assign({},vf.Modal);let kd=[];const q_=()=>kd.reduce((i,e)=>Object.assign(Object.assign({},i),e),vf.Modal);function sO(i){if(i){const e=Object.assign({},i);return kd.push(e),q_(),()=>{kd=kd.filter(t=>t!==e),q_()}}Object.assign({},vf.Modal)}const aw=H.createContext(void 0),aO="internalMark",oO=i=>{const{locale:e={},children:t,_ANT_MARK__:r}=i;H.useEffect(()=>sO(e==null?void 0:e.Modal),[e]);const n=H.useMemo(()=>Object.assign(Object.assign({},e),{exist:!0}),[e]);return H.createElement(aw.Provider,{value:n},t)},ow={blue:"#1677FF",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#EB2F96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},El=Object.assign(Object.assign({},ow),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorLink:"",colorTextBase:"",colorBgBase:"",fontFamily:`-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
'Noto Color Emoji'`,fontFamilyCode:"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1,motion:!0}),Cr=Math.round;function Zp(i,e){const t=i.replace(/^[^(]*\((.*)/,"$1").replace(/\).*/,"").match(/\d*\.?\d+%?/g)||[],r=t.map(n=>parseFloat(n));for(let n=0;n<3;n+=1)r[n]=e(r[n]||0,t[n]||"",n);return t[3]?r[3]=t[3].includes("%")?r[3]/100:r[3]:r[3]=1,r}const Y_=(i,e,t)=>t===0?i:i/100;function Lc(i,e){const t=e||255;return i>t?t:i<0?0:i}class Qt{constructor(e){ie(this,"isValid",!0),ie(this,"r",0),ie(this,"g",0),ie(this,"b",0),ie(this,"a",1),ie(this,"_h",void 0),ie(this,"_s",void 0),ie(this,"_l",void 0),ie(this,"_v",void 0),ie(this,"_max",void 0),ie(this,"_min",void 0),ie(this,"_brightness",void 0);function t(n){return n[0]in e&&n[1]in e&&n[2]in e}if(e)if(typeof e=="string"){let a=function(c){return n.startsWith(c)};var r=a;const n=e.trim();/^#?[A-F\d]{3,8}$/i.test(n)?this.fromHexString(n):a("rgb")?this.fromRgbString(n):a("hsl")?this.fromHslString(n):(a("hsv")||a("hsb"))&&this.fromHsvString(n)}else if(e instanceof Qt)this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this._h=e._h,this._s=e._s,this._l=e._l,this._v=e._v;else if(t("rgb"))this.r=Lc(e.r),this.g=Lc(e.g),this.b=Lc(e.b),this.a=typeof e.a=="number"?Lc(e.a,1):1;else if(t("hsl"))this.fromHsl(e);else if(t("hsv"))this.fromHsv(e);else throw new Error("@ant-design/fast-color: unsupported input "+JSON.stringify(e))}setR(e){return this._sc("r",e)}setG(e){return this._sc("g",e)}setB(e){return this._sc("b",e)}setA(e){return this._sc("a",e,1)}setHue(e){const t=this.toHsv();return t.h=e,this._c(t)}getLuminance(){function e(a){const c=a/255;return c<=.03928?c/12.92:Math.pow((c+.055)/1.055,2.4)}const t=e(this.r),r=e(this.g),n=e(this.b);return .2126*t+.7152*r+.0722*n}getHue(){if(typeof this._h>"u"){const e=this.getMax()-this.getMin();e===0?this._h=0:this._h=Cr(60*(this.r===this.getMax()?(this.g-this.b)/e+(this.g<this.b?6:0):this.g===this.getMax()?(this.b-this.r)/e+2:(this.r-this.g)/e+4))}return this._h}getSaturation(){if(typeof this._s>"u"){const e=this.getMax()-this.getMin();e===0?this._s=0:this._s=e/this.getMax()}return this._s}getLightness(){return typeof this._l>"u"&&(this._l=(this.getMax()+this.getMin())/510),this._l}getValue(){return typeof this._v>"u"&&(this._v=this.getMax()/255),this._v}getBrightness(){return typeof this._brightness>"u"&&(this._brightness=(this.r*299+this.g*587+this.b*114)/1e3),this._brightness}darken(e=10){const t=this.getHue(),r=this.getSaturation();let n=this.getLightness()-e/100;return n<0&&(n=0),this._c({h:t,s:r,l:n,a:this.a})}lighten(e=10){const t=this.getHue(),r=this.getSaturation();let n=this.getLightness()+e/100;return n>1&&(n=1),this._c({h:t,s:r,l:n,a:this.a})}mix(e,t=50){const r=this._c(e),n=t/100,a=l=>(r[l]-this[l])*n+this[l],c={r:Cr(a("r")),g:Cr(a("g")),b:Cr(a("b")),a:Cr(a("a")*100)/100};return this._c(c)}tint(e=10){return this.mix({r:255,g:255,b:255,a:1},e)}shade(e=10){return this.mix({r:0,g:0,b:0,a:1},e)}onBackground(e){const t=this._c(e),r=this.a+t.a*(1-this.a),n=a=>Cr((this[a]*this.a+t[a]*t.a*(1-this.a))/r);return this._c({r:n("r"),g:n("g"),b:n("b"),a:r})}isDark(){return this.getBrightness()<128}isLight(){return this.getBrightness()>=128}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}clone(){return this._c(this)}toHexString(){let e="#";const t=(this.r||0).toString(16);e+=t.length===2?t:"0"+t;const r=(this.g||0).toString(16);e+=r.length===2?r:"0"+r;const n=(this.b||0).toString(16);if(e+=n.length===2?n:"0"+n,typeof this.a=="number"&&this.a>=0&&this.a<1){const a=Cr(this.a*255).toString(16);e+=a.length===2?a:"0"+a}return e}toHsl(){return{h:this.getHue(),s:this.getSaturation(),l:this.getLightness(),a:this.a}}toHslString(){const e=this.getHue(),t=Cr(this.getSaturation()*100),r=Cr(this.getLightness()*100);return this.a!==1?`hsla(${e},${t}%,${r}%,${this.a})`:`hsl(${e},${t}%,${r}%)`}toHsv(){return{h:this.getHue(),s:this.getSaturation(),v:this.getValue(),a:this.a}}toRgb(){return{r:this.r,g:this.g,b:this.b,a:this.a}}toRgbString(){return this.a!==1?`rgba(${this.r},${this.g},${this.b},${this.a})`:`rgb(${this.r},${this.g},${this.b})`}toString(){return this.toRgbString()}_sc(e,t,r){const n=this.clone();return n[e]=Lc(t,r),n}_c(e){return new this.constructor(e)}getMax(){return typeof this._max>"u"&&(this._max=Math.max(this.r,this.g,this.b)),this._max}getMin(){return typeof this._min>"u"&&(this._min=Math.min(this.r,this.g,this.b)),this._min}fromHexString(e){const t=e.replace("#","");function r(n,a){return parseInt(t[n]+t[a||n],16)}t.length<6?(this.r=r(0),this.g=r(1),this.b=r(2),this.a=t[3]?r(3)/255:1):(this.r=r(0,1),this.g=r(2,3),this.b=r(4,5),this.a=t[6]?r(6,7)/255:1)}fromHsl({h:e,s:t,l:r,a:n}){if(this._h=e%360,this._s=t,this._l=r,this.a=typeof n=="number"?n:1,t<=0){const v=Cr(r*255);this.r=v,this.g=v,this.b=v}let a=0,c=0,l=0;const d=e/60,u=(1-Math.abs(2*r-1))*t,f=u*(1-Math.abs(d%2-1));d>=0&&d<1?(a=u,c=f):d>=1&&d<2?(a=f,c=u):d>=2&&d<3?(c=u,l=f):d>=3&&d<4?(c=f,l=u):d>=4&&d<5?(a=f,l=u):d>=5&&d<6&&(a=u,l=f);const p=r-u/2;this.r=Cr((a+p)*255),this.g=Cr((c+p)*255),this.b=Cr((l+p)*255)}fromHsv({h:e,s:t,v:r,a:n}){this._h=e%360,this._s=t,this._v=r,this.a=typeof n=="number"?n:1;const a=Cr(r*255);if(this.r=a,this.g=a,this.b=a,t<=0)return;const c=e/60,l=Math.floor(c),d=c-l,u=Cr(r*(1-t)*255),f=Cr(r*(1-t*d)*255),p=Cr(r*(1-t*(1-d))*255);switch(l){case 0:this.g=p,this.b=u;break;case 1:this.r=f,this.b=u;break;case 2:this.r=u,this.b=p;break;case 3:this.r=u,this.g=f;break;case 4:this.r=p,this.g=u;break;case 5:default:this.g=u,this.b=f;break}}fromHsvString(e){const t=Zp(e,Y_);this.fromHsv({h:t[0],s:t[1],v:t[2],a:t[3]})}fromHslString(e){const t=Zp(e,Y_);this.fromHsl({h:t[0],s:t[1],l:t[2],a:t[3]})}fromRgbString(e){const t=Zp(e,(r,n)=>n.includes("%")?Cr(r/100*255):r);this.r=t[0],this.g=t[1],this.b=t[2],this.a=t[3]}}var Ku=2,W_=.16,cO=.05,lO=.05,uO=.15,cw=5,lw=4,dO=[{index:7,amount:15},{index:6,amount:25},{index:5,amount:30},{index:5,amount:45},{index:5,amount:65},{index:5,amount:85},{index:4,amount:90},{index:3,amount:95},{index:2,amount:97},{index:1,amount:98}];function X_(i,e,t){var r;return Math.round(i.h)>=60&&Math.round(i.h)<=240?r=t?Math.round(i.h)-Ku*e:Math.round(i.h)+Ku*e:r=t?Math.round(i.h)+Ku*e:Math.round(i.h)-Ku*e,r<0?r+=360:r>=360&&(r-=360),r}function Q_(i,e,t){if(i.h===0&&i.s===0)return i.s;var r;return t?r=i.s-W_*e:e===lw?r=i.s+W_:r=i.s+cO*e,r>1&&(r=1),t&&e===cw&&r>.1&&(r=.1),r<.06&&(r=.06),Math.round(r*100)/100}function Z_(i,e,t){var r;return t?r=i.v+lO*e:r=i.v-uO*e,r=Math.max(0,Math.min(1,r)),Math.round(r*100)/100}function Rl(i){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=[],r=new Qt(i),n=r.toHsv(),a=cw;a>0;a-=1){var c=new Qt({h:X_(n,a,!0),s:Q_(n,a,!0),v:Z_(n,a,!0)});t.push(c)}t.push(r);for(var l=1;l<=lw;l+=1){var d=new Qt({h:X_(n,l),s:Q_(n,l),v:Z_(n,l)});t.push(d)}return e.theme==="dark"?dO.map(function(u){var f=u.index,p=u.amount;return new Qt(e.backgroundColor||"#141414").mix(t[f],p).toHexString()}):t.map(function(u){return u.toHexString()})}var Jp={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1677FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},ag=["#fff1f0","#ffccc7","#ffa39e","#ff7875","#ff4d4f","#f5222d","#cf1322","#a8071a","#820014","#5c0011"];ag.primary=ag[5];var og=["#fff2e8","#ffd8bf","#ffbb96","#ff9c6e","#ff7a45","#fa541c","#d4380d","#ad2102","#871400","#610b00"];og.primary=og[5];var cg=["#fff7e6","#ffe7ba","#ffd591","#ffc069","#ffa940","#fa8c16","#d46b08","#ad4e00","#873800","#612500"];cg.primary=cg[5];var lg=["#fffbe6","#fff1b8","#ffe58f","#ffd666","#ffc53d","#faad14","#d48806","#ad6800","#874d00","#613400"];lg.primary=lg[5];var ug=["#feffe6","#ffffb8","#fffb8f","#fff566","#ffec3d","#fadb14","#d4b106","#ad8b00","#876800","#614700"];ug.primary=ug[5];var dg=["#fcffe6","#f4ffb8","#eaff8f","#d3f261","#bae637","#a0d911","#7cb305","#5b8c00","#3f6600","#254000"];dg.primary=dg[5];var fg=["#f6ffed","#d9f7be","#b7eb8f","#95de64","#73d13d","#52c41a","#389e0d","#237804","#135200","#092b00"];fg.primary=fg[5];var hg=["#e6fffb","#b5f5ec","#87e8de","#5cdbd3","#36cfc9","#13c2c2","#08979c","#006d75","#00474f","#002329"];hg.primary=hg[5];var qd=["#e6f4ff","#bae0ff","#91caff","#69b1ff","#4096ff","#1677ff","#0958d9","#003eb3","#002c8c","#001d66"];qd.primary=qd[5];var pg=["#f0f5ff","#d6e4ff","#adc6ff","#85a5ff","#597ef7","#2f54eb","#1d39c4","#10239e","#061178","#030852"];pg.primary=pg[5];var mg=["#f9f0ff","#efdbff","#d3adf7","#b37feb","#9254de","#722ed1","#531dab","#391085","#22075e","#120338"];mg.primary=mg[5];var gg=["#fff0f6","#ffd6e7","#ffadd2","#ff85c0","#f759ab","#eb2f96","#c41d7f","#9e1068","#780650","#520339"];gg.primary=gg[5];var vg=["#a6a6a6","#999999","#8c8c8c","#808080","#737373","#666666","#404040","#1a1a1a","#000000","#000000"];vg.primary=vg[5];var em={red:ag,volcano:og,orange:cg,gold:lg,yellow:ug,lime:dg,green:fg,cyan:hg,blue:qd,geekblue:pg,purple:mg,magenta:gg,grey:vg};function fO(i,{generateColorPalettes:e,generateNeutralColorPalettes:t}){const{colorSuccess:r,colorWarning:n,colorError:a,colorInfo:c,colorPrimary:l,colorBgBase:d,colorTextBase:u}=i,f=e(l),p=e(r),v=e(n),E=e(a),g=e(c),_=t(d,u),m=i.colorLink||i.colorInfo,y=e(m),b=new Qt(E[1]).mix(new Qt(E[3]),50).toHexString();return Object.assign(Object.assign({},_),{colorPrimaryBg:f[1],colorPrimaryBgHover:f[2],colorPrimaryBorder:f[3],colorPrimaryBorderHover:f[4],colorPrimaryHover:f[5],colorPrimary:f[6],colorPrimaryActive:f[7],colorPrimaryTextHover:f[8],colorPrimaryText:f[9],colorPrimaryTextActive:f[10],colorSuccessBg:p[1],colorSuccessBgHover:p[2],colorSuccessBorder:p[3],colorSuccessBorderHover:p[4],colorSuccessHover:p[4],colorSuccess:p[6],colorSuccessActive:p[7],colorSuccessTextHover:p[8],colorSuccessText:p[9],colorSuccessTextActive:p[10],colorErrorBg:E[1],colorErrorBgHover:E[2],colorErrorBgFilledHover:b,colorErrorBgActive:E[3],colorErrorBorder:E[3],colorErrorBorderHover:E[4],colorErrorHover:E[5],colorError:E[6],colorErrorActive:E[7],colorErrorTextHover:E[8],colorErrorText:E[9],colorErrorTextActive:E[10],colorWarningBg:v[1],colorWarningBgHover:v[2],colorWarningBorder:v[3],colorWarningBorderHover:v[4],colorWarningHover:v[4],colorWarning:v[6],colorWarningActive:v[7],colorWarningTextHover:v[8],colorWarningText:v[9],colorWarningTextActive:v[10],colorInfoBg:g[1],colorInfoBgHover:g[2],colorInfoBorder:g[3],colorInfoBorderHover:g[4],colorInfoHover:g[4],colorInfo:g[6],colorInfoActive:g[7],colorInfoTextHover:g[8],colorInfoText:g[9],colorInfoTextActive:g[10],colorLinkHover:y[4],colorLink:y[6],colorLinkActive:y[7],colorBgMask:new Qt("#000").setA(.45).toRgbString(),colorWhite:"#fff"})}const hO=i=>{let e=i,t=i,r=i,n=i;return i<6&&i>=5?e=i+1:i<16&&i>=6?e=i+2:i>=16&&(e=16),i<7&&i>=5?t=4:i<8&&i>=7?t=5:i<14&&i>=8?t=6:i<16&&i>=14?t=7:i>=16&&(t=8),i<6&&i>=2?r=1:i>=6&&(r=2),i>4&&i<8?n=4:i>=8&&(n=6),{borderRadius:i,borderRadiusXS:r,borderRadiusSM:t,borderRadiusLG:e,borderRadiusOuter:n}};function pO(i){const{motionUnit:e,motionBase:t,borderRadius:r,lineWidth:n}=i;return Object.assign({motionDurationFast:`${(t+e).toFixed(1)}s`,motionDurationMid:`${(t+e*2).toFixed(1)}s`,motionDurationSlow:`${(t+e*3).toFixed(1)}s`,lineWidthBold:n+1},hO(r))}const mO=i=>{const{controlHeight:e}=i;return{controlHeightSM:e*.75,controlHeightXS:e*.5,controlHeightLG:e*1.25}};function Md(i){return(i+8)/i}function gO(i){const e=Array.from({length:10}).map((t,r)=>{const n=r-1,a=i*Math.pow(Math.E,n/5),c=r>1?Math.floor(a):Math.ceil(a);return Math.floor(c/2)*2});return e[1]=i,e.map(t=>({size:t,lineHeight:Md(t)}))}const vO=i=>{const e=gO(i),t=e.map(f=>f.size),r=e.map(f=>f.lineHeight),n=t[1],a=t[0],c=t[2],l=r[1],d=r[0],u=r[2];return{fontSizeSM:a,fontSize:n,fontSizeLG:c,fontSizeXL:t[3],fontSizeHeading1:t[6],fontSizeHeading2:t[5],fontSizeHeading3:t[4],fontSizeHeading4:t[3],fontSizeHeading5:t[2],lineHeight:l,lineHeightLG:u,lineHeightSM:d,fontHeight:Math.round(l*n),fontHeightLG:Math.round(u*c),fontHeightSM:Math.round(d*a),lineHeightHeading1:r[6],lineHeightHeading2:r[5],lineHeightHeading3:r[4],lineHeightHeading4:r[3],lineHeightHeading5:r[2]}};function yO(i){const{sizeUnit:e,sizeStep:t}=i;return{sizeXXL:e*(t+8),sizeXL:e*(t+4),sizeLG:e*(t+2),sizeMD:e*(t+1),sizeMS:e*t,size:e*t,sizeSM:e*(t-1),sizeXS:e*(t-2),sizeXXS:e*(t-3)}}const Oi=(i,e)=>new Qt(i).setA(e).toRgbString(),Oc=(i,e)=>new Qt(i).darken(e).toHexString(),bO=i=>{const e=Rl(i);return{1:e[0],2:e[1],3:e[2],4:e[3],5:e[4],6:e[5],7:e[6],8:e[4],9:e[5],10:e[6]}},_O=(i,e)=>{const t=i||"#fff",r=e||"#000";return{colorBgBase:t,colorTextBase:r,colorText:Oi(r,.88),colorTextSecondary:Oi(r,.65),colorTextTertiary:Oi(r,.45),colorTextQuaternary:Oi(r,.25),colorFill:Oi(r,.15),colorFillSecondary:Oi(r,.06),colorFillTertiary:Oi(r,.04),colorFillQuaternary:Oi(r,.02),colorBgSolid:Oi(r,1),colorBgSolidHover:Oi(r,.75),colorBgSolidActive:Oi(r,.95),colorBgLayout:Oc(t,4),colorBgContainer:Oc(t,0),colorBgElevated:Oc(t,0),colorBgSpotlight:Oi(r,.85),colorBgBlur:"transparent",colorBorder:Oc(t,15),colorBorderSecondary:Oc(t,6)}};function SO(i){Jp.pink=Jp.magenta,em.pink=em.magenta;const e=Object.keys(ow).map(t=>{const r=i[t]===Jp[t]?em[t]:Rl(i[t]);return Array.from({length:10},()=>1).reduce((n,a,c)=>(n[`${t}-${c+1}`]=r[c],n[`${t}${c+1}`]=r[c],n),{})}).reduce((t,r)=>(t=Object.assign(Object.assign({},t),r),t),{});return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},i),e),fO(i,{generateColorPalettes:bO,generateNeutralColorPalettes:_O})),vO(i.fontSize)),yO(i)),mO(i)),pO(i))}const uw=tg(SO),yg={token:El,override:{override:El},hashed:!0},dw=we.createContext(yg),Yd="ant",fv="anticon",EO=["outlined","borderless","filled","underlined"],RO=(i,e)=>e||(i?`${Yd}-${i}`:Yd),kr=H.createContext({getPrefixCls:RO,iconPrefixCls:fv}),{Consumer:$5}=kr,J_={};function hv(i){const e=H.useContext(kr),{getPrefixCls:t,direction:r,getPopupContainer:n}=e,a=e[i];return Object.assign(Object.assign({classNames:J_,styles:J_},a),{getPrefixCls:t,direction:r,getPopupContainer:n})}const wO=`-ant-${Date.now()}-${Math.random()}`;function TO(i,e){const t={},r=(c,l)=>{let d=c.clone();return d=(l==null?void 0:l(d))||d,d.toRgbString()},n=(c,l)=>{const d=new Qt(c),u=Rl(d.toRgbString());t[`${l}-color`]=r(d),t[`${l}-color-disabled`]=u[1],t[`${l}-color-hover`]=u[4],t[`${l}-color-active`]=u[6],t[`${l}-color-outline`]=d.clone().setA(.2).toRgbString(),t[`${l}-color-deprecated-bg`]=u[0],t[`${l}-color-deprecated-border`]=u[2]};if(e.primaryColor){n(e.primaryColor,"primary");const c=new Qt(e.primaryColor),l=Rl(c.toRgbString());l.forEach((u,f)=>{t[`primary-${f+1}`]=u}),t["primary-color-deprecated-l-35"]=r(c,u=>u.lighten(35)),t["primary-color-deprecated-l-20"]=r(c,u=>u.lighten(20)),t["primary-color-deprecated-t-20"]=r(c,u=>u.tint(20)),t["primary-color-deprecated-t-50"]=r(c,u=>u.tint(50)),t["primary-color-deprecated-f-12"]=r(c,u=>u.setA(u.a*.12));const d=new Qt(l[0]);t["primary-color-active-deprecated-f-30"]=r(d,u=>u.setA(u.a*.3)),t["primary-color-active-deprecated-d-02"]=r(d,u=>u.darken(2))}return e.successColor&&n(e.successColor,"success"),e.warningColor&&n(e.warningColor,"warning"),e.errorColor&&n(e.errorColor,"error"),e.infoColor&&n(e.infoColor,"info"),`
  :root {
    ${Object.keys(t).map(c=>`--${i}-${c}: ${t[c]};`).join(`
`)}
  }
  `.trim()}function CO(i,e){const t=TO(i,e);$n()&&da(t,`${wO}-dynamic-theme`)}const pa=H.createContext(!1),AO=({children:i,disabled:e})=>{const t=H.useContext(pa);return H.createElement(pa.Provider,{value:e??t},i)},wo=H.createContext(void 0),xO=({children:i,size:e})=>{const t=H.useContext(wo);return H.createElement(wo.Provider,{value:e||t},i)};function DO(){const i=H.useContext(pa),e=H.useContext(wo);return{componentDisabled:i,componentSize:e}}var fw=Nr(function i(){Mr(this,i)}),hw="CALC_UNIT",LO=new RegExp(hw,"g");function tm(i){return typeof i=="number"?"".concat(i).concat(hw):i}var OO=function(i){Cs(t,i);var e=As(t);function t(r,n){var a;Mr(this,t),a=e.call(this),ie(lt(a),"result",""),ie(lt(a),"unitlessCssVar",void 0),ie(lt(a),"lowPriority",void 0);var c=Xe(r);return a.unitlessCssVar=n,r instanceof t?a.result="(".concat(r.result,")"):c==="number"?a.result=tm(r):c==="string"&&(a.result=r),a}return Nr(t,[{key:"add",value:function(n){return n instanceof t?this.result="".concat(this.result," + ").concat(n.getResult()):(typeof n=="number"||typeof n=="string")&&(this.result="".concat(this.result," + ").concat(tm(n))),this.lowPriority=!0,this}},{key:"sub",value:function(n){return n instanceof t?this.result="".concat(this.result," - ").concat(n.getResult()):(typeof n=="number"||typeof n=="string")&&(this.result="".concat(this.result," - ").concat(tm(n))),this.lowPriority=!0,this}},{key:"mul",value:function(n){return this.lowPriority&&(this.result="(".concat(this.result,")")),n instanceof t?this.result="".concat(this.result," * ").concat(n.getResult(!0)):(typeof n=="number"||typeof n=="string")&&(this.result="".concat(this.result," * ").concat(n)),this.lowPriority=!1,this}},{key:"div",value:function(n){return this.lowPriority&&(this.result="(".concat(this.result,")")),n instanceof t?this.result="".concat(this.result," / ").concat(n.getResult(!0)):(typeof n=="number"||typeof n=="string")&&(this.result="".concat(this.result," / ").concat(n)),this.lowPriority=!1,this}},{key:"getResult",value:function(n){return this.lowPriority||n?"(".concat(this.result,")"):this.result}},{key:"equal",value:function(n){var a=this,c=n||{},l=c.unit,d=!0;return typeof l=="boolean"?d=l:Array.from(this.unitlessCssVar).some(function(u){return a.result.includes(u)})&&(d=!1),this.result=this.result.replace(LO,d?"px":""),typeof this.lowPriority<"u"?"calc(".concat(this.result,")"):this.result}}]),t}(fw),IO=function(i){Cs(t,i);var e=As(t);function t(r){var n;return Mr(this,t),n=e.call(this),ie(lt(n),"result",0),r instanceof t?n.result=r.result:typeof r=="number"&&(n.result=r),n}return Nr(t,[{key:"add",value:function(n){return n instanceof t?this.result+=n.result:typeof n=="number"&&(this.result+=n),this}},{key:"sub",value:function(n){return n instanceof t?this.result-=n.result:typeof n=="number"&&(this.result-=n),this}},{key:"mul",value:function(n){return n instanceof t?this.result*=n.result:typeof n=="number"&&(this.result*=n),this}},{key:"div",value:function(n){return n instanceof t?this.result/=n.result:typeof n=="number"&&(this.result/=n),this}},{key:"equal",value:function(){return this.result}}]),t}(fw),PO=function(e,t){var r=e==="css"?OO:IO;return function(n){return new r(n,t)}},eS=function(e,t){return"".concat([t,e.replace(/([A-Z]+)([A-Z][a-z]+)/g,"$1-$2").replace(/([a-z])([A-Z])/g,"$1-$2")].filter(Boolean).join("-"))};function Rs(i){var e=H.useRef();e.current=i;var t=H.useCallback(function(){for(var r,n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return(r=e.current)===null||r===void 0?void 0:r.call.apply(r,[e].concat(a))},[]);return t}function wl(i){var e=H.useRef(!1),t=H.useState(i),r=Be(t,2),n=r[0],a=r[1];H.useEffect(function(){return e.current=!1,function(){e.current=!0}},[]);function c(l,d){d&&e.current||a(l)}return[n,c]}function rm(i){return i!==void 0}function pv(i,e){var t=e||{},r=t.defaultValue,n=t.value,a=t.onChange,c=t.postState,l=wl(function(){return rm(n)?n:rm(r)?typeof r=="function"?r():r:typeof i=="function"?i():i}),d=Be(l,2),u=d[0],f=d[1],p=n!==void 0?n:u,v=c?c(p):p,E=Rs(a),g=wl([p]),_=Be(g,2),m=_[0],y=_[1];$_(function(){var R=m[0];u!==R&&E(u,R)},[m]),$_(function(){rm(n)||f(n)},[n]);var b=Rs(function(R,T){f(R,T),y([p],T)});return[v,b]}function tS(i,e,t,r){var n=ue({},e[i]);if(r!=null&&r.deprecatedTokens){var a=r.deprecatedTokens;a.forEach(function(l){var d=Be(l,2),u=d[0],f=d[1];if(n!=null&&n[u]||n!=null&&n[f]){var p;(p=n[f])!==null&&p!==void 0||(n[f]=n==null?void 0:n[u])}})}var c=ue(ue({},t),n);return Object.keys(c).forEach(function(l){c[l]===e[l]&&delete c[l]}),c}var pw=typeof CSSINJS_STATISTIC<"u",bg=!0;function Ui(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];if(!pw)return Object.assign.apply(Object,[{}].concat(e));bg=!1;var r={};return e.forEach(function(n){if(Xe(n)==="object"){var a=Object.keys(n);a.forEach(function(c){Object.defineProperty(r,c,{configurable:!0,enumerable:!0,get:function(){return n[c]}})})}}),bg=!0,r}var rS={};function kO(){}var MO=function(e){var t,r=e,n=kO;return pw&&typeof Proxy<"u"&&(t=new Set,r=new Proxy(e,{get:function(c,l){if(bg){var d;(d=t)===null||d===void 0||d.add(l)}return c[l]}}),n=function(c,l){var d;rS[c]={global:Array.from(t),component:ue(ue({},(d=rS[c])===null||d===void 0?void 0:d.component),l)}}),{token:r,keys:t,flush:n}};function iS(i,e,t){if(typeof t=="function"){var r;return t(Ui(e,(r=e[i])!==null&&r!==void 0?r:{}))}return t??{}}function NO(i){return i==="js"?{max:Math.max,min:Math.min}:{max:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return"max(".concat(r.map(function(a){return Bt(a)}).join(","),")")},min:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return"min(".concat(r.map(function(a){return Bt(a)}).join(","),")")}}}var BO=1e3*60*10,FO=function(){function i(){Mr(this,i),ie(this,"map",new Map),ie(this,"objectIDMap",new WeakMap),ie(this,"nextID",0),ie(this,"lastAccessBeat",new Map),ie(this,"accessBeat",0)}return Nr(i,[{key:"set",value:function(t,r){this.clear();var n=this.getCompositeKey(t);this.map.set(n,r),this.lastAccessBeat.set(n,Date.now())}},{key:"get",value:function(t){var r=this.getCompositeKey(t),n=this.map.get(r);return this.lastAccessBeat.set(r,Date.now()),this.accessBeat+=1,n}},{key:"getCompositeKey",value:function(t){var r=this,n=t.map(function(a){return a&&Xe(a)==="object"?"obj_".concat(r.getObjectID(a)):"".concat(Xe(a),"_").concat(a)});return n.join("|")}},{key:"getObjectID",value:function(t){if(this.objectIDMap.has(t))return this.objectIDMap.get(t);var r=this.nextID;return this.objectIDMap.set(t,r),this.nextID+=1,r}},{key:"clear",value:function(){var t=this;if(this.accessBeat>1e4){var r=Date.now();this.lastAccessBeat.forEach(function(n,a){r-n>BO&&(t.map.delete(a),t.lastAccessBeat.delete(a))}),this.accessBeat=0}}}]),i}(),nS=new FO;function UO(i,e){return we.useMemo(function(){var t=nS.get(e);if(t)return t;var r=i();return nS.set(e,r),r},e)}var $O=function(){return{}};function jO(i){var e=i.useCSP,t=e===void 0?$O:e,r=i.useToken,n=i.usePrefix,a=i.getResetStyles,c=i.getCommonStyle,l=i.getCompUnitless;function d(v,E,g,_){var m=Array.isArray(v)?v[0]:v;function y(L){return"".concat(String(m)).concat(L.slice(0,1).toUpperCase()).concat(L.slice(1))}var b=(_==null?void 0:_.unitless)||{},R=typeof l=="function"?l(v):{},T=ue(ue({},R),{},ie({},y("zIndexPopup"),!0));Object.keys(b).forEach(function(L){T[y(L)]=b[L]});var w=ue(ue({},_),{},{unitless:T,prefixToken:y}),C=f(v,E,g,w),A=u(m,g,w);return function(L){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:L,P=C(L,D),k=Be(P,2),M=k[1],I=A(D),F=Be(I,2),$=F[0],N=F[1];return[$,M,N]}}function u(v,E,g){var _=g.unitless,m=g.injectStyle,y=m===void 0?!0:m,b=g.prefixToken,R=g.ignore,T=function(A){var L=A.rootCls,D=A.cssVar,P=D===void 0?{}:D,k=r(),M=k.realToken;return ZL({path:[v],prefix:P.prefix,key:P.key,unitless:_,ignore:R,token:M,scope:L},function(){var I=iS(v,M,E),F=tS(v,M,I,{deprecatedTokens:g==null?void 0:g.deprecatedTokens});return Object.keys(I).forEach(function($){F[b($)]=F[$],delete F[$]}),F}),null},w=function(A){var L=r(),D=L.cssVar;return[function(P){return y&&D?we.createElement(we.Fragment,null,we.createElement(T,{rootCls:A,cssVar:D,component:v}),P):P},D==null?void 0:D.key]};return w}function f(v,E,g){var _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},m=Array.isArray(v)?v:[v,v],y=Be(m,1),b=y[0],R=m.join("-"),T=i.layer||{name:"antd"};return function(w){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w,A=r(),L=A.theme,D=A.realToken,P=A.hashId,k=A.token,M=A.cssVar,I=n(),F=I.rootPrefixCls,$=I.iconPrefixCls,N=t(),U=M?"css":"js",V=UO(function(){var Y=new Set;return M&&Object.keys(_.unitless||{}).forEach(function(re){Y.add(Dd(re,M.prefix)),Y.add(Dd(re,eS(b,M.prefix)))}),PO(U,Y)},[U,b,M==null?void 0:M.prefix]),J=NO(U),j=J.max,q=J.min,Z={theme:L,token:k,hashId:P,nonce:function(){return N.nonce},clientOnly:_.clientOnly,layer:T,order:_.order||-999};typeof a=="function"&&sg(ue(ue({},Z),{},{clientOnly:!1,path:["Shared",F]}),function(){return a(k,{prefix:{rootPrefixCls:F,iconPrefixCls:$},csp:N})});var X=sg(ue(ue({},Z),{},{path:[R,w,$]}),function(){if(_.injectStyle===!1)return[];var Y=MO(k),re=Y.token,oe=Y.flush,ve=iS(b,D,g),be=".".concat(w),Oe=tS(b,D,ve,{deprecatedTokens:_.deprecatedTokens});M&&ve&&Xe(ve)==="object"&&Object.keys(ve).forEach(function(ge){ve[ge]="var(".concat(Dd(ge,eS(b,M.prefix)),")")});var Pe=Ui(re,{componentCls:be,prefixCls:w,iconCls:".".concat($),antCls:".".concat(F),calc:V,max:j,min:q},M?ve:Oe),Se=E(Pe,{hashId:P,prefixCls:w,rootPrefixCls:F,iconPrefixCls:$});oe(b,Oe);var Te=typeof c=="function"?c(Pe,w,C,_.resetFont):null;return[_.resetStyle===!1?null:Te,Se]});return[X,P]}}function p(v,E,g){var _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},m=f(v,E,g,ue({resetStyle:!1,order:-998},_)),y=function(R){var T=R.prefixCls,w=R.rootCls,C=w===void 0?T:w;return m(T,C),null};return y}return{genStyleHooks:d,genSubStyleComponent:p,genComponentStyleHook:f}}const mv=["blue","purple","cyan","green","magenta","pink","red","orange","yellow","volcano","geekblue","lime","gold"],zO="5.26.1";function im(i){return i>=0&&i<=255}function cl(i,e){const{r:t,g:r,b:n,a}=new Qt(i).toRgb();if(a<1)return i;const{r:c,g:l,b:d}=new Qt(e).toRgb();for(let u=.01;u<=1;u+=.01){const f=Math.round((t-c*(1-u))/u),p=Math.round((r-l*(1-u))/u),v=Math.round((n-d*(1-u))/u);if(im(f)&&im(p)&&im(v))return new Qt({r:f,g:p,b:v,a:Math.round(u*100)/100}).toRgbString()}return new Qt({r:t,g:r,b:n,a:1}).toRgbString()}var GO=function(i,e){var t={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(i);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(i,r[n])&&(t[r[n]]=i[r[n]]);return t};function mw(i){const{override:e}=i,t=GO(i,["override"]),r=Object.assign({},e);Object.keys(El).forEach(v=>{delete r[v]});const n=Object.assign(Object.assign({},t),r),a=480,c=576,l=768,d=992,u=1200,f=1600;if(n.motion===!1){const v="0s";n.motionDurationFast=v,n.motionDurationMid=v,n.motionDurationSlow=v}return Object.assign(Object.assign(Object.assign({},n),{colorFillContent:n.colorFillSecondary,colorFillContentHover:n.colorFill,colorFillAlter:n.colorFillQuaternary,colorBgContainerDisabled:n.colorFillTertiary,colorBorderBg:n.colorBgContainer,colorSplit:cl(n.colorBorderSecondary,n.colorBgContainer),colorTextPlaceholder:n.colorTextQuaternary,colorTextDisabled:n.colorTextQuaternary,colorTextHeading:n.colorText,colorTextLabel:n.colorTextSecondary,colorTextDescription:n.colorTextTertiary,colorTextLightSolid:n.colorWhite,colorHighlight:n.colorError,colorBgTextHover:n.colorFillSecondary,colorBgTextActive:n.colorFill,colorIcon:n.colorTextTertiary,colorIconHover:n.colorText,colorErrorOutline:cl(n.colorErrorBg,n.colorBgContainer),colorWarningOutline:cl(n.colorWarningBg,n.colorBgContainer),fontSizeIcon:n.fontSizeSM,lineWidthFocus:n.lineWidth*3,lineWidth:n.lineWidth,controlOutlineWidth:n.lineWidth*2,controlInteractiveSize:n.controlHeight/2,controlItemBgHover:n.colorFillTertiary,controlItemBgActive:n.colorPrimaryBg,controlItemBgActiveHover:n.colorPrimaryBgHover,controlItemBgActiveDisabled:n.colorFill,controlTmpOutline:n.colorFillQuaternary,controlOutline:cl(n.colorPrimaryBg,n.colorBgContainer),lineType:n.lineType,borderRadius:n.borderRadius,borderRadiusXS:n.borderRadiusXS,borderRadiusSM:n.borderRadiusSM,borderRadiusLG:n.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:n.sizeXXS,paddingXS:n.sizeXS,paddingSM:n.sizeSM,padding:n.size,paddingMD:n.sizeMD,paddingLG:n.sizeLG,paddingXL:n.sizeXL,paddingContentHorizontalLG:n.sizeLG,paddingContentVerticalLG:n.sizeMS,paddingContentHorizontal:n.sizeMS,paddingContentVertical:n.sizeSM,paddingContentHorizontalSM:n.size,paddingContentVerticalSM:n.sizeXS,marginXXS:n.sizeXXS,marginXS:n.sizeXS,marginSM:n.sizeSM,margin:n.size,marginMD:n.sizeMD,marginLG:n.sizeLG,marginXL:n.sizeXL,marginXXL:n.sizeXXL,boxShadow:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowSecondary:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTertiary:`
      0 1px 2px 0 rgba(0, 0, 0, 0.03),
      0 1px 6px -1px rgba(0, 0, 0, 0.02),
      0 2px 4px 0 rgba(0, 0, 0, 0.02)
    `,screenXS:a,screenXSMin:a,screenXSMax:c-1,screenSM:c,screenSMMin:c,screenSMMax:l-1,screenMD:l,screenMDMin:l,screenMDMax:d-1,screenLG:d,screenLGMin:d,screenLGMax:u-1,screenXL:u,screenXLMin:u,screenXLMax:f-1,screenXXL:f,screenXXLMin:f,boxShadowPopoverArrow:"2px 2px 5px rgba(0, 0, 0, 0.05)",boxShadowCard:`
      0 1px 2px -2px ${new Qt("rgba(0, 0, 0, 0.16)").toRgbString()},
      0 3px 6px 0 ${new Qt("rgba(0, 0, 0, 0.12)").toRgbString()},
      0 5px 12px 4px ${new Qt("rgba(0, 0, 0, 0.09)").toRgbString()}
    `,boxShadowDrawerRight:`
      -6px 0 16px 0 rgba(0, 0, 0, 0.08),
      -3px 0 6px -4px rgba(0, 0, 0, 0.12),
      -9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerLeft:`
      6px 0 16px 0 rgba(0, 0, 0, 0.08),
      3px 0 6px -4px rgba(0, 0, 0, 0.12),
      9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerUp:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerDown:`
      0 -6px 16px 0 rgba(0, 0, 0, 0.08),
      0 -3px 6px -4px rgba(0, 0, 0, 0.12),
      0 -9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),r)}var sS=function(i,e){var t={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(i);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(i,r[n])&&(t[r[n]]=i[r[n]]);return t};const gw={lineHeight:!0,lineHeightSM:!0,lineHeightLG:!0,lineHeightHeading1:!0,lineHeightHeading2:!0,lineHeightHeading3:!0,lineHeightHeading4:!0,lineHeightHeading5:!0,opacityLoading:!0,fontWeightStrong:!0,zIndexPopupBase:!0,zIndexBase:!0,opacityImage:!0},HO={size:!0,sizeSM:!0,sizeLG:!0,sizeMD:!0,sizeXS:!0,sizeXXS:!0,sizeMS:!0,sizeXL:!0,sizeXXL:!0,sizeUnit:!0,sizeStep:!0,motionBase:!0,motionUnit:!0},VO={screenXS:!0,screenXSMin:!0,screenXSMax:!0,screenSM:!0,screenSMMin:!0,screenSMMax:!0,screenMD:!0,screenMDMin:!0,screenMDMax:!0,screenLG:!0,screenLGMin:!0,screenLGMax:!0,screenXL:!0,screenXLMin:!0,screenXLMax:!0,screenXXL:!0,screenXXLMin:!0},vw=(i,e,t)=>{const r=t.getDerivativeToken(i),{override:n}=e,a=sS(e,["override"]);let c=Object.assign(Object.assign({},r),{override:n});return c=mw(c),a&&Object.entries(a).forEach(([l,d])=>{const{theme:u}=d,f=sS(d,["theme"]);let p=f;u&&(p=vw(Object.assign(Object.assign({},c),f),{override:f},u)),c[l]=p}),c};function Io(){const{token:i,hashed:e,theme:t,override:r,cssVar:n}=we.useContext(dw),a=`${zO}-${e||""}`,c=t||uw,[l,d,u]=wL(c,[El,i],{salt:a,override:r,getComputedToken:vw,formatToken:mw,cssVar:n&&{prefix:n.prefix,key:n.key,unitless:gw,ignore:HO,preserve:VO}});return[c,u,e?d:"",l,n]}const yw=(i,e=!1)=>({boxSizing:"border-box",margin:0,padding:0,color:i.colorText,fontSize:i.fontSize,lineHeight:i.lineHeight,listStyle:"none",fontFamily:e?"inherit":i.fontFamily}),bw=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}}),KO=()=>({"&::before":{display:"table",content:'""'},"&::after":{display:"table",clear:"both",content:'""'}}),qO=i=>({a:{color:i.colorLink,textDecoration:i.linkDecoration,backgroundColor:"transparent",outline:"none",cursor:"pointer",transition:`color ${i.motionDurationSlow}`,"-webkit-text-decoration-skip":"objects","&:hover":{color:i.colorLinkHover},"&:active":{color:i.colorLinkActive},"&:active, &:hover":{textDecoration:i.linkHoverDecoration,outline:0},"&:focus":{textDecoration:i.linkFocusDecoration,outline:0},"&[disabled]":{color:i.colorTextDisabled,cursor:"not-allowed"}}}),YO=(i,e,t,r)=>{const n=`[class^="${e}"], [class*=" ${e}"]`,a=t?`.${t}`:n,c={boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"}};let l={};return r!==!1&&(l={fontFamily:i.fontFamily,fontSize:i.fontSize}),{[a]:Object.assign(Object.assign(Object.assign({},l),c),{[n]:c})}},WO=(i,e)=>({outline:`${Bt(i.lineWidthFocus)} solid ${i.colorPrimaryBorder}`,outlineOffset:e??1,transition:"outline-offset 0s, outline 0s"}),XO=(i,e)=>({"&:focus-visible":Object.assign({},WO(i,e))}),_w=i=>({[`.${i}`]:Object.assign(Object.assign({},bw()),{[`.${i} .${i}-icon`]:{display:"block"}})}),{genStyleHooks:Ol,genComponentStyleHook:QO,genSubStyleComponent:ZO}=jO({usePrefix:()=>{const{getPrefixCls:i,iconPrefixCls:e}=H.useContext(kr);return{rootPrefixCls:i(),iconPrefixCls:e}},useToken:()=>{const[i,e,t,r,n]=Io();return{theme:i,realToken:e,hashId:t,token:r,cssVar:n}},useCSP:()=>{const{csp:i}=H.useContext(kr);return i??{}},getResetStyles:(i,e)=>{var t;const r=qO(i);return[r,{"&":r},_w((t=e==null?void 0:e.prefix.iconPrefixCls)!==null&&t!==void 0?t:fv)]},getCommonStyle:YO,getCompUnitless:()=>gw}),JO=(i,e)=>{const[t,r]=Io();return sg({token:r,hashId:"",path:["ant-design-icons",i],nonce:()=>e==null?void 0:e.nonce,layer:{name:"antd"}},()=>[_w(i)])},eI=Object.assign({},Jg),{useId:aS}=eI,tI=()=>"",rI=typeof aS>"u"?tI:aS;function iI(i,e,t){var r;const n=i||{},a=n.inherit===!1||!e?Object.assign(Object.assign({},yg),{hashed:(r=e==null?void 0:e.hashed)!==null&&r!==void 0?r:yg.hashed,cssVar:e==null?void 0:e.cssVar}):e,c=rI();return ev(()=>{var l,d;if(!i)return e;const u=Object.assign({},a.components);Object.keys(i.components||{}).forEach(v=>{u[v]=Object.assign(Object.assign({},u[v]),i.components[v])});const f=`css-var-${c.replace(/:/g,"")}`,p=((l=n.cssVar)!==null&&l!==void 0?l:a.cssVar)&&Object.assign(Object.assign(Object.assign({prefix:t==null?void 0:t.prefixCls},typeof a.cssVar=="object"?a.cssVar:{}),typeof n.cssVar=="object"?n.cssVar:{}),{key:typeof n.cssVar=="object"&&((d=n.cssVar)===null||d===void 0?void 0:d.key)||f});return Object.assign(Object.assign(Object.assign({},a),n),{token:Object.assign(Object.assign({},a.token),n.token),components:u,cssVar:p})},[n,a],(l,d)=>l.some((u,f)=>{const p=d[f];return!Jm(u,p,!0)}))}var nI=["children"],Sw=H.createContext({});function sI(i){var e=i.children,t=ti(i,nI);return H.createElement(Sw.Provider,{value:t},e)}var aI=function(i){Cs(t,i);var e=As(t);function t(){return Mr(this,t),e.apply(this,arguments)}return Nr(t,[{key:"render",value:function(){return this.props.children}}]),t}(H.Component);function oI(i){var e=H.useReducer(function(l){return l+1},0),t=Be(e,2),r=t[1],n=H.useRef(i),a=Rs(function(){return n.current}),c=Rs(function(l){n.current=typeof l=="function"?l(n.current):l,r()});return[a,c]}var gs="none",qu="appear",Yu="enter",Wu="leave",oS="none",Zi="prepare",ho="start",po="active",gv="end",Ew="prepared";function cS(i,e){var t={};return t[i.toLowerCase()]=e.toLowerCase(),t["Webkit".concat(i)]="webkit".concat(e),t["Moz".concat(i)]="moz".concat(e),t["ms".concat(i)]="MS".concat(e),t["O".concat(i)]="o".concat(e.toLowerCase()),t}function cI(i,e){var t={animationend:cS("Animation","AnimationEnd"),transitionend:cS("Transition","TransitionEnd")};return i&&("AnimationEvent"in e||delete t.animationend.animation,"TransitionEvent"in e||delete t.transitionend.transition),t}var lI=cI($n(),typeof window<"u"?window:{}),Rw={};if($n()){var uI=document.createElement("div");Rw=uI.style}var Xu={};function ww(i){if(Xu[i])return Xu[i];var e=lI[i];if(e)for(var t=Object.keys(e),r=t.length,n=0;n<r;n+=1){var a=t[n];if(Object.prototype.hasOwnProperty.call(e,a)&&a in Rw)return Xu[i]=e[a],Xu[i]}return""}var Tw=ww("animationend"),Cw=ww("transitionend"),Aw=!!(Tw&&Cw),lS=Tw||"animationend",uS=Cw||"transitionend";function dS(i,e){if(!i)return null;if(Xe(i)==="object"){var t=e.replace(/-\w/g,function(r){return r[1].toUpperCase()});return i[t]}return"".concat(i,"-").concat(e)}const dI=function(i){var e=H.useRef();function t(n){n&&(n.removeEventListener(uS,i),n.removeEventListener(lS,i))}function r(n){e.current&&e.current!==n&&t(e.current),n&&n!==e.current&&(n.addEventListener(uS,i),n.addEventListener(lS,i),e.current=n)}return H.useEffect(function(){return function(){t(e.current)}},[]),[r,t]};var xw=$n()?H.useLayoutEffect:H.useEffect;const fI=function(){var i=H.useRef(null);function e(){yn.cancel(i.current)}function t(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;e();var a=yn(function(){n<=1?r({isCanceled:function(){return a!==i.current}}):t(r,n-1)});i.current=a}return H.useEffect(function(){return function(){e()}},[]),[t,e]};var hI=[Zi,ho,po,gv],pI=[Zi,Ew],Dw=!1,mI=!0;function Lw(i){return i===po||i===gv}const gI=function(i,e,t){var r=wl(oS),n=Be(r,2),a=n[0],c=n[1],l=fI(),d=Be(l,2),u=d[0],f=d[1];function p(){c(Zi,!0)}var v=e?pI:hI;return xw(function(){if(a!==oS&&a!==gv){var E=v.indexOf(a),g=v[E+1],_=t(a);_===Dw?c(g,!0):g&&u(function(m){function y(){m.isCanceled()||c(g,!0)}_===!0?y():Promise.resolve(_).then(y)})}},[i,a]),H.useEffect(function(){return function(){f()}},[]),[p,a]};function vI(i,e,t,r){var n=r.motionEnter,a=n===void 0?!0:n,c=r.motionAppear,l=c===void 0?!0:c,d=r.motionLeave,u=d===void 0?!0:d,f=r.motionDeadline,p=r.motionLeaveImmediately,v=r.onAppearPrepare,E=r.onEnterPrepare,g=r.onLeavePrepare,_=r.onAppearStart,m=r.onEnterStart,y=r.onLeaveStart,b=r.onAppearActive,R=r.onEnterActive,T=r.onLeaveActive,w=r.onAppearEnd,C=r.onEnterEnd,A=r.onLeaveEnd,L=r.onVisibleChanged,D=wl(),P=Be(D,2),k=P[0],M=P[1],I=oI(gs),F=Be(I,2),$=F[0],N=F[1],U=wl(null),V=Be(U,2),J=V[0],j=V[1],q=$(),Z=H.useRef(!1),X=H.useRef(null);function Y(){return t()}var re=H.useRef(!1);function oe(){N(gs),j(null,!0)}var ve=Rs(function(rt){var et=$();if(et!==gs){var $e=Y();if(!(rt&&!rt.deadline&&rt.target!==$e)){var Ge=re.current,ft;et===qu&&Ge?ft=w==null?void 0:w($e,rt):et===Yu&&Ge?ft=C==null?void 0:C($e,rt):et===Wu&&Ge&&(ft=A==null?void 0:A($e,rt)),Ge&&ft!==!1&&oe()}}}),be=dI(ve),Oe=Be(be,1),Pe=Oe[0],Se=function(et){switch(et){case qu:return ie(ie(ie({},Zi,v),ho,_),po,b);case Yu:return ie(ie(ie({},Zi,E),ho,m),po,R);case Wu:return ie(ie(ie({},Zi,g),ho,y),po,T);default:return{}}},Te=H.useMemo(function(){return Se(q)},[q]),ge=gI(q,!i,function(rt){if(rt===Zi){var et=Te[Zi];return et?et(Y()):Dw}if(Ie in Te){var $e;j((($e=Te[Ie])===null||$e===void 0?void 0:$e.call(Te,Y(),null))||null)}return Ie===po&&q!==gs&&(Pe(Y()),f>0&&(clearTimeout(X.current),X.current=setTimeout(function(){ve({deadline:!0})},f))),Ie===Ew&&oe(),mI}),Ue=Be(ge,2),je=Ue[0],Ie=Ue[1],De=Lw(Ie);re.current=De;var ze=H.useRef(null);xw(function(){if(!(Z.current&&ze.current===e)){M(e);var rt=Z.current;Z.current=!0;var et;!rt&&e&&l&&(et=qu),rt&&e&&a&&(et=Yu),(rt&&!e&&u||!rt&&p&&!e&&u)&&(et=Wu);var $e=Se(et);et&&(i||$e[Zi])?(N(et),je()):N(gs),ze.current=e}},[e]),H.useEffect(function(){(q===qu&&!l||q===Yu&&!a||q===Wu&&!u)&&N(gs)},[l,a,u]),H.useEffect(function(){return function(){Z.current=!1,clearTimeout(X.current)}},[]);var ut=H.useRef(!1);H.useEffect(function(){k&&(ut.current=!0),k!==void 0&&q===gs&&((ut.current||k)&&(L==null||L(k)),ut.current=!0)},[k,q]);var Ft=J;return Te[Zi]&&Ie===ho&&(Ft=ue({transition:"none"},Ft)),[q,Ie,Ft,k??e]}function yI(i){var e=i;Xe(i)==="object"&&(e=i.transitionSupport);function t(n,a){return!!(n.motionName&&e&&a!==!1)}var r=H.forwardRef(function(n,a){var c=n.visible,l=c===void 0?!0:c,d=n.removeOnLeave,u=d===void 0?!0:d,f=n.forceRender,p=n.children,v=n.motionName,E=n.leavedClassName,g=n.eventProps,_=H.useContext(Sw),m=_.motion,y=t(n,m),b=H.useRef(),R=H.useRef();function T(){try{return b.current instanceof HTMLElement?b.current:xd(R.current)}catch{return null}}var w=vI(y,l,T,n),C=Be(w,4),A=C[0],L=C[1],D=C[2],P=C[3],k=H.useRef(P);P&&(k.current=!0);var M=H.useCallback(function(V){b.current=V,wR(a,V)},[a]),I,F=ue(ue({},g),{},{visible:l});if(!p)I=null;else if(A===gs)P?I=p(ue({},F),M):!u&&k.current&&E?I=p(ue(ue({},F),{},{className:E}),M):f||!u&&!E?I=p(ue(ue({},F),{},{style:{display:"none"}}),M):I=null;else{var $;L===Zi?$="prepare":Lw(L)?$="active":L===ho&&($="start");var N=dS(v,"".concat(A,"-").concat($));I=p(ue(ue({},F),{},{className:tt(dS(v,A),ie(ie({},N,N&&$),v,typeof v=="string")),style:D}),M)}if(H.isValidElement(I)&&tv(I)){var U=rv(I);U||(I=H.cloneElement(I,{ref:M}))}return H.createElement(aI,{ref:R},I)});return r.displayName="CSSMotion",r}const vv=yI(Aw);var _g="add",Sg="keep",Eg="remove",nm="removed";function bI(i){var e;return i&&Xe(i)==="object"&&"key"in i?e=i:e={key:i},ue(ue({},e),{},{key:String(e.key)})}function Rg(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return i.map(bI)}function _I(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=[],r=0,n=e.length,a=Rg(i),c=Rg(e);a.forEach(function(u){for(var f=!1,p=r;p<n;p+=1){var v=c[p];if(v.key===u.key){r<p&&(t=t.concat(c.slice(r,p).map(function(E){return ue(ue({},E),{},{status:_g})})),r=p),t.push(ue(ue({},v),{},{status:Sg})),r+=1,f=!0;break}}f||t.push(ue(ue({},u),{},{status:Eg}))}),r<n&&(t=t.concat(c.slice(r).map(function(u){return ue(ue({},u),{},{status:_g})})));var l={};t.forEach(function(u){var f=u.key;l[f]=(l[f]||0)+1});var d=Object.keys(l).filter(function(u){return l[u]>1});return d.forEach(function(u){t=t.filter(function(f){var p=f.key,v=f.status;return p!==u||v!==Eg}),t.forEach(function(f){f.key===u&&(f.status=Sg)})}),t}var SI=["component","children","onVisibleChanged","onAllRemoved"],EI=["status"],RI=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];function wI(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:vv,t=function(r){Cs(a,r);var n=As(a);function a(){var c;Mr(this,a);for(var l=arguments.length,d=new Array(l),u=0;u<l;u++)d[u]=arguments[u];return c=n.call.apply(n,[this].concat(d)),ie(lt(c),"state",{keyEntities:[]}),ie(lt(c),"removeKey",function(f){c.setState(function(p){var v=p.keyEntities.map(function(E){return E.key!==f?E:ue(ue({},E),{},{status:nm})});return{keyEntities:v}},function(){var p=c.state.keyEntities,v=p.filter(function(E){var g=E.status;return g!==nm}).length;v===0&&c.props.onAllRemoved&&c.props.onAllRemoved()})}),c}return Nr(a,[{key:"render",value:function(){var l=this,d=this.state.keyEntities,u=this.props,f=u.component,p=u.children,v=u.onVisibleChanged;u.onAllRemoved;var E=ti(u,SI),g=f||H.Fragment,_={};return RI.forEach(function(m){_[m]=E[m],delete E[m]}),delete E.keys,H.createElement(g,E,d.map(function(m,y){var b=m.status,R=ti(m,EI),T=b===_g||b===Sg;return H.createElement(e,Dr({},_,{key:R.key,visible:T,eventProps:R,onVisibleChanged:function(C){v==null||v(C,{key:R.key}),C||l.removeKey(R.key)}}),function(w,C){return p(ue(ue({},w),{},{index:y}),C)})}))}}],[{key:"getDerivedStateFromProps",value:function(l,d){var u=l.keys,f=d.keyEntities,p=Rg(u),v=_I(f,p);return{keyEntities:v.filter(function(E){var g=f.find(function(_){var m=_.key;return E.key===m});return!(g&&g.status===nm&&E.status===Eg)})}}}]),a}(H.Component);return ie(t,"defaultProps",{component:"div"}),t}wI(Aw);const fS=H.createContext(!0);function TI(i){const e=H.useContext(fS),{children:t}=i,[,r]=Io(),{motion:n}=r,a=H.useRef(!1);return a.current||(a.current=e!==n),a.current?H.createElement(fS.Provider,{value:n},H.createElement(sI,{motion:n},t)):t}const CI=()=>null;var AI=function(i,e){var t={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(i);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(i,r[n])&&(t[r[n]]=i[r[n]]);return t};const xI=["getTargetContainer","getPopupContainer","renderEmpty","input","pagination","form","select","button"];let Ow;function DI(){return Ow||Yd}function LI(i){return Object.keys(i).some(e=>e.endsWith("Color"))}const OI=i=>{const{prefixCls:e,iconPrefixCls:t,theme:r,holderRender:n}=i;e!==void 0&&(Ow=e),r&&LI(r)&&CO(DI(),r)},II=i=>{const{children:e,csp:t,autoInsertSpaceInButton:r,alert:n,anchor:a,form:c,locale:l,componentSize:d,direction:u,space:f,splitter:p,virtual:v,dropdownMatchSelectWidth:E,popupMatchSelectWidth:g,popupOverflow:_,legacyLocale:m,parentContext:y,iconPrefixCls:b,theme:R,componentDisabled:T,segmented:w,statistic:C,spin:A,calendar:L,carousel:D,cascader:P,collapse:k,typography:M,checkbox:I,descriptions:F,divider:$,drawer:N,skeleton:U,steps:V,image:J,layout:j,list:q,mentions:Z,modal:X,progress:Y,result:re,slider:oe,breadcrumb:ve,menu:be,pagination:Oe,input:Pe,textArea:Se,empty:Te,badge:ge,radio:Ue,rate:je,switch:Ie,transfer:De,avatar:ze,message:ut,tag:Ft,table:rt,card:et,tabs:$e,timeline:Ge,timePicker:ft,upload:Wt,notification:_t,tree:Ze,colorPicker:Et,datePicker:le,rangePicker:pe,flex:_e,wave:Ce,dropdown:Ee,warning:ke,tour:Qe,tooltip:Tt,popover:pr,popconfirm:Si,floatButtonGroup:Is,variant:Ei,inputNumber:ni,treeSelect:Ps}=i,zn=H.useCallback((Ot,$t)=>{const{prefixCls:Jt}=i;if($t)return $t;const _r=Jt||y.getPrefixCls("");return Ot?`${_r}-${Ot}`:_r},[y.getPrefixCls,i.prefixCls]),Zt=b||y.iconPrefixCls||fv,Lr=t||y.csp;JO(Zt,Lr);const Sn=iI(R,y.theme,{prefixCls:zn("")}),$i={csp:Lr,autoInsertSpaceInButton:r,alert:n,anchor:a,locale:l||m,direction:u,space:f,splitter:p,virtual:v,popupMatchSelectWidth:g??E,popupOverflow:_,getPrefixCls:zn,iconPrefixCls:Zt,theme:Sn,segmented:w,statistic:C,spin:A,calendar:L,carousel:D,cascader:P,collapse:k,typography:M,checkbox:I,descriptions:F,divider:$,drawer:N,skeleton:U,steps:V,image:J,input:Pe,textArea:Se,layout:j,list:q,mentions:Z,modal:X,progress:Y,result:re,slider:oe,breadcrumb:ve,menu:be,pagination:Oe,empty:Te,badge:ge,radio:Ue,rate:je,switch:Ie,transfer:De,avatar:ze,message:ut,tag:Ft,table:rt,card:et,tabs:$e,timeline:Ge,timePicker:ft,upload:Wt,notification:_t,tree:Ze,colorPicker:Et,datePicker:le,rangePicker:pe,flex:_e,wave:Ce,dropdown:Ee,warning:ke,tour:Qe,tooltip:Tt,popover:pr,popconfirm:Si,floatButtonGroup:Is,variant:Ei,inputNumber:ni,treeSelect:Ps},Ri=Object.assign({},y);Object.keys($i).forEach(Ot=>{$i[Ot]!==void 0&&(Ri[Ot]=$i[Ot])}),xI.forEach(Ot=>{const $t=i[Ot];$t&&(Ri[Ot]=$t)}),typeof r<"u"&&(Ri.button=Object.assign({autoInsertSpace:r},Ri.button));const ar=ev(()=>Ri,Ri,(Ot,$t)=>{const Jt=Object.keys(Ot),_r=Object.keys($t);return Jt.length!==_r.length||Jt.some(cr=>Ot[cr]!==$t[cr])}),{layer:Ut}=H.useContext(Ll),or=H.useMemo(()=>({prefixCls:Zt,csp:Lr,layer:Ut?"antd":void 0}),[Zt,Lr,Ut]);let yt=H.createElement(H.Fragment,null,H.createElement(CI,{dropdownMatchSelectWidth:E}),e);const nn=H.useMemo(()=>{var Ot,$t,Jt,_r;return fo(((Ot=vf.Form)===null||Ot===void 0?void 0:Ot.defaultValidateMessages)||{},((Jt=($t=ar.locale)===null||$t===void 0?void 0:$t.Form)===null||Jt===void 0?void 0:Jt.defaultValidateMessages)||{},((_r=ar.form)===null||_r===void 0?void 0:_r.validateMessages)||{},(c==null?void 0:c.validateMessages)||{})},[ar,c==null?void 0:c.validateMessages]);Object.keys(nn).length>0&&(yt=H.createElement(nO.Provider,{value:nn},yt)),l&&(yt=H.createElement(oO,{locale:l,_ANT_MARK__:aO},yt)),yt=H.createElement(dv.Provider,{value:or},yt),d&&(yt=H.createElement(xO,{size:d},yt)),yt=H.createElement(TI,null,yt);const si=H.useMemo(()=>{const Ot=Sn||{},{algorithm:$t,token:Jt,components:_r,cssVar:cr}=Ot,ji=AI(Ot,["algorithm","token","components","cssVar"]),zi=$t&&(!Array.isArray($t)||$t.length>0)?tg($t):uw,ai={};Object.entries(_r||{}).forEach(([va,ks])=>{const lr=Object.assign({},ks);"algorithm"in lr&&(lr.algorithm===!0?lr.theme=zi:(Array.isArray(lr.algorithm)||typeof lr.algorithm=="function")&&(lr.theme=tg(lr.algorithm)),delete lr.algorithm),ai[va]=lr});const jt=Object.assign(Object.assign({},El),Jt);return Object.assign(Object.assign({},ji),{theme:zi,token:jt,components:ai,override:Object.assign({override:jt},ai),cssVar:cr})},[Sn]);return R&&(yt=H.createElement(dw.Provider,{value:si},yt)),ar.warning&&(yt=H.createElement(iO.Provider,{value:ar.warning},yt)),T!==void 0&&(yt=H.createElement(AO,{disabled:T},yt)),H.createElement(kr.Provider,{value:ar},yt)},Il=i=>{const e=H.useContext(kr),t=H.useContext(aw);return H.createElement(II,Object.assign({parentContext:e,legacyLocale:t},i))};Il.ConfigContext=kr;Il.SizeContext=wo;Il.config=OI;Il.useConfig=DO;Object.defineProperty(Il,"SizeContext",{get:()=>wo});function Iw(i){var e;return i==null||(e=i.getRootNode)===null||e===void 0?void 0:e.call(i)}function PI(i){return Iw(i)instanceof ShadowRoot}function kI(i){return PI(i)?Iw(i):null}function MI(i){return i.replace(/-(.)/g,function(e,t){return t.toUpperCase()})}function NI(i,e){bi(i,"[@ant-design/icons] ".concat(e))}function hS(i){return Xe(i)==="object"&&typeof i.name=="string"&&typeof i.theme=="string"&&(Xe(i.icon)==="object"||typeof i.icon=="function")}function pS(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(i).reduce(function(e,t){var r=i[t];switch(t){case"class":e.className=r,delete e.class;break;default:delete e[t],e[MI(t)]=r}return e},{})}function wg(i,e,t){return t?we.createElement(i.tag,ue(ue({key:e},pS(i.attrs)),t),(i.children||[]).map(function(r,n){return wg(r,"".concat(e,"-").concat(i.tag,"-").concat(n))})):we.createElement(i.tag,ue({key:e},pS(i.attrs)),(i.children||[]).map(function(r,n){return wg(r,"".concat(e,"-").concat(i.tag,"-").concat(n))}))}function Pw(i){return Rl(i)[0]}function kw(i){return i?Array.isArray(i)?i:[i]:[]}var BI=`
.anticon {
  display: inline-flex;
  align-items: center;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,FI=function(e){var t=H.useContext(dv),r=t.csp,n=t.prefixCls,a=t.layer,c=BI;n&&(c=c.replace(/anticon/g,n)),a&&(c="@layer ".concat(a,` {
`).concat(c,`
}`)),H.useEffect(function(){var l=e.current,d=kI(l);da(c,"@ant-design-icons",{prepend:!a,csp:r,attachTo:d})},[])},UI=["icon","className","onClick","style","primaryColor","secondaryColor"],hl={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};function $I(i){var e=i.primaryColor,t=i.secondaryColor;hl.primaryColor=e,hl.secondaryColor=t||Pw(e),hl.calculated=!!t}function jI(){return ue({},hl)}var Po=function(e){var t=e.icon,r=e.className,n=e.onClick,a=e.style,c=e.primaryColor,l=e.secondaryColor,d=ti(e,UI),u=H.useRef(),f=hl;if(c&&(f={primaryColor:c,secondaryColor:l||Pw(c)}),FI(u),NI(hS(t),"icon should be icon definiton, but got ".concat(t)),!hS(t))return null;var p=t;return p&&typeof p.icon=="function"&&(p=ue(ue({},p),{},{icon:p.icon(f.primaryColor,f.secondaryColor)})),wg(p.icon,"svg-".concat(p.name),ue(ue({className:r,onClick:n,style:a,"data-icon":p.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},d),{},{ref:u}))};Po.displayName="IconReact";Po.getTwoToneColors=jI;Po.setTwoToneColors=$I;function Mw(i){var e=kw(i),t=Be(e,2),r=t[0],n=t[1];return Po.setTwoToneColors({primaryColor:r,secondaryColor:n})}function zI(){var i=Po.getTwoToneColors();return i.calculated?[i.primaryColor,i.secondaryColor]:i.primaryColor}var GI=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];Mw(qd.primary);var xs=H.forwardRef(function(i,e){var t=i.className,r=i.icon,n=i.spin,a=i.rotate,c=i.tabIndex,l=i.onClick,d=i.twoToneColor,u=ti(i,GI),f=H.useContext(dv),p=f.prefixCls,v=p===void 0?"anticon":p,E=f.rootClassName,g=tt(E,v,ie(ie({},"".concat(v,"-").concat(r.name),!!r.name),"".concat(v,"-spin"),!!n||r.name==="loading"),t),_=c;_===void 0&&l&&(_=-1);var m=a?{msTransform:"rotate(".concat(a,"deg)"),transform:"rotate(".concat(a,"deg)")}:void 0,y=kw(d),b=Be(y,2),R=b[0],T=b[1];return H.createElement("span",Dr({role:"img","aria-label":r.name},u,{ref:e,tabIndex:_,onClick:l,className:g}),H.createElement(Po,{icon:r,primaryColor:R,secondaryColor:T,style:m}))});xs.displayName="AntdIcon";xs.getTwoToneColor=zI;xs.setTwoToneColor=Mw;var HI={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-circle",theme:"filled"},VI=function(e,t){return H.createElement(xs,Dr({},e,{ref:t,icon:HI}))},KI=H.forwardRef(VI),qI=`accept acceptCharset accessKey action allowFullScreen allowTransparency
    alt async autoComplete autoFocus autoPlay capture cellPadding cellSpacing challenge
    charSet checked classID className colSpan cols content contentEditable contextMenu
    controls coords crossOrigin data dateTime default defer dir disabled download draggable
    encType form formAction formEncType formMethod formNoValidate formTarget frameBorder
    headers height hidden high href hrefLang htmlFor httpEquiv icon id inputMode integrity
    is keyParams keyType kind label lang list loop low manifest marginHeight marginWidth max maxLength media
    mediaGroup method min minLength multiple muted name noValidate nonce open
    optimum pattern placeholder poster preload radioGroup readOnly rel required
    reversed role rowSpan rows sandbox scope scoped scrolling seamless selected
    shape size sizes span spellCheck src srcDoc srcLang srcSet start step style
    summary tabIndex target title type useMap value width wmode wrap`,YI=`onCopy onCut onPaste onCompositionEnd onCompositionStart onCompositionUpdate onKeyDown
    onKeyPress onKeyUp onFocus onBlur onChange onInput onSubmit onClick onContextMenu onDoubleClick
    onDrag onDragEnd onDragEnter onDragExit onDragLeave onDragOver onDragStart onDrop onMouseDown
    onMouseEnter onMouseLeave onMouseMove onMouseOut onMouseOver onMouseUp onSelect onTouchCancel
    onTouchEnd onTouchMove onTouchStart onScroll onWheel onAbort onCanPlay onCanPlayThrough
    onDurationChange onEmptied onEncrypted onEnded onError onLoadedData onLoadedMetadata
    onLoadStart onPause onPlay onPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend onTimeUpdate onVolumeChange onWaiting onLoad onError`,WI="".concat(qI," ").concat(YI).split(/[\s\n]+/),XI="aria-",QI="data-";function mS(i,e){return i.indexOf(e)===0}function ZI(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t;e===!1?t={aria:!0,data:!0,attr:!0}:e===!0?t={aria:!0}:t=ue({},e);var r={};return Object.keys(i).forEach(function(n){(t.aria&&(n==="role"||mS(n,XI))||t.data&&mS(n,QI)||t.attr&&WI.includes(n))&&(r[n]=i[n])}),r}function JI(i){return i&&we.isValidElement(i)&&i.type===we.Fragment}const eP=(i,e,t)=>we.isValidElement(i)?we.cloneElement(i,typeof t=="function"?t(i.props||{}):t):e;function Wd(i,e){return eP(i,i,e)}const Nw=i=>{const[,,,,e]=Io();return e?`${i}-css-var`:""};var tP={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"},rP=function(e,t){return H.createElement(xs,Dr({},e,{ref:t,icon:tP}))},iP=H.forwardRef(rP);function Bw(i,e){this.v=i,this.k=e}function $r(i,e,t,r){var n=Object.defineProperty;try{n({},"",{})}catch{n=0}$r=function(c,l,d,u){if(l)n?n(c,l,{value:d,enumerable:!u,configurable:!u,writable:!u}):c[l]=d;else{var f=function(v,E){$r(c,v,function(g){return this._invoke(v,E,g)})};f("next",0),f("throw",1),f("return",2)}},$r(i,e,t,r)}function yv(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var i,e,t=typeof Symbol=="function"?Symbol:{},r=t.iterator||"@@iterator",n=t.toStringTag||"@@toStringTag";function a(E,g,_,m){var y=g&&g.prototype instanceof l?g:l,b=Object.create(y.prototype);return $r(b,"_invoke",function(R,T,w){var C,A,L,D=0,P=w||[],k=!1,M={p:0,n:0,v:i,a:I,f:I.bind(i,4),d:function($,N){return C=$,A=0,L=i,M.n=N,c}};function I(F,$){for(A=F,L=$,e=0;!k&&D&&!N&&e<P.length;e++){var N,U=P[e],V=M.p,J=U[2];F>3?(N=J===$)&&(L=U[(A=U[4])?5:(A=3,3)],U[4]=U[5]=i):U[0]<=V&&((N=F<2&&V<U[1])?(A=0,M.v=$,M.n=U[1]):V<J&&(N=F<3||U[0]>$||$>J)&&(U[4]=F,U[5]=$,M.n=J,A=0))}if(N||F>1)return c;throw k=!0,$}return function(F,$,N){if(D>1)throw TypeError("Generator is already running");for(k&&$===1&&I($,N),A=$,L=N;(e=A<2?i:L)||!k;){C||(A?A<3?(A>1&&(M.n=-1),I(A,L)):M.n=L:M.v=L);try{if(D=2,C){if(A||(F="next"),e=C[F]){if(!(e=e.call(C,L)))throw TypeError("iterator result is not an object");if(!e.done)return e;L=e.value,A<2&&(A=0)}else A===1&&(e=C.return)&&e.call(C),A<2&&(L=TypeError("The iterator does not provide a '"+F+"' method"),A=1);C=i}else if((e=(k=M.n<0)?L:R.call(T,M))!==c)break}catch(U){C=i,A=1,L=U}finally{D=1}}return{value:e,done:k}}}(E,_,m),!0),b}var c={};function l(){}function d(){}function u(){}e=Object.getPrototypeOf;var f=[][r]?e(e([][r]())):($r(e={},r,function(){return this}),e),p=u.prototype=l.prototype=Object.create(f);function v(E){return Object.setPrototypeOf?Object.setPrototypeOf(E,u):(E.__proto__=u,$r(E,n,"GeneratorFunction")),E.prototype=Object.create(p),E}return d.prototype=u,$r(p,"constructor",u),$r(u,"constructor",d),d.displayName="GeneratorFunction",$r(u,n,"GeneratorFunction"),$r(p),$r(p,n,"Generator"),$r(p,r,function(){return this}),$r(p,"toString",function(){return"[object Generator]"}),(yv=function(){return{w:a,m:v}})()}function Xd(i,e){function t(n,a,c,l){try{var d=i[n](a),u=d.value;return u instanceof Bw?e.resolve(u.v).then(function(f){t("next",f,c,l)},function(f){t("throw",f,c,l)}):e.resolve(u).then(function(f){d.value=f,c(d)},function(f){return t("throw",f,c,l)})}catch(f){l(f)}}var r;this.next||($r(Xd.prototype),$r(Xd.prototype,typeof Symbol=="function"&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),$r(this,"_invoke",function(n,a,c){function l(){return new e(function(d,u){t(n,c,d,u)})}return r=r?r.then(l,l):l()},!0)}function Fw(i,e,t,r,n){return new Xd(yv().w(i,e,t,r),n||Promise)}function nP(i,e,t,r,n){var a=Fw(i,e,t,r,n);return a.next().then(function(c){return c.done?c.value:a.next()})}function sP(i){var e=Object(i),t=[];for(var r in e)t.unshift(r);return function n(){for(;t.length;)if((r=t.pop())in e)return n.value=r,n.done=!1,n;return n.done=!0,n}}function gS(i){if(i!=null){var e=i[typeof Symbol=="function"&&Symbol.iterator||"@@iterator"],t=0;if(e)return e.call(i);if(typeof i.next=="function")return i;if(!isNaN(i.length))return{next:function(){return i&&t>=i.length&&(i=void 0),{value:i&&i[t++],done:!i}}}}throw new TypeError(Xe(i)+" is not iterable")}function zr(){var i=yv(),e=i.m(zr),t=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(c){var l=typeof c=="function"&&c.constructor;return!!l&&(l===t||(l.displayName||l.name)==="GeneratorFunction")}var n={throw:1,return:2,break:3,continue:3};function a(c){var l,d;return function(u){l||(l={stop:function(){return d(u.a,2)},catch:function(){return u.v},abrupt:function(p,v){return d(u.a,n[p],v)},delegateYield:function(p,v,E){return l.resultName=v,d(u.d,gS(p),E)},finish:function(p){return d(u.f,p)}},d=function(p,v,E){u.p=l.prev,u.n=l.next;try{return p(v,E)}finally{l.next=u.n}}),l.resultName&&(l[l.resultName]=u.v,l.resultName=void 0),l.sent=u.v,l.next=u.n;try{return c.call(this,l)}finally{u.p=l.prev,u.n=l.next}}}return(zr=function(){return{wrap:function(d,u,f,p){return i.w(a(d),u,f,p&&p.reverse())},isGeneratorFunction:r,mark:i.m,awrap:function(d,u){return new Bw(d,u)},AsyncIterator:Xd,async:function(d,u,f,p,v){return(r(u)?Fw:nP)(a(d),u,f,p,v)},keys:sP,values:gS}})()}function vS(i,e,t,r,n,a,c){try{var l=i[a](c),d=l.value}catch(u){return void t(u)}l.done?e(d):Promise.resolve(d).then(r,n)}function ma(i){return function(){var e=this,t=arguments;return new Promise(function(r,n){var a=i.apply(e,t);function c(d){vS(a,r,n,c,l,"next",d)}function l(d){vS(a,r,n,c,l,"throw",d)}c(void 0)})}}var Pl=ue({},mD),aP=Pl.version,sm=Pl.render,oP=Pl.unmountComponentAtNode,yf;try{var cP=Number((aP||"").split(".")[0]);cP>=18&&(yf=Pl.createRoot)}catch{}function yS(i){var e=Pl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;e&&Xe(e)==="object"&&(e.usingClientEntryPoint=i)}var Qd="__rc_react_root__";function lP(i,e){yS(!0);var t=e[Qd]||yf(e);yS(!1),t.render(i),e[Qd]=t}function uP(i,e){sm==null||sm(i,e)}function dP(i,e){if(yf){lP(i,e);return}uP(i,e)}function fP(i){return Tg.apply(this,arguments)}function Tg(){return Tg=ma(zr().mark(function i(e){return zr().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Promise.resolve().then(function(){var n;(n=e[Qd])===null||n===void 0||n.unmount(),delete e[Qd]}));case 1:case"end":return r.stop()}},i)})),Tg.apply(this,arguments)}function hP(i){oP(i)}function pP(i){return Cg.apply(this,arguments)}function Cg(){return Cg=ma(zr().mark(function i(e){return zr().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(yf===void 0){r.next=2;break}return r.abrupt("return",fP(e));case 2:hP(e);case 3:case"end":return r.stop()}},i)})),Cg.apply(this,arguments)}const mP=(i,e)=>(dP(i,e),()=>pP(e));let gP=mP;function vP(i){return gP}function bv(i,e){var t=Object.assign({},i);return Array.isArray(e)&&e.forEach(function(r){delete t[r]}),t}const yP=function(i){if(!i)return!1;if(i instanceof Element){if(i.offsetParent)return!0;if(i.getBBox){var e=i.getBBox(),t=e.width,r=e.height;if(t||r)return!0}if(i.getBoundingClientRect){var n=i.getBoundingClientRect(),a=n.width,c=n.height;if(a||c)return!0}}return!1},bP=i=>{const{componentCls:e,colorPrimary:t}=i;return{[e]:{position:"absolute",background:"transparent",pointerEvents:"none",boxSizing:"border-box",color:`var(--wave-color, ${t})`,boxShadow:"0 0 0 0 currentcolor",opacity:.2,"&.wave-motion-appear":{transition:[`box-shadow 0.4s ${i.motionEaseOutCirc}`,`opacity 2s ${i.motionEaseOutCirc}`].join(","),"&-active":{boxShadow:"0 0 0 6px currentcolor",opacity:0},"&.wave-quick":{transition:[`box-shadow ${i.motionDurationSlow} ${i.motionEaseInOut}`,`opacity ${i.motionDurationSlow} ${i.motionEaseInOut}`].join(",")}}}}},_P=QO("Wave",i=>[bP(i)]),Uw=`${Yd}-wave-target`;function am(i){return i&&i!=="#fff"&&i!=="#ffffff"&&i!=="rgb(255, 255, 255)"&&i!=="rgba(255, 255, 255, 1)"&&!/rgba\((?:\d*, ){3}0\)/.test(i)&&i!=="transparent"}function SP(i){const{borderTopColor:e,borderColor:t,backgroundColor:r}=getComputedStyle(i);return am(e)?e:am(t)?t:am(r)?r:null}function om(i){return Number.isNaN(i)?0:i}const EP=i=>{const{className:e,target:t,component:r,registerUnmount:n}=i,a=H.useRef(null),c=H.useRef(null);H.useEffect(()=>{c.current=n()},[]);const[l,d]=H.useState(null),[u,f]=H.useState([]),[p,v]=H.useState(0),[E,g]=H.useState(0),[_,m]=H.useState(0),[y,b]=H.useState(0),[R,T]=H.useState(!1),w={left:p,top:E,width:_,height:y,borderRadius:u.map(L=>`${L}px`).join(" ")};l&&(w["--wave-color"]=l);function C(){const L=getComputedStyle(t);d(SP(t));const D=L.position==="static",{borderLeftWidth:P,borderTopWidth:k}=L;v(D?t.offsetLeft:om(-parseFloat(P))),g(D?t.offsetTop:om(-parseFloat(k))),m(t.offsetWidth),b(t.offsetHeight);const{borderTopLeftRadius:M,borderTopRightRadius:I,borderBottomLeftRadius:F,borderBottomRightRadius:$}=L;f([M,I,$,F].map(N=>om(parseFloat(N))))}if(H.useEffect(()=>{if(t){const L=yn(()=>{C(),T(!0)});let D;return typeof ResizeObserver<"u"&&(D=new ResizeObserver(C),D.observe(t)),()=>{yn.cancel(L),D==null||D.disconnect()}}},[]),!R)return null;const A=(r==="Checkbox"||r==="Radio")&&(t==null?void 0:t.classList.contains(Uw));return H.createElement(vv,{visible:!0,motionAppear:!0,motionName:"wave-motion",motionDeadline:5e3,onAppearEnd:(L,D)=>{var P,k;if(D.deadline||D.propertyName==="opacity"){const M=(P=a.current)===null||P===void 0?void 0:P.parentElement;(k=c.current)===null||k===void 0||k.call(c).then(()=>{M==null||M.remove()})}return!1}},({className:L},D)=>H.createElement("div",{ref:Lo(a,D),className:tt(e,L,{"wave-quick":A}),style:w}))},RP=(i,e)=>{var t;const{component:r}=e;if(r==="Checkbox"&&!(!((t=i.querySelector("input"))===null||t===void 0)&&t.checked))return;const n=document.createElement("div");n.style.position="absolute",n.style.left="0px",n.style.top="0px",i==null||i.insertBefore(n,i==null?void 0:i.firstChild);const a=vP();let c=null;function l(){return c}c=a(H.createElement(EP,Object.assign({},e,{target:i,registerUnmount:l})),n)},wP=(i,e,t)=>{const{wave:r}=H.useContext(kr),[,n,a]=Io(),c=Rs(u=>{const f=i.current;if(r!=null&&r.disabled||!f)return;const p=f.querySelector(`.${Uw}`)||f,{showEffect:v}=r||{};(v||RP)(p,{className:e,token:n,component:t,event:u,hashId:a})}),l=H.useRef(null);return u=>{yn.cancel(l.current),l.current=yn(()=>{c(u)})}},TP=i=>{const{children:e,disabled:t,component:r}=i,{getPrefixCls:n}=H.useContext(kr),a=H.useRef(null),c=n("wave"),[,l]=_P(c),d=wP(a,tt(c,l),r);if(we.useEffect(()=>{const f=a.current;if(!f||f.nodeType!==1||t)return;const p=v=>{!yP(v.target)||!f.getAttribute||f.getAttribute("disabled")||f.disabled||f.className.includes("disabled")||f.className.includes("-leave")||d(v)};return f.addEventListener("click",p,!0),()=>{f.removeEventListener("click",p,!0)}},[t]),!we.isValidElement(e))return e??null;const u=tv(e)?Lo(rv(e),a):a;return Wd(e,{ref:u})},kl=i=>{const e=we.useContext(wo);return we.useMemo(()=>i?typeof i=="string"?i??e:typeof i=="function"?i(e):e:e,[i,e])},$w=H.createContext(null),bf=(i,e)=>{const t=H.useContext($w),r=H.useMemo(()=>{if(!t)return"";const{compactDirection:n,isFirstItem:a,isLastItem:c}=t,l=n==="vertical"?"-vertical-":"-";return tt(`${i}-compact${l}item`,{[`${i}-compact${l}first-item`]:a,[`${i}-compact${l}last-item`]:c,[`${i}-compact${l}item-rtl`]:e==="rtl"})},[i,e,t]);return{compactSize:t==null?void 0:t.compactSize,compactDirection:t==null?void 0:t.compactDirection,compactItemClassnames:r}},CP=i=>{const{children:e}=i;return H.createElement($w.Provider,{value:null},e)};var AP=function(i,e){var t={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(i);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(i,r[n])&&(t[r[n]]=i[r[n]]);return t};const jw=H.createContext(void 0),xP=i=>{const{getPrefixCls:e,direction:t}=H.useContext(kr),{prefixCls:r,size:n,className:a}=i,c=AP(i,["prefixCls","size","className"]),l=e("btn-group",r),[,,d]=Io(),u=H.useMemo(()=>{switch(n){case"large":return"lg";case"small":return"sm";default:return""}},[n]),f=tt(l,{[`${l}-${u}`]:u,[`${l}-rtl`]:t==="rtl"},a,d);return H.createElement(jw.Provider,{value:n},H.createElement("div",Object.assign({},c,{className:f})))},bS=/^[\u4E00-\u9FA5]{2}$/,Ag=bS.test.bind(bS);function _S(i){return typeof i=="string"}function cm(i){return i==="text"||i==="link"}function DP(i,e){if(i==null)return;const t=e?" ":"";return typeof i!="string"&&typeof i!="number"&&_S(i.type)&&Ag(i.props.children)?Wd(i,{children:i.props.children.split("").join(t)}):_S(i)?Ag(i)?we.createElement("span",null,i.split("").join(t)):we.createElement("span",null,i):JI(i)?we.createElement("span",null,i):i}function LP(i,e){let t=!1;const r=[];return we.Children.forEach(i,n=>{const a=typeof n,c=a==="string"||a==="number";if(t&&c){const l=r.length-1,d=r[l];r[l]=`${d}${n}`}else r.push(n);t=c}),we.Children.map(r,n=>DP(n,e))}["default","primary","danger"].concat(Ye(mv));const xg=H.forwardRef((i,e)=>{const{className:t,style:r,children:n,prefixCls:a}=i,c=tt(`${a}-icon`,t);return we.createElement("span",{ref:e,className:c,style:r},n)}),SS=H.forwardRef((i,e)=>{const{prefixCls:t,className:r,style:n,iconClassName:a}=i,c=tt(`${t}-loading-icon`,r);return we.createElement(xg,{prefixCls:t,className:c,style:n,ref:e},we.createElement(iP,{className:a}))}),lm=()=>({width:0,opacity:0,transform:"scale(0)"}),um=i=>({width:i.scrollWidth,opacity:1,transform:"scale(1)"}),OP=i=>{const{prefixCls:e,loading:t,existIcon:r,className:n,style:a,mount:c}=i,l=!!t;return r?we.createElement(SS,{prefixCls:e,className:n,style:a}):we.createElement(vv,{visible:l,motionName:`${e}-loading-icon-motion`,motionAppear:!c,motionEnter:!c,motionLeave:!c,removeOnLeave:!0,onAppearStart:lm,onAppearActive:um,onEnterStart:lm,onEnterActive:um,onLeaveStart:um,onLeaveActive:lm},({className:d,style:u},f)=>{const p=Object.assign(Object.assign({},a),u);return we.createElement(SS,{prefixCls:e,className:tt(n,d),style:p,ref:f})})},ES=(i,e)=>({[`> span, > ${i}`]:{"&:not(:last-child)":{[`&, & > ${i}`]:{"&:not(:disabled)":{borderInlineEndColor:e}}},"&:not(:first-child)":{[`&, & > ${i}`]:{"&:not(:disabled)":{borderInlineStartColor:e}}}}}),IP=i=>{const{componentCls:e,fontSize:t,lineWidth:r,groupBorderColor:n,colorErrorHover:a}=i;return{[`${e}-group`]:[{position:"relative",display:"inline-flex",[`> span, > ${e}`]:{"&:not(:last-child)":{[`&, & > ${e}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},"&:not(:first-child)":{marginInlineStart:i.calc(r).mul(-1).equal(),[`&, & > ${e}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}},[e]:{position:"relative",zIndex:1,"&:hover, &:focus, &:active":{zIndex:2},"&[disabled]":{zIndex:0}},[`${e}-icon-only`]:{fontSize:t}},ES(`${e}-primary`,n),ES(`${e}-danger`,a)]}};var PP=["b"],kP=["v"],dm=function(e){return Math.round(Number(e||0))},MP=function(e){if(e instanceof Qt)return e;if(e&&Xe(e)==="object"&&"h"in e&&"b"in e){var t=e,r=t.b,n=ti(t,PP);return ue(ue({},n),{},{v:r})}return typeof e=="string"&&/hsb/.test(e)?e.replace(/hsb/,"hsv"):e},Tl=function(i){Cs(t,i);var e=As(t);function t(r){return Mr(this,t),e.call(this,MP(r))}return Nr(t,[{key:"toHsbString",value:function(){var n=this.toHsb(),a=dm(n.s*100),c=dm(n.b*100),l=dm(n.h),d=n.a,u="hsb(".concat(l,", ").concat(a,"%, ").concat(c,"%)"),f="hsba(".concat(l,", ").concat(a,"%, ").concat(c,"%, ").concat(d.toFixed(d===0?0:2),")");return d===1?u:f}},{key:"toHsb",value:function(){var n=this.toHsv(),a=n.v,c=ti(n,kP);return ue(ue({},c),{},{b:a,a:this.a})}}]),t}(Qt),NP=function(e){return e instanceof Tl?e:new Tl(e)};NP("#1677ff");const BP=(i,e)=>(i==null?void 0:i.replace(/[^\w/]/g,"").slice(0,e?8:6))||"",FP=(i,e)=>i?BP(i,e):"";let UP=function(){function i(e){Mr(this,i);var t;if(this.cleared=!1,e instanceof i){this.metaColor=e.metaColor.clone(),this.colors=(t=e.colors)===null||t===void 0?void 0:t.map(n=>({color:new i(n.color),percent:n.percent})),this.cleared=e.cleared;return}const r=Array.isArray(e);r&&e.length?(this.colors=e.map(({color:n,percent:a})=>({color:new i(n),percent:a})),this.metaColor=new Tl(this.colors[0].color.metaColor)):this.metaColor=new Tl(r?"":e),(!e||r&&!this.colors)&&(this.metaColor=this.metaColor.setA(0),this.cleared=!0)}return Nr(i,[{key:"toHsb",value:function(){return this.metaColor.toHsb()}},{key:"toHsbString",value:function(){return this.metaColor.toHsbString()}},{key:"toHex",value:function(){return FP(this.toHexString(),this.metaColor.a<1)}},{key:"toHexString",value:function(){return this.metaColor.toHexString()}},{key:"toRgb",value:function(){return this.metaColor.toRgb()}},{key:"toRgbString",value:function(){return this.metaColor.toRgbString()}},{key:"isGradient",value:function(){return!!this.colors&&!this.cleared}},{key:"getColors",value:function(){return this.colors||[{color:this,percent:0}]}},{key:"toCssString",value:function(){const{colors:t}=this;return t?`linear-gradient(90deg, ${t.map(n=>`${n.color.toRgbString()} ${n.percent}%`).join(", ")})`:this.metaColor.toRgbString()}},{key:"equals",value:function(t){return!t||this.isGradient()!==t.isGradient()?!1:this.isGradient()?this.colors.length===t.colors.length&&this.colors.every((r,n)=>{const a=t.colors[n];return r.percent===a.percent&&r.color.equals(a.color)}):this.toHexString()===t.toHexString()}}])}();const $P=(i,e)=>{const{r:t,g:r,b:n,a}=i.toRgb(),c=new Tl(i.toRgbString()).onBackground(e).toHsv();return a<=.5?c.v>.5:t*.299+r*.587+n*.114>192},zw=i=>{const{paddingInline:e,onlyIconSize:t}=i;return Ui(i,{buttonPaddingHorizontal:e,buttonPaddingVertical:0,buttonIconOnlyFontSize:t})},Gw=i=>{var e,t,r,n,a,c;const l=(e=i.contentFontSize)!==null&&e!==void 0?e:i.fontSize,d=(t=i.contentFontSizeSM)!==null&&t!==void 0?t:i.fontSize,u=(r=i.contentFontSizeLG)!==null&&r!==void 0?r:i.fontSizeLG,f=(n=i.contentLineHeight)!==null&&n!==void 0?n:Md(l),p=(a=i.contentLineHeightSM)!==null&&a!==void 0?a:Md(d),v=(c=i.contentLineHeightLG)!==null&&c!==void 0?c:Md(u),E=$P(new UP(i.colorBgSolid),"#fff")?"#000":"#fff",g=mv.reduce((_,m)=>Object.assign(Object.assign({},_),{[`${m}ShadowColor`]:`0 ${Bt(i.controlOutlineWidth)} 0 ${cl(i[`${m}1`],i.colorBgContainer)}`}),{});return Object.assign(Object.assign({},g),{fontWeight:400,defaultShadow:`0 ${i.controlOutlineWidth}px 0 ${i.controlTmpOutline}`,primaryShadow:`0 ${i.controlOutlineWidth}px 0 ${i.controlOutline}`,dangerShadow:`0 ${i.controlOutlineWidth}px 0 ${i.colorErrorOutline}`,primaryColor:i.colorTextLightSolid,dangerColor:i.colorTextLightSolid,borderColorDisabled:i.colorBorder,defaultGhostColor:i.colorBgContainer,ghostBg:"transparent",defaultGhostBorderColor:i.colorBgContainer,paddingInline:i.paddingContentHorizontal-i.lineWidth,paddingInlineLG:i.paddingContentHorizontal-i.lineWidth,paddingInlineSM:8-i.lineWidth,onlyIconSize:"inherit",onlyIconSizeSM:"inherit",onlyIconSizeLG:"inherit",groupBorderColor:i.colorPrimaryHover,linkHoverBg:"transparent",textTextColor:i.colorText,textTextHoverColor:i.colorText,textTextActiveColor:i.colorText,textHoverBg:i.colorFillTertiary,defaultColor:i.colorText,defaultBg:i.colorBgContainer,defaultBorderColor:i.colorBorder,defaultBorderColorDisabled:i.colorBorder,defaultHoverBg:i.colorBgContainer,defaultHoverColor:i.colorPrimaryHover,defaultHoverBorderColor:i.colorPrimaryHover,defaultActiveBg:i.colorBgContainer,defaultActiveColor:i.colorPrimaryActive,defaultActiveBorderColor:i.colorPrimaryActive,solidTextColor:E,contentFontSize:l,contentFontSizeSM:d,contentFontSizeLG:u,contentLineHeight:f,contentLineHeightSM:p,contentLineHeightLG:v,paddingBlock:Math.max((i.controlHeight-l*f)/2-i.lineWidth,0),paddingBlockSM:Math.max((i.controlHeightSM-d*p)/2-i.lineWidth,0),paddingBlockLG:Math.max((i.controlHeightLG-u*v)/2-i.lineWidth,0)})},jP=i=>{const{componentCls:e,iconCls:t,fontWeight:r,opacityLoading:n,motionDurationSlow:a,motionEaseInOut:c,marginXS:l,calc:d}=i;return{[e]:{outline:"none",position:"relative",display:"inline-flex",gap:i.marginXS,alignItems:"center",justifyContent:"center",fontWeight:r,whiteSpace:"nowrap",textAlign:"center",backgroundImage:"none",background:"transparent",border:`${Bt(i.lineWidth)} ${i.lineType} transparent`,cursor:"pointer",transition:`all ${i.motionDurationMid} ${i.motionEaseInOut}`,userSelect:"none",touchAction:"manipulation",color:i.colorText,"&:disabled > *":{pointerEvents:"none"},[`${e}-icon > svg`]:bw(),"> a":{color:"currentColor"},"&:not(:disabled)":XO(i),[`&${e}-two-chinese-chars::first-letter`]:{letterSpacing:"0.34em"},[`&${e}-two-chinese-chars > *:not(${t})`]:{marginInlineEnd:"-0.34em",letterSpacing:"0.34em"},[`&${e}-icon-only`]:{paddingInline:0,[`&${e}-compact-item`]:{flex:"none"},[`&${e}-round`]:{width:"auto"}},[`&${e}-loading`]:{opacity:n,cursor:"default"},[`${e}-loading-icon`]:{transition:["width","opacity","margin"].map(u=>`${u} ${a} ${c}`).join(",")},[`&:not(${e}-icon-end)`]:{[`${e}-loading-icon-motion`]:{"&-appear-start, &-enter-start":{marginInlineEnd:d(l).mul(-1).equal()},"&-appear-active, &-enter-active":{marginInlineEnd:0},"&-leave-start":{marginInlineEnd:0},"&-leave-active":{marginInlineEnd:d(l).mul(-1).equal()}}},"&-icon-end":{flexDirection:"row-reverse",[`${e}-loading-icon-motion`]:{"&-appear-start, &-enter-start":{marginInlineStart:d(l).mul(-1).equal()},"&-appear-active, &-enter-active":{marginInlineStart:0},"&-leave-start":{marginInlineStart:0},"&-leave-active":{marginInlineStart:d(l).mul(-1).equal()}}}}}},Hw=(i,e,t)=>({[`&:not(:disabled):not(${i}-disabled)`]:{"&:hover":e,"&:active":t}}),zP=i=>({minWidth:i.controlHeight,paddingInlineStart:0,paddingInlineEnd:0,borderRadius:"50%"}),GP=i=>({borderRadius:i.controlHeight,paddingInlineStart:i.calc(i.controlHeight).div(2).equal(),paddingInlineEnd:i.calc(i.controlHeight).div(2).equal()}),HP=i=>({cursor:"not-allowed",borderColor:i.borderColorDisabled,color:i.colorTextDisabled,background:i.colorBgContainerDisabled,boxShadow:"none"}),_f=(i,e,t,r,n,a,c,l)=>({[`&${i}-background-ghost`]:Object.assign(Object.assign({color:t||void 0,background:e,borderColor:r||void 0,boxShadow:"none"},Hw(i,Object.assign({background:e},c),Object.assign({background:e},l))),{"&:disabled":{cursor:"not-allowed",color:n||void 0,borderColor:a||void 0}})}),VP=i=>({[`&:disabled, &${i.componentCls}-disabled`]:Object.assign({},HP(i))}),KP=i=>({[`&:disabled, &${i.componentCls}-disabled`]:{cursor:"not-allowed",color:i.colorTextDisabled}}),Sf=(i,e,t,r)=>{const a=r&&["link","text"].includes(r)?KP:VP;return Object.assign(Object.assign({},a(i)),Hw(i.componentCls,e,t))},Ef=(i,e,t,r,n)=>({[`&${i.componentCls}-variant-solid`]:Object.assign({color:e,background:t},Sf(i,r,n))}),Rf=(i,e,t,r,n)=>({[`&${i.componentCls}-variant-outlined, &${i.componentCls}-variant-dashed`]:Object.assign({borderColor:e,background:t},Sf(i,r,n))}),wf=i=>({[`&${i.componentCls}-variant-dashed`]:{borderStyle:"dashed"}}),Tf=(i,e,t,r)=>({[`&${i.componentCls}-variant-filled`]:Object.assign({boxShadow:"none",background:e},Sf(i,t,r))}),bn=(i,e,t,r,n)=>({[`&${i.componentCls}-variant-${t}`]:Object.assign({color:e,boxShadow:"none"},Sf(i,r,n,t))}),qP=i=>{const{componentCls:e}=i;return mv.reduce((t,r)=>{const n=i[`${r}6`],a=i[`${r}1`],c=i[`${r}5`],l=i[`${r}2`],d=i[`${r}3`],u=i[`${r}7`];return Object.assign(Object.assign({},t),{[`&${e}-color-${r}`]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:n,boxShadow:i[`${r}ShadowColor`]},Ef(i,i.colorTextLightSolid,n,{background:c},{background:u})),Rf(i,n,i.colorBgContainer,{color:c,borderColor:c,background:i.colorBgContainer},{color:u,borderColor:u,background:i.colorBgContainer})),wf(i)),Tf(i,a,{background:l},{background:d})),bn(i,n,"link",{color:c},{color:u})),bn(i,n,"text",{color:c,background:a},{color:u,background:d}))})},{})},YP=i=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:i.defaultColor,boxShadow:i.defaultShadow},Ef(i,i.solidTextColor,i.colorBgSolid,{color:i.solidTextColor,background:i.colorBgSolidHover},{color:i.solidTextColor,background:i.colorBgSolidActive})),wf(i)),Tf(i,i.colorFillTertiary,{background:i.colorFillSecondary},{background:i.colorFill})),_f(i.componentCls,i.ghostBg,i.defaultGhostColor,i.defaultGhostBorderColor,i.colorTextDisabled,i.colorBorder)),bn(i,i.textTextColor,"link",{color:i.colorLinkHover,background:i.linkHoverBg},{color:i.colorLinkActive})),WP=i=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:i.colorPrimary,boxShadow:i.primaryShadow},Rf(i,i.colorPrimary,i.colorBgContainer,{color:i.colorPrimaryTextHover,borderColor:i.colorPrimaryHover,background:i.colorBgContainer},{color:i.colorPrimaryTextActive,borderColor:i.colorPrimaryActive,background:i.colorBgContainer})),wf(i)),Tf(i,i.colorPrimaryBg,{background:i.colorPrimaryBgHover},{background:i.colorPrimaryBorder})),bn(i,i.colorPrimaryText,"text",{color:i.colorPrimaryTextHover,background:i.colorPrimaryBg},{color:i.colorPrimaryTextActive,background:i.colorPrimaryBorder})),bn(i,i.colorPrimaryText,"link",{color:i.colorPrimaryTextHover,background:i.linkHoverBg},{color:i.colorPrimaryTextActive})),_f(i.componentCls,i.ghostBg,i.colorPrimary,i.colorPrimary,i.colorTextDisabled,i.colorBorder,{color:i.colorPrimaryHover,borderColor:i.colorPrimaryHover},{color:i.colorPrimaryActive,borderColor:i.colorPrimaryActive})),XP=i=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:i.colorError,boxShadow:i.dangerShadow},Ef(i,i.dangerColor,i.colorError,{background:i.colorErrorHover},{background:i.colorErrorActive})),Rf(i,i.colorError,i.colorBgContainer,{color:i.colorErrorHover,borderColor:i.colorErrorBorderHover},{color:i.colorErrorActive,borderColor:i.colorErrorActive})),wf(i)),Tf(i,i.colorErrorBg,{background:i.colorErrorBgFilledHover},{background:i.colorErrorBgActive})),bn(i,i.colorError,"text",{color:i.colorErrorHover,background:i.colorErrorBg},{color:i.colorErrorHover,background:i.colorErrorBgActive})),bn(i,i.colorError,"link",{color:i.colorErrorHover},{color:i.colorErrorActive})),_f(i.componentCls,i.ghostBg,i.colorError,i.colorError,i.colorTextDisabled,i.colorBorder,{color:i.colorErrorHover,borderColor:i.colorErrorHover},{color:i.colorErrorActive,borderColor:i.colorErrorActive})),QP=i=>Object.assign(Object.assign({},bn(i,i.colorLink,"link",{color:i.colorLinkHover},{color:i.colorLinkActive})),_f(i.componentCls,i.ghostBg,i.colorInfo,i.colorInfo,i.colorTextDisabled,i.colorBorder,{color:i.colorInfoHover,borderColor:i.colorInfoHover},{color:i.colorInfoActive,borderColor:i.colorInfoActive})),ZP=i=>{const{componentCls:e}=i;return Object.assign({[`${e}-color-default`]:YP(i),[`${e}-color-primary`]:WP(i),[`${e}-color-dangerous`]:XP(i),[`${e}-color-link`]:QP(i)},qP(i))},JP=i=>Object.assign(Object.assign(Object.assign(Object.assign({},Rf(i,i.defaultBorderColor,i.defaultBg,{color:i.defaultHoverColor,borderColor:i.defaultHoverBorderColor,background:i.defaultHoverBg},{color:i.defaultActiveColor,borderColor:i.defaultActiveBorderColor,background:i.defaultActiveBg})),bn(i,i.textTextColor,"text",{color:i.textTextHoverColor,background:i.textHoverBg},{color:i.textTextActiveColor,background:i.colorBgTextActive})),Ef(i,i.primaryColor,i.colorPrimary,{background:i.colorPrimaryHover,color:i.primaryColor},{background:i.colorPrimaryActive,color:i.primaryColor})),bn(i,i.colorLink,"link",{color:i.colorLinkHover,background:i.linkHoverBg},{color:i.colorLinkActive})),_v=(i,e="")=>{const{componentCls:t,controlHeight:r,fontSize:n,borderRadius:a,buttonPaddingHorizontal:c,iconCls:l,buttonPaddingVertical:d,buttonIconOnlyFontSize:u}=i;return[{[e]:{fontSize:n,height:r,padding:`${Bt(d)} ${Bt(c)}`,borderRadius:a,[`&${t}-icon-only`]:{width:r,[l]:{fontSize:u}}}},{[`${t}${t}-circle${e}`]:zP(i)},{[`${t}${t}-round${e}`]:GP(i)}]},ek=i=>{const e=Ui(i,{fontSize:i.contentFontSize});return _v(e,i.componentCls)},tk=i=>{const e=Ui(i,{controlHeight:i.controlHeightSM,fontSize:i.contentFontSizeSM,padding:i.paddingXS,buttonPaddingHorizontal:i.paddingInlineSM,buttonPaddingVertical:0,borderRadius:i.borderRadiusSM,buttonIconOnlyFontSize:i.onlyIconSizeSM});return _v(e,`${i.componentCls}-sm`)},rk=i=>{const e=Ui(i,{controlHeight:i.controlHeightLG,fontSize:i.contentFontSizeLG,buttonPaddingHorizontal:i.paddingInlineLG,buttonPaddingVertical:0,borderRadius:i.borderRadiusLG,buttonIconOnlyFontSize:i.onlyIconSizeLG});return _v(e,`${i.componentCls}-lg`)},ik=i=>{const{componentCls:e}=i;return{[e]:{[`&${e}-block`]:{width:"100%"}}}},nk=Ol("Button",i=>{const e=zw(i);return[jP(e),ek(e),tk(e),rk(e),ik(e),ZP(e),JP(e),IP(e)]},Gw,{unitless:{fontWeight:!0,contentLineHeight:!0,contentLineHeightSM:!0,contentLineHeightLG:!0}});function sk(i,e,t){const{focusElCls:r,focus:n,borderElCls:a}=t,c=a?"> *":"",l=["hover",n?"focus":null,"active"].filter(Boolean).map(d=>`&:${d} ${c}`).join(",");return{[`&-item:not(${e}-last-item)`]:{marginInlineEnd:i.calc(i.lineWidth).mul(-1).equal()},"&-item":Object.assign(Object.assign({[l]:{zIndex:2}},r?{[`&${r}`]:{zIndex:2}}:{}),{[`&[disabled] ${c}`]:{zIndex:0}})}}function ak(i,e,t){const{borderElCls:r}=t,n=r?`> ${r}`:"";return{[`&-item:not(${e}-first-item):not(${e}-last-item) ${n}`]:{borderRadius:0},[`&-item:not(${e}-last-item)${e}-first-item`]:{[`& ${n}, &${i}-sm ${n}, &${i}-lg ${n}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&-item:not(${e}-first-item)${e}-last-item`]:{[`& ${n}, &${i}-sm ${n}, &${i}-lg ${n}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}}}function Vw(i,e={focus:!0}){const{componentCls:t}=i,r=`${t}-compact`;return{[r]:Object.assign(Object.assign({},sk(i,r,e)),ak(t,r,e))}}function ok(i,e){return{[`&-item:not(${e}-last-item)`]:{marginBottom:i.calc(i.lineWidth).mul(-1).equal()},"&-item":{"&:hover,&:focus,&:active":{zIndex:2},"&[disabled]":{zIndex:0}}}}function ck(i,e){return{[`&-item:not(${e}-first-item):not(${e}-last-item)`]:{borderRadius:0},[`&-item${e}-first-item:not(${e}-last-item)`]:{[`&, &${i}-sm, &${i}-lg`]:{borderEndEndRadius:0,borderEndStartRadius:0}},[`&-item${e}-last-item:not(${e}-first-item)`]:{[`&, &${i}-sm, &${i}-lg`]:{borderStartStartRadius:0,borderStartEndRadius:0}}}}function lk(i){const e=`${i.componentCls}-compact-vertical`;return{[e]:Object.assign(Object.assign({},ok(i,e)),ck(i.componentCls,e))}}const uk=i=>{const{componentCls:e,colorPrimaryHover:t,lineWidth:r,calc:n}=i,a=n(r).mul(-1).equal(),c=l=>{const d=`${e}-compact${l?"-vertical":""}-item${e}-primary:not([disabled])`;return{[`${d} + ${d}::before`]:{position:"absolute",top:l?a:0,insetInlineStart:l?0:a,backgroundColor:t,content:'""',width:l?"100%":r,height:l?r:"100%"}}};return Object.assign(Object.assign({},c()),c(!0))},dk=ZO(["Button","compact"],i=>{const e=zw(i);return[Vw(e),lk(e),uk(e)]},Gw);var fk=function(i,e){var t={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(i);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(i,r[n])&&(t[r[n]]=i[r[n]]);return t};function hk(i){if(typeof i=="object"&&i){let e=i==null?void 0:i.delay;return e=!Number.isNaN(e)&&typeof e=="number"?e:0,{loading:e<=0,delay:e}}return{loading:!!i,delay:0}}const pk={default:["default","outlined"],primary:["primary","solid"],dashed:["default","dashed"],link:["link","link"],text:["default","text"]},mk=we.forwardRef((i,e)=>{var t,r;const{loading:n=!1,prefixCls:a,color:c,variant:l,type:d,danger:u=!1,shape:f="default",size:p,styles:v,disabled:E,className:g,rootClassName:_,children:m,icon:y,iconPosition:b="start",ghost:R=!1,block:T=!1,htmlType:w="button",classNames:C,style:A={},autoInsertSpace:L,autoFocus:D}=i,P=fk(i,["loading","prefixCls","color","variant","type","danger","shape","size","styles","disabled","className","rootClassName","children","icon","iconPosition","ghost","block","htmlType","classNames","style","autoInsertSpace","autoFocus"]),k=d||"default",{button:M}=we.useContext(kr),[I,F]=H.useMemo(()=>{if(c&&l)return[c,l];if(d||u){const Qe=pk[k]||[];return u?["danger",Qe[1]]:Qe}return M!=null&&M.color&&(M!=null&&M.variant)?[M.color,M.variant]:["default","outlined"]},[d,c,l,u,M==null?void 0:M.variant,M==null?void 0:M.color]),N=I==="danger"?"dangerous":I,{getPrefixCls:U,direction:V,autoInsertSpace:J,className:j,style:q,classNames:Z,styles:X}=hv("button"),Y=(t=L??J)!==null&&t!==void 0?t:!0,re=U("btn",a),[oe,ve,be]=nk(re),Oe=H.useContext(pa),Pe=E??Oe,Se=H.useContext(jw),Te=H.useMemo(()=>hk(n),[n]),[ge,Ue]=H.useState(Te.loading),[je,Ie]=H.useState(!1),De=H.useRef(null),ze=TR(e,De),ut=H.Children.count(m)===1&&!y&&!cm(F),Ft=H.useRef(!0);we.useEffect(()=>(Ft.current=!1,()=>{Ft.current=!0}),[]),H.useLayoutEffect(()=>{let Qe=null;Te.delay>0?Qe=setTimeout(()=>{Qe=null,Ue(!0)},Te.delay):Ue(Te.loading);function Tt(){Qe&&(clearTimeout(Qe),Qe=null)}return Tt},[Te.delay,Te.loading]),H.useEffect(()=>{if(!De.current||!Y)return;const Qe=De.current.textContent||"";ut&&Ag(Qe)?je||Ie(!0):je&&Ie(!1)}),H.useEffect(()=>{D&&De.current&&De.current.focus()},[]);const rt=we.useCallback(Qe=>{var Tt;if(ge||Pe){Qe.preventDefault();return}(Tt=i.onClick)===null||Tt===void 0||Tt.call(i,("href"in i,Qe))},[i.onClick,ge,Pe]),{compactSize:et,compactItemClassnames:$e}=bf(re,V),Ge={large:"lg",small:"sm",middle:void 0},ft=kl(Qe=>{var Tt,pr;return(pr=(Tt=p??et)!==null&&Tt!==void 0?Tt:Se)!==null&&pr!==void 0?pr:Qe}),Wt=ft&&(r=Ge[ft])!==null&&r!==void 0?r:"",_t=ge?"loading":y,Ze=bv(P,["navigate"]),Et=tt(re,ve,be,{[`${re}-${f}`]:f!=="default"&&f,[`${re}-${k}`]:k,[`${re}-dangerous`]:u,[`${re}-color-${N}`]:N,[`${re}-variant-${F}`]:F,[`${re}-${Wt}`]:Wt,[`${re}-icon-only`]:!m&&m!==0&&!!_t,[`${re}-background-ghost`]:R&&!cm(F),[`${re}-loading`]:ge,[`${re}-two-chinese-chars`]:je&&Y&&!ge,[`${re}-block`]:T,[`${re}-rtl`]:V==="rtl",[`${re}-icon-end`]:b==="end"},$e,g,_,j),le=Object.assign(Object.assign({},q),A),pe=tt(C==null?void 0:C.icon,Z.icon),_e=Object.assign(Object.assign({},(v==null?void 0:v.icon)||{}),X.icon||{}),Ce=y&&!ge?we.createElement(xg,{prefixCls:re,className:pe,style:_e},y):n&&typeof n=="object"&&n.icon?we.createElement(xg,{prefixCls:re,className:pe,style:_e},n.icon):we.createElement(OP,{existIcon:!!y,prefixCls:re,loading:ge,mount:Ft.current}),Ee=m||m===0?LP(m,ut&&Y):null;if(Ze.href!==void 0)return oe(we.createElement("a",Object.assign({},Ze,{className:tt(Et,{[`${re}-disabled`]:Pe}),href:Pe?void 0:Ze.href,style:le,onClick:rt,ref:ze,tabIndex:Pe?-1:0}),Ce,Ee));let ke=we.createElement("button",Object.assign({},P,{type:w,className:Et,style:le,onClick:rt,disabled:Pe,ref:ze}),Ce,Ee,$e&&we.createElement(dk,{prefixCls:re}));return cm(F)||(ke=we.createElement(TP,{component:"Button",disabled:ge},ke)),oe(ke)}),Cf=mk;Cf.Group=xP;Cf.__ANT_BUTTON=!0;var la="RC_FORM_INTERNAL_HOOKS",Mt=function(){bi(!1,"Can not find FormContext. Please make sure you wrap Field under Form.")},To=H.createContext({getFieldValue:Mt,getFieldsValue:Mt,getFieldError:Mt,getFieldWarning:Mt,getFieldsError:Mt,isFieldsTouched:Mt,isFieldTouched:Mt,isFieldValidating:Mt,isFieldsValidating:Mt,resetFields:Mt,setFields:Mt,setFieldValue:Mt,setFieldsValue:Mt,validateFields:Mt,submit:Mt,getInternalHooks:function(){return Mt(),{dispatch:Mt,initEntityValue:Mt,registerField:Mt,useSubscribe:Mt,setInitialValues:Mt,destroyForm:Mt,setCallbacks:Mt,registerWatch:Mt,getFields:Mt,setValidateMessages:Mt,setPreserve:Mt,getInitialValue:Mt}}}),Zd=H.createContext(null);function Dg(i){return i==null?[]:Array.isArray(i)?i:[i]}function gk(i){return i&&!!i._init}function Lg(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var e=JSON.parse(JSON.stringify(this));return e.clone=this.clone,e}}}var Og=Lg();function vk(i){try{return Function.toString.call(i).indexOf("[native code]")!==-1}catch{return typeof i=="function"}}function yk(i,e,t){if(iv())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var n=new(i.bind.apply(i,r));return t&&yl(n,t.prototype),n}function Ig(i){var e=typeof Map=="function"?new Map:void 0;return Ig=function(r){if(r===null||!vk(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(r))return e.get(r);e.set(r,n)}function n(){return yk(r,arguments,bl(this).constructor)}return n.prototype=Object.create(r.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),yl(n,r)},Ig(i)}var bk=/%[sdj%]/g,_k=function(){};function Pg(i){if(!i||!i.length)return null;var e={};return i.forEach(function(t){var r=t.field;e[r]=e[r]||[],e[r].push(t)}),e}function yi(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];var n=0,a=t.length;if(typeof i=="function")return i.apply(null,t);if(typeof i=="string"){var c=i.replace(bk,function(l){if(l==="%%")return"%";if(n>=a)return l;switch(l){case"%s":return String(t[n++]);case"%d":return Number(t[n++]);case"%j":try{return JSON.stringify(t[n++])}catch{return"[Circular]"}break;default:return l}});return c}return i}function Sk(i){return i==="string"||i==="url"||i==="hex"||i==="email"||i==="date"||i==="pattern"}function yr(i,e){return!!(i==null||e==="array"&&Array.isArray(i)&&!i.length||Sk(e)&&typeof i=="string"&&!i)}function Ek(i,e,t){var r=[],n=0,a=i.length;function c(l){r.push.apply(r,Ye(l||[])),n++,n===a&&t(r)}i.forEach(function(l){e(l,c)})}function RS(i,e,t){var r=0,n=i.length;function a(c){if(c&&c.length){t(c);return}var l=r;r=r+1,l<n?e(i[l],a):t([])}a([])}function Rk(i){var e=[];return Object.keys(i).forEach(function(t){e.push.apply(e,Ye(i[t]||[]))}),e}var wS=function(i){Cs(t,i);var e=As(t);function t(r,n){var a;return Mr(this,t),a=e.call(this,"Async Validation Error"),ie(lt(a),"errors",void 0),ie(lt(a),"fields",void 0),a.errors=r,a.fields=n,a}return Nr(t)}(Ig(Error));function wk(i,e,t,r,n){if(e.first){var a=new Promise(function(v,E){var g=function(y){return r(y),y.length?E(new wS(y,Pg(y))):v(n)},_=Rk(i);RS(_,t,g)});return a.catch(function(v){return v}),a}var c=e.firstFields===!0?Object.keys(i):e.firstFields||[],l=Object.keys(i),d=l.length,u=0,f=[],p=new Promise(function(v,E){var g=function(m){if(f.push.apply(f,m),u++,u===d)return r(f),f.length?E(new wS(f,Pg(f))):v(n)};l.length||(r(f),v(n)),l.forEach(function(_){var m=i[_];c.indexOf(_)!==-1?RS(m,t,g):Ek(m,t,g)})});return p.catch(function(v){return v}),p}function Tk(i){return!!(i&&i.message!==void 0)}function Ck(i,e){for(var t=i,r=0;r<e.length;r++){if(t==null)return t;t=t[e[r]]}return t}function TS(i,e){return function(t){var r;return i.fullFields?r=Ck(e,i.fullFields):r=e[t.field||i.fullField],Tk(t)?(t.field=t.field||i.fullField,t.fieldValue=r,t):{message:typeof t=="function"?t():t,fieldValue:r,field:t.field||i.fullField}}}function CS(i,e){if(e){for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];Xe(r)==="object"&&Xe(i[t])==="object"?i[t]=ue(ue({},i[t]),r):i[t]=r}}return i}var eo="enum",Ak=function(e,t,r,n,a){e[eo]=Array.isArray(e[eo])?e[eo]:[],e[eo].indexOf(t)===-1&&n.push(yi(a.messages[eo],e.fullField,e[eo].join(", ")))},xk=function(e,t,r,n,a){if(e.pattern){if(e.pattern instanceof RegExp)e.pattern.lastIndex=0,e.pattern.test(t)||n.push(yi(a.messages.pattern.mismatch,e.fullField,t,e.pattern));else if(typeof e.pattern=="string"){var c=new RegExp(e.pattern);c.test(t)||n.push(yi(a.messages.pattern.mismatch,e.fullField,t,e.pattern))}}},Dk=function(e,t,r,n,a){var c=typeof e.len=="number",l=typeof e.min=="number",d=typeof e.max=="number",u=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,f=t,p=null,v=typeof t=="number",E=typeof t=="string",g=Array.isArray(t);if(v?p="number":E?p="string":g&&(p="array"),!p)return!1;g&&(f=t.length),E&&(f=t.replace(u,"_").length),c?f!==e.len&&n.push(yi(a.messages[p].len,e.fullField,e.len)):l&&!d&&f<e.min?n.push(yi(a.messages[p].min,e.fullField,e.min)):d&&!l&&f>e.max?n.push(yi(a.messages[p].max,e.fullField,e.max)):l&&d&&(f<e.min||f>e.max)&&n.push(yi(a.messages[p].range,e.fullField,e.min,e.max))},Kw=function(e,t,r,n,a,c){e.required&&(!r.hasOwnProperty(e.field)||yr(t,c||e.type))&&n.push(yi(a.messages.required,e.fullField))},Qu;const Lk=function(){if(Qu)return Qu;var i="[a-fA-F\\d:]",e=function(C){return C&&C.includeBoundaries?"(?:(?<=\\s|^)(?=".concat(i,")|(?<=").concat(i,")(?=\\s|$))"):""},t="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",r="[a-fA-F\\d]{1,4}",n=["(?:".concat(r,":){7}(?:").concat(r,"|:)"),"(?:".concat(r,":){6}(?:").concat(t,"|:").concat(r,"|:)"),"(?:".concat(r,":){5}(?::").concat(t,"|(?::").concat(r,"){1,2}|:)"),"(?:".concat(r,":){4}(?:(?::").concat(r,"){0,1}:").concat(t,"|(?::").concat(r,"){1,3}|:)"),"(?:".concat(r,":){3}(?:(?::").concat(r,"){0,2}:").concat(t,"|(?::").concat(r,"){1,4}|:)"),"(?:".concat(r,":){2}(?:(?::").concat(r,"){0,3}:").concat(t,"|(?::").concat(r,"){1,5}|:)"),"(?:".concat(r,":){1}(?:(?::").concat(r,"){0,4}:").concat(t,"|(?::").concat(r,"){1,6}|:)"),"(?::(?:(?::".concat(r,"){0,5}:").concat(t,"|(?::").concat(r,"){1,7}|:))")],a="(?:%[0-9a-zA-Z]{1,})?",c="(?:".concat(n.join("|"),")").concat(a),l=new RegExp("(?:^".concat(t,"$)|(?:^").concat(c,"$)")),d=new RegExp("^".concat(t,"$")),u=new RegExp("^".concat(c,"$")),f=function(C){return C&&C.exact?l:new RegExp("(?:".concat(e(C)).concat(t).concat(e(C),")|(?:").concat(e(C)).concat(c).concat(e(C),")"),"g")};f.v4=function(w){return w&&w.exact?d:new RegExp("".concat(e(w)).concat(t).concat(e(w)),"g")},f.v6=function(w){return w&&w.exact?u:new RegExp("".concat(e(w)).concat(c).concat(e(w)),"g")};var p="(?:(?:[a-z]+:)?//)",v="(?:\\S+(?::\\S*)?@)?",E=f.v4().source,g=f.v6().source,_="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",m="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",y="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",b="(?::\\d{2,5})?",R='(?:[/?#][^\\s"]*)?',T="(?:".concat(p,"|www\\.)").concat(v,"(?:localhost|").concat(E,"|").concat(g,"|").concat(_).concat(m).concat(y,")").concat(b).concat(R);return Qu=new RegExp("(?:^".concat(T,"$)"),"i"),Qu};var AS={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},ll={integer:function(e){return ll.number(e)&&parseInt(e,10)===e},float:function(e){return ll.number(e)&&!ll.integer(e)},array:function(e){return Array.isArray(e)},regexp:function(e){if(e instanceof RegExp)return!0;try{return!!new RegExp(e)}catch{return!1}},date:function(e){return typeof e.getTime=="function"&&typeof e.getMonth=="function"&&typeof e.getYear=="function"&&!isNaN(e.getTime())},number:function(e){return isNaN(e)?!1:typeof e=="number"},object:function(e){return Xe(e)==="object"&&!ll.array(e)},method:function(e){return typeof e=="function"},email:function(e){return typeof e=="string"&&e.length<=320&&!!e.match(AS.email)},url:function(e){return typeof e=="string"&&e.length<=2048&&!!e.match(Lk())},hex:function(e){return typeof e=="string"&&!!e.match(AS.hex)}},Ok=function(e,t,r,n,a){if(e.required&&t===void 0){Kw(e,t,r,n,a);return}var c=["integer","float","array","regexp","object","method","email","number","date","url","hex"],l=e.type;c.indexOf(l)>-1?ll[l](t)||n.push(yi(a.messages.types[l],e.fullField,e.type)):l&&Xe(t)!==e.type&&n.push(yi(a.messages.types[l],e.fullField,e.type))},Ik=function(e,t,r,n,a){(/^\s+$/.test(t)||t==="")&&n.push(yi(a.messages.whitespace,e.fullField))};const vt={required:Kw,whitespace:Ik,type:Ok,range:Dk,enum:Ak,pattern:xk};var Pk=function(e,t,r,n,a){var c=[],l=e.required||!e.required&&n.hasOwnProperty(e.field);if(l){if(yr(t)&&!e.required)return r();vt.required(e,t,n,c,a)}r(c)},kk=function(e,t,r,n,a){var c=[],l=e.required||!e.required&&n.hasOwnProperty(e.field);if(l){if(t==null&&!e.required)return r();vt.required(e,t,n,c,a,"array"),t!=null&&(vt.type(e,t,n,c,a),vt.range(e,t,n,c,a))}r(c)},Mk=function(e,t,r,n,a){var c=[],l=e.required||!e.required&&n.hasOwnProperty(e.field);if(l){if(yr(t)&&!e.required)return r();vt.required(e,t,n,c,a),t!==void 0&&vt.type(e,t,n,c,a)}r(c)},Nk=function(e,t,r,n,a){var c=[],l=e.required||!e.required&&n.hasOwnProperty(e.field);if(l){if(yr(t,"date")&&!e.required)return r();if(vt.required(e,t,n,c,a),!yr(t,"date")){var d;t instanceof Date?d=t:d=new Date(t),vt.type(e,d,n,c,a),d&&vt.range(e,d.getTime(),n,c,a)}}r(c)},Bk="enum",Fk=function(e,t,r,n,a){var c=[],l=e.required||!e.required&&n.hasOwnProperty(e.field);if(l){if(yr(t)&&!e.required)return r();vt.required(e,t,n,c,a),t!==void 0&&vt[Bk](e,t,n,c,a)}r(c)},Uk=function(e,t,r,n,a){var c=[],l=e.required||!e.required&&n.hasOwnProperty(e.field);if(l){if(yr(t)&&!e.required)return r();vt.required(e,t,n,c,a),t!==void 0&&(vt.type(e,t,n,c,a),vt.range(e,t,n,c,a))}r(c)},$k=function(e,t,r,n,a){var c=[],l=e.required||!e.required&&n.hasOwnProperty(e.field);if(l){if(yr(t)&&!e.required)return r();vt.required(e,t,n,c,a),t!==void 0&&(vt.type(e,t,n,c,a),vt.range(e,t,n,c,a))}r(c)},jk=function(e,t,r,n,a){var c=[],l=e.required||!e.required&&n.hasOwnProperty(e.field);if(l){if(yr(t)&&!e.required)return r();vt.required(e,t,n,c,a),t!==void 0&&vt.type(e,t,n,c,a)}r(c)},zk=function(e,t,r,n,a){var c=[],l=e.required||!e.required&&n.hasOwnProperty(e.field);if(l){if(t===""&&(t=void 0),yr(t)&&!e.required)return r();vt.required(e,t,n,c,a),t!==void 0&&(vt.type(e,t,n,c,a),vt.range(e,t,n,c,a))}r(c)},Gk=function(e,t,r,n,a){var c=[],l=e.required||!e.required&&n.hasOwnProperty(e.field);if(l){if(yr(t)&&!e.required)return r();vt.required(e,t,n,c,a),t!==void 0&&vt.type(e,t,n,c,a)}r(c)},Hk=function(e,t,r,n,a){var c=[],l=e.required||!e.required&&n.hasOwnProperty(e.field);if(l){if(yr(t,"string")&&!e.required)return r();vt.required(e,t,n,c,a),yr(t,"string")||vt.pattern(e,t,n,c,a)}r(c)},Vk=function(e,t,r,n,a){var c=[],l=e.required||!e.required&&n.hasOwnProperty(e.field);if(l){if(yr(t)&&!e.required)return r();vt.required(e,t,n,c,a),yr(t)||vt.type(e,t,n,c,a)}r(c)},Kk=function(e,t,r,n,a){var c=[],l=Array.isArray(t)?"array":Xe(t);vt.required(e,t,n,c,a,l),r(c)},qk=function(e,t,r,n,a){var c=[],l=e.required||!e.required&&n.hasOwnProperty(e.field);if(l){if(yr(t,"string")&&!e.required)return r();vt.required(e,t,n,c,a,"string"),yr(t,"string")||(vt.type(e,t,n,c,a),vt.range(e,t,n,c,a),vt.pattern(e,t,n,c,a),e.whitespace===!0&&vt.whitespace(e,t,n,c,a))}r(c)},fm=function(e,t,r,n,a){var c=e.type,l=[],d=e.required||!e.required&&n.hasOwnProperty(e.field);if(d){if(yr(t,c)&&!e.required)return r();vt.required(e,t,n,l,a,c),yr(t,c)||vt.type(e,t,n,l,a)}r(l)};const pl={string:qk,method:jk,number:zk,boolean:Mk,regexp:Vk,integer:$k,float:Uk,array:kk,object:Gk,enum:Fk,pattern:Hk,date:Nk,url:fm,hex:fm,email:fm,required:Kk,any:Pk};var Ml=function(){function i(e){Mr(this,i),ie(this,"rules",null),ie(this,"_messages",Og),this.define(e)}return Nr(i,[{key:"define",value:function(t){var r=this;if(!t)throw new Error("Cannot configure a schema with no rules");if(Xe(t)!=="object"||Array.isArray(t))throw new Error("Rules must be an object");this.rules={},Object.keys(t).forEach(function(n){var a=t[n];r.rules[n]=Array.isArray(a)?a:[a]})}},{key:"messages",value:function(t){return t&&(this._messages=CS(Lg(),t)),this._messages}},{key:"validate",value:function(t){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){},c=t,l=n,d=a;if(typeof l=="function"&&(d=l,l={}),!this.rules||Object.keys(this.rules).length===0)return d&&d(null,c),Promise.resolve(c);function u(g){var _=[],m={};function y(R){if(Array.isArray(R)){var T;_=(T=_).concat.apply(T,Ye(R))}else _.push(R)}for(var b=0;b<g.length;b++)y(g[b]);_.length?(m=Pg(_),d(_,m)):d(null,c)}if(l.messages){var f=this.messages();f===Og&&(f=Lg()),CS(f,l.messages),l.messages=f}else l.messages=this.messages();var p={},v=l.keys||Object.keys(this.rules);v.forEach(function(g){var _=r.rules[g],m=c[g];_.forEach(function(y){var b=y;typeof b.transform=="function"&&(c===t&&(c=ue({},c)),m=c[g]=b.transform(m),m!=null&&(b.type=b.type||(Array.isArray(m)?"array":Xe(m)))),typeof b=="function"?b={validator:b}:b=ue({},b),b.validator=r.getValidationMethod(b),b.validator&&(b.field=g,b.fullField=b.fullField||g,b.type=r.getType(b),p[g]=p[g]||[],p[g].push({rule:b,value:m,source:c,field:g}))})});var E={};return wk(p,l,function(g,_){var m=g.rule,y=(m.type==="object"||m.type==="array")&&(Xe(m.fields)==="object"||Xe(m.defaultField)==="object");y=y&&(m.required||!m.required&&g.value),m.field=g.field;function b(A,L){return ue(ue({},L),{},{fullField:"".concat(m.fullField,".").concat(A),fullFields:m.fullFields?[].concat(Ye(m.fullFields),[A]):[A]})}function R(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],L=Array.isArray(A)?A:[A];!l.suppressWarning&&L.length&&i.warning("async-validator:",L),L.length&&m.message!==void 0&&(L=[].concat(m.message));var D=L.map(TS(m,c));if(l.first&&D.length)return E[m.field]=1,_(D);if(!y)_(D);else{if(m.required&&!g.value)return m.message!==void 0?D=[].concat(m.message).map(TS(m,c)):l.error&&(D=[l.error(m,yi(l.messages.required,m.field))]),_(D);var P={};m.defaultField&&Object.keys(g.value).map(function(I){P[I]=m.defaultField}),P=ue(ue({},P),g.rule.fields);var k={};Object.keys(P).forEach(function(I){var F=P[I],$=Array.isArray(F)?F:[F];k[I]=$.map(b.bind(null,I))});var M=new i(k);M.messages(l.messages),g.rule.options&&(g.rule.options.messages=l.messages,g.rule.options.error=l.error),M.validate(g.value,g.rule.options||l,function(I){var F=[];D&&D.length&&F.push.apply(F,Ye(D)),I&&I.length&&F.push.apply(F,Ye(I)),_(F.length?F:null)})}}var T;if(m.asyncValidator)T=m.asyncValidator(m,g.value,R,g.source,l);else if(m.validator){try{T=m.validator(m,g.value,R,g.source,l)}catch(A){var w,C;(w=(C=console).error)===null||w===void 0||w.call(C,A),l.suppressValidatorError||setTimeout(function(){throw A},0),R(A.message)}T===!0?R():T===!1?R(typeof m.message=="function"?m.message(m.fullField||m.field):m.message||"".concat(m.fullField||m.field," fails")):T instanceof Array?R(T):T instanceof Error&&R(T.message)}T&&T.then&&T.then(function(){return R()},function(A){return R(A)})},function(g){u(g)},c)}},{key:"getType",value:function(t){if(t.type===void 0&&t.pattern instanceof RegExp&&(t.type="pattern"),typeof t.validator!="function"&&t.type&&!pl.hasOwnProperty(t.type))throw new Error(yi("Unknown rule type %s",t.type));return t.type||"string"}},{key:"getValidationMethod",value:function(t){if(typeof t.validator=="function")return t.validator;var r=Object.keys(t),n=r.indexOf("message");return n!==-1&&r.splice(n,1),r.length===1&&r[0]==="required"?pl.required:pl[this.getType(t)]||void 0}}]),i}();ie(Ml,"register",function(e,t){if(typeof t!="function")throw new Error("Cannot register a validator by type, validator is not a function");pl[e]=t});ie(Ml,"warning",_k);ie(Ml,"messages",Og);ie(Ml,"validators",pl);var mi="'${name}' is not a valid ${type}",qw={default:"Validation error on field '${name}'",required:"'${name}' is required",enum:"'${name}' must be one of [${enum}]",whitespace:"'${name}' cannot be empty",date:{format:"'${name}' is invalid for format date",parse:"'${name}' could not be parsed as date",invalid:"'${name}' is invalid date"},types:{string:mi,method:mi,array:mi,object:mi,number:mi,date:mi,boolean:mi,integer:mi,float:mi,regexp:mi,email:mi,url:mi,hex:mi},string:{len:"'${name}' must be exactly ${len} characters",min:"'${name}' must be at least ${min} characters",max:"'${name}' cannot be longer than ${max} characters",range:"'${name}' must be between ${min} and ${max} characters"},number:{len:"'${name}' must equal ${len}",min:"'${name}' cannot be less than ${min}",max:"'${name}' cannot be greater than ${max}",range:"'${name}' must be between ${min} and ${max}"},array:{len:"'${name}' must be exactly ${len} in length",min:"'${name}' cannot be less than ${min} in length",max:"'${name}' cannot be greater than ${max} in length",range:"'${name}' must be between ${min} and ${max} in length"},pattern:{mismatch:"'${name}' does not match pattern ${pattern}"}},xS=Ml;function Yk(i,e){return i.replace(/\\?\$\{\w+\}/g,function(t){if(t.startsWith("\\"))return t.slice(1);var r=t.slice(2,-1);return e[r]})}var DS="CODE_LOGIC_ERROR";function kg(i,e,t,r,n){return Mg.apply(this,arguments)}function Mg(){return Mg=ma(zr().mark(function i(e,t,r,n,a){var c,l,d,u,f,p,v,E,g;return zr().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return c=ue({},r),delete c.ruleIndex,xS.warning=function(){},c.validator&&(l=c.validator,c.validator=function(){try{return l.apply(void 0,arguments)}catch(y){return console.error(y),Promise.reject(DS)}}),d=null,c&&c.type==="array"&&c.defaultField&&(d=c.defaultField,delete c.defaultField),u=new xS(ie({},e,[c])),f=fo(qw,n.validateMessages),u.messages(f),p=[],m.prev=10,m.next=13,Promise.resolve(u.validate(ie({},e,t),ue({},n)));case 13:m.next=18;break;case 15:m.prev=15,m.t0=m.catch(10),m.t0.errors&&(p=m.t0.errors.map(function(y,b){var R=y.message,T=R===DS?f.default:R;return H.isValidElement(T)?H.cloneElement(T,{key:"error_".concat(b)}):T}));case 18:if(!(!p.length&&d)){m.next=23;break}return m.next=21,Promise.all(t.map(function(y,b){return kg("".concat(e,".").concat(b),y,d,n,a)}));case 21:return v=m.sent,m.abrupt("return",v.reduce(function(y,b){return[].concat(Ye(y),Ye(b))},[]));case 23:return E=ue(ue({},r),{},{name:e,enum:(r.enum||[]).join(", ")},a),g=p.map(function(y){return typeof y=="string"?Yk(y,E):y}),m.abrupt("return",g);case 26:case"end":return m.stop()}},i,null,[[10,15]])})),Mg.apply(this,arguments)}function Wk(i,e,t,r,n,a){var c=i.join("."),l=t.map(function(f,p){var v=f.validator,E=ue(ue({},f),{},{ruleIndex:p});return v&&(E.validator=function(g,_,m){var y=!1,b=function(){for(var w=arguments.length,C=new Array(w),A=0;A<w;A++)C[A]=arguments[A];Promise.resolve().then(function(){bi(!y,"Your validator function has already return a promise. `callback` will be ignored."),y||m.apply(void 0,C)})},R=v(g,_,b);y=R&&typeof R.then=="function"&&typeof R.catch=="function",bi(y,"`callback` is deprecated. Please return a promise instead."),y&&R.then(function(){m()}).catch(function(T){m(T||" ")})}),E}).sort(function(f,p){var v=f.warningOnly,E=f.ruleIndex,g=p.warningOnly,_=p.ruleIndex;return!!v==!!g?E-_:v?1:-1}),d;if(n===!0)d=new Promise(function(){var f=ma(zr().mark(function p(v,E){var g,_,m;return zr().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:g=0;case 1:if(!(g<l.length)){b.next=12;break}return _=l[g],b.next=5,kg(c,e,_,r,a);case 5:if(m=b.sent,!m.length){b.next=9;break}return E([{errors:m,rule:_}]),b.abrupt("return");case 9:g+=1,b.next=1;break;case 12:v([]);case 13:case"end":return b.stop()}},p)}));return function(p,v){return f.apply(this,arguments)}}());else{var u=l.map(function(f){return kg(c,e,f,r,a).then(function(p){return{errors:p,rule:f}})});d=(n?Qk(u):Xk(u)).then(function(f){return Promise.reject(f)})}return d.catch(function(f){return f}),d}function Xk(i){return Ng.apply(this,arguments)}function Ng(){return Ng=ma(zr().mark(function i(e){return zr().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Promise.all(e).then(function(n){var a,c=(a=[]).concat.apply(a,Ye(n));return c}));case 1:case"end":return r.stop()}},i)})),Ng.apply(this,arguments)}function Qk(i){return Bg.apply(this,arguments)}function Bg(){return Bg=ma(zr().mark(function i(e){var t;return zr().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=0,n.abrupt("return",new Promise(function(a){e.forEach(function(c){c.then(function(l){l.errors.length&&a([l]),t+=1,t===e.length&&a([])})})}));case 2:case"end":return n.stop()}},i)})),Bg.apply(this,arguments)}function nr(i){return Dg(i)}function LS(i,e){var t={};return e.forEach(function(r){var n=gn(i,r);t=Qi(t,r,n)}),t}function go(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return i&&i.some(function(r){return Yw(e,r,t)})}function Yw(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return!i||!e||!t&&i.length!==e.length?!1:e.every(function(r,n){return i[n]===r})}function Zk(i,e){if(i===e)return!0;if(!i&&e||i&&!e||!i||!e||Xe(i)!=="object"||Xe(e)!=="object")return!1;var t=Object.keys(i),r=Object.keys(e),n=new Set([].concat(t,r));return Ye(n).every(function(a){var c=i[a],l=e[a];return typeof c=="function"&&typeof l=="function"?!0:c===l})}function Jk(i){var e=arguments.length<=1?void 0:arguments[1];return e&&e.target&&Xe(e.target)==="object"&&i in e.target?e.target[i]:e}function OS(i,e,t){var r=i.length;if(e<0||e>=r||t<0||t>=r)return i;var n=i[e],a=e-t;return a>0?[].concat(Ye(i.slice(0,t)),[n],Ye(i.slice(t,e)),Ye(i.slice(e+1,r))):a<0?[].concat(Ye(i.slice(0,e)),Ye(i.slice(e+1,t+1)),[n],Ye(i.slice(t+1,r))):i}var e2=["name"],Ii=[];function hm(i,e,t,r,n,a){return typeof i=="function"?i(e,t,"source"in a?{source:a.source}:{}):r!==n}var Sv=function(i){Cs(t,i);var e=As(t);function t(r){var n;if(Mr(this,t),n=e.call(this,r),ie(lt(n),"state",{resetCount:0}),ie(lt(n),"cancelRegisterFunc",null),ie(lt(n),"mounted",!1),ie(lt(n),"touched",!1),ie(lt(n),"dirty",!1),ie(lt(n),"validatePromise",void 0),ie(lt(n),"prevValidating",void 0),ie(lt(n),"errors",Ii),ie(lt(n),"warnings",Ii),ie(lt(n),"cancelRegister",function(){var d=n.props,u=d.preserve,f=d.isListField,p=d.name;n.cancelRegisterFunc&&n.cancelRegisterFunc(f,u,nr(p)),n.cancelRegisterFunc=null}),ie(lt(n),"getNamePath",function(){var d=n.props,u=d.name,f=d.fieldContext,p=f.prefixName,v=p===void 0?[]:p;return u!==void 0?[].concat(Ye(v),Ye(u)):[]}),ie(lt(n),"getRules",function(){var d=n.props,u=d.rules,f=u===void 0?[]:u,p=d.fieldContext;return f.map(function(v){return typeof v=="function"?v(p):v})}),ie(lt(n),"refresh",function(){n.mounted&&n.setState(function(d){var u=d.resetCount;return{resetCount:u+1}})}),ie(lt(n),"metaCache",null),ie(lt(n),"triggerMetaEvent",function(d){var u=n.props.onMetaChange;if(u){var f=ue(ue({},n.getMeta()),{},{destroy:d});Jm(n.metaCache,f)||u(f),n.metaCache=f}else n.metaCache=null}),ie(lt(n),"onStoreChange",function(d,u,f){var p=n.props,v=p.shouldUpdate,E=p.dependencies,g=E===void 0?[]:E,_=p.onReset,m=f.store,y=n.getNamePath(),b=n.getValue(d),R=n.getValue(m),T=u&&go(u,y);switch(f.type==="valueUpdate"&&f.source==="external"&&!Jm(b,R)&&(n.touched=!0,n.dirty=!0,n.validatePromise=null,n.errors=Ii,n.warnings=Ii,n.triggerMetaEvent()),f.type){case"reset":if(!u||T){n.touched=!1,n.dirty=!1,n.validatePromise=void 0,n.errors=Ii,n.warnings=Ii,n.triggerMetaEvent(),_==null||_(),n.refresh();return}break;case"remove":{if(v&&hm(v,d,m,b,R,f)){n.reRender();return}break}case"setField":{var w=f.data;if(T){"touched"in w&&(n.touched=w.touched),"validating"in w&&!("originRCField"in w)&&(n.validatePromise=w.validating?Promise.resolve([]):null),"errors"in w&&(n.errors=w.errors||Ii),"warnings"in w&&(n.warnings=w.warnings||Ii),n.dirty=!0,n.triggerMetaEvent(),n.reRender();return}else if("value"in w&&go(u,y,!0)){n.reRender();return}if(v&&!y.length&&hm(v,d,m,b,R,f)){n.reRender();return}break}case"dependenciesUpdate":{var C=g.map(nr);if(C.some(function(A){return go(f.relatedFields,A)})){n.reRender();return}break}default:if(T||(!g.length||y.length||v)&&hm(v,d,m,b,R,f)){n.reRender();return}break}v===!0&&n.reRender()}),ie(lt(n),"validateRules",function(d){var u=n.getNamePath(),f=n.getValue(),p=d||{},v=p.triggerName,E=p.validateOnly,g=E===void 0?!1:E,_=Promise.resolve().then(ma(zr().mark(function m(){var y,b,R,T,w,C,A;return zr().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(n.mounted){D.next=2;break}return D.abrupt("return",[]);case 2:if(y=n.props,b=y.validateFirst,R=b===void 0?!1:b,T=y.messageVariables,w=y.validateDebounce,C=n.getRules(),v&&(C=C.filter(function(P){return P}).filter(function(P){var k=P.validateTrigger;if(!k)return!0;var M=Dg(k);return M.includes(v)})),!(w&&v)){D.next=10;break}return D.next=8,new Promise(function(P){setTimeout(P,w)});case 8:if(n.validatePromise===_){D.next=10;break}return D.abrupt("return",[]);case 10:return A=Wk(u,f,C,d,R,T),A.catch(function(P){return P}).then(function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ii;if(n.validatePromise===_){var k;n.validatePromise=null;var M=[],I=[];(k=P.forEach)===null||k===void 0||k.call(P,function(F){var $=F.rule.warningOnly,N=F.errors,U=N===void 0?Ii:N;$?I.push.apply(I,Ye(U)):M.push.apply(M,Ye(U))}),n.errors=M,n.warnings=I,n.triggerMetaEvent(),n.reRender()}}),D.abrupt("return",A);case 13:case"end":return D.stop()}},m)})));return g||(n.validatePromise=_,n.dirty=!0,n.errors=Ii,n.warnings=Ii,n.triggerMetaEvent(),n.reRender()),_}),ie(lt(n),"isFieldValidating",function(){return!!n.validatePromise}),ie(lt(n),"isFieldTouched",function(){return n.touched}),ie(lt(n),"isFieldDirty",function(){if(n.dirty||n.props.initialValue!==void 0)return!0;var d=n.props.fieldContext,u=d.getInternalHooks(la),f=u.getInitialValue;return f(n.getNamePath())!==void 0}),ie(lt(n),"getErrors",function(){return n.errors}),ie(lt(n),"getWarnings",function(){return n.warnings}),ie(lt(n),"isListField",function(){return n.props.isListField}),ie(lt(n),"isList",function(){return n.props.isList}),ie(lt(n),"isPreserve",function(){return n.props.preserve}),ie(lt(n),"getMeta",function(){n.prevValidating=n.isFieldValidating();var d={touched:n.isFieldTouched(),validating:n.prevValidating,errors:n.errors,warnings:n.warnings,name:n.getNamePath(),validated:n.validatePromise===null};return d}),ie(lt(n),"getOnlyChild",function(d){if(typeof d=="function"){var u=n.getMeta();return ue(ue({},n.getOnlyChild(d(n.getControlled(),u,n.props.fieldContext))),{},{isFunction:!0})}var f=zd(d);return f.length!==1||!H.isValidElement(f[0])?{child:f,isFunction:!1}:{child:f[0],isFunction:!1}}),ie(lt(n),"getValue",function(d){var u=n.props.fieldContext.getFieldsValue,f=n.getNamePath();return gn(d||u(!0),f)}),ie(lt(n),"getControlled",function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=n.props,f=u.name,p=u.trigger,v=u.validateTrigger,E=u.getValueFromEvent,g=u.normalize,_=u.valuePropName,m=u.getValueProps,y=u.fieldContext,b=v!==void 0?v:y.validateTrigger,R=n.getNamePath(),T=y.getInternalHooks,w=y.getFieldsValue,C=T(la),A=C.dispatch,L=n.getValue(),D=m||function(F){return ie({},_,F)},P=d[p],k=f!==void 0?D(L):{},M=ue(ue({},d),k);M[p]=function(){n.touched=!0,n.dirty=!0,n.triggerMetaEvent();for(var F,$=arguments.length,N=new Array($),U=0;U<$;U++)N[U]=arguments[U];E?F=E.apply(void 0,N):F=Jk.apply(void 0,[_].concat(N)),g&&(F=g(F,L,w(!0))),F!==L&&A({type:"updateValue",namePath:R,value:F}),P&&P.apply(void 0,N)};var I=Dg(b||[]);return I.forEach(function(F){var $=M[F];M[F]=function(){$&&$.apply(void 0,arguments);var N=n.props.rules;N&&N.length&&A({type:"validateField",namePath:R,triggerName:F})}}),M}),r.fieldContext){var a=r.fieldContext.getInternalHooks,c=a(la),l=c.initEntityValue;l(lt(n))}return n}return Nr(t,[{key:"componentDidMount",value:function(){var n=this.props,a=n.shouldUpdate,c=n.fieldContext;if(this.mounted=!0,c){var l=c.getInternalHooks,d=l(la),u=d.registerField;this.cancelRegisterFunc=u(this)}a===!0&&this.reRender()}},{key:"componentWillUnmount",value:function(){this.cancelRegister(),this.triggerMetaEvent(!0),this.mounted=!1}},{key:"reRender",value:function(){this.mounted&&this.forceUpdate()}},{key:"render",value:function(){var n=this.state.resetCount,a=this.props.children,c=this.getOnlyChild(a),l=c.child,d=c.isFunction,u;return d?u=l:H.isValidElement(l)?u=H.cloneElement(l,this.getControlled(l.props)):(bi(!l,"`children` of Field is not validate ReactElement."),u=l),H.createElement(H.Fragment,{key:n},u)}}]),t}(H.Component);ie(Sv,"contextType",To);ie(Sv,"defaultProps",{trigger:"onChange",valuePropName:"value"});function Ww(i){var e,t=i.name,r=ti(i,e2),n=H.useContext(To),a=H.useContext(Zd),c=t!==void 0?nr(t):void 0,l=(e=r.isListField)!==null&&e!==void 0?e:!!a,d="keep";return l||(d="_".concat((c||[]).join("_"))),H.createElement(Sv,Dr({key:d,name:c,isListField:l},r,{fieldContext:n}))}function t2(i){var e=i.name,t=i.initialValue,r=i.children,n=i.rules,a=i.validateTrigger,c=i.isListField,l=H.useContext(To),d=H.useContext(Zd),u=H.useRef({keys:[],id:0}),f=u.current,p=H.useMemo(function(){var _=nr(l.prefixName)||[];return[].concat(Ye(_),Ye(nr(e)))},[l.prefixName,e]),v=H.useMemo(function(){return ue(ue({},l),{},{prefixName:p})},[l,p]),E=H.useMemo(function(){return{getKey:function(m){var y=p.length,b=m[y];return[f.keys[b],m.slice(y+1)]}}},[p]);if(typeof r!="function")return bi(!1,"Form.List only accepts function as children."),null;var g=function(m,y,b){var R=b.source;return R==="internal"?!1:m!==y};return H.createElement(Zd.Provider,{value:E},H.createElement(To.Provider,{value:v},H.createElement(Ww,{name:[],shouldUpdate:g,rules:n,validateTrigger:a,initialValue:t,isList:!0,isListField:c??!!d},function(_,m){var y=_.value,b=y===void 0?[]:y,R=_.onChange,T=l.getFieldValue,w=function(){var D=T(p||[]);return D||[]},C={add:function(D,P){var k=w();P>=0&&P<=k.length?(f.keys=[].concat(Ye(f.keys.slice(0,P)),[f.id],Ye(f.keys.slice(P))),R([].concat(Ye(k.slice(0,P)),[D],Ye(k.slice(P))))):(f.keys=[].concat(Ye(f.keys),[f.id]),R([].concat(Ye(k),[D]))),f.id+=1},remove:function(D){var P=w(),k=new Set(Array.isArray(D)?D:[D]);k.size<=0||(f.keys=f.keys.filter(function(M,I){return!k.has(I)}),R(P.filter(function(M,I){return!k.has(I)})))},move:function(D,P){if(D!==P){var k=w();D<0||D>=k.length||P<0||P>=k.length||(f.keys=OS(f.keys,D,P),R(OS(k,D,P)))}}},A=b||[];return Array.isArray(A)||(A=[]),r(A.map(function(L,D){var P=f.keys[D];return P===void 0&&(f.keys[D]=f.id,P=f.keys[D],f.id+=1),{name:D,key:P,isListField:!0}}),C,m)})))}function r2(i){var e=!1,t=i.length,r=[];return i.length?new Promise(function(n,a){i.forEach(function(c,l){c.catch(function(d){return e=!0,d}).then(function(d){t-=1,r[l]=d,!(t>0)&&(e&&a(r),n(r))})})}):Promise.resolve([])}var Xw="__@field_split__";function pm(i){return i.map(function(e){return"".concat(Xe(e),":").concat(e)}).join(Xw)}var to=function(){function i(){Mr(this,i),ie(this,"kvs",new Map)}return Nr(i,[{key:"set",value:function(t,r){this.kvs.set(pm(t),r)}},{key:"get",value:function(t){return this.kvs.get(pm(t))}},{key:"update",value:function(t,r){var n=this.get(t),a=r(n);a?this.set(t,a):this.delete(t)}},{key:"delete",value:function(t){this.kvs.delete(pm(t))}},{key:"map",value:function(t){return Ye(this.kvs.entries()).map(function(r){var n=Be(r,2),a=n[0],c=n[1],l=a.split(Xw);return t({key:l.map(function(d){var u=d.match(/^([^:]*):(.*)$/),f=Be(u,3),p=f[1],v=f[2];return p==="number"?Number(v):v}),value:c})})}},{key:"toJSON",value:function(){var t={};return this.map(function(r){var n=r.key,a=r.value;return t[n.join(".")]=a,null}),t}}]),i}(),i2=["name"],n2=Nr(function i(e){var t=this;Mr(this,i),ie(this,"formHooked",!1),ie(this,"forceRootUpdate",void 0),ie(this,"subscribable",!0),ie(this,"store",{}),ie(this,"fieldEntities",[]),ie(this,"initialValues",{}),ie(this,"callbacks",{}),ie(this,"validateMessages",null),ie(this,"preserve",null),ie(this,"lastValidatePromise",null),ie(this,"getForm",function(){return{getFieldValue:t.getFieldValue,getFieldsValue:t.getFieldsValue,getFieldError:t.getFieldError,getFieldWarning:t.getFieldWarning,getFieldsError:t.getFieldsError,isFieldsTouched:t.isFieldsTouched,isFieldTouched:t.isFieldTouched,isFieldValidating:t.isFieldValidating,isFieldsValidating:t.isFieldsValidating,resetFields:t.resetFields,setFields:t.setFields,setFieldValue:t.setFieldValue,setFieldsValue:t.setFieldsValue,validateFields:t.validateFields,submit:t.submit,_init:!0,getInternalHooks:t.getInternalHooks}}),ie(this,"getInternalHooks",function(r){return r===la?(t.formHooked=!0,{dispatch:t.dispatch,initEntityValue:t.initEntityValue,registerField:t.registerField,useSubscribe:t.useSubscribe,setInitialValues:t.setInitialValues,destroyForm:t.destroyForm,setCallbacks:t.setCallbacks,setValidateMessages:t.setValidateMessages,getFields:t.getFields,setPreserve:t.setPreserve,getInitialValue:t.getInitialValue,registerWatch:t.registerWatch}):(bi(!1,"`getInternalHooks` is internal usage. Should not call directly."),null)}),ie(this,"useSubscribe",function(r){t.subscribable=r}),ie(this,"prevWithoutPreserves",null),ie(this,"setInitialValues",function(r,n){if(t.initialValues=r||{},n){var a,c=fo(r,t.store);(a=t.prevWithoutPreserves)===null||a===void 0||a.map(function(l){var d=l.key;c=Qi(c,d,gn(r,d))}),t.prevWithoutPreserves=null,t.updateStore(c)}}),ie(this,"destroyForm",function(r){if(r)t.updateStore({});else{var n=new to;t.getFieldEntities(!0).forEach(function(a){t.isMergedPreserve(a.isPreserve())||n.set(a.getNamePath(),!0)}),t.prevWithoutPreserves=n}}),ie(this,"getInitialValue",function(r){var n=gn(t.initialValues,r);return r.length?fo(n):n}),ie(this,"setCallbacks",function(r){t.callbacks=r}),ie(this,"setValidateMessages",function(r){t.validateMessages=r}),ie(this,"setPreserve",function(r){t.preserve=r}),ie(this,"watchList",[]),ie(this,"registerWatch",function(r){return t.watchList.push(r),function(){t.watchList=t.watchList.filter(function(n){return n!==r})}}),ie(this,"notifyWatch",function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];if(t.watchList.length){var n=t.getFieldsValue(),a=t.getFieldsValue(!0);t.watchList.forEach(function(c){c(n,a,r)})}}),ie(this,"timeoutId",null),ie(this,"warningUnhooked",function(){}),ie(this,"updateStore",function(r){t.store=r}),ie(this,"getFieldEntities",function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return r?t.fieldEntities.filter(function(n){return n.getNamePath().length}):t.fieldEntities}),ie(this,"getFieldsMap",function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=new to;return t.getFieldEntities(r).forEach(function(a){var c=a.getNamePath();n.set(c,a)}),n}),ie(this,"getFieldEntitiesForNamePathList",function(r){if(!r)return t.getFieldEntities(!0);var n=t.getFieldsMap(!0);return r.map(function(a){var c=nr(a);return n.get(c)||{INVALIDATE_NAME_PATH:nr(a)}})}),ie(this,"getFieldsValue",function(r,n){t.warningUnhooked();var a,c,l;if(r===!0||Array.isArray(r)?(a=r,c=n):r&&Xe(r)==="object"&&(l=r.strict,c=r.filter),a===!0&&!c)return t.store;var d=t.getFieldEntitiesForNamePathList(Array.isArray(a)?a:null),u=[];return d.forEach(function(f){var p,v,E="INVALIDATE_NAME_PATH"in f?f.INVALIDATE_NAME_PATH:f.getNamePath();if(l){var g,_;if((g=(_=f).isList)!==null&&g!==void 0&&g.call(_))return}else if(!a&&(p=(v=f).isListField)!==null&&p!==void 0&&p.call(v))return;if(!c)u.push(E);else{var m="getMeta"in f?f.getMeta():null;c(m)&&u.push(E)}}),LS(t.store,u.map(nr))}),ie(this,"getFieldValue",function(r){t.warningUnhooked();var n=nr(r);return gn(t.store,n)}),ie(this,"getFieldsError",function(r){t.warningUnhooked();var n=t.getFieldEntitiesForNamePathList(r);return n.map(function(a,c){return a&&!("INVALIDATE_NAME_PATH"in a)?{name:a.getNamePath(),errors:a.getErrors(),warnings:a.getWarnings()}:{name:nr(r[c]),errors:[],warnings:[]}})}),ie(this,"getFieldError",function(r){t.warningUnhooked();var n=nr(r),a=t.getFieldsError([n])[0];return a.errors}),ie(this,"getFieldWarning",function(r){t.warningUnhooked();var n=nr(r),a=t.getFieldsError([n])[0];return a.warnings}),ie(this,"isFieldsTouched",function(){t.warningUnhooked();for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var c=n[0],l=n[1],d,u=!1;n.length===0?d=null:n.length===1?Array.isArray(c)?(d=c.map(nr),u=!1):(d=null,u=c):(d=c.map(nr),u=l);var f=t.getFieldEntities(!0),p=function(m){return m.isFieldTouched()};if(!d)return u?f.every(function(_){return p(_)||_.isList()}):f.some(p);var v=new to;d.forEach(function(_){v.set(_,[])}),f.forEach(function(_){var m=_.getNamePath();d.forEach(function(y){y.every(function(b,R){return m[R]===b})&&v.update(y,function(b){return[].concat(Ye(b),[_])})})});var E=function(m){return m.some(p)},g=v.map(function(_){var m=_.value;return m});return u?g.every(E):g.some(E)}),ie(this,"isFieldTouched",function(r){return t.warningUnhooked(),t.isFieldsTouched([r])}),ie(this,"isFieldsValidating",function(r){t.warningUnhooked();var n=t.getFieldEntities();if(!r)return n.some(function(c){return c.isFieldValidating()});var a=r.map(nr);return n.some(function(c){var l=c.getNamePath();return go(a,l)&&c.isFieldValidating()})}),ie(this,"isFieldValidating",function(r){return t.warningUnhooked(),t.isFieldsValidating([r])}),ie(this,"resetWithFieldInitialValue",function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=new to,a=t.getFieldEntities(!0);a.forEach(function(d){var u=d.props.initialValue,f=d.getNamePath();if(u!==void 0){var p=n.get(f)||new Set;p.add({entity:d,value:u}),n.set(f,p)}});var c=function(u){u.forEach(function(f){var p=f.props.initialValue;if(p!==void 0){var v=f.getNamePath(),E=t.getInitialValue(v);if(E!==void 0)bi(!1,"Form already set 'initialValues' with path '".concat(v.join("."),"'. Field can not overwrite it."));else{var g=n.get(v);if(g&&g.size>1)bi(!1,"Multiple Field with path '".concat(v.join("."),"' set 'initialValue'. Can not decide which one to pick."));else if(g){var _=t.getFieldValue(v),m=f.isListField();!m&&(!r.skipExist||_===void 0)&&t.updateStore(Qi(t.store,v,Ye(g)[0].value))}}}})},l;r.entities?l=r.entities:r.namePathList?(l=[],r.namePathList.forEach(function(d){var u=n.get(d);if(u){var f;(f=l).push.apply(f,Ye(Ye(u).map(function(p){return p.entity})))}})):l=a,c(l)}),ie(this,"resetFields",function(r){t.warningUnhooked();var n=t.store;if(!r){t.updateStore(fo(t.initialValues)),t.resetWithFieldInitialValue(),t.notifyObservers(n,null,{type:"reset"}),t.notifyWatch();return}var a=r.map(nr);a.forEach(function(c){var l=t.getInitialValue(c);t.updateStore(Qi(t.store,c,l))}),t.resetWithFieldInitialValue({namePathList:a}),t.notifyObservers(n,a,{type:"reset"}),t.notifyWatch(a)}),ie(this,"setFields",function(r){t.warningUnhooked();var n=t.store,a=[];r.forEach(function(c){var l=c.name,d=ti(c,i2),u=nr(l);a.push(u),"value"in d&&t.updateStore(Qi(t.store,u,d.value)),t.notifyObservers(n,[u],{type:"setField",data:c})}),t.notifyWatch(a)}),ie(this,"getFields",function(){var r=t.getFieldEntities(!0),n=r.map(function(a){var c=a.getNamePath(),l=a.getMeta(),d=ue(ue({},l),{},{name:c,value:t.getFieldValue(c)});return Object.defineProperty(d,"originRCField",{value:!0}),d});return n}),ie(this,"initEntityValue",function(r){var n=r.props.initialValue;if(n!==void 0){var a=r.getNamePath(),c=gn(t.store,a);c===void 0&&t.updateStore(Qi(t.store,a,n))}}),ie(this,"isMergedPreserve",function(r){var n=r!==void 0?r:t.preserve;return n??!0}),ie(this,"registerField",function(r){t.fieldEntities.push(r);var n=r.getNamePath();if(t.notifyWatch([n]),r.props.initialValue!==void 0){var a=t.store;t.resetWithFieldInitialValue({entities:[r],skipExist:!0}),t.notifyObservers(a,[r.getNamePath()],{type:"valueUpdate",source:"internal"})}return function(c,l){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(t.fieldEntities=t.fieldEntities.filter(function(p){return p!==r}),!t.isMergedPreserve(l)&&(!c||d.length>1)){var u=c?void 0:t.getInitialValue(n);if(n.length&&t.getFieldValue(n)!==u&&t.fieldEntities.every(function(p){return!Yw(p.getNamePath(),n)})){var f=t.store;t.updateStore(Qi(f,n,u,!0)),t.notifyObservers(f,[n],{type:"remove"}),t.triggerDependenciesUpdate(f,n)}}t.notifyWatch([n])}}),ie(this,"dispatch",function(r){switch(r.type){case"updateValue":{var n=r.namePath,a=r.value;t.updateValue(n,a);break}case"validateField":{var c=r.namePath,l=r.triggerName;t.validateFields([c],{triggerName:l});break}}}),ie(this,"notifyObservers",function(r,n,a){if(t.subscribable){var c=ue(ue({},a),{},{store:t.getFieldsValue(!0)});t.getFieldEntities().forEach(function(l){var d=l.onStoreChange;d(r,n,c)})}else t.forceRootUpdate()}),ie(this,"triggerDependenciesUpdate",function(r,n){var a=t.getDependencyChildrenFields(n);return a.length&&t.validateFields(a),t.notifyObservers(r,a,{type:"dependenciesUpdate",relatedFields:[n].concat(Ye(a))}),a}),ie(this,"updateValue",function(r,n){var a=nr(r),c=t.store;t.updateStore(Qi(t.store,a,n)),t.notifyObservers(c,[a],{type:"valueUpdate",source:"internal"}),t.notifyWatch([a]);var l=t.triggerDependenciesUpdate(c,a),d=t.callbacks.onValuesChange;if(d){var u=LS(t.store,[a]);d(u,t.getFieldsValue())}t.triggerOnFieldsChange([a].concat(Ye(l)))}),ie(this,"setFieldsValue",function(r){t.warningUnhooked();var n=t.store;if(r){var a=fo(t.store,r);t.updateStore(a)}t.notifyObservers(n,null,{type:"valueUpdate",source:"external"}),t.notifyWatch()}),ie(this,"setFieldValue",function(r,n){t.setFields([{name:r,value:n,errors:[],warnings:[]}])}),ie(this,"getDependencyChildrenFields",function(r){var n=new Set,a=[],c=new to;t.getFieldEntities().forEach(function(d){var u=d.props.dependencies;(u||[]).forEach(function(f){var p=nr(f);c.update(p,function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Set;return v.add(d),v})})});var l=function d(u){var f=c.get(u)||new Set;f.forEach(function(p){if(!n.has(p)){n.add(p);var v=p.getNamePath();p.isFieldDirty()&&v.length&&(a.push(v),d(v))}})};return l(r),a}),ie(this,"triggerOnFieldsChange",function(r,n){var a=t.callbacks.onFieldsChange;if(a){var c=t.getFields();if(n){var l=new to;n.forEach(function(u){var f=u.name,p=u.errors;l.set(f,p)}),c.forEach(function(u){u.errors=l.get(u.name)||u.errors})}var d=c.filter(function(u){var f=u.name;return go(r,f)});d.length&&a(d,c)}}),ie(this,"validateFields",function(r,n){t.warningUnhooked();var a,c;Array.isArray(r)||typeof r=="string"||typeof n=="string"?(a=r,c=n):c=r;var l=!!a,d=l?a.map(nr):[],u=[],f=String(Date.now()),p=new Set,v=c||{},E=v.recursive,g=v.dirty;t.getFieldEntities(!0).forEach(function(b){if(l||d.push(b.getNamePath()),!(!b.props.rules||!b.props.rules.length)&&!(g&&!b.isFieldDirty())){var R=b.getNamePath();if(p.add(R.join(f)),!l||go(d,R,E)){var T=b.validateRules(ue({validateMessages:ue(ue({},qw),t.validateMessages)},c));u.push(T.then(function(){return{name:R,errors:[],warnings:[]}}).catch(function(w){var C,A=[],L=[];return(C=w.forEach)===null||C===void 0||C.call(w,function(D){var P=D.rule.warningOnly,k=D.errors;P?L.push.apply(L,Ye(k)):A.push.apply(A,Ye(k))}),A.length?Promise.reject({name:R,errors:A,warnings:L}):{name:R,errors:A,warnings:L}}))}}});var _=r2(u);t.lastValidatePromise=_,_.catch(function(b){return b}).then(function(b){var R=b.map(function(T){var w=T.name;return w});t.notifyObservers(t.store,R,{type:"validateFinish"}),t.triggerOnFieldsChange(R,b)});var m=_.then(function(){return t.lastValidatePromise===_?Promise.resolve(t.getFieldsValue(d)):Promise.reject([])}).catch(function(b){var R=b.filter(function(T){return T&&T.errors.length});return Promise.reject({values:t.getFieldsValue(d),errorFields:R,outOfDate:t.lastValidatePromise!==_})});m.catch(function(b){return b});var y=d.filter(function(b){return p.has(b.join(f))});return t.triggerOnFieldsChange(y),m}),ie(this,"submit",function(){t.warningUnhooked(),t.validateFields().then(function(r){var n=t.callbacks.onFinish;if(n)try{n(r)}catch(a){console.error(a)}}).catch(function(r){var n=t.callbacks.onFinishFailed;n&&n(r)})}),this.forceRootUpdate=e});function Qw(i){var e=H.useRef(),t=H.useState({}),r=Be(t,2),n=r[1];if(!e.current)if(i)e.current=i;else{var a=function(){n({})},c=new n2(a);e.current=c.getForm()}return[e.current]}var Fg=H.createContext({triggerFormChange:function(){},triggerFormFinish:function(){},registerForm:function(){},unregisterForm:function(){}}),s2=function(e){var t=e.validateMessages,r=e.onFormChange,n=e.onFormFinish,a=e.children,c=H.useContext(Fg),l=H.useRef({});return H.createElement(Fg.Provider,{value:ue(ue({},c),{},{validateMessages:ue(ue({},c.validateMessages),t),triggerFormChange:function(u,f){r&&r(u,{changedFields:f,forms:l.current}),c.triggerFormChange(u,f)},triggerFormFinish:function(u,f){n&&n(u,{values:f,forms:l.current}),c.triggerFormFinish(u,f)},registerForm:function(u,f){u&&(l.current=ue(ue({},l.current),{},ie({},u,f))),c.registerForm(u,f)},unregisterForm:function(u){var f=ue({},l.current);delete f[u],l.current=f,c.unregisterForm(u)}})},a)},a2=["name","initialValues","fields","form","preserve","children","component","validateMessages","validateTrigger","onValuesChange","onFieldsChange","onFinish","onFinishFailed","clearOnDestroy"],o2=function(e,t){var r=e.name,n=e.initialValues,a=e.fields,c=e.form,l=e.preserve,d=e.children,u=e.component,f=u===void 0?"form":u,p=e.validateMessages,v=e.validateTrigger,E=v===void 0?"onChange":v,g=e.onValuesChange,_=e.onFieldsChange,m=e.onFinish,y=e.onFinishFailed,b=e.clearOnDestroy,R=ti(e,a2),T=H.useRef(null),w=H.useContext(Fg),C=Qw(c),A=Be(C,1),L=A[0],D=L.getInternalHooks(la),P=D.useSubscribe,k=D.setInitialValues,M=D.setCallbacks,I=D.setValidateMessages,F=D.setPreserve,$=D.destroyForm;H.useImperativeHandle(t,function(){return ue(ue({},L),{},{nativeElement:T.current})}),H.useEffect(function(){return w.registerForm(r,L),function(){w.unregisterForm(r)}},[w,L,r]),I(ue(ue({},w.validateMessages),p)),M({onValuesChange:g,onFieldsChange:function(Y){if(w.triggerFormChange(r,Y),_){for(var re=arguments.length,oe=new Array(re>1?re-1:0),ve=1;ve<re;ve++)oe[ve-1]=arguments[ve];_.apply(void 0,[Y].concat(oe))}},onFinish:function(Y){w.triggerFormFinish(r,Y),m&&m(Y)},onFinishFailed:y}),F(l);var N=H.useRef(null);k(n,!N.current),N.current||(N.current=!0),H.useEffect(function(){return function(){return $(b)}},[]);var U,V=typeof d=="function";if(V){var J=L.getFieldsValue(!0);U=d(J,L)}else U=d;P(!V);var j=H.useRef();H.useEffect(function(){Zk(j.current||[],a||[])||L.setFields(a||[]),j.current=a},[a,L]);var q=H.useMemo(function(){return ue(ue({},L),{},{validateTrigger:E})},[L,E]),Z=H.createElement(Zd.Provider,{value:null},H.createElement(To.Provider,{value:q},U));return f===!1?Z:H.createElement(f,Dr({},R,{ref:T,onSubmit:function(Y){Y.preventDefault(),Y.stopPropagation(),L.submit()},onReset:function(Y){var re;Y.preventDefault(),L.resetFields(),(re=R.onReset)===null||re===void 0||re.call(R,Y)}}),Z)};function IS(i){try{return JSON.stringify(i)}catch{return Math.random()}}function c2(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];var r=e[0],n=e[1],a=n===void 0?{}:n,c=gk(a)?{form:a}:a,l=c.form,d=H.useState(),u=Be(d,2),f=u[0],p=u[1],v=H.useMemo(function(){return IS(f)},[f]),E=H.useRef(v);E.current=v;var g=H.useContext(To),_=l||g,m=_&&_._init,y=nr(r),b=H.useRef(y);return b.current=y,H.useEffect(function(){if(m){var R=_.getFieldsValue,T=_.getInternalHooks,w=T(la),C=w.registerWatch,A=function(k,M){var I=c.preserve?M:k;return typeof r=="function"?r(I):gn(I,b.current)},L=C(function(P,k){var M=A(P,k),I=IS(M);E.current!==I&&(E.current=I,p(M))}),D=A(R(),R(!0));return f!==D&&p(D),L}},[m]),f}var l2=H.forwardRef(o2),Nl=l2;Nl.FormProvider=s2;Nl.Field=Ww;Nl.List=t2;Nl.useForm=Qw;Nl.useWatch=c2;const ws=H.createContext({}),u2=({children:i,status:e,override:t})=>{const r=H.useContext(ws),n=H.useMemo(()=>{const a=Object.assign({},r);return t&&delete a.isFormItemInput,e&&(delete a.status,delete a.hasFeedback,delete a.feedbackIcon),a},[e,t,r]);return H.createElement(ws.Provider,{value:n},i)},d2=H.createContext(void 0),PS=i=>{const{space:e,form:t,children:r}=i;if(r==null)return null;let n=r;return t&&(n=we.createElement(u2,{override:!0,status:!0},n)),e&&(n=we.createElement(CP,null,n)),n};function Ug(i,e,t){return tt({[`${i}-status-success`]:e==="success",[`${i}-status-warning`]:e==="warning",[`${i}-status-error`]:e==="error",[`${i}-status-validating`]:e==="validating",[`${i}-has-feedback`]:t})}const Ev=(i,e)=>e||i,Zw=(i,e,t=void 0)=>{var r,n;const{variant:a,[i]:c}=H.useContext(kr),l=H.useContext(d2),d=c==null?void 0:c.variant;let u;typeof e<"u"?u=e:t===!1?u="borderless":u=(n=(r=l??d)!==null&&r!==void 0?r:a)!==null&&n!==void 0?n:"outlined";const f=EO.includes(u);return[u,f]};var f2={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0011.6 0l43.6-43.5a8.2 8.2 0 000-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"}}]},name:"search",theme:"outlined"},h2=function(e,t){return H.createElement(xs,Dr({},e,{ref:t,icon:f2}))},p2=H.forwardRef(h2);function Af(i){return Ui(i,{inputAffixPadding:i.paddingXXS})}const xf=i=>{const{controlHeight:e,fontSize:t,lineHeight:r,lineWidth:n,controlHeightSM:a,controlHeightLG:c,fontSizeLG:l,lineHeightLG:d,paddingSM:u,controlPaddingHorizontalSM:f,controlPaddingHorizontal:p,colorFillAlter:v,colorPrimaryHover:E,colorPrimary:g,controlOutlineWidth:_,controlOutline:m,colorErrorOutline:y,colorWarningOutline:b,colorBgContainer:R,inputFontSize:T,inputFontSizeLG:w,inputFontSizeSM:C}=i,A=T||t,L=C||A,D=w||l,P=Math.round((e-A*r)/2*10)/10-n,k=Math.round((a-L*r)/2*10)/10-n,M=Math.ceil((c-D*d)/2*10)/10-n;return{paddingBlock:Math.max(P,0),paddingBlockSM:Math.max(k,0),paddingBlockLG:Math.max(M,0),paddingInline:u-n,paddingInlineSM:f-n,paddingInlineLG:p-n,addonBg:v,activeBorderColor:g,hoverBorderColor:E,activeShadow:`0 0 0 ${_}px ${m}`,errorActiveShadow:`0 0 0 ${_}px ${y}`,warningActiveShadow:`0 0 0 ${_}px ${b}`,hoverBg:R,activeBg:R,inputFontSize:A,inputFontSizeLG:D,inputFontSizeSM:L}},m2=i=>({borderColor:i.hoverBorderColor,backgroundColor:i.hoverBg}),Rv=i=>({color:i.colorTextDisabled,backgroundColor:i.colorBgContainerDisabled,borderColor:i.colorBorder,boxShadow:"none",cursor:"not-allowed",opacity:1,"input[disabled], textarea[disabled]":{cursor:"not-allowed"},"&:hover:not([disabled])":Object.assign({},m2(Ui(i,{hoverBorderColor:i.colorBorder,hoverBg:i.colorBgContainerDisabled})))}),Jw=(i,e)=>({background:i.colorBgContainer,borderWidth:i.lineWidth,borderStyle:i.lineType,borderColor:e.borderColor,"&:hover":{borderColor:e.hoverBorderColor,backgroundColor:i.hoverBg},"&:focus, &:focus-within":{borderColor:e.activeBorderColor,boxShadow:e.activeShadow,outline:0,backgroundColor:i.activeBg}}),kS=(i,e)=>({[`&${i.componentCls}-status-${e.status}:not(${i.componentCls}-disabled)`]:Object.assign(Object.assign({},Jw(i,e)),{[`${i.componentCls}-prefix, ${i.componentCls}-suffix`]:{color:e.affixColor}}),[`&${i.componentCls}-status-${e.status}${i.componentCls}-disabled`]:{borderColor:e.borderColor}}),g2=(i,e)=>({"&-outlined":Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Jw(i,{borderColor:i.colorBorder,hoverBorderColor:i.hoverBorderColor,activeBorderColor:i.activeBorderColor,activeShadow:i.activeShadow})),{[`&${i.componentCls}-disabled, &[disabled]`]:Object.assign({},Rv(i))}),kS(i,{status:"error",borderColor:i.colorError,hoverBorderColor:i.colorErrorBorderHover,activeBorderColor:i.colorError,activeShadow:i.errorActiveShadow,affixColor:i.colorError})),kS(i,{status:"warning",borderColor:i.colorWarning,hoverBorderColor:i.colorWarningBorderHover,activeBorderColor:i.colorWarning,activeShadow:i.warningActiveShadow,affixColor:i.colorWarning})),e)}),MS=(i,e)=>({[`&${i.componentCls}-group-wrapper-status-${e.status}`]:{[`${i.componentCls}-group-addon`]:{borderColor:e.addonBorderColor,color:e.addonColor}}}),v2=i=>({"&-outlined":Object.assign(Object.assign(Object.assign({[`${i.componentCls}-group`]:{"&-addon":{background:i.addonBg,border:`${Bt(i.lineWidth)} ${i.lineType} ${i.colorBorder}`},"&-addon:first-child":{borderInlineEnd:0},"&-addon:last-child":{borderInlineStart:0}}},MS(i,{status:"error",addonBorderColor:i.colorError,addonColor:i.colorErrorText})),MS(i,{status:"warning",addonBorderColor:i.colorWarning,addonColor:i.colorWarningText})),{[`&${i.componentCls}-group-wrapper-disabled`]:{[`${i.componentCls}-group-addon`]:Object.assign({},Rv(i))}})}),y2=(i,e)=>{const{componentCls:t}=i;return{"&-borderless":Object.assign({background:"transparent",border:"none","&:focus, &:focus-within":{outline:"none"},[`&${t}-disabled, &[disabled]`]:{color:i.colorTextDisabled,cursor:"not-allowed"},[`&${t}-status-error`]:{"&, & input, & textarea":{color:i.colorError}},[`&${t}-status-warning`]:{"&, & input, & textarea":{color:i.colorWarning}}},e)}},eT=(i,e)=>{var t;return{background:e.bg,borderWidth:i.lineWidth,borderStyle:i.lineType,borderColor:"transparent","input&, & input, textarea&, & textarea":{color:(t=e==null?void 0:e.inputColor)!==null&&t!==void 0?t:"unset"},"&:hover":{background:e.hoverBg},"&:focus, &:focus-within":{outline:0,borderColor:e.activeBorderColor,backgroundColor:i.activeBg}}},NS=(i,e)=>({[`&${i.componentCls}-status-${e.status}:not(${i.componentCls}-disabled)`]:Object.assign(Object.assign({},eT(i,e)),{[`${i.componentCls}-prefix, ${i.componentCls}-suffix`]:{color:e.affixColor}})}),b2=(i,e)=>({"&-filled":Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},eT(i,{bg:i.colorFillTertiary,hoverBg:i.colorFillSecondary,activeBorderColor:i.activeBorderColor})),{[`&${i.componentCls}-disabled, &[disabled]`]:Object.assign({},Rv(i))}),NS(i,{status:"error",bg:i.colorErrorBg,hoverBg:i.colorErrorBgHover,activeBorderColor:i.colorError,inputColor:i.colorErrorText,affixColor:i.colorError})),NS(i,{status:"warning",bg:i.colorWarningBg,hoverBg:i.colorWarningBgHover,activeBorderColor:i.colorWarning,inputColor:i.colorWarningText,affixColor:i.colorWarning})),e)}),BS=(i,e)=>({[`&${i.componentCls}-group-wrapper-status-${e.status}`]:{[`${i.componentCls}-group-addon`]:{background:e.addonBg,color:e.addonColor}}}),_2=i=>({"&-filled":Object.assign(Object.assign(Object.assign({[`${i.componentCls}-group-addon`]:{background:i.colorFillTertiary,"&:last-child":{position:"static"}}},BS(i,{status:"error",addonBg:i.colorErrorBg,addonColor:i.colorErrorText})),BS(i,{status:"warning",addonBg:i.colorWarningBg,addonColor:i.colorWarningText})),{[`&${i.componentCls}-group-wrapper-disabled`]:{[`${i.componentCls}-group`]:{"&-addon":{background:i.colorFillTertiary,color:i.colorTextDisabled},"&-addon:first-child":{borderInlineStart:`${Bt(i.lineWidth)} ${i.lineType} ${i.colorBorder}`,borderTop:`${Bt(i.lineWidth)} ${i.lineType} ${i.colorBorder}`,borderBottom:`${Bt(i.lineWidth)} ${i.lineType} ${i.colorBorder}`},"&-addon:last-child":{borderInlineEnd:`${Bt(i.lineWidth)} ${i.lineType} ${i.colorBorder}`,borderTop:`${Bt(i.lineWidth)} ${i.lineType} ${i.colorBorder}`,borderBottom:`${Bt(i.lineWidth)} ${i.lineType} ${i.colorBorder}`}}}})}),tT=(i,e)=>({background:i.colorBgContainer,borderWidth:`${Bt(i.lineWidth)} 0`,borderStyle:`${i.lineType} none`,borderColor:`transparent transparent ${e.borderColor} transparent`,borderRadius:0,"&:hover":{borderColor:`transparent transparent ${e.borderColor} transparent`,backgroundColor:i.hoverBg},"&:focus, &:focus-within":{borderColor:`transparent transparent ${e.borderColor} transparent`,outline:0,backgroundColor:i.activeBg}}),FS=(i,e)=>({[`&${i.componentCls}-status-${e.status}:not(${i.componentCls}-disabled)`]:Object.assign(Object.assign({},tT(i,e)),{[`${i.componentCls}-prefix, ${i.componentCls}-suffix`]:{color:e.affixColor}}),[`&${i.componentCls}-status-${e.status}${i.componentCls}-disabled`]:{borderColor:`transparent transparent ${e.borderColor} transparent`}}),S2=(i,e)=>({"&-underlined":Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},tT(i,{borderColor:i.colorBorder,hoverBorderColor:i.hoverBorderColor,activeBorderColor:i.activeBorderColor,activeShadow:i.activeShadow})),{[`&${i.componentCls}-disabled, &[disabled]`]:{color:i.colorTextDisabled,boxShadow:"none",cursor:"not-allowed","&:hover":{borderColor:`transparent transparent ${i.colorBorder} transparent`}},"input[disabled], textarea[disabled]":{cursor:"not-allowed"}}),FS(i,{status:"error",borderColor:i.colorError,hoverBorderColor:i.colorErrorBorderHover,activeBorderColor:i.colorError,activeShadow:i.errorActiveShadow,affixColor:i.colorError})),FS(i,{status:"warning",borderColor:i.colorWarning,hoverBorderColor:i.colorWarningBorderHover,activeBorderColor:i.colorWarning,activeShadow:i.warningActiveShadow,affixColor:i.colorWarning})),e)}),E2=i=>({"&::-moz-placeholder":{opacity:1},"&::placeholder":{color:i,userSelect:"none"},"&:placeholder-shown":{textOverflow:"ellipsis"}}),rT=i=>{const{paddingBlockLG:e,lineHeightLG:t,borderRadiusLG:r,paddingInlineLG:n}=i;return{padding:`${Bt(e)} ${Bt(n)}`,fontSize:i.inputFontSizeLG,lineHeight:t,borderRadius:r}},iT=i=>({padding:`${Bt(i.paddingBlockSM)} ${Bt(i.paddingInlineSM)}`,fontSize:i.inputFontSizeSM,borderRadius:i.borderRadiusSM}),nT=i=>Object.assign(Object.assign({position:"relative",display:"inline-block",width:"100%",minWidth:0,padding:`${Bt(i.paddingBlock)} ${Bt(i.paddingInline)}`,color:i.colorText,fontSize:i.inputFontSize,lineHeight:i.lineHeight,borderRadius:i.borderRadius,transition:`all ${i.motionDurationMid}`},E2(i.colorTextPlaceholder)),{"&-lg":Object.assign({},rT(i)),"&-sm":Object.assign({},iT(i)),"&-rtl, &-textarea-rtl":{direction:"rtl"}}),R2=i=>{const{componentCls:e,antCls:t}=i;return{position:"relative",display:"table",width:"100%",borderCollapse:"separate",borderSpacing:0,"&[class*='col-']":{paddingInlineEnd:i.paddingXS,"&:last-child":{paddingInlineEnd:0}},[`&-lg ${e}, &-lg > ${e}-group-addon`]:Object.assign({},rT(i)),[`&-sm ${e}, &-sm > ${e}-group-addon`]:Object.assign({},iT(i)),[`&-lg ${t}-select-single ${t}-select-selector`]:{height:i.controlHeightLG},[`&-sm ${t}-select-single ${t}-select-selector`]:{height:i.controlHeightSM},[`> ${e}`]:{display:"table-cell","&:not(:first-child):not(:last-child)":{borderRadius:0}},[`${e}-group`]:{"&-addon, &-wrap":{display:"table-cell",width:1,whiteSpace:"nowrap",verticalAlign:"middle","&:not(:first-child):not(:last-child)":{borderRadius:0}},"&-wrap > *":{display:"block !important"},"&-addon":{position:"relative",padding:`0 ${Bt(i.paddingInline)}`,color:i.colorText,fontWeight:"normal",fontSize:i.inputFontSize,textAlign:"center",borderRadius:i.borderRadius,transition:`all ${i.motionDurationSlow}`,lineHeight:1,[`${t}-select`]:{margin:`${Bt(i.calc(i.paddingBlock).add(1).mul(-1).equal())} ${Bt(i.calc(i.paddingInline).mul(-1).equal())}`,[`&${t}-select-single:not(${t}-select-customize-input):not(${t}-pagination-size-changer)`]:{[`${t}-select-selector`]:{backgroundColor:"inherit",border:`${Bt(i.lineWidth)} ${i.lineType} transparent`,boxShadow:"none"}}},[`${t}-cascader-picker`]:{margin:`-9px ${Bt(i.calc(i.paddingInline).mul(-1).equal())}`,backgroundColor:"transparent",[`${t}-cascader-input`]:{textAlign:"start",border:0,boxShadow:"none"}}}},[e]:{width:"100%",marginBottom:0,textAlign:"inherit","&:focus":{zIndex:1,borderInlineEndWidth:1},"&:hover":{zIndex:1,borderInlineEndWidth:1,[`${e}-search-with-button &`]:{zIndex:0}}},[`> ${e}:first-child, ${e}-group-addon:first-child`]:{borderStartEndRadius:0,borderEndEndRadius:0,[`${t}-select ${t}-select-selector`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${e}-affix-wrapper`]:{[`&:not(:first-child) ${e}`]:{borderStartStartRadius:0,borderEndStartRadius:0},[`&:not(:last-child) ${e}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`> ${e}:last-child, ${e}-group-addon:last-child`]:{borderStartStartRadius:0,borderEndStartRadius:0,[`${t}-select ${t}-select-selector`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`${e}-affix-wrapper`]:{"&:not(:last-child)":{borderStartEndRadius:0,borderEndEndRadius:0,[`${e}-search &`]:{borderStartStartRadius:i.borderRadius,borderEndStartRadius:i.borderRadius}},[`&:not(:first-child), ${e}-search &:not(:first-child)`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`&${e}-group-compact`]:Object.assign(Object.assign({display:"block"},KO()),{[`${e}-group-addon, ${e}-group-wrap, > ${e}`]:{"&:not(:first-child):not(:last-child)":{borderInlineEndWidth:i.lineWidth,"&:hover, &:focus":{zIndex:1}}},"& > *":{display:"inline-flex",float:"none",verticalAlign:"top",borderRadius:0},[`
        & > ${e}-affix-wrapper,
        & > ${e}-number-affix-wrapper,
        & > ${t}-picker-range
      `]:{display:"inline-flex"},"& > *:not(:last-child)":{marginInlineEnd:i.calc(i.lineWidth).mul(-1).equal(),borderInlineEndWidth:i.lineWidth},[e]:{float:"none"},[`& > ${t}-select > ${t}-select-selector,
      & > ${t}-select-auto-complete ${e},
      & > ${t}-cascader-picker ${e},
      & > ${e}-group-wrapper ${e}`]:{borderInlineEndWidth:i.lineWidth,borderRadius:0,"&:hover, &:focus":{zIndex:1}},[`& > ${t}-select-focused`]:{zIndex:1},[`& > ${t}-select > ${t}-select-arrow`]:{zIndex:1},[`& > *:first-child,
      & > ${t}-select:first-child > ${t}-select-selector,
      & > ${t}-select-auto-complete:first-child ${e},
      & > ${t}-cascader-picker:first-child ${e}`]:{borderStartStartRadius:i.borderRadius,borderEndStartRadius:i.borderRadius},[`& > *:last-child,
      & > ${t}-select:last-child > ${t}-select-selector,
      & > ${t}-cascader-picker:last-child ${e},
      & > ${t}-cascader-picker-focused:last-child ${e}`]:{borderInlineEndWidth:i.lineWidth,borderStartEndRadius:i.borderRadius,borderEndEndRadius:i.borderRadius},[`& > ${t}-select-auto-complete ${e}`]:{verticalAlign:"top"},[`${e}-group-wrapper + ${e}-group-wrapper`]:{marginInlineStart:i.calc(i.lineWidth).mul(-1).equal(),[`${e}-affix-wrapper`]:{borderRadius:0}},[`${e}-group-wrapper:not(:last-child)`]:{[`&${e}-search > ${e}-group`]:{[`& > ${e}-group-addon > ${e}-search-button`]:{borderRadius:0},[`& > ${e}`]:{borderStartStartRadius:i.borderRadius,borderStartEndRadius:0,borderEndEndRadius:0,borderEndStartRadius:i.borderRadius}}}})}},w2=i=>{const{componentCls:e,controlHeightSM:t,lineWidth:r,calc:n}=i,c=n(t).sub(n(r).mul(2)).sub(16).div(2).equal();return{[e]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},yw(i)),nT(i)),g2(i)),b2(i)),y2(i)),S2(i)),{'&[type="color"]':{height:i.controlHeight,[`&${e}-lg`]:{height:i.controlHeightLG},[`&${e}-sm`]:{height:t,paddingTop:c,paddingBottom:c}},'&[type="search"]::-webkit-search-cancel-button, &[type="search"]::-webkit-search-decoration':{appearance:"none"}})}},T2=i=>{const{componentCls:e}=i;return{[`${e}-clear-icon`]:{margin:0,padding:0,lineHeight:0,color:i.colorTextQuaternary,fontSize:i.fontSizeIcon,verticalAlign:-1,cursor:"pointer",transition:`color ${i.motionDurationSlow}`,border:"none",outline:"none",backgroundColor:"transparent","&:hover":{color:i.colorIcon},"&:active":{color:i.colorText},"&-hidden":{visibility:"hidden"},"&-has-suffix":{margin:`0 ${Bt(i.inputAffixPadding)}`}}}},C2=i=>{const{componentCls:e,inputAffixPadding:t,colorTextDescription:r,motionDurationSlow:n,colorIcon:a,colorIconHover:c,iconCls:l}=i,d=`${e}-affix-wrapper`,u=`${e}-affix-wrapper-disabled`;return{[d]:Object.assign(Object.assign(Object.assign(Object.assign({},nT(i)),{display:"inline-flex",[`&:not(${e}-disabled):hover`]:{zIndex:1,[`${e}-search-with-button &`]:{zIndex:0}},"&-focused, &:focus":{zIndex:1},[`> input${e}`]:{padding:0},[`> input${e}, > textarea${e}`]:{fontSize:"inherit",border:"none",borderRadius:0,outline:"none",background:"transparent",color:"inherit","&::-ms-reveal":{display:"none"},"&:focus":{boxShadow:"none !important"}},"&::before":{display:"inline-block",width:0,visibility:"hidden",content:'"\\a0"'},[e]:{"&-prefix, &-suffix":{display:"flex",flex:"none",alignItems:"center","> *:not(:last-child)":{marginInlineEnd:i.paddingXS}},"&-show-count-suffix":{color:r,direction:"ltr"},"&-show-count-has-suffix":{marginInlineEnd:i.paddingXXS},"&-prefix":{marginInlineEnd:t},"&-suffix":{marginInlineStart:t}}}),T2(i)),{[`${l}${e}-password-icon`]:{color:a,cursor:"pointer",transition:`all ${n}`,"&:hover":{color:c}}}),[`${e}-underlined`]:{borderRadius:0},[u]:{[`${l}${e}-password-icon`]:{color:a,cursor:"not-allowed","&:hover":{color:a}}}}},A2=i=>{const{componentCls:e,borderRadiusLG:t,borderRadiusSM:r}=i;return{[`${e}-group`]:Object.assign(Object.assign(Object.assign({},yw(i)),R2(i)),{"&-rtl":{direction:"rtl"},"&-wrapper":Object.assign(Object.assign(Object.assign({display:"inline-block",width:"100%",textAlign:"start",verticalAlign:"top","&-rtl":{direction:"rtl"},"&-lg":{[`${e}-group-addon`]:{borderRadius:t,fontSize:i.inputFontSizeLG}},"&-sm":{[`${e}-group-addon`]:{borderRadius:r}}},v2(i)),_2(i)),{[`&:not(${e}-compact-first-item):not(${e}-compact-last-item)${e}-compact-item`]:{[`${e}, ${e}-group-addon`]:{borderRadius:0}},[`&:not(${e}-compact-last-item)${e}-compact-first-item`]:{[`${e}, ${e}-group-addon`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&:not(${e}-compact-first-item)${e}-compact-last-item`]:{[`${e}, ${e}-group-addon`]:{borderStartStartRadius:0,borderEndStartRadius:0}},[`&:not(${e}-compact-last-item)${e}-compact-item`]:{[`${e}-affix-wrapper`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&:not(${e}-compact-first-item)${e}-compact-item`]:{[`${e}-affix-wrapper`]:{borderStartStartRadius:0,borderEndStartRadius:0}}})})}},x2=i=>{const{componentCls:e,antCls:t}=i,r=`${e}-search`;return{[r]:{[e]:{"&:hover, &:focus":{[`+ ${e}-group-addon ${r}-button:not(${t}-btn-color-primary):not(${t}-btn-variant-text)`]:{borderInlineStartColor:i.colorPrimaryHover}}},[`${e}-affix-wrapper`]:{height:i.controlHeight,borderRadius:0},[`${e}-lg`]:{lineHeight:i.calc(i.lineHeightLG).sub(2e-4).equal()},[`> ${e}-group`]:{[`> ${e}-group-addon:last-child`]:{insetInlineStart:-1,padding:0,border:0,[`${r}-button`]:{marginInlineEnd:-1,borderStartStartRadius:0,borderEndStartRadius:0,boxShadow:"none"},[`${r}-button:not(${t}-btn-color-primary)`]:{color:i.colorTextDescription,"&:hover":{color:i.colorPrimaryHover},"&:active":{color:i.colorPrimaryActive},[`&${t}-btn-loading::before`]:{inset:0}}}},[`${r}-button`]:{height:i.controlHeight,"&:hover, &:focus":{zIndex:1}},"&-large":{[`${e}-affix-wrapper, ${r}-button`]:{height:i.controlHeightLG}},"&-small":{[`${e}-affix-wrapper, ${r}-button`]:{height:i.controlHeightSM}},"&-rtl":{direction:"rtl"},[`&${e}-compact-item`]:{[`&:not(${e}-compact-last-item)`]:{[`${e}-group-addon`]:{[`${e}-search-button`]:{marginInlineEnd:i.calc(i.lineWidth).mul(-1).equal(),borderRadius:0}}},[`&:not(${e}-compact-first-item)`]:{[`${e},${e}-affix-wrapper`]:{borderRadius:0}},[`> ${e}-group-addon ${e}-search-button,
        > ${e},
        ${e}-affix-wrapper`]:{"&:hover, &:focus, &:active":{zIndex:2}},[`> ${e}-affix-wrapper-focused`]:{zIndex:2}}}}},D2=i=>{const{componentCls:e}=i;return{[`${e}-out-of-range`]:{[`&, & input, & textarea, ${e}-show-count-suffix, ${e}-data-count`]:{color:i.colorError}}}},sT=Ol(["Input","Shared"],i=>{const e=Ui(i,Af(i));return[w2(e),C2(e)]},xf,{resetFont:!1}),aT=Ol(["Input","Component"],i=>{const e=Ui(i,Af(i));return[A2(e),x2(e),D2(e),Vw(e)]},xf,{resetFont:!1});function L2(i){return!!(i.addonBefore||i.addonAfter)}function O2(i){return!!(i.prefix||i.suffix||i.allowClear)}function US(i,e,t){var r=e.cloneNode(!0),n=Object.create(i,{target:{value:r},currentTarget:{value:r}});return r.value=t,typeof e.selectionStart=="number"&&typeof e.selectionEnd=="number"&&(r.selectionStart=e.selectionStart,r.selectionEnd=e.selectionEnd),r.setSelectionRange=function(){e.setSelectionRange.apply(e,arguments)},n}function Jd(i,e,t,r){if(t){var n=e;if(e.type==="click"){n=US(e,i,""),t(n);return}if(i.type!=="file"&&r!==void 0){n=US(e,i,r),t(n);return}t(n)}}function oT(i,e){if(i){i.focus(e);var t=e||{},r=t.cursor;if(r){var n=i.value.length;switch(r){case"start":i.setSelectionRange(0,0);break;case"end":i.setSelectionRange(n,n);break;default:i.setSelectionRange(0,n)}}}}var cT=we.forwardRef(function(i,e){var t,r,n,a=i.inputElement,c=i.children,l=i.prefixCls,d=i.prefix,u=i.suffix,f=i.addonBefore,p=i.addonAfter,v=i.className,E=i.style,g=i.disabled,_=i.readOnly,m=i.focused,y=i.triggerFocus,b=i.allowClear,R=i.value,T=i.handleReset,w=i.hidden,C=i.classes,A=i.classNames,L=i.dataAttrs,D=i.styles,P=i.components,k=i.onClear,M=c??a,I=(P==null?void 0:P.affixWrapper)||"span",F=(P==null?void 0:P.groupWrapper)||"span",$=(P==null?void 0:P.wrapper)||"span",N=(P==null?void 0:P.groupAddon)||"span",U=H.useRef(null),V=function(je){var Ie;(Ie=U.current)!==null&&Ie!==void 0&&Ie.contains(je.target)&&(y==null||y())},J=O2(i),j=H.cloneElement(M,{value:R,className:tt((t=M.props)===null||t===void 0?void 0:t.className,!J&&(A==null?void 0:A.variant))||null}),q=H.useRef(null);if(we.useImperativeHandle(e,function(){return{nativeElement:q.current||U.current}}),J){var Z=null;if(b){var X=!g&&!_&&R,Y="".concat(l,"-clear-icon"),re=Xe(b)==="object"&&b!==null&&b!==void 0&&b.clearIcon?b.clearIcon:"✖";Z=we.createElement("button",{type:"button",tabIndex:-1,onClick:function(je){T==null||T(je),k==null||k()},onMouseDown:function(je){return je.preventDefault()},className:tt(Y,ie(ie({},"".concat(Y,"-hidden"),!X),"".concat(Y,"-has-suffix"),!!u))},re)}var oe="".concat(l,"-affix-wrapper"),ve=tt(oe,ie(ie(ie(ie(ie({},"".concat(l,"-disabled"),g),"".concat(oe,"-disabled"),g),"".concat(oe,"-focused"),m),"".concat(oe,"-readonly"),_),"".concat(oe,"-input-with-clear-btn"),u&&b&&R),C==null?void 0:C.affixWrapper,A==null?void 0:A.affixWrapper,A==null?void 0:A.variant),be=(u||b)&&we.createElement("span",{className:tt("".concat(l,"-suffix"),A==null?void 0:A.suffix),style:D==null?void 0:D.suffix},Z,u);j=we.createElement(I,Dr({className:ve,style:D==null?void 0:D.affixWrapper,onClick:V},L==null?void 0:L.affixWrapper,{ref:U}),d&&we.createElement("span",{className:tt("".concat(l,"-prefix"),A==null?void 0:A.prefix),style:D==null?void 0:D.prefix},d),j,be)}if(L2(i)){var Oe="".concat(l,"-group"),Pe="".concat(Oe,"-addon"),Se="".concat(Oe,"-wrapper"),Te=tt("".concat(l,"-wrapper"),Oe,C==null?void 0:C.wrapper,A==null?void 0:A.wrapper),ge=tt(Se,ie({},"".concat(Se,"-disabled"),g),C==null?void 0:C.group,A==null?void 0:A.groupWrapper);j=we.createElement(F,{className:ge,ref:q},we.createElement($,{className:Te},f&&we.createElement(N,{className:Pe},f),j,p&&we.createElement(N,{className:Pe},p)))}return we.cloneElement(j,{className:tt((r=j.props)===null||r===void 0?void 0:r.className,v)||null,style:ue(ue({},(n=j.props)===null||n===void 0?void 0:n.style),E),hidden:w})}),I2=["show"];function lT(i,e){return H.useMemo(function(){var t={};e&&(t.show=Xe(e)==="object"&&e.formatter?e.formatter:!!e),t=ue(ue({},t),i);var r=t,n=r.show,a=ti(r,I2);return ue(ue({},a),{},{show:!!n,showFormatter:typeof n=="function"?n:void 0,strategy:a.strategy||function(c){return c.length}})},[i,e])}var P2=["autoComplete","onChange","onFocus","onBlur","onPressEnter","onKeyDown","onKeyUp","prefixCls","disabled","htmlSize","className","maxLength","suffix","showCount","count","type","classes","classNames","styles","onCompositionStart","onCompositionEnd"],k2=H.forwardRef(function(i,e){var t=i.autoComplete,r=i.onChange,n=i.onFocus,a=i.onBlur,c=i.onPressEnter,l=i.onKeyDown,d=i.onKeyUp,u=i.prefixCls,f=u===void 0?"rc-input":u,p=i.disabled,v=i.htmlSize,E=i.className,g=i.maxLength,_=i.suffix,m=i.showCount,y=i.count,b=i.type,R=b===void 0?"text":b,T=i.classes,w=i.classNames,C=i.styles,A=i.onCompositionStart,L=i.onCompositionEnd,D=ti(i,P2),P=H.useState(!1),k=Be(P,2),M=k[0],I=k[1],F=H.useRef(!1),$=H.useRef(!1),N=H.useRef(null),U=H.useRef(null),V=function(Ge){N.current&&oT(N.current,Ge)},J=pv(i.defaultValue,{value:i.value}),j=Be(J,2),q=j[0],Z=j[1],X=q==null?"":String(q),Y=H.useState(null),re=Be(Y,2),oe=re[0],ve=re[1],be=lT(y,m),Oe=be.max||g,Pe=be.strategy(X),Se=!!Oe&&Pe>Oe;H.useImperativeHandle(e,function(){var $e;return{focus:V,blur:function(){var ft;(ft=N.current)===null||ft===void 0||ft.blur()},setSelectionRange:function(ft,Wt,_t){var Ze;(Ze=N.current)===null||Ze===void 0||Ze.setSelectionRange(ft,Wt,_t)},select:function(){var ft;(ft=N.current)===null||ft===void 0||ft.select()},input:N.current,nativeElement:(($e=U.current)===null||$e===void 0?void 0:$e.nativeElement)||N.current}}),H.useEffect(function(){$.current&&($.current=!1),I(function($e){return $e&&p?!1:$e})},[p]);var Te=function(Ge,ft,Wt){var _t=ft;if(!F.current&&be.exceedFormatter&&be.max&&be.strategy(ft)>be.max){if(_t=be.exceedFormatter(ft,{max:be.max}),ft!==_t){var Ze,Et;ve([((Ze=N.current)===null||Ze===void 0?void 0:Ze.selectionStart)||0,((Et=N.current)===null||Et===void 0?void 0:Et.selectionEnd)||0])}}else if(Wt.source==="compositionEnd")return;Z(_t),N.current&&Jd(N.current,Ge,r,_t)};H.useEffect(function(){if(oe){var $e;($e=N.current)===null||$e===void 0||$e.setSelectionRange.apply($e,Ye(oe))}},[oe]);var ge=function(Ge){Te(Ge,Ge.target.value,{source:"change"})},Ue=function(Ge){F.current=!1,Te(Ge,Ge.currentTarget.value,{source:"compositionEnd"}),L==null||L(Ge)},je=function(Ge){c&&Ge.key==="Enter"&&!$.current&&($.current=!0,c(Ge)),l==null||l(Ge)},Ie=function(Ge){Ge.key==="Enter"&&($.current=!1),d==null||d(Ge)},De=function(Ge){I(!0),n==null||n(Ge)},ze=function(Ge){$.current&&($.current=!1),I(!1),a==null||a(Ge)},ut=function(Ge){Z(""),V(),N.current&&Jd(N.current,Ge,r)},Ft=Se&&"".concat(f,"-out-of-range"),rt=function(){var Ge=bv(i,["prefixCls","onPressEnter","addonBefore","addonAfter","prefix","suffix","allowClear","defaultValue","showCount","count","classes","htmlSize","styles","classNames","onClear"]);return we.createElement("input",Dr({autoComplete:t},Ge,{onChange:ge,onFocus:De,onBlur:ze,onKeyDown:je,onKeyUp:Ie,className:tt(f,ie({},"".concat(f,"-disabled"),p),w==null?void 0:w.input),style:C==null?void 0:C.input,ref:N,size:v,type:R,onCompositionStart:function(Wt){F.current=!0,A==null||A(Wt)},onCompositionEnd:Ue}))},et=function(){var Ge=Number(Oe)>0;if(_||be.show){var ft=be.showFormatter?be.showFormatter({value:X,count:Pe,maxLength:Oe}):"".concat(Pe).concat(Ge?" / ".concat(Oe):"");return we.createElement(we.Fragment,null,be.show&&we.createElement("span",{className:tt("".concat(f,"-show-count-suffix"),ie({},"".concat(f,"-show-count-has-suffix"),!!_),w==null?void 0:w.count),style:ue({},C==null?void 0:C.count)},ft),_)}return null};return we.createElement(cT,Dr({},D,{prefixCls:f,className:tt(E,Ft),handleReset:ut,value:X,focused:M,triggerFocus:V,suffix:et(),disabled:p,classes:T,classNames:w,styles:C,ref:U}),rt())});const uT=i=>{let e;return typeof i=="object"&&(i!=null&&i.clearIcon)?e=i:i&&(e={clearIcon:we.createElement(KI,null)}),e};function dT(i,e){const t=H.useRef([]),r=()=>{t.current.push(setTimeout(()=>{var n,a,c,l;!((n=i.current)===null||n===void 0)&&n.input&&((a=i.current)===null||a===void 0?void 0:a.input.getAttribute("type"))==="password"&&(!((c=i.current)===null||c===void 0)&&c.input.hasAttribute("value"))&&((l=i.current)===null||l===void 0||l.input.removeAttribute("value"))}))};return H.useEffect(()=>(e&&r(),()=>t.current.forEach(n=>{n&&clearTimeout(n)})),[]),r}function M2(i){return!!(i.prefix||i.suffix||i.allowClear||i.showCount)}var N2=function(i,e){var t={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(i);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(i,r[n])&&(t[r[n]]=i[r[n]]);return t};const Df=H.forwardRef((i,e)=>{const{prefixCls:t,bordered:r=!0,status:n,size:a,disabled:c,onBlur:l,onFocus:d,suffix:u,allowClear:f,addonAfter:p,addonBefore:v,className:E,style:g,styles:_,rootClassName:m,onChange:y,classNames:b,variant:R}=i,T=N2(i,["prefixCls","bordered","status","size","disabled","onBlur","onFocus","suffix","allowClear","addonAfter","addonBefore","className","style","styles","rootClassName","onChange","classNames","variant"]),{getPrefixCls:w,direction:C,allowClear:A,autoComplete:L,className:D,style:P,classNames:k,styles:M}=hv("input"),I=w("input",t),F=H.useRef(null),$=Nw(I),[N,U,V]=sT(I,m),[J]=aT(I,$),{compactSize:j,compactItemClassnames:q}=bf(I,C),Z=kl(ze=>{var ut;return(ut=a??j)!==null&&ut!==void 0?ut:ze}),X=we.useContext(pa),Y=c??X,{status:re,hasFeedback:oe,feedbackIcon:ve}=H.useContext(ws),be=Ev(re,n),Oe=M2(i)||!!oe;H.useRef(Oe);const Pe=dT(F,!0),Se=ze=>{Pe(),l==null||l(ze)},Te=ze=>{Pe(),d==null||d(ze)},ge=ze=>{Pe(),y==null||y(ze)},Ue=(oe||u)&&we.createElement(we.Fragment,null,u,oe&&ve),je=uT(f??A),[Ie,De]=Zw("input",R,r);return N(J(we.createElement(k2,Object.assign({ref:Lo(e,F),prefixCls:I,autoComplete:L},T,{disabled:Y,onBlur:Se,onFocus:Te,style:Object.assign(Object.assign({},P),g),styles:Object.assign(Object.assign({},M),_),suffix:Ue,allowClear:je,className:tt(E,m,V,$,q,D),onChange:ge,addonBefore:v&&we.createElement(PS,{form:!0,space:!0},v),addonAfter:p&&we.createElement(PS,{form:!0,space:!0},p),classNames:Object.assign(Object.assign(Object.assign({},b),k),{input:tt({[`${I}-sm`]:Z==="small",[`${I}-lg`]:Z==="large",[`${I}-rtl`]:C==="rtl"},b==null?void 0:b.input,k.input,U),variant:tt({[`${I}-${Ie}`]:De},Ug(I,be)),affixWrapper:tt({[`${I}-affix-wrapper-sm`]:Z==="small",[`${I}-affix-wrapper-lg`]:Z==="large",[`${I}-affix-wrapper-rtl`]:C==="rtl"},U),wrapper:tt({[`${I}-group-rtl`]:C==="rtl"},U),groupWrapper:tt({[`${I}-group-wrapper-sm`]:Z==="small",[`${I}-group-wrapper-lg`]:Z==="large",[`${I}-group-wrapper-rtl`]:C==="rtl",[`${I}-group-wrapper-${Ie}`]:De},Ug(`${I}-group-wrapper`,be,oe),U)})}))))});var B2={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]},name:"eye",theme:"outlined"},F2=function(e,t){return H.createElement(xs,Dr({},e,{ref:t,icon:B2}))},U2=H.forwardRef(F2);const $2=i=>{const{getPrefixCls:e,direction:t}=H.useContext(kr),{prefixCls:r,className:n}=i,a=e("input-group",r),c=e("input"),[l,d,u]=aT(c),f=tt(a,u,{[`${a}-lg`]:i.size==="large",[`${a}-sm`]:i.size==="small",[`${a}-compact`]:i.compact,[`${a}-rtl`]:t==="rtl"},d,n),p=H.useContext(ws),v=H.useMemo(()=>Object.assign(Object.assign({},p),{isFormItemInput:!1}),[p]);return l(H.createElement("span",{className:f,style:i.style,onMouseEnter:i.onMouseEnter,onMouseLeave:i.onMouseLeave,onFocus:i.onFocus,onBlur:i.onBlur},H.createElement(ws.Provider,{value:v},i.children)))},j2=i=>{const{componentCls:e,paddingXS:t}=i;return{[e]:{display:"inline-flex",alignItems:"center",flexWrap:"nowrap",columnGap:t,[`${e}-input-wrapper`]:{position:"relative",[`${e}-mask-icon`]:{position:"absolute",zIndex:"1",top:"50%",right:"50%",transform:"translate(50%, -50%)",pointerEvents:"none"},[`${e}-mask-input`]:{color:"transparent",caretColor:"var(--ant-color-text)"},[`${e}-mask-input[type=number]::-webkit-inner-spin-button`]:{"-webkit-appearance":"none",margin:0},[`${e}-mask-input[type=number]`]:{"-moz-appearance":"textfield"}},"&-rtl":{direction:"rtl"},[`${e}-input`]:{textAlign:"center",paddingInline:i.paddingXXS},[`&${e}-sm ${e}-input`]:{paddingInline:i.calc(i.paddingXXS).div(2).equal()},[`&${e}-lg ${e}-input`]:{paddingInline:i.paddingXS}}}},z2=Ol(["Input","OTP"],i=>{const e=Ui(i,Af(i));return[j2(e)]},xf);var G2=function(i,e){var t={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(i);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(i,r[n])&&(t[r[n]]=i[r[n]]);return t};const H2=H.forwardRef((i,e)=>{const{className:t,value:r,onChange:n,onActiveChange:a,index:c,mask:l}=i,d=G2(i,["className","value","onChange","onActiveChange","index","mask"]),{getPrefixCls:u}=H.useContext(kr),f=u("otp"),p=typeof l=="string"?l:r,v=H.useRef(null);H.useImperativeHandle(e,()=>v.current);const E=y=>{n(c,y.target.value)},g=()=>{yn(()=>{var y;const b=(y=v.current)===null||y===void 0?void 0:y.input;document.activeElement===b&&b&&b.select()})},_=y=>{const{key:b,ctrlKey:R,metaKey:T}=y;b==="ArrowLeft"?a(c-1):b==="ArrowRight"?a(c+1):b==="z"&&(R||T)&&y.preventDefault(),g()},m=y=>{y.key==="Backspace"&&!r&&a(c-1),g()};return H.createElement("span",{className:`${f}-input-wrapper`,role:"presentation"},l&&r!==""&&r!==void 0&&H.createElement("span",{className:`${f}-mask-icon`,"aria-hidden":"true"},p),H.createElement(Df,Object.assign({"aria-label":`OTP Input ${c+1}`,type:l===!0?"password":"text"},d,{ref:v,value:r,onInput:E,onFocus:g,onKeyDown:_,onKeyUp:m,onMouseDown:g,onMouseUp:g,className:tt(t,{[`${f}-mask-input`]:l})})))});var V2=function(i,e){var t={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(i);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(i,r[n])&&(t[r[n]]=i[r[n]]);return t};function Zu(i){return(i||"").split("")}const K2=i=>{const{index:e,prefixCls:t,separator:r}=i,n=typeof r=="function"?r(e):r;return n?H.createElement("span",{className:`${t}-separator`},n):null},q2=H.forwardRef((i,e)=>{const{prefixCls:t,length:r=6,size:n,defaultValue:a,value:c,onChange:l,formatter:d,separator:u,variant:f,disabled:p,status:v,autoFocus:E,mask:g,type:_,onInput:m,inputMode:y}=i,b=V2(i,["prefixCls","length","size","defaultValue","value","onChange","formatter","separator","variant","disabled","status","autoFocus","mask","type","onInput","inputMode"]),{getPrefixCls:R,direction:T}=H.useContext(kr),w=R("otp",t),C=ZI(b,{aria:!0,data:!0,attr:!0}),[A,L,D]=z2(w),P=kl(Y=>n??Y),k=H.useContext(ws),M=Ev(k.status,v),I=H.useMemo(()=>Object.assign(Object.assign({},k),{status:M,hasFeedback:!1,feedbackIcon:null}),[k,M]),F=H.useRef(null),$=H.useRef({});H.useImperativeHandle(e,()=>({focus:()=>{var Y;(Y=$.current[0])===null||Y===void 0||Y.focus()},blur:()=>{var Y;for(let re=0;re<r;re+=1)(Y=$.current[re])===null||Y===void 0||Y.blur()},nativeElement:F.current}));const N=Y=>d?d(Y):Y,[U,V]=H.useState(()=>Zu(N(a||"")));H.useEffect(()=>{c!==void 0&&V(Zu(c))},[c]);const J=Rs(Y=>{V(Y),m&&m(Y),l&&Y.length===r&&Y.every(re=>re)&&Y.some((re,oe)=>U[oe]!==re)&&l(Y.join(""))}),j=Rs((Y,re)=>{let oe=Ye(U);for(let be=0;be<Y;be+=1)oe[be]||(oe[be]="");re.length<=1?oe[Y]=re:oe=oe.slice(0,Y).concat(Zu(re)),oe=oe.slice(0,r);for(let be=oe.length-1;be>=0&&!oe[be];be-=1)oe.pop();const ve=N(oe.map(be=>be||" ").join(""));return oe=Zu(ve).map((be,Oe)=>be===" "&&!oe[Oe]?oe[Oe]:be),oe}),q=(Y,re)=>{var oe;const ve=j(Y,re),be=Math.min(Y+re.length,r-1);be!==Y&&ve[Y]!==void 0&&((oe=$.current[be])===null||oe===void 0||oe.focus()),J(ve)},Z=Y=>{var re;(re=$.current[Y])===null||re===void 0||re.focus()},X={variant:f,disabled:p,status:M,mask:g,type:_,inputMode:y};return A(H.createElement("div",Object.assign({},C,{ref:F,className:tt(w,{[`${w}-sm`]:P==="small",[`${w}-lg`]:P==="large",[`${w}-rtl`]:T==="rtl"},D,L),role:"group"}),H.createElement(ws.Provider,{value:I},Array.from({length:r}).map((Y,re)=>{const oe=`otp-${re}`,ve=U[re]||"";return H.createElement(H.Fragment,{key:oe},H.createElement(H2,Object.assign({ref:be=>{$.current[re]=be},index:re,size:P,htmlSize:1,className:`${w}-input`,onChange:q,value:ve,onActiveChange:Z,autoFocus:re===0&&E},X)),re<r-1&&H.createElement(K2,{separator:u,index:re,prefixCls:w}))}))))});var Y2={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2Q889.47 375.11 816.7 305l-50.88 50.88C807.31 395.53 843.45 447.4 874.7 512 791.5 684.2 673.4 766 512 766q-72.67 0-133.87-22.38L323 798.75Q408 838 512 838q288.3 0 430.2-300.3a60.29 60.29 0 000-51.5zm-63.57-320.64L836 122.88a8 8 0 00-11.32 0L715.31 232.2Q624.86 186 512 186q-288.3 0-430.2 300.3a60.3 60.3 0 000 51.5q56.69 119.4 136.5 191.41L112.48 835a8 8 0 000 11.31L155.17 889a8 8 0 0011.31 0l712.15-712.12a8 8 0 000-11.32zM149.3 512C232.6 339.8 350.7 258 512 258c54.54 0 104.13 9.36 149.12 28.39l-70.3 70.3a176 176 0 00-238.13 238.13l-83.42 83.42C223.1 637.49 183.3 582.28 149.3 512zm246.7 0a112.11 112.11 0 01146.2-106.69L401.31 546.2A112 112 0 01396 512z"}},{tag:"path",attrs:{d:"M508 624c-3.46 0-6.87-.16-10.25-.47l-52.82 52.82a176.09 176.09 0 00227.42-227.42l-52.82 52.82c.31 3.38.47 6.79.47 10.25a111.94 111.94 0 01-112 112z"}}]},name:"eye-invisible",theme:"outlined"},W2=function(e,t){return H.createElement(xs,Dr({},e,{ref:t,icon:Y2}))},X2=H.forwardRef(W2),Q2=function(i,e){var t={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(i);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(i,r[n])&&(t[r[n]]=i[r[n]]);return t};const Z2=i=>i?H.createElement(U2,null):H.createElement(X2,null),J2={click:"onClick",hover:"onMouseOver"},eM=H.forwardRef((i,e)=>{const{disabled:t,action:r="click",visibilityToggle:n=!0,iconRender:a=Z2}=i,c=H.useContext(pa),l=t??c,d=typeof n=="object"&&n.visible!==void 0,[u,f]=H.useState(()=>d?n.visible:!1),p=H.useRef(null);H.useEffect(()=>{d&&f(n.visible)},[d,n]);const v=dT(p),E=()=>{var P;if(l)return;u&&v();const k=!u;f(k),typeof n=="object"&&((P=n.onVisibleChange)===null||P===void 0||P.call(n,k))},g=P=>{const k=J2[r]||"",M=a(u),I={[k]:E,className:`${P}-icon`,key:"passwordIcon",onMouseDown:F=>{F.preventDefault()},onMouseUp:F=>{F.preventDefault()}};return H.cloneElement(H.isValidElement(M)?M:H.createElement("span",null,M),I)},{className:_,prefixCls:m,inputPrefixCls:y,size:b}=i,R=Q2(i,["className","prefixCls","inputPrefixCls","size"]),{getPrefixCls:T}=H.useContext(kr),w=T("input",y),C=T("input-password",m),A=n&&g(C),L=tt(C,_,{[`${C}-${b}`]:!!b}),D=Object.assign(Object.assign({},bv(R,["suffix","iconRender","visibilityToggle"])),{type:u?"text":"password",className:L,prefixCls:w,suffix:A});return b&&(D.size=b),H.createElement(Df,Object.assign({ref:Lo(e,p)},D))});var tM=function(i,e){var t={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(i);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(i,r[n])&&(t[r[n]]=i[r[n]]);return t};const rM=H.forwardRef((i,e)=>{const{prefixCls:t,inputPrefixCls:r,className:n,size:a,suffix:c,enterButton:l=!1,addonAfter:d,loading:u,disabled:f,onSearch:p,onChange:v,onCompositionStart:E,onCompositionEnd:g,variant:_,onPressEnter:m}=i,y=tM(i,["prefixCls","inputPrefixCls","className","size","suffix","enterButton","addonAfter","loading","disabled","onSearch","onChange","onCompositionStart","onCompositionEnd","variant","onPressEnter"]),{getPrefixCls:b,direction:R}=H.useContext(kr),T=H.useRef(!1),w=b("input-search",t),C=b("input",r),{compactSize:A}=bf(w,R),L=kl(X=>{var Y;return(Y=a??A)!==null&&Y!==void 0?Y:X}),D=H.useRef(null),P=X=>{X!=null&&X.target&&X.type==="click"&&p&&p(X.target.value,X,{source:"clear"}),v==null||v(X)},k=X=>{var Y;document.activeElement===((Y=D.current)===null||Y===void 0?void 0:Y.input)&&X.preventDefault()},M=X=>{var Y,re;p&&p((re=(Y=D.current)===null||Y===void 0?void 0:Y.input)===null||re===void 0?void 0:re.value,X,{source:"input"})},I=X=>{T.current||u||(m==null||m(X),M(X))},F=typeof l=="boolean"?H.createElement(p2,null):null,$=`${w}-button`;let N;const U=l||{},V=U.type&&U.type.__ANT_BUTTON===!0;V||U.type==="button"?N=Wd(U,Object.assign({onMouseDown:k,onClick:X=>{var Y,re;(re=(Y=U==null?void 0:U.props)===null||Y===void 0?void 0:Y.onClick)===null||re===void 0||re.call(Y,X),M(X)},key:"enterButton"},V?{className:$,size:L}:{})):N=H.createElement(Cf,{className:$,color:l?"primary":"default",size:L,disabled:f,key:"enterButton",onMouseDown:k,onClick:M,loading:u,icon:F,variant:_==="borderless"||_==="filled"||_==="underlined"?"text":l?"solid":void 0},l),d&&(N=[N,Wd(d,{key:"addonAfter"})]);const J=tt(w,{[`${w}-rtl`]:R==="rtl",[`${w}-${L}`]:!!L,[`${w}-with-button`]:!!l},n),j=X=>{T.current=!0,E==null||E(X)},q=X=>{T.current=!1,g==null||g(X)},Z=Object.assign(Object.assign({},y),{className:J,prefixCls:C,type:"search",size:L,variant:_,onPressEnter:I,onCompositionStart:j,onCompositionEnd:q,addonAfter:N,suffix:c,onChange:P,disabled:f});return H.createElement(Df,Object.assign({ref:Lo(D,e)},Z))});var iM=`
  min-height:0 !important;
  max-height:none !important;
  height:0 !important;
  visibility:hidden !important;
  overflow:hidden !important;
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
  pointer-events: none !important;
`,nM=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing","word-break","white-space"],mm={},gi;function sM(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=i.getAttribute("id")||i.getAttribute("data-reactid")||i.getAttribute("name");if(e&&mm[t])return mm[t];var r=window.getComputedStyle(i),n=r.getPropertyValue("box-sizing")||r.getPropertyValue("-moz-box-sizing")||r.getPropertyValue("-webkit-box-sizing"),a=parseFloat(r.getPropertyValue("padding-bottom"))+parseFloat(r.getPropertyValue("padding-top")),c=parseFloat(r.getPropertyValue("border-bottom-width"))+parseFloat(r.getPropertyValue("border-top-width")),l=nM.map(function(u){return"".concat(u,":").concat(r.getPropertyValue(u))}).join(";"),d={sizingStyle:l,paddingSize:a,borderSize:c,boxSizing:n};return e&&t&&(mm[t]=d),d}function aM(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;gi||(gi=document.createElement("textarea"),gi.setAttribute("tab-index","-1"),gi.setAttribute("aria-hidden","true"),gi.setAttribute("name","hiddenTextarea"),document.body.appendChild(gi)),i.getAttribute("wrap")?gi.setAttribute("wrap",i.getAttribute("wrap")):gi.removeAttribute("wrap");var n=sM(i,e),a=n.paddingSize,c=n.borderSize,l=n.boxSizing,d=n.sizingStyle;gi.setAttribute("style","".concat(d,";").concat(iM)),gi.value=i.value||i.placeholder||"";var u=void 0,f=void 0,p,v=gi.scrollHeight;if(l==="border-box"?v+=c:l==="content-box"&&(v-=a),t!==null||r!==null){gi.value=" ";var E=gi.scrollHeight-a;t!==null&&(u=E*t,l==="border-box"&&(u=u+a+c),v=Math.max(u,v)),r!==null&&(f=E*r,l==="border-box"&&(f=f+a+c),p=v>f?"":"hidden",v=Math.min(f,v))}var g={height:v,overflowY:p,resize:"none"};return u&&(g.minHeight=u),f&&(g.maxHeight=f),g}var oM=["prefixCls","defaultValue","value","autoSize","onResize","className","style","disabled","onChange","onInternalAutoSize"],gm=0,vm=1,ym=2,cM=H.forwardRef(function(i,e){var t=i,r=t.prefixCls,n=t.defaultValue,a=t.value,c=t.autoSize,l=t.onResize,d=t.className,u=t.style,f=t.disabled,p=t.onChange;t.onInternalAutoSize;var v=ti(t,oM),E=pv(n,{value:a,postState:function(Y){return Y??""}}),g=Be(E,2),_=g[0],m=g[1],y=function(Y){m(Y.target.value),p==null||p(Y)},b=H.useRef();H.useImperativeHandle(e,function(){return{textArea:b.current}});var R=H.useMemo(function(){return c&&Xe(c)==="object"?[c.minRows,c.maxRows]:[]},[c]),T=Be(R,2),w=T[0],C=T[1],A=!!c,L=function(){try{if(document.activeElement===b.current){var Y=b.current,re=Y.selectionStart,oe=Y.selectionEnd,ve=Y.scrollTop;b.current.setSelectionRange(re,oe),b.current.scrollTop=ve}}catch{}},D=H.useState(ym),P=Be(D,2),k=P[0],M=P[1],I=H.useState(),F=Be(I,2),$=F[0],N=F[1],U=function(){M(gm)};Kd(function(){A&&U()},[a,w,C,A]),Kd(function(){if(k===gm)M(vm);else if(k===vm){var X=aM(b.current,!1,w,C);M(ym),N(X)}else L()},[k]);var V=H.useRef(),J=function(){yn.cancel(V.current)},j=function(Y){k===ym&&(l==null||l(Y),c&&(J(),V.current=yn(function(){U()})))};H.useEffect(function(){return J},[]);var q=A?$:null,Z=ue(ue({},u),q);return(k===gm||k===vm)&&(Z.overflowY="hidden",Z.overflowX="hidden"),H.createElement(PR,{onResize:j,disabled:!(c||l)},H.createElement("textarea",Dr({},v,{ref:b,style:Z,className:tt(r,d,ie({},"".concat(r,"-disabled"),f)),disabled:f,value:_,onChange:y})))}),lM=["defaultValue","value","onFocus","onBlur","onChange","allowClear","maxLength","onCompositionStart","onCompositionEnd","suffix","prefixCls","showCount","count","className","style","disabled","hidden","classNames","styles","onResize","onClear","onPressEnter","readOnly","autoSize","onKeyDown"],uM=we.forwardRef(function(i,e){var t,r=i.defaultValue,n=i.value,a=i.onFocus,c=i.onBlur,l=i.onChange,d=i.allowClear,u=i.maxLength,f=i.onCompositionStart,p=i.onCompositionEnd,v=i.suffix,E=i.prefixCls,g=E===void 0?"rc-textarea":E,_=i.showCount,m=i.count,y=i.className,b=i.style,R=i.disabled,T=i.hidden,w=i.classNames,C=i.styles,A=i.onResize,L=i.onClear,D=i.onPressEnter,P=i.readOnly,k=i.autoSize,M=i.onKeyDown,I=ti(i,lM),F=pv(r,{value:n,defaultValue:r}),$=Be(F,2),N=$[0],U=$[1],V=N==null?"":String(N),J=we.useState(!1),j=Be(J,2),q=j[0],Z=j[1],X=we.useRef(!1),Y=we.useState(null),re=Be(Y,2),oe=re[0],ve=re[1],be=H.useRef(null),Oe=H.useRef(null),Pe=function(){var Ee;return(Ee=Oe.current)===null||Ee===void 0?void 0:Ee.textArea},Se=function(){Pe().focus()};H.useImperativeHandle(e,function(){var Ce;return{resizableTextArea:Oe.current,focus:Se,blur:function(){Pe().blur()},nativeElement:((Ce=be.current)===null||Ce===void 0?void 0:Ce.nativeElement)||Pe()}}),H.useEffect(function(){Z(function(Ce){return!R&&Ce})},[R]);var Te=we.useState(null),ge=Be(Te,2),Ue=ge[0],je=ge[1];we.useEffect(function(){if(Ue){var Ce;(Ce=Pe()).setSelectionRange.apply(Ce,Ye(Ue))}},[Ue]);var Ie=lT(m,_),De=(t=Ie.max)!==null&&t!==void 0?t:u,ze=Number(De)>0,ut=Ie.strategy(V),Ft=!!De&&ut>De,rt=function(Ee,ke){var Qe=ke;!X.current&&Ie.exceedFormatter&&Ie.max&&Ie.strategy(ke)>Ie.max&&(Qe=Ie.exceedFormatter(ke,{max:Ie.max}),ke!==Qe&&je([Pe().selectionStart||0,Pe().selectionEnd||0])),U(Qe),Jd(Ee.currentTarget,Ee,l,Qe)},et=function(Ee){X.current=!0,f==null||f(Ee)},$e=function(Ee){X.current=!1,rt(Ee,Ee.currentTarget.value),p==null||p(Ee)},Ge=function(Ee){rt(Ee,Ee.target.value)},ft=function(Ee){Ee.key==="Enter"&&D&&D(Ee),M==null||M(Ee)},Wt=function(Ee){Z(!0),a==null||a(Ee)},_t=function(Ee){Z(!1),c==null||c(Ee)},Ze=function(Ee){U(""),Se(),Jd(Pe(),Ee,l)},Et=v,le;Ie.show&&(Ie.showFormatter?le=Ie.showFormatter({value:V,count:ut,maxLength:De}):le="".concat(ut).concat(ze?" / ".concat(De):""),Et=we.createElement(we.Fragment,null,Et,we.createElement("span",{className:tt("".concat(g,"-data-count"),w==null?void 0:w.count),style:C==null?void 0:C.count},le)));var pe=function(Ee){var ke;A==null||A(Ee),(ke=Pe())!==null&&ke!==void 0&&ke.style.height&&ve(!0)},_e=!k&&!_&&!d;return we.createElement(cT,{ref:be,value:V,allowClear:d,handleReset:Ze,suffix:Et,prefixCls:g,classNames:ue(ue({},w),{},{affixWrapper:tt(w==null?void 0:w.affixWrapper,ie(ie({},"".concat(g,"-show-count"),_),"".concat(g,"-textarea-allow-clear"),d))}),disabled:R,focused:q,className:tt(y,Ft&&"".concat(g,"-out-of-range")),style:ue(ue({},b),oe&&!_e?{height:"auto"}:{}),dataAttrs:{affixWrapper:{"data-count":typeof le=="string"?le:void 0}},hidden:T,readOnly:P,onClear:L},we.createElement(cM,Dr({},I,{autoSize:k,maxLength:u,onKeyDown:ft,onChange:Ge,onFocus:Wt,onBlur:_t,onCompositionStart:et,onCompositionEnd:$e,className:tt(w==null?void 0:w.textarea),style:ue(ue({},C==null?void 0:C.textarea),{},{resize:b==null?void 0:b.resize}),disabled:R,prefixCls:g,onResize:pe,ref:Oe,readOnly:P})))});const dM=i=>{const{componentCls:e,paddingLG:t}=i,r=`${e}-textarea`;return{[`textarea${e}`]:{maxWidth:"100%",height:"auto",minHeight:i.controlHeight,lineHeight:i.lineHeight,verticalAlign:"bottom",transition:`all ${i.motionDurationSlow}`,resize:"vertical",[`&${e}-mouse-active`]:{transition:`all ${i.motionDurationSlow}, height 0s, width 0s`}},[`${e}-textarea-affix-wrapper-resize-dirty`]:{width:"auto"},[r]:{position:"relative","&-show-count":{[`${e}-data-count`]:{position:"absolute",bottom:i.calc(i.fontSize).mul(i.lineHeight).mul(-1).equal(),insetInlineEnd:0,color:i.colorTextDescription,whiteSpace:"nowrap",pointerEvents:"none"}},[`
        &-allow-clear > ${e},
        &-affix-wrapper${r}-has-feedback ${e}
      `]:{paddingInlineEnd:t},[`&-affix-wrapper${e}-affix-wrapper`]:{padding:0,[`> textarea${e}`]:{fontSize:"inherit",border:"none",outline:"none",background:"transparent",minHeight:i.calc(i.controlHeight).sub(i.calc(i.lineWidth).mul(2)).equal(),"&:focus":{boxShadow:"none !important"}},[`${e}-suffix`]:{margin:0,"> *:not(:last-child)":{marginInline:0},[`${e}-clear-icon`]:{position:"absolute",insetInlineEnd:i.paddingInline,insetBlockStart:i.paddingXS},[`${r}-suffix`]:{position:"absolute",top:0,insetInlineEnd:i.paddingInline,bottom:0,zIndex:1,display:"inline-flex",alignItems:"center",margin:"auto",pointerEvents:"none"}}},[`&-affix-wrapper${e}-affix-wrapper-rtl`]:{[`${e}-suffix`]:{[`${e}-data-count`]:{direction:"ltr",insetInlineStart:0}}},[`&-affix-wrapper${e}-affix-wrapper-sm`]:{[`${e}-suffix`]:{[`${e}-clear-icon`]:{insetInlineEnd:i.paddingInlineSM}}}}}},fM=Ol(["Input","TextArea"],i=>{const e=Ui(i,Af(i));return[dM(e)]},xf,{resetFont:!1});var hM=function(i,e){var t={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(i);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(i,r[n])&&(t[r[n]]=i[r[n]]);return t};const pM=H.forwardRef((i,e)=>{var t;const{prefixCls:r,bordered:n=!0,size:a,disabled:c,status:l,allowClear:d,classNames:u,rootClassName:f,className:p,style:v,styles:E,variant:g,showCount:_,onMouseDown:m,onResize:y}=i,b=hM(i,["prefixCls","bordered","size","disabled","status","allowClear","classNames","rootClassName","className","style","styles","variant","showCount","onMouseDown","onResize"]),{getPrefixCls:R,direction:T,allowClear:w,autoComplete:C,className:A,style:L,classNames:D,styles:P}=hv("textArea"),k=H.useContext(pa),M=c??k,{status:I,hasFeedback:F,feedbackIcon:$}=H.useContext(ws),N=Ev(I,l),U=H.useRef(null);H.useImperativeHandle(e,()=>{var Ie;return{resizableTextArea:(Ie=U.current)===null||Ie===void 0?void 0:Ie.resizableTextArea,focus:De=>{var ze,ut;oT((ut=(ze=U.current)===null||ze===void 0?void 0:ze.resizableTextArea)===null||ut===void 0?void 0:ut.textArea,De)},blur:()=>{var De;return(De=U.current)===null||De===void 0?void 0:De.blur()}}});const V=R("input",r),J=Nw(V),[j,q,Z]=sT(V,f),[X]=fM(V,J),{compactSize:Y,compactItemClassnames:re}=bf(V,T),oe=kl(Ie=>{var De;return(De=a??Y)!==null&&De!==void 0?De:Ie}),[ve,be]=Zw("textArea",g,n),Oe=uT(d??w),[Pe,Se]=H.useState(!1),[Te,ge]=H.useState(!1),Ue=Ie=>{Se(!0),m==null||m(Ie);const De=()=>{Se(!1),document.removeEventListener("mouseup",De)};document.addEventListener("mouseup",De)},je=Ie=>{var De,ze;if(y==null||y(Ie),Pe&&typeof getComputedStyle=="function"){const ut=(ze=(De=U.current)===null||De===void 0?void 0:De.nativeElement)===null||ze===void 0?void 0:ze.querySelector("textarea");ut&&getComputedStyle(ut).resize==="both"&&ge(!0)}};return j(X(H.createElement(uM,Object.assign({autoComplete:C},b,{style:Object.assign(Object.assign({},L),v),styles:Object.assign(Object.assign({},P),E),disabled:M,allowClear:Oe,className:tt(Z,J,p,f,re,A,Te&&`${V}-textarea-affix-wrapper-resize-dirty`),classNames:Object.assign(Object.assign(Object.assign({},u),D),{textarea:tt({[`${V}-sm`]:oe==="small",[`${V}-lg`]:oe==="large"},q,u==null?void 0:u.textarea,D.textarea,Pe&&`${V}-mouse-active`),variant:tt({[`${V}-${ve}`]:be},Ug(V,N)),affixWrapper:tt(`${V}-textarea-affix-wrapper`,{[`${V}-affix-wrapper-rtl`]:T==="rtl",[`${V}-affix-wrapper-sm`]:oe==="small",[`${V}-affix-wrapper-lg`]:oe==="large",[`${V}-textarea-show-count`]:_||((t=i.count)===null||t===void 0?void 0:t.show)},q)}),prefixCls:V,suffix:F&&H.createElement("span",{className:`${V}-textarea-suffix`},$),showCount:_,ref:U,onResize:je,onMouseDown:Ue}))))}),ko=Df;ko.Group=$2;ko.Search=rM;ko.TextArea=pM;ko.Password=eM;ko.OTP=q2;var mM={},gM=Object.defineProperty,fT=i=>{throw TypeError(i)},vM=(i,e,t)=>e in i?gM(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,K=(i,e,t)=>vM(i,typeof e!="symbol"?e+"":e,t),hT=(i,e,t)=>e.has(i)||fT("Cannot "+t),at=(i,e,t)=>(hT(i,e,"read from private field"),t?t.call(i):e.get(i)),Ur=(i,e,t)=>e.has(i)?fT("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),qt=(i,e,t,r)=>(hT(i,e,"write to private field"),e.set(i,t),t),$S={exports:{}},jS;function yM(){return jS||(jS=1,function(i,e){(function(t,r){i.exports=r()})(self,function(){return function(){var t={"./node_modules/es6-promise/dist/es6-promise.js":function(c,l,d){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */(function(u,f){c.exports=f()})(this,function(){function u(le){var pe=typeof le;return le!==null&&(pe==="object"||pe==="function")}function f(le){return typeof le=="function"}var p=void 0;Array.isArray?p=Array.isArray:p=function(le){return Object.prototype.toString.call(le)==="[object Array]"};var v=p,E=0,g=void 0,_=void 0,m=function(le,pe){I[E]=le,I[E+1]=pe,E+=2,E===2&&(_?_(F):N())};function y(le){_=le}function b(le){m=le}var R=typeof window<"u"?window:void 0,T=R||{},w=T.MutationObserver||T.WebKitMutationObserver,C=typeof self>"u"&&typeof process<"u"&&{}.toString.call(process)==="[object process]",A=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function L(){return function(){return process.nextTick(F)}}function D(){return typeof g<"u"?function(){g(F)}:M()}function P(){var le=0,pe=new w(F),_e=document.createTextNode("");return pe.observe(_e,{characterData:!0}),function(){_e.data=le=++le%2}}function k(){var le=new MessageChannel;return le.port1.onmessage=F,function(){return le.port2.postMessage(0)}}function M(){var le=setTimeout;return function(){return le(F,1)}}var I=new Array(1e3);function F(){for(var le=0;le<E;le+=2){var pe=I[le],_e=I[le+1];pe(_e),I[le]=void 0,I[le+1]=void 0}E=0}function $(){try{var le=Function("return this")().require("vertx");return g=le.runOnLoop||le.runOnContext,D()}catch{return M()}}var N=void 0;C?N=L():w?N=P():A?N=k():R===void 0?N=$():N=M();function U(le,pe){var _e=this,Ce=new this.constructor(j);Ce[J]===void 0&&Ft(Ce);var Ee=_e._state;if(Ee){var ke=arguments[Ee-1];m(function(){return Ie(Ee,Ce,ke,_e._result)})}else Ue(_e,Ce,le,pe);return Ce}function V(le){var pe=this;if(le&&typeof le=="object"&&le.constructor===pe)return le;var _e=new pe(j);return Pe(_e,le),_e}var J=Math.random().toString(36).substring(2);function j(){}var q=void 0,Z=1,X=2;function Y(){return new TypeError("You cannot resolve a promise with itself")}function re(){return new TypeError("A promises callback cannot return that same promise.")}function oe(le,pe,_e,Ce){try{le.call(pe,_e,Ce)}catch(Ee){return Ee}}function ve(le,pe,_e){m(function(Ce){var Ee=!1,ke=oe(_e,pe,function(Qe){Ee||(Ee=!0,pe!==Qe?Pe(Ce,Qe):Te(Ce,Qe))},function(Qe){Ee||(Ee=!0,ge(Ce,Qe))},"Settle: "+(Ce._label||" unknown promise"));!Ee&&ke&&(Ee=!0,ge(Ce,ke))},le)}function be(le,pe){pe._state===Z?Te(le,pe._result):pe._state===X?ge(le,pe._result):Ue(pe,void 0,function(_e){return Pe(le,_e)},function(_e){return ge(le,_e)})}function Oe(le,pe,_e){pe.constructor===le.constructor&&_e===U&&pe.constructor.resolve===V?be(le,pe):_e===void 0?Te(le,pe):f(_e)?ve(le,pe,_e):Te(le,pe)}function Pe(le,pe){if(le===pe)ge(le,Y());else if(u(pe)){var _e=void 0;try{_e=pe.then}catch(Ce){ge(le,Ce);return}Oe(le,pe,_e)}else Te(le,pe)}function Se(le){le._onerror&&le._onerror(le._result),je(le)}function Te(le,pe){le._state===q&&(le._result=pe,le._state=Z,le._subscribers.length!==0&&m(je,le))}function ge(le,pe){le._state===q&&(le._state=X,le._result=pe,m(Se,le))}function Ue(le,pe,_e,Ce){var Ee=le._subscribers,ke=Ee.length;le._onerror=null,Ee[ke]=pe,Ee[ke+Z]=_e,Ee[ke+X]=Ce,ke===0&&le._state&&m(je,le)}function je(le){var pe=le._subscribers,_e=le._state;if(pe.length!==0){for(var Ce=void 0,Ee=void 0,ke=le._result,Qe=0;Qe<pe.length;Qe+=3)Ce=pe[Qe],Ee=pe[Qe+_e],Ce?Ie(_e,Ce,Ee,ke):Ee(ke);le._subscribers.length=0}}function Ie(le,pe,_e,Ce){var Ee=f(_e),ke=void 0,Qe=void 0,Tt=!0;if(Ee){try{ke=_e(Ce)}catch(pr){Tt=!1,Qe=pr}if(pe===ke){ge(pe,re());return}}else ke=Ce;pe._state!==q||(Ee&&Tt?Pe(pe,ke):Tt===!1?ge(pe,Qe):le===Z?Te(pe,ke):le===X&&ge(pe,ke))}function De(le,pe){try{pe(function(_e){Pe(le,_e)},function(_e){ge(le,_e)})}catch(_e){ge(le,_e)}}var ze=0;function ut(){return ze++}function Ft(le){le[J]=ze++,le._state=void 0,le._result=void 0,le._subscribers=[]}function rt(){return new Error("Array Methods must be provided an Array")}var et=function(){function le(pe,_e){this._instanceConstructor=pe,this.promise=new pe(j),this.promise[J]||Ft(this.promise),v(_e)?(this.length=_e.length,this._remaining=_e.length,this._result=new Array(this.length),this.length===0?Te(this.promise,this._result):(this.length=this.length||0,this._enumerate(_e),this._remaining===0&&Te(this.promise,this._result))):ge(this.promise,rt())}return le.prototype._enumerate=function(pe){for(var _e=0;this._state===q&&_e<pe.length;_e++)this._eachEntry(pe[_e],_e)},le.prototype._eachEntry=function(pe,_e){var Ce=this._instanceConstructor,Ee=Ce.resolve;if(Ee===V){var ke=void 0,Qe=void 0,Tt=!1;try{ke=pe.then}catch(Si){Tt=!0,Qe=Si}if(ke===U&&pe._state!==q)this._settledAt(pe._state,_e,pe._result);else if(typeof ke!="function")this._remaining--,this._result[_e]=pe;else if(Ce===Ze){var pr=new Ce(j);Tt?ge(pr,Qe):Oe(pr,pe,ke),this._willSettleAt(pr,_e)}else this._willSettleAt(new Ce(function(Si){return Si(pe)}),_e)}else this._willSettleAt(Ee(pe),_e)},le.prototype._settledAt=function(pe,_e,Ce){var Ee=this.promise;Ee._state===q&&(this._remaining--,pe===X?ge(Ee,Ce):this._result[_e]=Ce),this._remaining===0&&Te(Ee,this._result)},le.prototype._willSettleAt=function(pe,_e){var Ce=this;Ue(pe,void 0,function(Ee){return Ce._settledAt(Z,_e,Ee)},function(Ee){return Ce._settledAt(X,_e,Ee)})},le}();function $e(le){return new et(this,le).promise}function Ge(le){var pe=this;return v(le)?new pe(function(_e,Ce){for(var Ee=le.length,ke=0;ke<Ee;ke++)pe.resolve(le[ke]).then(_e,Ce)}):new pe(function(_e,Ce){return Ce(new TypeError("You must pass an array to race."))})}function ft(le){var pe=this,_e=new pe(j);return ge(_e,le),_e}function Wt(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function _t(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var Ze=function(){function le(pe){this[J]=ut(),this._result=this._state=void 0,this._subscribers=[],j!==pe&&(typeof pe!="function"&&Wt(),this instanceof le?De(this,pe):_t())}return le.prototype.catch=function(pe){return this.then(null,pe)},le.prototype.finally=function(pe){var _e=this,Ce=_e.constructor;return f(pe)?_e.then(function(Ee){return Ce.resolve(pe()).then(function(){return Ee})},function(Ee){return Ce.resolve(pe()).then(function(){throw Ee})}):_e.then(pe,pe)},le}();Ze.prototype.then=U,Ze.all=$e,Ze.race=Ge,Ze.resolve=V,Ze.reject=ft,Ze._setScheduler=y,Ze._setAsap=b,Ze._asap=m;function Et(){var le=void 0;if(typeof d.g<"u")le=d.g;else if(typeof self<"u")le=self;else try{le=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var pe=le.Promise;if(pe){var _e=null;try{_e=Object.prototype.toString.call(pe.resolve())}catch{}if(_e==="[object Promise]"&&!pe.cast)return}le.Promise=Ze}return Ze.polyfill=Et,Ze.Promise=Ze,Ze})},"./node_modules/events/events.js":function(c){var l=typeof Reflect=="object"?Reflect:null,d=l&&typeof l.apply=="function"?l.apply:function(k,M,I){return Function.prototype.apply.call(k,M,I)},u;l&&typeof l.ownKeys=="function"?u=l.ownKeys:Object.getOwnPropertySymbols?u=function(k){return Object.getOwnPropertyNames(k).concat(Object.getOwnPropertySymbols(k))}:u=function(k){return Object.getOwnPropertyNames(k)};function f(k){console&&console.warn&&console.warn(k)}var p=Number.isNaN||function(k){return k!==k};function v(){v.init.call(this)}c.exports=v,c.exports.once=L,v.EventEmitter=v,v.prototype._events=void 0,v.prototype._eventsCount=0,v.prototype._maxListeners=void 0;var E=10;function g(k){if(typeof k!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof k)}Object.defineProperty(v,"defaultMaxListeners",{enumerable:!0,get:function(){return E},set:function(k){if(typeof k!="number"||k<0||p(k))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+k+".");E=k}}),v.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},v.prototype.setMaxListeners=function(k){if(typeof k!="number"||k<0||p(k))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+k+".");return this._maxListeners=k,this};function _(k){return k._maxListeners===void 0?v.defaultMaxListeners:k._maxListeners}v.prototype.getMaxListeners=function(){return _(this)},v.prototype.emit=function(k){for(var M=[],I=1;I<arguments.length;I++)M.push(arguments[I]);var F=k==="error",$=this._events;if($!==void 0)F=F&&$.error===void 0;else if(!F)return!1;if(F){var N;if(M.length>0&&(N=M[0]),N instanceof Error)throw N;var U=new Error("Unhandled error."+(N?" ("+N.message+")":""));throw U.context=N,U}var V=$[k];if(V===void 0)return!1;if(typeof V=="function")d(V,this,M);else for(var J=V.length,j=w(V,J),I=0;I<J;++I)d(j[I],this,M);return!0};function m(k,M,I,F){var $,N,U;if(g(I),N=k._events,N===void 0?(N=k._events=Object.create(null),k._eventsCount=0):(N.newListener!==void 0&&(k.emit("newListener",M,I.listener?I.listener:I),N=k._events),U=N[M]),U===void 0)U=N[M]=I,++k._eventsCount;else if(typeof U=="function"?U=N[M]=F?[I,U]:[U,I]:F?U.unshift(I):U.push(I),$=_(k),$>0&&U.length>$&&!U.warned){U.warned=!0;var V=new Error("Possible EventEmitter memory leak detected. "+U.length+" "+String(M)+" listeners added. Use emitter.setMaxListeners() to increase limit");V.name="MaxListenersExceededWarning",V.emitter=k,V.type=M,V.count=U.length,f(V)}return k}v.prototype.addListener=function(k,M){return m(this,k,M,!1)},v.prototype.on=v.prototype.addListener,v.prototype.prependListener=function(k,M){return m(this,k,M,!0)};function y(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function b(k,M,I){var F={fired:!1,wrapFn:void 0,target:k,type:M,listener:I},$=y.bind(F);return $.listener=I,F.wrapFn=$,$}v.prototype.once=function(k,M){return g(M),this.on(k,b(this,k,M)),this},v.prototype.prependOnceListener=function(k,M){return g(M),this.prependListener(k,b(this,k,M)),this},v.prototype.removeListener=function(k,M){var I,F,$,N,U;if(g(M),F=this._events,F===void 0)return this;if(I=F[k],I===void 0)return this;if(I===M||I.listener===M)--this._eventsCount===0?this._events=Object.create(null):(delete F[k],F.removeListener&&this.emit("removeListener",k,I.listener||M));else if(typeof I!="function"){for($=-1,N=I.length-1;N>=0;N--)if(I[N]===M||I[N].listener===M){U=I[N].listener,$=N;break}if($<0)return this;$===0?I.shift():C(I,$),I.length===1&&(F[k]=I[0]),F.removeListener!==void 0&&this.emit("removeListener",k,U||M)}return this},v.prototype.off=v.prototype.removeListener,v.prototype.removeAllListeners=function(k){var M,I,F;if(I=this._events,I===void 0)return this;if(I.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):I[k]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete I[k]),this;if(arguments.length===0){var $=Object.keys(I),N;for(F=0;F<$.length;++F)N=$[F],N!=="removeListener"&&this.removeAllListeners(N);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(M=I[k],typeof M=="function")this.removeListener(k,M);else if(M!==void 0)for(F=M.length-1;F>=0;F--)this.removeListener(k,M[F]);return this};function R(k,M,I){var F=k._events;if(F===void 0)return[];var $=F[M];return $===void 0?[]:typeof $=="function"?I?[$.listener||$]:[$]:I?A($):w($,$.length)}v.prototype.listeners=function(k){return R(this,k,!0)},v.prototype.rawListeners=function(k){return R(this,k,!1)},v.listenerCount=function(k,M){return typeof k.listenerCount=="function"?k.listenerCount(M):T.call(k,M)},v.prototype.listenerCount=T;function T(k){var M=this._events;if(M!==void 0){var I=M[k];if(typeof I=="function")return 1;if(I!==void 0)return I.length}return 0}v.prototype.eventNames=function(){return this._eventsCount>0?u(this._events):[]};function w(k,M){for(var I=new Array(M),F=0;F<M;++F)I[F]=k[F];return I}function C(k,M){for(;M+1<k.length;M++)k[M]=k[M+1];k.pop()}function A(k){for(var M=new Array(k.length),I=0;I<M.length;++I)M[I]=k[I].listener||k[I];return M}function L(k,M){return new Promise(function(I,F){function $(U){k.removeListener(M,N),F(U)}function N(){typeof k.removeListener=="function"&&k.removeListener("error",$),I([].slice.call(arguments))}P(k,M,N,{once:!0}),M!=="error"&&D(k,$,{once:!0})})}function D(k,M,I){typeof k.on=="function"&&P(k,"error",M,I)}function P(k,M,I,F){if(typeof k.on=="function")F.once?k.once(M,I):k.on(M,I);else if(typeof k.addEventListener=="function")k.addEventListener(M,function $(N){F.once&&k.removeEventListener(M,$),I(N)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof k)}},"./node_modules/webworkify-webpack/index.js":function(c,l,d){function u(y){var b={};function R(w){if(b[w])return b[w].exports;var C=b[w]={i:w,l:!1,exports:{}};return y[w].call(C.exports,C,C.exports,R),C.l=!0,C.exports}R.m=y,R.c=b,R.i=function(w){return w},R.d=function(w,C,A){R.o(w,C)||Object.defineProperty(w,C,{configurable:!1,enumerable:!0,get:A})},R.r=function(w){Object.defineProperty(w,"__esModule",{value:!0})},R.n=function(w){var C=w&&w.__esModule?function(){return w.default}:function(){return w};return R.d(C,"a",C),C},R.o=function(w,C){return Object.prototype.hasOwnProperty.call(w,C)},R.p="/",R.oe=function(w){throw console.error(w),w};var T=R(R.s=ENTRY_MODULE);return T.default||T}var f="[\\.|\\-|\\+|\\w|/|@]+",p="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+f+").*?\\)";function v(y){return(y+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function E(y){return!isNaN(1*y)}function g(y,b,R){var T={};T[R]=[];var w=b.toString(),C=w.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!C)return T;for(var A=C[1],L=new RegExp("(\\\\n|\\W)"+v(A)+p,"g"),D;D=L.exec(w);)D[3]!=="dll-reference"&&T[R].push(D[3]);for(L=new RegExp("\\("+v(A)+'\\("(dll-reference\\s('+f+'))"\\)\\)'+p,"g");D=L.exec(w);)y[D[2]]||(T[R].push(D[1]),y[D[2]]=d(D[1]).m),T[D[2]]=T[D[2]]||[],T[D[2]].push(D[4]);for(var P=Object.keys(T),k=0;k<P.length;k++)for(var M=0;M<T[P[k]].length;M++)E(T[P[k]][M])&&(T[P[k]][M]=1*T[P[k]][M]);return T}function _(y){var b=Object.keys(y);return b.reduce(function(R,T){return R||y[T].length>0},!1)}function m(y,b){for(var R={main:[b]},T={main:[]},w={main:{}};_(R);)for(var C=Object.keys(R),A=0;A<C.length;A++){var L=C[A],D=R[L],P=D.pop();if(w[L]=w[L]||{},!(w[L][P]||!y[L][P])){w[L][P]=!0,T[L]=T[L]||[],T[L].push(P);for(var k=g(y,y[L][P],L),M=Object.keys(k),I=0;I<M.length;I++)R[M[I]]=R[M[I]]||[],R[M[I]]=R[M[I]].concat(k[M[I]])}}return T}c.exports=function(y,b){b=b||{};var R={main:d.m},T=b.all?{main:Object.keys(R.main)}:m(R,y),w="";Object.keys(T).filter(function(P){return P!=="main"}).forEach(function(P){for(var k=0;T[P][k];)k++;T[P].push(k),R[P][k]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",w=w+"var "+P+" = ("+u.toString().replace("ENTRY_MODULE",JSON.stringify(k))+")({"+T[P].map(function(M){return""+JSON.stringify(M)+": "+R[P][M].toString()}).join(",")+`});
`}),w=w+"new (("+u.toString().replace("ENTRY_MODULE",JSON.stringify(y))+")({"+T.main.map(function(P){return""+JSON.stringify(P)+": "+R.main[P].toString()}).join(",")+"}))(self);";var C=new window.Blob([w],{type:"text/javascript"});if(b.bare)return C;var A=window.URL||window.webkitURL||window.mozURL||window.msURL,L=A.createObjectURL(C),D=new window.Worker(L);return D.objectURL=L,D}},"./src/config.js":function(c,l,d){d.r(l),d.d(l,{defaultConfig:function(){return u},createDefaultConfig:function(){return f}});var u={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:3*60,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:3*60,autoCleanupMinBackwardDuration:2*60,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function f(){return Object.assign({},u)}},"./src/core/features.js":function(c,l,d){d.r(l);var u=d("./src/io/io-controller.js"),f=d("./src/config.js"),p=function(){function v(){}return v.supportMSEH264Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')},v.supportNetworkStreamIO=function(){var E=new u.default({},(0,f.createDefaultConfig)()),g=E.loaderType;return E.destroy(),g=="fetch-stream-loader"||g=="xhr-moz-chunked-loader"},v.getNetworkLoaderTypeName=function(){var E=new u.default({},(0,f.createDefaultConfig)()),g=E.loaderType;return E.destroy(),g},v.supportNativeMediaPlayback=function(E){v.videoElement==null&&(v.videoElement=window.document.createElement("video"));var g=v.videoElement.canPlayType(E);return g==="probably"||g=="maybe"},v.getFeatureList=function(){var E={mseFlvPlayback:!1,mseLiveFlvPlayback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return E.mseFlvPlayback=v.supportMSEH264Playback(),E.networkStreamIO=v.supportNetworkStreamIO(),E.networkLoaderName=v.getNetworkLoaderTypeName(),E.mseLiveFlvPlayback=E.mseFlvPlayback&&E.networkStreamIO,E.nativeMP4H264Playback=v.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),E.nativeWebmVP8Playback=v.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),E.nativeWebmVP9Playback=v.supportNativeMediaPlayback('video/webm; codecs="vp9"'),E},v}();l.default=p},"./src/core/media-info.js":function(c,l,d){d.r(l);var u=function(){function f(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return f.prototype.isComplete=function(){var p=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,v=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&this.duration!=null&&this.metadata!=null&&this.hasKeyframesIndex!=null&&p&&v},f.prototype.isSeekable=function(){return this.hasKeyframesIndex===!0},f.prototype.getNearestKeyframe=function(p){if(this.keyframesIndex==null)return null;var v=this.keyframesIndex,E=this._search(v.times,p);return{index:E,milliseconds:v.times[E],fileposition:v.filepositions[E]}},f.prototype._search=function(p,v){var E=0,g=p.length-1,_=0,m=0,y=g;for(v<p[0]&&(E=0,m=y+1);m<=y;)if(_=m+Math.floor((y-m)/2),_===g||v>=p[_]&&v<p[_+1]){E=_;break}else p[_]<v?m=_+1:y=_-1;return E},f}();l.default=u},"./src/core/media-segment-info.js":function(c,l,d){d.r(l),d.d(l,{SampleInfo:function(){return u},MediaSegmentInfo:function(){return f},IDRSampleList:function(){return p},MediaSegmentInfoList:function(){return v}});var u=function(){function E(g,_,m,y,b){this.dts=g,this.pts=_,this.duration=m,this.originalDts=y,this.isSyncPoint=b,this.fileposition=null}return E}(),f=function(){function E(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return E.prototype.appendSyncPoint=function(g){g.isSyncPoint=!0,this.syncPoints.push(g)},E}(),p=function(){function E(){this._list=[]}return E.prototype.clear=function(){this._list=[]},E.prototype.appendArray=function(g){var _=this._list;g.length!==0&&(_.length>0&&g[0].originalDts<_[_.length-1].originalDts&&this.clear(),Array.prototype.push.apply(_,g))},E.prototype.getLastSyncPointBeforeDts=function(g){if(this._list.length==0)return null;var _=this._list,m=0,y=_.length-1,b=0,R=0,T=y;for(g<_[0].dts&&(m=0,R=T+1);R<=T;)if(b=R+Math.floor((T-R)/2),b===y||g>=_[b].dts&&g<_[b+1].dts){m=b;break}else _[b].dts<g?R=b+1:T=b-1;return this._list[m]},E}(),v=function(){function E(g){this._type=g,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(E.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),E.prototype.isEmpty=function(){return this._list.length===0},E.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},E.prototype._searchNearestSegmentBefore=function(g){var _=this._list;if(_.length===0)return-2;var m=_.length-1,y=0,b=0,R=m,T=0;if(g<_[0].originalBeginDts)return T=-1,T;for(;b<=R;)if(y=b+Math.floor((R-b)/2),y===m||g>_[y].lastSample.originalDts&&g<_[y+1].originalBeginDts){T=y;break}else _[y].originalBeginDts<g?b=y+1:R=y-1;return T},E.prototype._searchNearestSegmentAfter=function(g){return this._searchNearestSegmentBefore(g)+1},E.prototype.append=function(g){var _=this._list,m=g,y=this._lastAppendLocation,b=0;y!==-1&&y<_.length&&m.originalBeginDts>=_[y].lastSample.originalDts&&(y===_.length-1||y<_.length-1&&m.originalBeginDts<_[y+1].originalBeginDts)?b=y+1:_.length>0&&(b=this._searchNearestSegmentBefore(m.originalBeginDts)+1),this._lastAppendLocation=b,this._list.splice(b,0,m)},E.prototype.getLastSegmentBefore=function(g){var _=this._searchNearestSegmentBefore(g);return _>=0?this._list[_]:null},E.prototype.getLastSampleBefore=function(g){var _=this.getLastSegmentBefore(g);return _!=null?_.lastSample:null},E.prototype.getLastSyncPointBefore=function(g){for(var _=this._searchNearestSegmentBefore(g),m=this._list[_].syncPoints;m.length===0&&_>0;)_--,m=this._list[_].syncPoints;return m.length>0?m[m.length-1]:null},E}()},"./src/core/mse-controller.js":function(c,l,d){d.r(l);var u=d("./node_modules/events/events.js"),f=d.n(u),p=d("./src/utils/logger.js"),v=d("./src/utils/browser.js"),E=d("./src/core/mse-events.js"),g=d("./src/core/media-segment-info.js"),_=d("./src/utils/exception.js"),m=function(){function y(b){this.TAG="MSEController",this._config=b,this._emitter=new(f()),this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new g.IDRSampleList}return y.prototype.destroy=function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},y.prototype.on=function(b,R){this._emitter.addListener(b,R)},y.prototype.off=function(b,R){this._emitter.removeListener(b,R)},y.prototype.attachMediaElement=function(b){if(this._mediaSource)throw new _.IllegalStateException("MediaSource has been attached to an HTMLMediaElement!");var R=this._mediaSource=new window.MediaSource;R.addEventListener("sourceopen",this.e.onSourceOpen),R.addEventListener("sourceended",this.e.onSourceEnded),R.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=b,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),b.src=this._mediaSourceObjectURL},y.prototype.detachMediaElement=function(){if(this._mediaSource){var b=this._mediaSource;for(var R in this._sourceBuffers){var T=this._pendingSegments[R];T.splice(0,T.length),this._pendingSegments[R]=null,this._pendingRemoveRanges[R]=null,this._lastInitSegments[R]=null;var w=this._sourceBuffers[R];if(w){if(b.readyState!=="closed"){try{b.removeSourceBuffer(w)}catch(C){p.default.e(this.TAG,C.message)}w.removeEventListener("error",this.e.onSourceBufferError),w.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[R]=null,this._sourceBuffers[R]=null}}if(b.readyState==="open")try{b.endOfStream()}catch(C){p.default.e(this.TAG,C.message)}b.removeEventListener("sourceopen",this.e.onSourceOpen),b.removeEventListener("sourceended",this.e.onSourceEnded),b.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},y.prototype.appendInitSegment=function(b,R){if(!this._mediaSource||this._mediaSource.readyState!=="open"){this._pendingSourceBufferInit.push(b),this._pendingSegments[b.type].push(b);return}var T=b,w=""+T.container;T.codec&&T.codec.length>0&&(w+=";codecs="+T.codec);var C=!1;if(p.default.v(this.TAG,"Received Initialization Segment, mimeType: "+w),this._lastInitSegments[T.type]=T,w!==this._mimeTypes[T.type]){if(this._mimeTypes[T.type])p.default.v(this.TAG,"Notice: "+T.type+" mimeType changed, origin: "+this._mimeTypes[T.type]+", target: "+w);else{C=!0;try{var A=this._sourceBuffers[T.type]=this._mediaSource.addSourceBuffer(w);A.addEventListener("error",this.e.onSourceBufferError),A.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(L){p.default.e(this.TAG,L.message),this._emitter.emit(E.default.ERROR,{code:L.code,msg:L.message});return}}this._mimeTypes[T.type]=w}R||this._pendingSegments[T.type].push(T),C||this._sourceBuffers[T.type]&&!this._sourceBuffers[T.type].updating&&this._doAppendSegments(),v.default.safari&&T.container==="audio/mpeg"&&T.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=T.mediaDuration/1e3,this._updateMediaSourceDuration())},y.prototype.appendMediaSegment=function(b){var R=b;this._pendingSegments[R.type].push(R),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var T=this._sourceBuffers[R.type];T&&!T.updating&&!this._hasPendingRemoveRanges()&&this._doAppendSegments()},y.prototype.seek=function(b){for(var R in this._sourceBuffers)if(this._sourceBuffers[R]){var T=this._sourceBuffers[R];if(this._mediaSource.readyState==="open")try{T.abort()}catch(P){p.default.e(this.TAG,P.message)}this._idrList.clear();var w=this._pendingSegments[R];if(w.splice(0,w.length),this._mediaSource.readyState!=="closed"){for(var C=0;C<T.buffered.length;C++){var A=T.buffered.start(C),L=T.buffered.end(C);this._pendingRemoveRanges[R].push({start:A,end:L})}if(T.updating||this._doRemoveRanges(),v.default.safari){var D=this._lastInitSegments[R];D&&(this._pendingSegments[R].push(D),T.updating||this._doAppendSegments())}}}},y.prototype.endOfStream=function(){var b=this._mediaSource,R=this._sourceBuffers;if(!b||b.readyState!=="open"){b&&b.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0);return}R.video&&R.video.updating||R.audio&&R.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,b.endOfStream())},y.prototype.getNearestKeyframe=function(b){return this._idrList.getLastSyncPointBeforeDts(b)},y.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var b=this._mediaElement.currentTime;for(var R in this._sourceBuffers){var T=this._sourceBuffers[R];if(T){var w=T.buffered;if(w.length>=1&&b-w.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},y.prototype._doCleanupSourceBuffer=function(){var b=this._mediaElement.currentTime;for(var R in this._sourceBuffers){var T=this._sourceBuffers[R];if(T){for(var w=T.buffered,C=!1,A=0;A<w.length;A++){var L=w.start(A),D=w.end(A);if(L<=b&&b<D+3){if(b-L>=this._config.autoCleanupMaxBackwardDuration){C=!0;var P=b-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[R].push({start:L,end:P})}}else D<b&&(C=!0,this._pendingRemoveRanges[R].push({start:L,end:D}))}C&&!T.updating&&this._doRemoveRanges()}}},y.prototype._updateMediaSourceDuration=function(){var b=this._sourceBuffers;if(!(this._mediaElement.readyState===0||this._mediaSource.readyState!=="open")&&!(b.video&&b.video.updating||b.audio&&b.audio.updating)){var R=this._mediaSource.duration,T=this._pendingMediaDuration;T>0&&(isNaN(R)||T>R)&&(p.default.v(this.TAG,"Update MediaSource duration from "+R+" to "+T),this._mediaSource.duration=T),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},y.prototype._doRemoveRanges=function(){for(var b in this._pendingRemoveRanges)if(!(!this._sourceBuffers[b]||this._sourceBuffers[b].updating))for(var R=this._sourceBuffers[b],T=this._pendingRemoveRanges[b];T.length&&!R.updating;){var w=T.shift();R.remove(w.start,w.end)}},y.prototype._doAppendSegments=function(){var b=this._pendingSegments;for(var R in b)if(!(!this._sourceBuffers[R]||this._sourceBuffers[R].updating)&&b[R].length>0){var T=b[R].shift();if(T.timestampOffset){var w=this._sourceBuffers[R].timestampOffset,C=T.timestampOffset/1e3,A=Math.abs(w-C);A>.1&&(p.default.v(this.TAG,"Update MPEG audio timestampOffset from "+w+" to "+C),this._sourceBuffers[R].timestampOffset=C),delete T.timestampOffset}if(!T.data||T.data.byteLength===0)continue;try{this._sourceBuffers[R].appendBuffer(T.data),this._isBufferFull=!1,R==="video"&&T.hasOwnProperty("info")&&this._idrList.appendArray(T.info.syncPoints)}catch(L){this._pendingSegments[R].unshift(T),L.code===22?(this._isBufferFull||this._emitter.emit(E.default.BUFFER_FULL),this._isBufferFull=!0):(p.default.e(this.TAG,L.message),this._emitter.emit(E.default.ERROR,{code:L.code,msg:L.message}))}}},y.prototype._onSourceOpen=function(){if(p.default.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var b=this._pendingSourceBufferInit;b.length;){var R=b.shift();this.appendInitSegment(R,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(E.default.SOURCE_OPEN)},y.prototype._onSourceEnded=function(){p.default.v(this.TAG,"MediaSource onSourceEnded")},y.prototype._onSourceClose=function(){p.default.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))},y.prototype._hasPendingSegments=function(){var b=this._pendingSegments;return b.video.length>0||b.audio.length>0},y.prototype._hasPendingRemoveRanges=function(){var b=this._pendingRemoveRanges;return b.video.length>0||b.audio.length>0},y.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(E.default.UPDATE_END)},y.prototype._onSourceBufferError=function(b){p.default.e(this.TAG,"SourceBuffer Error: "+b)},y}();l.default=m},"./src/core/mse-events.js":function(c,l,d){d.r(l);var u={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"};l.default=u},"./src/core/transmuxer.js":function(c,l,d){d.r(l);var u=d("./node_modules/events/events.js"),f=d.n(u),p=d("./node_modules/webworkify-webpack/index.js"),v=d.n(p),E=d("./src/utils/logger.js"),g=d("./src/utils/logging-control.js"),_=d("./src/core/transmuxing-controller.js"),m=d("./src/core/transmuxing-events.js"),y=d("./src/core/media-info.js"),b=function(){function R(T,w){if(this.TAG="Transmuxer",this._emitter=new(f()),w.enableWorker&&typeof Worker<"u")try{this._worker=v()("./src/core/transmuxing-worker.js"),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[T,w]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},g.default.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:g.default.getConfig()})}catch{E.default.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new _.default(T,w)}else this._controller=new _.default(T,w);if(this._controller){var C=this._controller;C.on(m.default.IO_ERROR,this._onIOError.bind(this)),C.on(m.default.DEMUX_ERROR,this._onDemuxError.bind(this)),C.on(m.default.INIT_SEGMENT,this._onInitSegment.bind(this)),C.on(m.default.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),C.on(m.default.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),C.on(m.default.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),C.on(m.default.MEDIA_INFO,this._onMediaInfo.bind(this)),C.on(m.default.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),C.on(m.default.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),C.on(m.default.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),C.on(m.default.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return R.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),g.default.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},R.prototype.on=function(T,w){this._emitter.addListener(T,w)},R.prototype.off=function(T,w){this._emitter.removeListener(T,w)},R.prototype.hasWorker=function(){return this._worker!=null},R.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},R.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},R.prototype.seek=function(T){this._worker?this._worker.postMessage({cmd:"seek",param:T}):this._controller.seek(T)},R.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},R.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},R.prototype._onInitSegment=function(T,w){var C=this;Promise.resolve().then(function(){C._emitter.emit(m.default.INIT_SEGMENT,T,w)})},R.prototype._onMediaSegment=function(T,w){var C=this;Promise.resolve().then(function(){C._emitter.emit(m.default.MEDIA_SEGMENT,T,w)})},R.prototype._onLoadingComplete=function(){var T=this;Promise.resolve().then(function(){T._emitter.emit(m.default.LOADING_COMPLETE)})},R.prototype._onRecoveredEarlyEof=function(){var T=this;Promise.resolve().then(function(){T._emitter.emit(m.default.RECOVERED_EARLY_EOF)})},R.prototype._onMediaInfo=function(T){var w=this;Promise.resolve().then(function(){w._emitter.emit(m.default.MEDIA_INFO,T)})},R.prototype._onMetaDataArrived=function(T){var w=this;Promise.resolve().then(function(){w._emitter.emit(m.default.METADATA_ARRIVED,T)})},R.prototype._onScriptDataArrived=function(T){var w=this;Promise.resolve().then(function(){w._emitter.emit(m.default.SCRIPTDATA_ARRIVED,T)})},R.prototype._onStatisticsInfo=function(T){var w=this;Promise.resolve().then(function(){w._emitter.emit(m.default.STATISTICS_INFO,T)})},R.prototype._onIOError=function(T,w){var C=this;Promise.resolve().then(function(){C._emitter.emit(m.default.IO_ERROR,T,w)})},R.prototype._onDemuxError=function(T,w){var C=this;Promise.resolve().then(function(){C._emitter.emit(m.default.DEMUX_ERROR,T,w)})},R.prototype._onRecommendSeekpoint=function(T){var w=this;Promise.resolve().then(function(){w._emitter.emit(m.default.RECOMMEND_SEEKPOINT,T)})},R.prototype._onLoggingConfigChanged=function(T){this._worker&&this._worker.postMessage({cmd:"logging_config",param:T})},R.prototype._onWorkerMessage=function(T){var w=T.data,C=w.data;if(w.msg==="destroyed"||this._workerDestroying){this._workerDestroying=!1,this._worker.terminate(),this._worker=null;return}switch(w.msg){case m.default.INIT_SEGMENT:case m.default.MEDIA_SEGMENT:this._emitter.emit(w.msg,C.type,C.data);break;case m.default.LOADING_COMPLETE:case m.default.RECOVERED_EARLY_EOF:this._emitter.emit(w.msg);break;case m.default.MEDIA_INFO:Object.setPrototypeOf(C,y.default.prototype),this._emitter.emit(w.msg,C);break;case m.default.METADATA_ARRIVED:case m.default.SCRIPTDATA_ARRIVED:case m.default.STATISTICS_INFO:this._emitter.emit(w.msg,C);break;case m.default.IO_ERROR:case m.default.DEMUX_ERROR:this._emitter.emit(w.msg,C.type,C.info);break;case m.default.RECOMMEND_SEEKPOINT:this._emitter.emit(w.msg,C);break;case"logcat_callback":E.default.emitter.emit("log",C.type,C.logcat);break}},R}();l.default=b},"./src/core/transmuxing-controller.js":function(c,l,d){d.r(l);var u=d("./node_modules/events/events.js"),f=d.n(u),p=d("./src/utils/logger.js"),v=d("./src/utils/browser.js"),E=d("./src/core/media-info.js"),g=d("./src/demux/flv-demuxer.js"),_=d("./src/remux/mp4-remuxer.js"),m=d("./src/demux/demux-errors.js"),y=d("./src/io/io-controller.js"),b=d("./src/core/transmuxing-events.js"),R=function(){function T(w,C){this.TAG="TransmuxingController",this._emitter=new(f()),this._config=C,w.segments||(w.segments=[{duration:w.duration,filesize:w.filesize,url:w.url}]),typeof w.cors!="boolean"&&(w.cors=!0),typeof w.withCredentials!="boolean"&&(w.withCredentials=!1),this._mediaDataSource=w,this._currentSegmentIndex=0;var A=0;this._mediaDataSource.segments.forEach(function(L){L.timestampBase=A,A+=L.duration,L.cors=w.cors,L.withCredentials=w.withCredentials,C.referrerPolicy&&(L.referrerPolicy=C.referrerPolicy)}),!isNaN(A)&&this._mediaDataSource.duration!==A&&(this._mediaDataSource.duration=A),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return T.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},T.prototype.on=function(w,C){this._emitter.addListener(w,C)},T.prototype.off=function(w,C){this._emitter.removeListener(w,C)},T.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},T.prototype._loadSegment=function(w,C){this._currentSegmentIndex=w;var A=this._mediaDataSource.segments[w],L=this._ioctl=new y.default(A,this._config,w);L.onError=this._onIOException.bind(this),L.onSeeked=this._onIOSeeked.bind(this),L.onComplete=this._onIOComplete.bind(this),L.onRedirect=this._onIORedirect.bind(this),L.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),C?this._demuxer.bindDataSource(this._ioctl):L.onDataArrival=this._onInitChunkArrival.bind(this),L.open(C)},T.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},T.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},T.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},T.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},T.prototype.seek=function(w){if(!(this._mediaInfo==null||!this._mediaInfo.isSeekable())){var C=this._searchSegmentIndexContains(w);if(C===this._currentSegmentIndex){var A=this._mediaInfo.segments[C];if(A==null)this._pendingSeekTime=w;else{var L=A.getNearestKeyframe(w);this._remuxer.seek(L.milliseconds),this._ioctl.seek(L.fileposition),this._pendingResolveSeekPoint=L.milliseconds}}else{var D=this._mediaInfo.segments[C];if(D==null)this._pendingSeekTime=w,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(C);else{var L=D.getNearestKeyframe(w);this._internalAbort(),this._remuxer.seek(w),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[C].timestampBase,this._loadSegment(C,L.fileposition),this._pendingResolveSeekPoint=L.milliseconds,this._reportSegmentMediaInfo(C)}}this._enableStatisticsReporter()}},T.prototype._searchSegmentIndexContains=function(w){for(var C=this._mediaDataSource.segments,A=C.length-1,L=0;L<C.length;L++)if(w<C[L].timestampBase){A=L-1;break}return A},T.prototype._onInitChunkArrival=function(w,C){var A=this,L=null,D=0;if(C>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,D=this._demuxer.parseChunks(w,C);else if((L=g.default.probe(w)).match){this._demuxer=new g.default(L,this._config),this._remuxer||(this._remuxer=new _.default(this._config));var P=this._mediaDataSource;P.duration!=null&&!isNaN(P.duration)&&(this._demuxer.overridedDuration=P.duration),typeof P.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=P.hasAudio),typeof P.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=P.hasVideo),this._demuxer.timestampBase=P.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),D=this._demuxer.parseChunks(w,C)}else L=null,p.default.e(this.TAG,"Non-FLV, Unsupported media type!"),Promise.resolve().then(function(){A._internalAbort()}),this._emitter.emit(b.default.DEMUX_ERROR,m.default.FORMAT_UNSUPPORTED,"Non-FLV, Unsupported media type"),D=0;return D},T.prototype._onMediaInfo=function(w){var C=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},w),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,E.default.prototype));var A=Object.assign({},w);Object.setPrototypeOf(A,E.default.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=A,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then(function(){var L=C._pendingSeekTime;C._pendingSeekTime=null,C.seek(L)})},T.prototype._onMetaDataArrived=function(w){this._emitter.emit(b.default.METADATA_ARRIVED,w)},T.prototype._onScriptDataArrived=function(w){this._emitter.emit(b.default.SCRIPTDATA_ARRIVED,w)},T.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},T.prototype._onIOComplete=function(w){var C=w,A=C+1;A<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer.flushStashedSamples(),this._loadSegment(A)):(this._remuxer.flushStashedSamples(),this._emitter.emit(b.default.LOADING_COMPLETE),this._disableStatisticsReporter())},T.prototype._onIORedirect=function(w){var C=this._ioctl.extraData;this._mediaDataSource.segments[C].redirectedURL=w},T.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(b.default.RECOVERED_EARLY_EOF)},T.prototype._onIOException=function(w,C){p.default.e(this.TAG,"IOException: type = "+w+", code = "+C.code+", msg = "+C.msg),this._emitter.emit(b.default.IO_ERROR,w,C),this._disableStatisticsReporter()},T.prototype._onDemuxException=function(w,C){p.default.e(this.TAG,"DemuxException: type = "+w+", info = "+C),this._emitter.emit(b.default.DEMUX_ERROR,w,C)},T.prototype._onRemuxerInitSegmentArrival=function(w,C){this._emitter.emit(b.default.INIT_SEGMENT,w,C)},T.prototype._onRemuxerMediaSegmentArrival=function(w,C){if(this._pendingSeekTime==null&&(this._emitter.emit(b.default.MEDIA_SEGMENT,w,C),this._pendingResolveSeekPoint!=null&&w==="video")){var A=C.info.syncPoints,L=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,v.default.safari&&A.length>0&&A[0].originalDts===L&&(L=A[0].pts),this._emitter.emit(b.default.RECOMMEND_SEEKPOINT,L)}},T.prototype._enableStatisticsReporter=function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},T.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},T.prototype._reportSegmentMediaInfo=function(w){var C=this._mediaInfo.segments[w],A=Object.assign({},C);A.duration=this._mediaInfo.duration,A.segmentCount=this._mediaInfo.segmentCount,delete A.segments,delete A.keyframesIndex,this._emitter.emit(b.default.MEDIA_INFO,A)},T.prototype._reportStatisticsInfo=function(){var w={};w.url=this._ioctl.currentURL,w.hasRedirect=this._ioctl.hasRedirect,w.hasRedirect&&(w.redirectedURL=this._ioctl.currentRedirectedURL),w.speed=this._ioctl.currentSpeed,w.loaderType=this._ioctl.loaderType,w.currentSegmentIndex=this._currentSegmentIndex,w.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(b.default.STATISTICS_INFO,w)},T}();l.default=R},"./src/core/transmuxing-events.js":function(c,l,d){d.r(l);var u={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"};l.default=u},"./src/core/transmuxing-worker.js":function(c,l,d){d.r(l);var u=d("./src/utils/logging-control.js"),f=d("./src/utils/polyfill.js"),p=d("./src/core/transmuxing-controller.js"),v=d("./src/core/transmuxing-events.js"),E=function(g){var _=null,m=M.bind(this);f.default.install(),g.addEventListener("message",function(I){switch(I.data.cmd){case"init":_=new p.default(I.data.param[0],I.data.param[1]),_.on(v.default.IO_ERROR,D.bind(this)),_.on(v.default.DEMUX_ERROR,P.bind(this)),_.on(v.default.INIT_SEGMENT,y.bind(this)),_.on(v.default.MEDIA_SEGMENT,b.bind(this)),_.on(v.default.LOADING_COMPLETE,R.bind(this)),_.on(v.default.RECOVERED_EARLY_EOF,T.bind(this)),_.on(v.default.MEDIA_INFO,w.bind(this)),_.on(v.default.METADATA_ARRIVED,C.bind(this)),_.on(v.default.SCRIPTDATA_ARRIVED,A.bind(this)),_.on(v.default.STATISTICS_INFO,L.bind(this)),_.on(v.default.RECOMMEND_SEEKPOINT,k.bind(this));break;case"destroy":_&&(_.destroy(),_=null),g.postMessage({msg:"destroyed"});break;case"start":_.start();break;case"stop":_.stop();break;case"seek":_.seek(I.data.param);break;case"pause":_.pause();break;case"resume":_.resume();break;case"logging_config":{var F=I.data.param;u.default.applyConfig(F),F.enableCallback===!0?u.default.addLogListener(m):u.default.removeLogListener(m);break}}});function y(I,F){var $={msg:v.default.INIT_SEGMENT,data:{type:I,data:F}};g.postMessage($,[F.data])}function b(I,F){var $={msg:v.default.MEDIA_SEGMENT,data:{type:I,data:F}};g.postMessage($,[F.data])}function R(){var I={msg:v.default.LOADING_COMPLETE};g.postMessage(I)}function T(){var I={msg:v.default.RECOVERED_EARLY_EOF};g.postMessage(I)}function w(I){var F={msg:v.default.MEDIA_INFO,data:I};g.postMessage(F)}function C(I){var F={msg:v.default.METADATA_ARRIVED,data:I};g.postMessage(F)}function A(I){var F={msg:v.default.SCRIPTDATA_ARRIVED,data:I};g.postMessage(F)}function L(I){var F={msg:v.default.STATISTICS_INFO,data:I};g.postMessage(F)}function D(I,F){g.postMessage({msg:v.default.IO_ERROR,data:{type:I,info:F}})}function P(I,F){g.postMessage({msg:v.default.DEMUX_ERROR,data:{type:I,info:F}})}function k(I){g.postMessage({msg:v.default.RECOMMEND_SEEKPOINT,data:I})}function M(I,F){g.postMessage({msg:"logcat_callback",data:{type:I,logcat:F}})}};l.default=E},"./src/demux/amf-parser.js":function(c,l,d){d.r(l);var u=d("./src/utils/logger.js"),f=d("./src/utils/utf8-conv.js"),p=d("./src/utils/exception.js"),v=function(){var g=new ArrayBuffer(2);return new DataView(g).setInt16(0,256,!0),new Int16Array(g)[0]===256}(),E=function(){function g(){}return g.parseScriptData=function(_,m,y){var b={};try{var R=g.parseValue(_,m,y),T=g.parseValue(_,m+R.size,y-R.size);b[R.data]=T.data}catch(w){u.default.e("AMF",w.toString())}return b},g.parseObject=function(_,m,y){if(y<3)throw new p.IllegalStateException("Data not enough when parse ScriptDataObject");var b=g.parseString(_,m,y),R=g.parseValue(_,m+b.size,y-b.size),T=R.objectEnd;return{data:{name:b.data,value:R.data},size:b.size+R.size,objectEnd:T}},g.parseVariable=function(_,m,y){return g.parseObject(_,m,y)},g.parseString=function(_,m,y){if(y<2)throw new p.IllegalStateException("Data not enough when parse String");var b=new DataView(_,m,y),R=b.getUint16(0,!v),T;return R>0?T=(0,f.default)(new Uint8Array(_,m+2,R)):T="",{data:T,size:2+R}},g.parseLongString=function(_,m,y){if(y<4)throw new p.IllegalStateException("Data not enough when parse LongString");var b=new DataView(_,m,y),R=b.getUint32(0,!v),T;return R>0?T=(0,f.default)(new Uint8Array(_,m+4,R)):T="",{data:T,size:4+R}},g.parseDate=function(_,m,y){if(y<10)throw new p.IllegalStateException("Data size invalid when parse Date");var b=new DataView(_,m,y),R=b.getFloat64(0,!v),T=b.getInt16(8,!v);return R+=T*60*1e3,{data:new Date(R),size:10}},g.parseValue=function(_,m,y){if(y<1)throw new p.IllegalStateException("Data not enough when parse Value");var b=new DataView(_,m,y),R=1,T=b.getUint8(0),w,C=!1;try{switch(T){case 0:w=b.getFloat64(1,!v),R+=8;break;case 1:{var A=b.getUint8(1);w=!!A,R+=1;break}case 2:{var L=g.parseString(_,m+1,y-1);w=L.data,R+=L.size;break}case 3:{w={};var D=0;for((b.getUint32(y-4,!v)&16777215)===9&&(D=3);R<y-4;){var P=g.parseObject(_,m+R,y-R-D);if(P.objectEnd)break;w[P.data.name]=P.data.value,R+=P.size}if(R<=y-3){var k=b.getUint32(R-1,!v)&16777215;k===9&&(R+=3)}break}case 8:{w={},R+=4;var D=0;for((b.getUint32(y-4,!v)&16777215)===9&&(D=3);R<y-8;){var M=g.parseVariable(_,m+R,y-R-D);if(M.objectEnd)break;w[M.data.name]=M.data.value,R+=M.size}if(R<=y-3){var k=b.getUint32(R-1,!v)&16777215;k===9&&(R+=3)}break}case 9:w=void 0,R=1,C=!0;break;case 10:{w=[];var I=b.getUint32(1,!v);R+=4;for(var F=0;F<I;F++){var $=g.parseValue(_,m+R,y-R);w.push($.data),R+=$.size}break}case 11:{var N=g.parseDate(_,m+1,y-1);w=N.data,R+=N.size;break}case 12:{var U=g.parseString(_,m+1,y-1);w=U.data,R+=U.size;break}default:R=y,u.default.w("AMF","Unsupported AMF value type "+T)}}catch(V){u.default.e("AMF",V.toString())}return{data:w,size:R,objectEnd:C}},g}();l.default=E},"./src/demux/demux-errors.js":function(c,l,d){d.r(l);var u={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"};l.default=u},"./src/demux/exp-golomb.js":function(c,l,d){d.r(l);var u=d("./src/utils/exception.js"),f=function(){function p(v){this.TAG="ExpGolomb",this._buffer=v,this._buffer_index=0,this._total_bytes=v.byteLength,this._total_bits=v.byteLength*8,this._current_word=0,this._current_word_bits_left=0}return p.prototype.destroy=function(){this._buffer=null},p.prototype._fillCurrentWord=function(){var v=this._total_bytes-this._buffer_index;if(v<=0)throw new u.IllegalStateException("ExpGolomb: _fillCurrentWord() but no bytes available");var E=Math.min(4,v),g=new Uint8Array(4);g.set(this._buffer.subarray(this._buffer_index,this._buffer_index+E)),this._current_word=new DataView(g.buffer).getUint32(0,!1),this._buffer_index+=E,this._current_word_bits_left=E*8},p.prototype.readBits=function(v){if(v>32)throw new u.InvalidArgumentException("ExpGolomb: readBits() bits exceeded max 32bits!");if(v<=this._current_word_bits_left){var E=this._current_word>>>32-v;return this._current_word<<=v,this._current_word_bits_left-=v,E}var g=this._current_word_bits_left?this._current_word:0;g=g>>>32-this._current_word_bits_left;var _=v-this._current_word_bits_left;this._fillCurrentWord();var m=Math.min(_,this._current_word_bits_left),y=this._current_word>>>32-m;return this._current_word<<=m,this._current_word_bits_left-=m,g=g<<m|y,g},p.prototype.readBool=function(){return this.readBits(1)===1},p.prototype.readByte=function(){return this.readBits(8)},p.prototype._skipLeadingZero=function(){var v;for(v=0;v<this._current_word_bits_left;v++)if((this._current_word&2147483648>>>v)!==0)return this._current_word<<=v,this._current_word_bits_left-=v,v;return this._fillCurrentWord(),v+this._skipLeadingZero()},p.prototype.readUEG=function(){var v=this._skipLeadingZero();return this.readBits(v+1)-1},p.prototype.readSEG=function(){var v=this.readUEG();return v&1?v+1>>>1:-1*(v>>>1)},p}();l.default=f},"./src/demux/flv-demuxer.js":function(c,l,d){d.r(l);var u=d("./src/utils/logger.js"),f=d("./src/demux/amf-parser.js"),p=d("./src/demux/sps-parser.js"),v=d("./src/demux/demux-errors.js"),E=d("./src/core/media-info.js"),g=d("./src/utils/exception.js");function _(y,b){return y[b]<<24|y[b+1]<<16|y[b+2]<<8|y[b+3]}var m=function(){function y(b,R){this.TAG="FLVDemuxer",this._config=R,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=b.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=b.hasAudioTrack,this._hasVideo=b.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new E.default,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var T=new ArrayBuffer(2);return new DataView(T).setInt16(0,256,!0),new Int16Array(T)[0]===256}()}return y.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},y.probe=function(b){var R=new Uint8Array(b),T={match:!1};if(R[0]!==70||R[1]!==76||R[2]!==86||R[3]!==1)return T;var w=(R[4]&4)>>>2!==0,C=(R[4]&1)!==0,A=_(R,5);return A<9?T:{match:!0,consumed:A,dataOffset:A,hasAudioTrack:w,hasVideoTrack:C}},y.prototype.bindDataSource=function(b){return b.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(y.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(b){this._onTrackMetadata=b},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(b){this._onMediaInfo=b},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(b){this._onMetaDataArrived=b},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(b){this._onScriptDataArrived=b},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onError",{get:function(){return this._onError},set:function(b){this._onError=b},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(b){this._onDataAvailable=b},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(b){this._timestampBase=b},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"overridedDuration",{get:function(){return this._duration},set:function(b){this._durationOverrided=!0,this._duration=b,this._mediaInfo.duration=b},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"overridedHasAudio",{set:function(b){this._hasAudioFlagOverrided=!0,this._hasAudio=b,this._mediaInfo.hasAudio=b},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"overridedHasVideo",{set:function(b){this._hasVideoFlagOverrided=!0,this._hasVideo=b,this._mediaInfo.hasVideo=b},enumerable:!1,configurable:!0}),y.prototype.resetMediaInfo=function(){this._mediaInfo=new E.default},y.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!this._hasAudio&&this._hasVideo?this._videoInitialMetadataDispatched:!1},y.prototype.parseChunks=function(b,R){if(!this._onError||!this._onMediaInfo||!this._onTrackMetadata||!this._onDataAvailable)throw new g.IllegalStateException("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var T=0,w=this._littleEndian;if(R===0)if(b.byteLength>13){var C=y.probe(b);T=C.dataOffset}else return 0;if(this._firstParse){this._firstParse=!1,R+T!==this._dataOffset&&u.default.w(this.TAG,"First time parsing but chunk byteStart invalid!");var A=new DataView(b,T),L=A.getUint32(0,!w);L!==0&&u.default.w(this.TAG,"PrevTagSize0 !== 0 !!!"),T+=4}for(;T<b.byteLength;){this._dispatch=!0;var A=new DataView(b,T);if(T+11+4>b.byteLength)break;var D=A.getUint8(0),P=A.getUint32(0,!w)&16777215;if(T+11+P+4>b.byteLength)break;if(D!==8&&D!==9&&D!==18){u.default.w(this.TAG,"Unsupported tag type "+D+", skipped"),T+=11+P+4;continue}var k=A.getUint8(4),M=A.getUint8(5),I=A.getUint8(6),F=A.getUint8(7),$=I|M<<8|k<<16|F<<24,N=A.getUint32(7,!w)&16777215;N!==0&&u.default.w(this.TAG,"Meet tag which has StreamID != 0!");var U=T+11;switch(D){case 8:this._parseAudioData(b,U,P,$);break;case 9:this._parseVideoData(b,U,P,$,R+T);break;case 18:this._parseScriptData(b,U,P);break}var V=A.getUint32(11+P,!w);V!==11+P&&u.default.w(this.TAG,"Invalid PrevTagSize "+V),T+=11+P+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),T},y.prototype._parseScriptData=function(b,R,T){var w=f.default.parseScriptData(b,R,T);if(w.hasOwnProperty("onMetaData")){if(w.onMetaData==null||typeof w.onMetaData!="object"){u.default.w(this.TAG,"Invalid onMetaData structure!");return}this._metadata&&u.default.w(this.TAG,"Found another onMetaData tag!"),this._metadata=w;var C=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},C)),typeof C.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=C.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof C.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=C.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof C.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=C.audiodatarate),typeof C.videodatarate=="number"&&(this._mediaInfo.videoDataRate=C.videodatarate),typeof C.width=="number"&&(this._mediaInfo.width=C.width),typeof C.height=="number"&&(this._mediaInfo.height=C.height),typeof C.duration=="number"){if(!this._durationOverrided){var A=Math.floor(C.duration*this._timescale);this._duration=A,this._mediaInfo.duration=A}}else this._mediaInfo.duration=0;if(typeof C.framerate=="number"){var L=Math.floor(C.framerate*1e3);if(L>0){var D=L/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=D,this._referenceFrameRate.fps_num=L,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=D}}if(typeof C.keyframes=="object"){this._mediaInfo.hasKeyframesIndex=!0;var P=C.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(P),C.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=C,u.default.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(w).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},w))},y.prototype._parseKeyframesIndex=function(b){for(var R=[],T=[],w=1;w<b.times.length;w++){var C=this._timestampBase+Math.floor(b.times[w]*1e3);R.push(C),T.push(b.filepositions[w])}return{times:R,filepositions:T}},y.prototype._parseAudioData=function(b,R,T,w){if(T<=1){u.default.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");return}if(!(this._hasAudioFlagOverrided===!0&&this._hasAudio===!1)){this._littleEndian;var C=new DataView(b,R,T),A=C.getUint8(0),L=A>>>4;if(L!==2&&L!==10){this._onError(v.default.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+L);return}var D=0,P=(A&12)>>>2;if(P>=0&&P<=4)D=this._flvSoundRateTable[P];else{this._onError(v.default.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+P);return}var k=A&1,M=this._audioMetadata,I=this._audioTrack;if(M||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),M=this._audioMetadata={},M.type="audio",M.id=I.id,M.timescale=this._timescale,M.duration=this._duration,M.audioSampleRate=D,M.channelCount=k===0?1:2),L===10){var F=this._parseAACAudioData(b,R+1,T-1);if(F==null)return;if(F.packetType===0){M.config&&u.default.w(this.TAG,"Found another AudioSpecificConfig!");var $=F.data;M.audioSampleRate=$.samplingRate,M.channelCount=$.channelCount,M.codec=$.codec,M.originalCodec=$.originalCodec,M.config=$.config,M.refSampleDuration=1024/M.audioSampleRate*M.timescale,u.default.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",M);var N=this._mediaInfo;N.audioCodec=M.originalCodec,N.audioSampleRate=M.audioSampleRate,N.audioChannelCount=M.channelCount,N.hasVideo?N.videoCodec!=null&&(N.mimeType='video/x-flv; codecs="'+N.videoCodec+","+N.audioCodec+'"'):N.mimeType='video/x-flv; codecs="'+N.audioCodec+'"',N.isComplete()&&this._onMediaInfo(N)}else if(F.packetType===1){var U=this._timestampBase+w,V={unit:F.data,length:F.data.byteLength,dts:U,pts:U};I.samples.push(V),I.length+=F.data.length}else u.default.e(this.TAG,"Flv: Unsupported AAC data type "+F.packetType)}else if(L===2){if(!M.codec){var $=this._parseMP3AudioData(b,R+1,T-1,!0);if($==null)return;M.audioSampleRate=$.samplingRate,M.channelCount=$.channelCount,M.codec=$.codec,M.originalCodec=$.originalCodec,M.refSampleDuration=1152/M.audioSampleRate*M.timescale,u.default.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",M);var N=this._mediaInfo;N.audioCodec=M.codec,N.audioSampleRate=M.audioSampleRate,N.audioChannelCount=M.channelCount,N.audioDataRate=$.bitRate,N.hasVideo?N.videoCodec!=null&&(N.mimeType='video/x-flv; codecs="'+N.videoCodec+","+N.audioCodec+'"'):N.mimeType='video/x-flv; codecs="'+N.audioCodec+'"',N.isComplete()&&this._onMediaInfo(N)}var J=this._parseMP3AudioData(b,R+1,T-1,!1);if(J==null)return;var U=this._timestampBase+w,j={unit:J,length:J.byteLength,dts:U,pts:U};I.samples.push(j),I.length+=J.length}}},y.prototype._parseAACAudioData=function(b,R,T){if(T<=1){u.default.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!");return}var w={},C=new Uint8Array(b,R,T);return w.packetType=C[0],C[0]===0?w.data=this._parseAACAudioSpecificConfig(b,R+1,T-1):w.data=C.subarray(1),w},y.prototype._parseAACAudioSpecificConfig=function(b,R,T){var w=new Uint8Array(b,R,T),C=null,A=0,L=0,D=0,P=null;if(A=L=w[0]>>>3,D=(w[0]&7)<<1|w[1]>>>7,D<0||D>=this._mpegSamplingRates.length){this._onError(v.default.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");return}var k=this._mpegSamplingRates[D],M=(w[1]&120)>>>3;if(M<0||M>=8){this._onError(v.default.FORMAT_ERROR,"Flv: AAC invalid channel configuration");return}A===5&&(P=(w[1]&7)<<1|w[2]>>>7,(w[2]&124)>>>2);var I=self.navigator.userAgent.toLowerCase();return I.indexOf("firefox")!==-1?D>=6?(A=5,C=new Array(4),P=D-3):(A=2,C=new Array(2),P=D):I.indexOf("android")!==-1?(A=2,C=new Array(2),P=D):(A=5,P=D,C=new Array(4),D>=6?P=D-3:M===1&&(A=2,C=new Array(2),P=D)),C[0]=A<<3,C[0]|=(D&15)>>>1,C[1]=(D&15)<<7,C[1]|=(M&15)<<3,A===5&&(C[1]|=(P&15)>>>1,C[2]=(P&1)<<7,C[2]|=8,C[3]=0),{config:C,samplingRate:k,channelCount:M,codec:"mp4a.40."+A,originalCodec:"mp4a.40."+L}},y.prototype._parseMP3AudioData=function(b,R,T,w){if(T<4){u.default.w(this.TAG,"Flv: Invalid MP3 packet, header missing!");return}this._littleEndian;var C=new Uint8Array(b,R,T),A=null;if(w){if(C[0]!==255)return;var L=C[1]>>>3&3,D=(C[1]&6)>>1,P=(C[2]&240)>>>4,k=(C[2]&12)>>>2,M=C[3]>>>6&3,I=M!==3?2:1,F=0,$=0,N="mp3";switch(L){case 0:F=this._mpegAudioV25SampleRateTable[k];break;case 2:F=this._mpegAudioV20SampleRateTable[k];break;case 3:F=this._mpegAudioV10SampleRateTable[k];break}switch(D){case 1:P<this._mpegAudioL3BitRateTable.length&&($=this._mpegAudioL3BitRateTable[P]);break;case 2:P<this._mpegAudioL2BitRateTable.length&&($=this._mpegAudioL2BitRateTable[P]);break;case 3:P<this._mpegAudioL1BitRateTable.length&&($=this._mpegAudioL1BitRateTable[P]);break}A={bitRate:$,samplingRate:F,channelCount:I,codec:N,originalCodec:N}}else A=C;return A},y.prototype._parseVideoData=function(b,R,T,w,C){if(T<=1){u.default.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");return}if(!(this._hasVideoFlagOverrided===!0&&this._hasVideo===!1)){var A=new Uint8Array(b,R,T)[0],L=(A&240)>>>4,D=A&15;if(D!==7){this._onError(v.default.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+D);return}this._parseAVCVideoPacket(b,R+1,T-1,w,C,L)}},y.prototype._parseAVCVideoPacket=function(b,R,T,w,C,A){if(T<4){u.default.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");return}var L=this._littleEndian,D=new DataView(b,R,T),P=D.getUint8(0),k=D.getUint32(0,!L)&16777215,M=k<<8>>8;if(P===0)this._parseAVCDecoderConfigurationRecord(b,R+4,T-4);else if(P===1)this._parseAVCVideoData(b,R+4,T-4,w,C,A,M);else if(P!==2){this._onError(v.default.FORMAT_ERROR,"Flv: Invalid video packet type "+P);return}},y.prototype._parseAVCDecoderConfigurationRecord=function(b,R,T){if(T<7){u.default.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");return}var w=this._videoMetadata,C=this._videoTrack,A=this._littleEndian,L=new DataView(b,R,T);w?typeof w.avcc<"u"&&u.default.w(this.TAG,"Found another AVCDecoderConfigurationRecord!"):(this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),w=this._videoMetadata={},w.type="video",w.id=C.id,w.timescale=this._timescale,w.duration=this._duration);var D=L.getUint8(0),P=L.getUint8(1);if(L.getUint8(2),L.getUint8(3),D!==1||P===0){this._onError(v.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord");return}if(this._naluLengthSize=(L.getUint8(4)&3)+1,this._naluLengthSize!==3&&this._naluLengthSize!==4){this._onError(v.default.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));return}var k=L.getUint8(5)&31;if(k===0){this._onError(v.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS");return}else k>1&&u.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+k);for(var M=6,I=0;I<k;I++){var F=L.getUint16(M,!A);if(M+=2,F!==0){var $=new Uint8Array(b,R+M,F);M+=F;var N=p.default.parseSPS($);if(I===0){w.codecWidth=N.codec_size.width,w.codecHeight=N.codec_size.height,w.presentWidth=N.present_size.width,w.presentHeight=N.present_size.height,w.profile=N.profile_string,w.level=N.level_string,w.bitDepth=N.bit_depth,w.chromaFormat=N.chroma_format,w.sarRatio=N.sar_ratio,w.frameRate=N.frame_rate,(N.frame_rate.fixed===!1||N.frame_rate.fps_num===0||N.frame_rate.fps_den===0)&&(w.frameRate=this._referenceFrameRate);var U=w.frameRate.fps_den,V=w.frameRate.fps_num;w.refSampleDuration=w.timescale*(U/V);for(var J=$.subarray(1,4),j="avc1.",q=0;q<3;q++){var Z=J[q].toString(16);Z.length<2&&(Z="0"+Z),j+=Z}w.codec=j;var X=this._mediaInfo;X.width=w.codecWidth,X.height=w.codecHeight,X.fps=w.frameRate.fps,X.profile=w.profile,X.level=w.level,X.refFrames=N.ref_frames,X.chromaFormat=N.chroma_format_string,X.sarNum=w.sarRatio.width,X.sarDen=w.sarRatio.height,X.videoCodec=j,X.hasAudio?X.audioCodec!=null&&(X.mimeType='video/x-flv; codecs="'+X.videoCodec+","+X.audioCodec+'"'):X.mimeType='video/x-flv; codecs="'+X.videoCodec+'"',X.isComplete()&&this._onMediaInfo(X)}}}var Y=L.getUint8(M);if(Y===0){this._onError(v.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS");return}else Y>1&&u.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+Y);M++;for(var I=0;I<Y;I++){var F=L.getUint16(M,!A);M+=2,F!==0&&(M+=F)}w.avcc=new Uint8Array(T),w.avcc.set(new Uint8Array(b,R,T),0),u.default.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",w)},y.prototype._parseAVCVideoData=function(b,R,T,w,C,A,L){for(var D=this._littleEndian,P=new DataView(b,R,T),k=[],M=0,I=0,F=this._naluLengthSize,$=this._timestampBase+w,N=A===1;I<T;){if(I+4>=T){u.default.w(this.TAG,"Malformed Nalu near timestamp "+$+", offset = "+I+", dataSize = "+T);break}var U=P.getUint32(I,!D);if(F===3&&(U>>>=8),U>T-F){u.default.w(this.TAG,"Malformed Nalus near timestamp "+$+", NaluSize > DataSize!");return}var V=P.getUint8(I+F)&31;V===5&&(N=!0);var J=new Uint8Array(b,R+I,F+U),j={type:V,data:J};k.push(j),M+=J.byteLength,I+=F+U}if(k.length){var q=this._videoTrack,Z={units:k,length:M,isKeyframe:N,dts:$,cts:L,pts:$+L};N&&(Z.fileposition=C),q.samples.push(Z),q.length+=M}},y}();l.default=m},"./src/demux/sps-parser.js":function(c,l,d){d.r(l);var u=d("./src/demux/exp-golomb.js"),f=function(){function p(){}return p._ebsp2rbsp=function(v){for(var E=v,g=E.byteLength,_=new Uint8Array(g),m=0,y=0;y<g;y++)y>=2&&E[y]===3&&E[y-1]===0&&E[y-2]===0||(_[m]=E[y],m++);return new Uint8Array(_.buffer,0,m)},p.parseSPS=function(v){var E=p._ebsp2rbsp(v),g=new u.default(E);g.readByte();var _=g.readByte();g.readByte();var m=g.readByte();g.readUEG();var y=p.getProfileString(_),b=p.getLevelString(m),R=1,T=420,w=[0,420,422,444],C=8;if((_===100||_===110||_===122||_===244||_===44||_===83||_===86||_===118||_===128||_===138||_===144)&&(R=g.readUEG(),R===3&&g.readBits(1),R<=3&&(T=w[R]),C=g.readUEG()+8,g.readUEG(),g.readBits(1),g.readBool()))for(var A=R!==3?8:12,L=0;L<A;L++)g.readBool()&&(L<6?p._skipScalingList(g,16):p._skipScalingList(g,64));g.readUEG();var D=g.readUEG();if(D===0)g.readUEG();else if(D===1){g.readBits(1),g.readSEG(),g.readSEG();for(var P=g.readUEG(),L=0;L<P;L++)g.readSEG()}var k=g.readUEG();g.readBits(1);var M=g.readUEG(),I=g.readUEG(),F=g.readBits(1);F===0&&g.readBits(1),g.readBits(1);var $=0,N=0,U=0,V=0,J=g.readBool();J&&($=g.readUEG(),N=g.readUEG(),U=g.readUEG(),V=g.readUEG());var j=1,q=1,Z=0,X=!0,Y=0,re=0,oe=g.readBool();if(oe){if(g.readBool()){var ve=g.readByte(),be=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],Oe=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];ve>0&&ve<16?(j=be[ve-1],q=Oe[ve-1]):ve===255&&(j=g.readByte()<<8|g.readByte(),q=g.readByte()<<8|g.readByte())}if(g.readBool()&&g.readBool(),g.readBool()&&(g.readBits(4),g.readBool()&&g.readBits(24)),g.readBool()&&(g.readUEG(),g.readUEG()),g.readBool()){var Pe=g.readBits(32),Se=g.readBits(32);X=g.readBool(),Y=Se,re=Pe*2,Z=Y/re}}var Te=1;(j!==1||q!==1)&&(Te=j/q);var ge=0,Ue=0;if(R===0)ge=1,Ue=2-F;else{var je=R===3?1:2,Ie=R===1?2:1;ge=je,Ue=Ie*(2-F)}var De=(M+1)*16,ze=(2-F)*((I+1)*16);De-=($+N)*ge,ze-=(U+V)*Ue;var ut=Math.ceil(De*Te);return g.destroy(),g=null,{profile_string:y,level_string:b,bit_depth:C,ref_frames:k,chroma_format:T,chroma_format_string:p.getChromaFormatString(T),frame_rate:{fixed:X,fps:Z,fps_den:re,fps_num:Y},sar_ratio:{width:j,height:q},codec_size:{width:De,height:ze},present_size:{width:ut,height:ze}}},p._skipScalingList=function(v,E){for(var g=8,_=8,m=0,y=0;y<E;y++)_!==0&&(m=v.readSEG(),_=(g+m+256)%256),g=_===0?g:_},p.getProfileString=function(v){switch(v){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},p.getLevelString=function(v){return(v/10).toFixed(1)},p.getChromaFormatString=function(v){switch(v){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},p}();l.default=f},"./src/flv.js":function(c,l,d){d.r(l);var u=d("./src/utils/polyfill.js"),f=d("./src/core/features.js"),p=d("./src/io/loader.js"),v=d("./src/player/flv-player.js"),E=d("./src/player/native-player.js"),g=d("./src/player/player-events.js"),_=d("./src/player/player-errors.js"),m=d("./src/utils/logging-control.js"),y=d("./src/utils/exception.js");u.default.install();function b(C,A){var L=C;if(L==null||typeof L!="object")throw new y.InvalidArgumentException("MediaDataSource must be an javascript object!");if(!L.hasOwnProperty("type"))throw new y.InvalidArgumentException("MediaDataSource must has type field to indicate video file type!");switch(L.type){case"flv":return new v.default(L,A);default:return new E.default(L,A)}}function R(){return f.default.supportMSEH264Playback()}function T(){return f.default.getFeatureList()}var w={};w.createPlayer=b,w.isSupported=R,w.getFeatureList=T,w.BaseLoader=p.BaseLoader,w.LoaderStatus=p.LoaderStatus,w.LoaderErrors=p.LoaderErrors,w.Events=g.default,w.ErrorTypes=_.ErrorTypes,w.ErrorDetails=_.ErrorDetails,w.FlvPlayer=v.default,w.NativePlayer=E.default,w.LoggingControl=m.default,Object.defineProperty(w,"version",{enumerable:!0,get:function(){return"1.6.2"}}),l.default=w},"./src/index.js":function(c,l,d){c.exports=d("./src/flv.js").default},"./src/io/fetch-stream-loader.js":function(c,l,d){d.r(l);var u=d("./src/utils/browser.js"),f=d("./src/io/loader.js"),p=d("./src/utils/exception.js"),v=function(){var g=function(_,m){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,b){y.__proto__=b}||function(y,b){for(var R in b)Object.prototype.hasOwnProperty.call(b,R)&&(y[R]=b[R])},g(_,m)};return function(_,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");g(_,m);function y(){this.constructor=_}_.prototype=m===null?Object.create(m):(y.prototype=m.prototype,new y)}}(),E=function(g){v(_,g);function _(m,y){var b=g.call(this,"fetch-stream-loader")||this;return b.TAG="FetchStreamLoader",b._seekHandler=m,b._config=y,b._needStash=!0,b._requestAbort=!1,b._contentLength=null,b._receivedLength=0,b}return _.isSupported=function(){try{var m=u.default.msedge&&u.default.version.minor>=15048,y=u.default.msedge?m:!0;return self.fetch&&self.ReadableStream&&y}catch{return!1}},_.prototype.destroy=function(){this.isWorking()&&this.abort(),g.prototype.destroy.call(this)},_.prototype.open=function(m,y){var b=this;this._dataSource=m,this._range=y;var R=m.url;this._config.reuseRedirectedURL&&m.redirectedURL!=null&&(R=m.redirectedURL);var T=this._seekHandler.getConfig(R,y),w=new self.Headers;if(typeof T.headers=="object"){var C=T.headers;for(var A in C)C.hasOwnProperty(A)&&w.append(A,C[A])}var L={method:"GET",headers:w,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(typeof this._config.headers=="object")for(var A in this._config.headers)w.append(A,this._config.headers[A]);m.cors===!1&&(L.mode="same-origin"),m.withCredentials&&(L.credentials="include"),m.referrerPolicy&&(L.referrerPolicy=m.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,L.signal=this._abortController.signal),this._status=f.LoaderStatus.kConnecting,self.fetch(T.url,L).then(function(D){if(b._requestAbort){b._status=f.LoaderStatus.kIdle,D.body.cancel();return}if(D.ok&&D.status>=200&&D.status<=299){if(D.url!==T.url&&b._onURLRedirect){var P=b._seekHandler.removeURLParameters(D.url);b._onURLRedirect(P)}var k=D.headers.get("Content-Length");return k!=null&&(b._contentLength=parseInt(k),b._contentLength!==0&&b._onContentLengthKnown&&b._onContentLengthKnown(b._contentLength)),b._pump.call(b,D.body.getReader())}else if(b._status=f.LoaderStatus.kError,b._onError)b._onError(f.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:D.status,msg:D.statusText});else throw new p.RuntimeException("FetchStreamLoader: Http code invalid, "+D.status+" "+D.statusText)}).catch(function(D){if(!(b._abortController&&b._abortController.signal.aborted))if(b._status=f.LoaderStatus.kError,b._onError)b._onError(f.LoaderErrors.EXCEPTION,{code:-1,msg:D.message});else throw D})},_.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==f.LoaderStatus.kBuffering||!u.default.chrome)&&this._abortController)try{this._abortController.abort()}catch{}},_.prototype._pump=function(m){var y=this;return m.read().then(function(b){if(b.done)if(y._contentLength!==null&&y._receivedLength<y._contentLength){y._status=f.LoaderStatus.kError;var R=f.LoaderErrors.EARLY_EOF,T={code:-1,msg:"Fetch stream meet Early-EOF"};if(y._onError)y._onError(R,T);else throw new p.RuntimeException(T.msg)}else y._status=f.LoaderStatus.kComplete,y._onComplete&&y._onComplete(y._range.from,y._range.from+y._receivedLength-1);else{if(y._abortController&&y._abortController.signal.aborted){y._status=f.LoaderStatus.kComplete;return}else if(y._requestAbort===!0)return y._status=f.LoaderStatus.kComplete,m.cancel();y._status=f.LoaderStatus.kBuffering;var w=b.value.buffer,C=y._range.from+y._receivedLength;y._receivedLength+=w.byteLength,y._onDataArrival&&y._onDataArrival(w,C,y._receivedLength),y._pump(m)}}).catch(function(b){if(y._abortController&&y._abortController.signal.aborted){y._status=f.LoaderStatus.kComplete;return}if(!(b.code===11&&u.default.msedge)){y._status=f.LoaderStatus.kError;var R=0,T=null;if((b.code===19||b.message==="network error")&&(y._contentLength===null||y._contentLength!==null&&y._receivedLength<y._contentLength)?(R=f.LoaderErrors.EARLY_EOF,T={code:b.code,msg:"Fetch stream meet Early-EOF"}):(R=f.LoaderErrors.EXCEPTION,T={code:b.code,msg:b.message}),y._onError)y._onError(R,T);else throw new p.RuntimeException(T.msg)}})},_}(f.BaseLoader);l.default=E},"./src/io/io-controller.js":function(c,l,d){d.r(l);var u=d("./src/utils/logger.js"),f=d("./src/io/speed-sampler.js"),p=d("./src/io/loader.js"),v=d("./src/io/fetch-stream-loader.js"),E=d("./src/io/xhr-moz-chunked-loader.js"),g=d("./src/io/xhr-range-loader.js"),_=d("./src/io/websocket-loader.js"),m=d("./src/io/range-seek-handler.js"),y=d("./src/io/param-seek-handler.js"),b=d("./src/utils/exception.js"),R=function(){function T(w,C,A){this.TAG="IOController",this._config=C,this._extraData=A,this._stashInitialSize=1024*384,C.stashInitialSize!=null&&C.stashInitialSize>0&&(this._stashInitialSize=C.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=1024*1024*3,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,C.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=w,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(w.url),this._refTotalLength=w.filesize?w.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new f.default,this._speedNormalizeList=[64,128,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return T.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},T.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},T.prototype.isPaused=function(){return this._paused},Object.defineProperty(T.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"extraData",{get:function(){return this._extraData},set:function(w){this._extraData=w},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(w){this._onDataArrival=w},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(w){this._onSeeked=w},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"onError",{get:function(){return this._onError},set:function(w){this._onError=w},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"onComplete",{get:function(){return this._onComplete},set:function(w){this._onComplete=w},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(w){this._onRedirect=w},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(w){this._onRecoveredEarlyEof=w},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"hasRedirect",{get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"currentSpeed",{get:function(){return this._loaderClass===g.default?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),T.prototype._selectSeekHandler=function(){var w=this._config;if(w.seekType==="range")this._seekHandler=new m.default(this._config.rangeLoadZeroStart);else if(w.seekType==="param"){var C=w.seekParamStart||"bstart",A=w.seekParamEnd||"bend";this._seekHandler=new y.default(C,A)}else if(w.seekType==="custom"){if(typeof w.customSeekHandler!="function")throw new b.InvalidArgumentException("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new w.customSeekHandler}else throw new b.InvalidArgumentException("Invalid seekType in config: "+w.seekType)},T.prototype._selectLoader=function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=_.default;else if(v.default.isSupported())this._loaderClass=v.default;else if(E.default.isSupported())this._loaderClass=E.default;else if(g.default.isSupported())this._loaderClass=g.default;else throw new b.RuntimeException("Your browser doesn't support xhr with arraybuffer responseType!")},T.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},T.prototype.open=function(w){this._currentRange={from:0,to:-1},w&&(this._currentRange.from=w),this._speedSampler.reset(),w||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},T.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},T.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},T.prototype.resume=function(){if(this._paused){this._paused=!1;var w=this._resumeFrom;this._resumeFrom=0,this._internalSeek(w,!0)}},T.prototype.seek=function(w){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(w,!0)},T.prototype._internalSeek=function(w,C){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(C),this._loader.destroy(),this._loader=null;var A={from:w,to:-1};this._currentRange={from:A.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,A),this._onSeeked&&this._onSeeked()},T.prototype.updateUrl=function(w){if(!w||typeof w!="string"||w.length===0)throw new b.InvalidArgumentException("Url must be a non-empty string!");this._dataSource.url=w},T.prototype._expandBuffer=function(w){for(var C=this._stashSize;C+1024*1024*1<w;)C*=2;if(C+=1024*1024*1,C!==this._bufferSize){var A=new ArrayBuffer(C);if(this._stashUsed>0){var L=new Uint8Array(this._stashBuffer,0,this._stashUsed),D=new Uint8Array(A,0,C);D.set(L,0)}this._stashBuffer=A,this._bufferSize=C}},T.prototype._normalizeSpeed=function(w){var C=this._speedNormalizeList,A=C.length-1,L=0,D=0,P=A;if(w<C[0])return C[0];for(;D<=P;){if(L=D+Math.floor((P-D)/2),L===A||w>=C[L]&&w<C[L+1])return C[L];C[L]<w?D=L+1:P=L-1}},T.prototype._adjustStashSize=function(w){var C=0;this._config.isLive||w<512?C=w:w>=512&&w<=1024?C=Math.floor(w*1.5):C=w*2,C>8192&&(C=8192);var A=C*1024+1024*1024*1;this._bufferSize<A&&this._expandBuffer(A),this._stashSize=C*1024},T.prototype._dispatchChunks=function(w,C){return this._currentRange.to=C+w.byteLength-1,this._onDataArrival(w,C)},T.prototype._onURLRedirect=function(w){this._redirectedURL=w,this._onRedirect&&this._onRedirect(w)},T.prototype._onContentLengthKnown=function(w){w&&this._fullRequestFlag&&(this._totalLength=w,this._fullRequestFlag=!1)},T.prototype._onLoaderChunkArrival=function(w,C,A){if(!this._onDataArrival)throw new b.IllegalStateException("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(w.byteLength);var L=this._speedSampler.lastSecondKBps;if(L!==0){var D=this._normalizeSpeed(L);this._speedNormalized!==D&&(this._speedNormalized=D,this._adjustStashSize(D))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=C),this._stashUsed+w.byteLength<=this._stashSize){var P=new Uint8Array(this._stashBuffer,0,this._stashSize);P.set(new Uint8Array(w),this._stashUsed),this._stashUsed+=w.byteLength}else{var P=new Uint8Array(this._stashBuffer,0,this._bufferSize);if(this._stashUsed>0){var k=this._stashBuffer.slice(0,this._stashUsed),M=this._dispatchChunks(k,this._stashByteStart);if(M<k.byteLength){if(M>0){var I=new Uint8Array(k,M);P.set(I,0),this._stashUsed=I.byteLength,this._stashByteStart+=M}}else this._stashUsed=0,this._stashByteStart+=M;this._stashUsed+w.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+w.byteLength),P=new Uint8Array(this._stashBuffer,0,this._bufferSize)),P.set(new Uint8Array(w),this._stashUsed),this._stashUsed+=w.byteLength}else{var M=this._dispatchChunks(w,C);if(M<w.byteLength){var F=w.byteLength-M;F>this._bufferSize&&(this._expandBuffer(F),P=new Uint8Array(this._stashBuffer,0,this._bufferSize)),P.set(new Uint8Array(w,M),0),this._stashUsed+=F,this._stashByteStart=C+M}}}else if(this._stashUsed===0){var M=this._dispatchChunks(w,C);if(M<w.byteLength){var F=w.byteLength-M;F>this._bufferSize&&this._expandBuffer(F);var P=new Uint8Array(this._stashBuffer,0,this._bufferSize);P.set(new Uint8Array(w,M),0),this._stashUsed+=F,this._stashByteStart=C+M}}else{this._stashUsed+w.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+w.byteLength);var P=new Uint8Array(this._stashBuffer,0,this._bufferSize);P.set(new Uint8Array(w),this._stashUsed),this._stashUsed+=w.byteLength;var M=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart);if(M<this._stashUsed&&M>0){var I=new Uint8Array(this._stashBuffer,M);P.set(I,0)}this._stashUsed-=M,this._stashByteStart+=M}}},T.prototype._flushStashBuffer=function(w){if(this._stashUsed>0){var C=this._stashBuffer.slice(0,this._stashUsed),A=this._dispatchChunks(C,this._stashByteStart),L=C.byteLength-A;if(A<C.byteLength)if(w)u.default.w(this.TAG,L+" bytes unconsumed data remain when flush buffer, dropped");else{if(A>0){var D=new Uint8Array(this._stashBuffer,0,this._bufferSize),P=new Uint8Array(C,A);D.set(P,0),this._stashUsed=P.byteLength,this._stashByteStart+=A}return 0}return this._stashUsed=0,this._stashByteStart=0,L}return 0},T.prototype._onLoaderComplete=function(w,C){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},T.prototype._onLoaderError=function(w,C){switch(u.default.e(this.TAG,"Loader error, code = "+C.code+", msg = "+C.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,w=p.LoaderErrors.UNRECOVERABLE_EARLY_EOF),w){case p.LoaderErrors.EARLY_EOF:{if(!this._config.isLive&&this._totalLength){var A=this._currentRange.to+1;A<this._totalLength&&(u.default.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(A,!1));return}w=p.LoaderErrors.UNRECOVERABLE_EARLY_EOF;break}case p.LoaderErrors.UNRECOVERABLE_EARLY_EOF:case p.LoaderErrors.CONNECTING_TIMEOUT:case p.LoaderErrors.HTTP_STATUS_CODE_INVALID:case p.LoaderErrors.EXCEPTION:break}if(this._onError)this._onError(w,C);else throw new b.RuntimeException("IOException: "+C.msg)},T}();l.default=R},"./src/io/loader.js":function(c,l,d){d.r(l),d.d(l,{LoaderStatus:function(){return f},LoaderErrors:function(){return p},BaseLoader:function(){return v}});var u=d("./src/utils/exception.js"),f={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},p={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},v=function(){function E(g){this._type=g||"undefined",this._status=f.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return E.prototype.destroy=function(){this._status=f.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},E.prototype.isWorking=function(){return this._status===f.kConnecting||this._status===f.kBuffering},Object.defineProperty(E.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(g){this._onContentLengthKnown=g},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(g){this._onURLRedirect=g},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(g){this._onDataArrival=g},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"onError",{get:function(){return this._onError},set:function(g){this._onError=g},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"onComplete",{get:function(){return this._onComplete},set:function(g){this._onComplete=g},enumerable:!1,configurable:!0}),E.prototype.open=function(g,_){throw new u.NotImplementedException("Unimplemented abstract function!")},E.prototype.abort=function(){throw new u.NotImplementedException("Unimplemented abstract function!")},E}()},"./src/io/param-seek-handler.js":function(c,l,d){d.r(l);var u=function(){function f(p,v){this._startName=p,this._endName=v}return f.prototype.getConfig=function(p,v){var E=p;if(v.from!==0||v.to!==-1){var g=!0;E.indexOf("?")===-1&&(E+="?",g=!1),g&&(E+="&"),E+=this._startName+"="+v.from.toString(),v.to!==-1&&(E+="&"+this._endName+"="+v.to.toString())}return{url:E,headers:{}}},f.prototype.removeURLParameters=function(p){var v=p.split("?")[0],E=void 0,g=p.indexOf("?");g!==-1&&(E=p.substring(g+1));var _="";if(E!=null&&E.length>0)for(var m=E.split("&"),y=0;y<m.length;y++){var b=m[y].split("="),R=y>0;b[0]!==this._startName&&b[0]!==this._endName&&(R&&(_+="&"),_+=m[y])}return _.length===0?v:v+"?"+_},f}();l.default=u},"./src/io/range-seek-handler.js":function(c,l,d){d.r(l);var u=function(){function f(p){this._zeroStart=p||!1}return f.prototype.getConfig=function(p,v){var E={};if(v.from!==0||v.to!==-1){var g=void 0;v.to!==-1?g="bytes="+v.from.toString()+"-"+v.to.toString():g="bytes="+v.from.toString()+"-",E.Range=g}else this._zeroStart&&(E.Range="bytes=0-");return{url:p,headers:E}},f.prototype.removeURLParameters=function(p){return p},f}();l.default=u},"./src/io/speed-sampler.js":function(c,l,d){d.r(l);var u=function(){function f(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return f.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},f.prototype.addBytes=function(p){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=p,this._totalBytes+=p):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=p,this._totalBytes+=p):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=p,this._totalBytes+=p,this._lastCheckpoint=this._now())},Object.defineProperty(f.prototype,"currentKBps",{get:function(){this.addBytes(0);var p=(this._now()-this._lastCheckpoint)/1e3;return p==0&&(p=1),this._intervalBytes/p/1024},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"averageKBps",{get:function(){var p=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/p/1024},enumerable:!1,configurable:!0}),f}();l.default=u},"./src/io/websocket-loader.js":function(c,l,d){d.r(l);var u=d("./src/io/loader.js"),f=d("./src/utils/exception.js"),p=function(){var E=function(g,_){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var b in y)Object.prototype.hasOwnProperty.call(y,b)&&(m[b]=y[b])},E(g,_)};return function(g,_){if(typeof _!="function"&&_!==null)throw new TypeError("Class extends value "+String(_)+" is not a constructor or null");E(g,_);function m(){this.constructor=g}g.prototype=_===null?Object.create(_):(m.prototype=_.prototype,new m)}}(),v=function(E){p(g,E);function g(){var _=E.call(this,"websocket-loader")||this;return _.TAG="WebSocketLoader",_._needStash=!0,_._ws=null,_._requestAbort=!1,_._receivedLength=0,_}return g.isSupported=function(){try{return typeof self.WebSocket<"u"}catch{return!1}},g.prototype.destroy=function(){this._ws&&this.abort(),E.prototype.destroy.call(this)},g.prototype.open=function(_){try{var m=this._ws=new self.WebSocket(_.url);m.binaryType="arraybuffer",m.onopen=this._onWebSocketOpen.bind(this),m.onclose=this._onWebSocketClose.bind(this),m.onmessage=this._onWebSocketMessage.bind(this),m.onerror=this._onWebSocketError.bind(this),this._status=u.LoaderStatus.kConnecting}catch(b){this._status=u.LoaderStatus.kError;var y={code:b.code,msg:b.message};if(this._onError)this._onError(u.LoaderErrors.EXCEPTION,y);else throw new f.RuntimeException(y.msg)}},g.prototype.abort=function(){var _=this._ws;_&&(_.readyState===0||_.readyState===1)&&(this._requestAbort=!0,_.close()),this._ws=null,this._status=u.LoaderStatus.kComplete},g.prototype._onWebSocketOpen=function(_){this._status=u.LoaderStatus.kBuffering},g.prototype._onWebSocketClose=function(_){if(this._requestAbort===!0){this._requestAbort=!1;return}this._status=u.LoaderStatus.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)},g.prototype._onWebSocketMessage=function(_){var m=this;if(_.data instanceof ArrayBuffer)this._dispatchArrayBuffer(_.data);else if(_.data instanceof Blob){var y=new FileReader;y.onload=function(){m._dispatchArrayBuffer(y.result)},y.readAsArrayBuffer(_.data)}else{this._status=u.LoaderStatus.kError;var b={code:-1,msg:"Unsupported WebSocket message type: "+_.data.constructor.name};if(this._onError)this._onError(u.LoaderErrors.EXCEPTION,b);else throw new f.RuntimeException(b.msg)}},g.prototype._dispatchArrayBuffer=function(_){var m=_,y=this._receivedLength;this._receivedLength+=m.byteLength,this._onDataArrival&&this._onDataArrival(m,y,this._receivedLength)},g.prototype._onWebSocketError=function(_){this._status=u.LoaderStatus.kError;var m={code:_.code,msg:_.message};if(this._onError)this._onError(u.LoaderErrors.EXCEPTION,m);else throw new f.RuntimeException(m.msg)},g}(u.BaseLoader);l.default=v},"./src/io/xhr-moz-chunked-loader.js":function(c,l,d){d.r(l);var u=d("./src/utils/logger.js"),f=d("./src/io/loader.js"),p=d("./src/utils/exception.js"),v=function(){var g=function(_,m){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,b){y.__proto__=b}||function(y,b){for(var R in b)Object.prototype.hasOwnProperty.call(b,R)&&(y[R]=b[R])},g(_,m)};return function(_,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");g(_,m);function y(){this.constructor=_}_.prototype=m===null?Object.create(m):(y.prototype=m.prototype,new y)}}(),E=function(g){v(_,g);function _(m,y){var b=g.call(this,"xhr-moz-chunked-loader")||this;return b.TAG="MozChunkedLoader",b._seekHandler=m,b._config=y,b._needStash=!0,b._xhr=null,b._requestAbort=!1,b._contentLength=null,b._receivedLength=0,b}return _.isSupported=function(){try{var m=new XMLHttpRequest;return m.open("GET","https://example.com",!0),m.responseType="moz-chunked-arraybuffer",m.responseType==="moz-chunked-arraybuffer"}catch(y){return u.default.w("MozChunkedLoader",y.message),!1}},_.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),g.prototype.destroy.call(this)},_.prototype.open=function(m,y){this._dataSource=m,this._range=y;var b=m.url;this._config.reuseRedirectedURL&&m.redirectedURL!=null&&(b=m.redirectedURL);var R=this._seekHandler.getConfig(b,y);this._requestURL=R.url;var T=this._xhr=new XMLHttpRequest;if(T.open("GET",R.url,!0),T.responseType="moz-chunked-arraybuffer",T.onreadystatechange=this._onReadyStateChange.bind(this),T.onprogress=this._onProgress.bind(this),T.onloadend=this._onLoadEnd.bind(this),T.onerror=this._onXhrError.bind(this),m.withCredentials&&(T.withCredentials=!0),typeof R.headers=="object"){var w=R.headers;for(var C in w)w.hasOwnProperty(C)&&T.setRequestHeader(C,w[C])}if(typeof this._config.headers=="object"){var w=this._config.headers;for(var C in w)w.hasOwnProperty(C)&&T.setRequestHeader(C,w[C])}this._status=f.LoaderStatus.kConnecting,T.send()},_.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=f.LoaderStatus.kComplete},_.prototype._onReadyStateChange=function(m){var y=m.target;if(y.readyState===2){if(y.responseURL!=null&&y.responseURL!==this._requestURL&&this._onURLRedirect){var b=this._seekHandler.removeURLParameters(y.responseURL);this._onURLRedirect(b)}if(y.status!==0&&(y.status<200||y.status>299))if(this._status=f.LoaderStatus.kError,this._onError)this._onError(f.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:y.status,msg:y.statusText});else throw new p.RuntimeException("MozChunkedLoader: Http code invalid, "+y.status+" "+y.statusText);else this._status=f.LoaderStatus.kBuffering}},_.prototype._onProgress=function(m){if(this._status!==f.LoaderStatus.kError){this._contentLength===null&&m.total!==null&&m.total!==0&&(this._contentLength=m.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var y=m.target.response,b=this._range.from+this._receivedLength;this._receivedLength+=y.byteLength,this._onDataArrival&&this._onDataArrival(y,b,this._receivedLength)}},_.prototype._onLoadEnd=function(m){if(this._requestAbort===!0){this._requestAbort=!1;return}else if(this._status===f.LoaderStatus.kError)return;this._status=f.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)},_.prototype._onXhrError=function(m){this._status=f.LoaderStatus.kError;var y=0,b=null;if(this._contentLength&&m.loaded<this._contentLength?(y=f.LoaderErrors.EARLY_EOF,b={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(y=f.LoaderErrors.EXCEPTION,b={code:-1,msg:m.constructor.name+" "+m.type}),this._onError)this._onError(y,b);else throw new p.RuntimeException(b.msg)},_}(f.BaseLoader);l.default=E},"./src/io/xhr-range-loader.js":function(c,l,d){d.r(l);var u=d("./src/utils/logger.js"),f=d("./src/io/speed-sampler.js"),p=d("./src/io/loader.js"),v=d("./src/utils/exception.js"),E=function(){var _=function(m,y){return _=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,R){b.__proto__=R}||function(b,R){for(var T in R)Object.prototype.hasOwnProperty.call(R,T)&&(b[T]=R[T])},_(m,y)};return function(m,y){if(typeof y!="function"&&y!==null)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");_(m,y);function b(){this.constructor=m}m.prototype=y===null?Object.create(y):(b.prototype=y.prototype,new b)}}(),g=function(_){E(m,_);function m(y,b){var R=_.call(this,"xhr-range-loader")||this;return R.TAG="RangeLoader",R._seekHandler=y,R._config=b,R._needStash=!1,R._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],R._currentChunkSizeKB=384,R._currentSpeedNormalized=0,R._zeroSpeedChunkCount=0,R._xhr=null,R._speedSampler=new f.default,R._requestAbort=!1,R._waitForTotalLength=!1,R._totalLengthReceived=!1,R._currentRequestURL=null,R._currentRedirectedURL=null,R._currentRequestRange=null,R._totalLength=null,R._contentLength=null,R._receivedLength=0,R._lastTimeLoaded=0,R}return m.isSupported=function(){try{var y=new XMLHttpRequest;return y.open("GET","https://example.com",!0),y.responseType="arraybuffer",y.responseType==="arraybuffer"}catch(b){return u.default.w("RangeLoader",b.message),!1}},m.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),_.prototype.destroy.call(this)},Object.defineProperty(m.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),m.prototype.open=function(y,b){this._dataSource=y,this._range=b,this._status=p.LoaderStatus.kConnecting;var R=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&(R=!0,this._totalLength=this._dataSource.filesize),!this._totalLengthReceived&&!R?(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1})):this._openSubRange()},m.prototype._openSubRange=function(){var y=this._currentChunkSizeKB*1024,b=this._range.from+this._receivedLength,R=b+y;this._contentLength!=null&&R-this._range.from>=this._contentLength&&(R=this._range.from+this._contentLength-1),this._currentRequestRange={from:b,to:R},this._internalOpen(this._dataSource,this._currentRequestRange)},m.prototype._internalOpen=function(y,b){this._lastTimeLoaded=0;var R=y.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?R=this._currentRedirectedURL:y.redirectedURL!=null&&(R=y.redirectedURL));var T=this._seekHandler.getConfig(R,b);this._currentRequestURL=T.url;var w=this._xhr=new XMLHttpRequest;if(w.open("GET",T.url,!0),w.responseType="arraybuffer",w.onreadystatechange=this._onReadyStateChange.bind(this),w.onprogress=this._onProgress.bind(this),w.onload=this._onLoad.bind(this),w.onerror=this._onXhrError.bind(this),y.withCredentials&&(w.withCredentials=!0),typeof T.headers=="object"){var C=T.headers;for(var A in C)C.hasOwnProperty(A)&&w.setRequestHeader(A,C[A])}if(typeof this._config.headers=="object"){var C=this._config.headers;for(var A in C)C.hasOwnProperty(A)&&w.setRequestHeader(A,C[A])}w.send()},m.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=p.LoaderStatus.kComplete},m.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},m.prototype._onReadyStateChange=function(y){var b=y.target;if(b.readyState===2){if(b.responseURL!=null){var R=this._seekHandler.removeURLParameters(b.responseURL);b.responseURL!==this._currentRequestURL&&R!==this._currentRedirectedURL&&(this._currentRedirectedURL=R,this._onURLRedirect&&this._onURLRedirect(R))}if(b.status>=200&&b.status<=299){if(this._waitForTotalLength)return;this._status=p.LoaderStatus.kBuffering}else if(this._status=p.LoaderStatus.kError,this._onError)this._onError(p.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:b.status,msg:b.statusText});else throw new v.RuntimeException("RangeLoader: Http code invalid, "+b.status+" "+b.statusText)}},m.prototype._onProgress=function(y){if(this._status!==p.LoaderStatus.kError){if(this._contentLength===null){var b=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,b=!0;var R=y.total;this._internalAbort(),R!=null&R!==0&&(this._totalLength=R)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,b){this._openSubRange();return}this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var T=y.loaded-this._lastTimeLoaded;this._lastTimeLoaded=y.loaded,this._speedSampler.addBytes(T)}},m.prototype._normalizeSpeed=function(y){var b=this._chunkSizeKBList,R=b.length-1,T=0,w=0,C=R;if(y<b[0])return b[0];for(;w<=C;){if(T=w+Math.floor((C-w)/2),T===R||y>=b[T]&&y<b[T+1])return b[T];b[T]<y?w=T+1:C=T-1}},m.prototype._onLoad=function(y){if(this._status!==p.LoaderStatus.kError){if(this._waitForTotalLength){this._waitForTotalLength=!1;return}this._lastTimeLoaded=0;var b=this._speedSampler.lastSecondKBps;if(b===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(b=this._speedSampler.currentKBps)),b!==0){var R=this._normalizeSpeed(b);this._currentSpeedNormalized!==R&&(this._currentSpeedNormalized=R,this._currentChunkSizeKB=R)}var T=y.target.response,w=this._range.from+this._receivedLength;this._receivedLength+=T.byteLength;var C=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():C=!0,this._onDataArrival&&this._onDataArrival(T,w,this._receivedLength),C&&(this._status=p.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},m.prototype._onXhrError=function(y){this._status=p.LoaderStatus.kError;var b=0,R=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(b=p.LoaderErrors.EARLY_EOF,R={code:-1,msg:"RangeLoader meet Early-Eof"}):(b=p.LoaderErrors.EXCEPTION,R={code:-1,msg:y.constructor.name+" "+y.type}),this._onError)this._onError(b,R);else throw new v.RuntimeException(R.msg)},m}(p.BaseLoader);l.default=g},"./src/player/flv-player.js":function(c,l,d){d.r(l);var u=d("./node_modules/events/events.js"),f=d.n(u),p=d("./src/utils/logger.js"),v=d("./src/utils/browser.js"),E=d("./src/player/player-events.js"),g=d("./src/core/transmuxer.js"),_=d("./src/core/transmuxing-events.js"),m=d("./src/core/mse-controller.js"),y=d("./src/core/mse-events.js"),b=d("./src/player/player-errors.js"),R=d("./src/config.js"),T=d("./src/utils/exception.js"),w=function(){function C(A,L){if(this.TAG="FlvPlayer",this._type="FlvPlayer",this._emitter=new(f()),this._config=(0,R.createDefaultConfig)(),typeof L=="object"&&Object.assign(this._config,L),A.type.toLowerCase()!=="flv")throw new T.InvalidArgumentException("FlvPlayer requires an flv MediaDataSource input!");A.isLive===!0&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=A,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var D=v.default.chrome&&(v.default.version.major<50||v.default.version.major===50&&v.default.version.build<2661);this._alwaysSeekKeyframe=!!(D||v.default.msedge||v.default.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}return C.prototype.destroy=function(){this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},C.prototype.on=function(A,L){var D=this;A===E.default.MEDIA_INFO?this._mediaInfo!=null&&Promise.resolve().then(function(){D._emitter.emit(E.default.MEDIA_INFO,D.mediaInfo)}):A===E.default.STATISTICS_INFO&&this._statisticsInfo!=null&&Promise.resolve().then(function(){D._emitter.emit(E.default.STATISTICS_INFO,D.statisticsInfo)}),this._emitter.addListener(A,L)},C.prototype.off=function(A,L){this._emitter.removeListener(A,L)},C.prototype.attachMediaElement=function(A){var L=this;if(this._mediaElement=A,A.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),A.addEventListener("seeking",this.e.onvSeeking),A.addEventListener("canplay",this.e.onvCanPlay),A.addEventListener("stalled",this.e.onvStalled),A.addEventListener("progress",this.e.onvProgress),this._msectl=new m.default(this._config),this._msectl.on(y.default.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(y.default.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(y.default.SOURCE_OPEN,function(){L._mseSourceOpened=!0,L._hasPendingLoad&&(L._hasPendingLoad=!1,L.load())}),this._msectl.on(y.default.ERROR,function(D){L._emitter.emit(E.default.ERROR,b.ErrorTypes.MEDIA_ERROR,b.ErrorDetails.MEDIA_MSE_ERROR,D)}),this._msectl.attachMediaElement(A),this._pendingSeekTime!=null)try{A.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}},C.prototype.detachMediaElement=function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)},C.prototype.load=function(){var A=this;if(!this._mediaElement)throw new T.IllegalStateException("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new T.IllegalStateException("FlvPlayer.load() has been called, please call unload() first!");if(!this._hasPendingLoad){if(this._config.deferLoadAfterSourceOpen&&this._mseSourceOpened===!1){this._hasPendingLoad=!0;return}this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new g.default(this._mediaDataSource,this._config),this._transmuxer.on(_.default.INIT_SEGMENT,function(L,D){A._msectl.appendInitSegment(D)}),this._transmuxer.on(_.default.MEDIA_SEGMENT,function(L,D){if(A._msectl.appendMediaSegment(D),A._config.lazyLoad&&!A._config.isLive){var P=A._mediaElement.currentTime;D.info.endDts>=(P+A._config.lazyLoadMaxDuration)*1e3&&A._progressChecker==null&&(p.default.v(A.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),A._suspendTransmuxer())}}),this._transmuxer.on(_.default.LOADING_COMPLETE,function(){A._msectl.endOfStream(),A._emitter.emit(E.default.LOADING_COMPLETE)}),this._transmuxer.on(_.default.RECOVERED_EARLY_EOF,function(){A._emitter.emit(E.default.RECOVERED_EARLY_EOF)}),this._transmuxer.on(_.default.IO_ERROR,function(L,D){A._emitter.emit(E.default.ERROR,b.ErrorTypes.NETWORK_ERROR,L,D)}),this._transmuxer.on(_.default.DEMUX_ERROR,function(L,D){A._emitter.emit(E.default.ERROR,b.ErrorTypes.MEDIA_ERROR,L,{code:-1,msg:D})}),this._transmuxer.on(_.default.MEDIA_INFO,function(L){A._mediaInfo=L,A._emitter.emit(E.default.MEDIA_INFO,Object.assign({},L))}),this._transmuxer.on(_.default.METADATA_ARRIVED,function(L){A._emitter.emit(E.default.METADATA_ARRIVED,L)}),this._transmuxer.on(_.default.SCRIPTDATA_ARRIVED,function(L){A._emitter.emit(E.default.SCRIPTDATA_ARRIVED,L)}),this._transmuxer.on(_.default.STATISTICS_INFO,function(L){A._statisticsInfo=A._fillStatisticsInfo(L),A._emitter.emit(E.default.STATISTICS_INFO,Object.assign({},A._statisticsInfo))}),this._transmuxer.on(_.default.RECOMMEND_SEEKPOINT,function(L){A._mediaElement&&!A._config.accurateSeek&&(A._requestSetTime=!0,A._mediaElement.currentTime=L/1e3)}),this._transmuxer.open()}},C.prototype.unload=function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)},C.prototype.play=function(){return this._mediaElement.play()},C.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(C.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(A){this._mediaElement.volume=A},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(A){this._mediaElement.muted=A},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(A){this._mediaElement?this._internalSeek(A):this._pendingSeekTime=A},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"mediaInfo",{get:function(){return Object.assign({},this._mediaInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"statisticsInfo",{get:function(){return this._statisticsInfo==null&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)},enumerable:!1,configurable:!0}),C.prototype._fillStatisticsInfo=function(A){if(A.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return A;var L=!0,D=0,P=0;if(this._mediaElement.getVideoPlaybackQuality){var k=this._mediaElement.getVideoPlaybackQuality();D=k.totalVideoFrames,P=k.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(D=this._mediaElement.webkitDecodedFrameCount,P=this._mediaElement.webkitDroppedFrameCount):L=!1;return L&&(A.decodedFrames=D,A.droppedFrames=P),A},C.prototype._onmseUpdateEnd=function(){if(!(!this._config.lazyLoad||this._config.isLive)){for(var A=this._mediaElement.buffered,L=this._mediaElement.currentTime,D=0,P=0;P<A.length;P++){var k=A.start(P),M=A.end(P);if(k<=L&&L<M){D=M;break}}D>=L+this._config.lazyLoadMaxDuration&&this._progressChecker==null&&(p.default.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}},C.prototype._onmseBufferFull=function(){p.default.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._progressChecker==null&&this._suspendTransmuxer()},C.prototype._suspendTransmuxer=function(){this._transmuxer&&(this._transmuxer.pause(),this._progressChecker==null&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))},C.prototype._checkProgressAndResume=function(){for(var A=this._mediaElement.currentTime,L=this._mediaElement.buffered,D=!1,P=0;P<L.length;P++){var k=L.start(P),M=L.end(P);if(A>=k&&A<M){A>=M-this._config.lazyLoadRecoverDuration&&(D=!0);break}}D&&(window.clearInterval(this._progressChecker),this._progressChecker=null,D&&(p.default.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))},C.prototype._isTimepointBuffered=function(A){for(var L=this._mediaElement.buffered,D=0;D<L.length;D++){var P=L.start(D),k=L.end(D);if(A>=P&&A<k)return!0}return!1},C.prototype._internalSeek=function(A){var L=this._isTimepointBuffered(A),D=!1,P=0;if(A<1&&this._mediaElement.buffered.length>0){var k=this._mediaElement.buffered.start(0);(k<1&&A<k||v.default.safari)&&(D=!0,P=v.default.safari?.1:k)}if(D)this._requestSetTime=!0,this._mediaElement.currentTime=P;else if(L){if(!this._alwaysSeekKeyframe)this._requestSetTime=!0,this._mediaElement.currentTime=A;else{var M=this._msectl.getNearestKeyframe(Math.floor(A*1e3));this._requestSetTime=!0,M!=null?this._mediaElement.currentTime=M.dts/1e3:this._mediaElement.currentTime=A}this._progressChecker!=null&&this._checkProgressAndResume()}else this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(A),this._transmuxer.seek(Math.floor(A*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=A)},C.prototype._checkAndApplyUnbufferedSeekpoint=function(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){var A=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(A)||(this._progressChecker!=null&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(A),this._transmuxer.seek(Math.floor(A*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=A))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},C.prototype._checkAndResumeStuckPlayback=function(A){var L=this._mediaElement;if(A||!this._receivedCanPlay||L.readyState<2){var D=L.buffered;D.length>0&&L.currentTime<D.start(0)&&(p.default.w(this.TAG,"Playback seems stuck at "+L.currentTime+", seek to "+D.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=D.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)},C.prototype._onvLoadedMetadata=function(A){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)},C.prototype._onvSeeking=function(A){var L=this._mediaElement.currentTime,D=this._mediaElement.buffered;if(this._requestSetTime){this._requestSetTime=!1;return}if(L<1&&D.length>0){var P=D.start(0);if(P<1&&L<P||v.default.safari){this._requestSetTime=!0,this._mediaElement.currentTime=v.default.safari?.1:P;return}}if(this._isTimepointBuffered(L)){if(this._alwaysSeekKeyframe){var k=this._msectl.getNearestKeyframe(Math.floor(L*1e3));k!=null&&(this._requestSetTime=!0,this._mediaElement.currentTime=k.dts/1e3)}this._progressChecker!=null&&this._checkProgressAndResume();return}this._seekpointRecord={seekPoint:L,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},C.prototype._onvCanPlay=function(A){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)},C.prototype._onvStalled=function(A){this._checkAndResumeStuckPlayback(!0)},C.prototype._onvProgress=function(A){this._checkAndResumeStuckPlayback()},C}();l.default=w},"./src/player/native-player.js":function(c,l,d){d.r(l);var u=d("./node_modules/events/events.js"),f=d.n(u),p=d("./src/player/player-events.js"),v=d("./src/config.js"),E=d("./src/utils/exception.js"),g=function(){function _(m,y){if(this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new(f()),this._config=(0,v.createDefaultConfig)(),typeof y=="object"&&Object.assign(this._config,y),m.type.toLowerCase()==="flv")throw new E.InvalidArgumentException("NativePlayer does't support flv MediaDataSource input!");if(m.hasOwnProperty("segments"))throw new E.InvalidArgumentException("NativePlayer("+m.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=m,this._mediaElement=null}return _.prototype.destroy=function(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},_.prototype.on=function(m,y){var b=this;m===p.default.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){b._emitter.emit(p.default.MEDIA_INFO,b.mediaInfo)}):m===p.default.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){b._emitter.emit(p.default.STATISTICS_INFO,b.statisticsInfo)}),this._emitter.addListener(m,y)},_.prototype.off=function(m,y){this._emitter.removeListener(m,y)},_.prototype.attachMediaElement=function(m){if(this._mediaElement=m,m.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{m.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch{}},_.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},_.prototype.load=function(){if(!this._mediaElement)throw new E.IllegalStateException("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},_.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},_.prototype.play=function(){return this._mediaElement.play()},_.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(_.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(m){this._mediaElement.volume=m},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(m){this._mediaElement.muted=m},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(m){this._mediaElement?this._mediaElement.currentTime=m:this._pendingSeekTime=m},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"mediaInfo",{get:function(){var m=this._mediaElement instanceof HTMLAudioElement?"audio/":"video/",y={mimeType:m+this._mediaDataSource.type};return this._mediaElement&&(y.duration=Math.floor(this._mediaElement.duration*1e3),this._mediaElement instanceof HTMLVideoElement&&(y.width=this._mediaElement.videoWidth,y.height=this._mediaElement.videoHeight)),y},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"statisticsInfo",{get:function(){var m={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return m;var y=!0,b=0,R=0;if(this._mediaElement.getVideoPlaybackQuality){var T=this._mediaElement.getVideoPlaybackQuality();b=T.totalVideoFrames,R=T.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(b=this._mediaElement.webkitDecodedFrameCount,R=this._mediaElement.webkitDroppedFrameCount):y=!1;return y&&(m.decodedFrames=b,m.droppedFrames=R),m},enumerable:!1,configurable:!0}),_.prototype._onvLoadedMetadata=function(m){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(p.default.MEDIA_INFO,this.mediaInfo)},_.prototype._reportStatisticsInfo=function(){this._emitter.emit(p.default.STATISTICS_INFO,this.statisticsInfo)},_}();l.default=g},"./src/player/player-errors.js":function(c,l,d){d.r(l),d.d(l,{ErrorTypes:function(){return p},ErrorDetails:function(){return v}});var u=d("./src/io/loader.js"),f=d("./src/demux/demux-errors.js"),p={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},v={NETWORK_EXCEPTION:u.LoaderErrors.EXCEPTION,NETWORK_STATUS_CODE_INVALID:u.LoaderErrors.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:u.LoaderErrors.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:u.LoaderErrors.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:f.default.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:f.default.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:f.default.CODEC_UNSUPPORTED}},"./src/player/player-events.js":function(c,l,d){d.r(l);var u={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info"};l.default=u},"./src/remux/aac-silent.js":function(c,l,d){d.r(l);var u=function(){function f(){}return f.getSilentFrame=function(p,v){if(p==="mp4a.40.2"){if(v===1)return new Uint8Array([0,200,0,128,35,128]);if(v===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(v===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(v===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(v===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(v===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(v===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(v===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(v===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},f}();l.default=u},"./src/remux/mp4-generator.js":function(c,l,d){d.r(l);var u=function(){function f(){}return f.init=function(){f.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[]};for(var p in f.types)f.types.hasOwnProperty(p)&&(f.types[p]=[p.charCodeAt(0),p.charCodeAt(1),p.charCodeAt(2),p.charCodeAt(3)]);var v=f.constants={};v.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),v.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),v.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),v.STSC=v.STCO=v.STTS,v.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),v.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),v.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),v.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),v.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),v.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},f.box=function(p){for(var v=8,E=null,g=Array.prototype.slice.call(arguments,1),_=g.length,m=0;m<_;m++)v+=g[m].byteLength;E=new Uint8Array(v),E[0]=v>>>24&255,E[1]=v>>>16&255,E[2]=v>>>8&255,E[3]=v&255,E.set(p,4);for(var y=8,m=0;m<_;m++)E.set(g[m],y),y+=g[m].byteLength;return E},f.generateInitSegment=function(p){var v=f.box(f.types.ftyp,f.constants.FTYP),E=f.moov(p),g=new Uint8Array(v.byteLength+E.byteLength);return g.set(v,0),g.set(E,v.byteLength),g},f.moov=function(p){var v=f.mvhd(p.timescale,p.duration),E=f.trak(p),g=f.mvex(p);return f.box(f.types.moov,v,E,g)},f.mvhd=function(p,v){return f.box(f.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,p>>>24&255,p>>>16&255,p>>>8&255,p&255,v>>>24&255,v>>>16&255,v>>>8&255,v&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},f.trak=function(p){return f.box(f.types.trak,f.tkhd(p),f.mdia(p))},f.tkhd=function(p){var v=p.id,E=p.duration,g=p.presentWidth,_=p.presentHeight;return f.box(f.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,v>>>24&255,v>>>16&255,v>>>8&255,v&255,0,0,0,0,E>>>24&255,E>>>16&255,E>>>8&255,E&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,g>>>8&255,g&255,0,0,_>>>8&255,_&255,0,0]))},f.mdia=function(p){return f.box(f.types.mdia,f.mdhd(p),f.hdlr(p),f.minf(p))},f.mdhd=function(p){var v=p.timescale,E=p.duration;return f.box(f.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,v>>>24&255,v>>>16&255,v>>>8&255,v&255,E>>>24&255,E>>>16&255,E>>>8&255,E&255,85,196,0,0]))},f.hdlr=function(p){var v=null;return p.type==="audio"?v=f.constants.HDLR_AUDIO:v=f.constants.HDLR_VIDEO,f.box(f.types.hdlr,v)},f.minf=function(p){var v=null;return p.type==="audio"?v=f.box(f.types.smhd,f.constants.SMHD):v=f.box(f.types.vmhd,f.constants.VMHD),f.box(f.types.minf,v,f.dinf(),f.stbl(p))},f.dinf=function(){var p=f.box(f.types.dinf,f.box(f.types.dref,f.constants.DREF));return p},f.stbl=function(p){var v=f.box(f.types.stbl,f.stsd(p),f.box(f.types.stts,f.constants.STTS),f.box(f.types.stsc,f.constants.STSC),f.box(f.types.stsz,f.constants.STSZ),f.box(f.types.stco,f.constants.STCO));return v},f.stsd=function(p){return p.type==="audio"?p.codec==="mp3"?f.box(f.types.stsd,f.constants.STSD_PREFIX,f.mp3(p)):f.box(f.types.stsd,f.constants.STSD_PREFIX,f.mp4a(p)):f.box(f.types.stsd,f.constants.STSD_PREFIX,f.avc1(p))},f.mp3=function(p){var v=p.channelCount,E=p.audioSampleRate,g=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,v,0,16,0,0,0,0,E>>>8&255,E&255,0,0]);return f.box(f.types[".mp3"],g)},f.mp4a=function(p){var v=p.channelCount,E=p.audioSampleRate,g=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,v,0,16,0,0,0,0,E>>>8&255,E&255,0,0]);return f.box(f.types.mp4a,g,f.esds(p))},f.esds=function(p){var v=p.config||[],E=v.length,g=new Uint8Array([0,0,0,0,3,23+E,0,1,0,4,15+E,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([E]).concat(v).concat([6,1,2]));return f.box(f.types.esds,g)},f.avc1=function(p){var v=p.avcc,E=p.codecWidth,g=p.codecHeight,_=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,E>>>8&255,E&255,g>>>8&255,g&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return f.box(f.types.avc1,_,f.box(f.types.avcC,v))},f.mvex=function(p){return f.box(f.types.mvex,f.trex(p))},f.trex=function(p){var v=p.id,E=new Uint8Array([0,0,0,0,v>>>24&255,v>>>16&255,v>>>8&255,v&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return f.box(f.types.trex,E)},f.moof=function(p,v){return f.box(f.types.moof,f.mfhd(p.sequenceNumber),f.traf(p,v))},f.mfhd=function(p){var v=new Uint8Array([0,0,0,0,p>>>24&255,p>>>16&255,p>>>8&255,p&255]);return f.box(f.types.mfhd,v)},f.traf=function(p,v){var E=p.id,g=f.box(f.types.tfhd,new Uint8Array([0,0,0,0,E>>>24&255,E>>>16&255,E>>>8&255,E&255])),_=f.box(f.types.tfdt,new Uint8Array([0,0,0,0,v>>>24&255,v>>>16&255,v>>>8&255,v&255])),m=f.sdtp(p),y=f.trun(p,m.byteLength+16+16+8+16+8+8);return f.box(f.types.traf,g,_,y,m)},f.sdtp=function(p){for(var v=p.samples||[],E=v.length,g=new Uint8Array(4+E),_=0;_<E;_++){var m=v[_].flags;g[_+4]=m.isLeading<<6|m.dependsOn<<4|m.isDependedOn<<2|m.hasRedundancy}return f.box(f.types.sdtp,g)},f.trun=function(p,v){var E=p.samples||[],g=E.length,_=12+16*g,m=new Uint8Array(_);v+=8+_,m.set([0,0,15,1,g>>>24&255,g>>>16&255,g>>>8&255,g&255,v>>>24&255,v>>>16&255,v>>>8&255,v&255],0);for(var y=0;y<g;y++){var b=E[y].duration,R=E[y].size,T=E[y].flags,w=E[y].cts;m.set([b>>>24&255,b>>>16&255,b>>>8&255,b&255,R>>>24&255,R>>>16&255,R>>>8&255,R&255,T.isLeading<<2|T.dependsOn,T.isDependedOn<<6|T.hasRedundancy<<4|T.isNonSync,0,0,w>>>24&255,w>>>16&255,w>>>8&255,w&255],12+16*y)}return f.box(f.types.trun,m)},f.mdat=function(p){return f.box(f.types.mdat,p)},f}();u.init(),l.default=u},"./src/remux/mp4-remuxer.js":function(c,l,d){d.r(l);var u=d("./src/utils/logger.js"),f=d("./src/remux/mp4-generator.js"),p=d("./src/remux/aac-silent.js"),v=d("./src/utils/browser.js"),E=d("./src/core/media-segment-info.js"),g=d("./src/utils/exception.js"),_=function(){function m(y){this.TAG="MP4Remuxer",this._config=y,this._isLive=y.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new E.MediaSegmentInfoList("audio"),this._videoSegmentInfoList=new E.MediaSegmentInfoList("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!!(v.default.chrome&&(v.default.version.major<50||v.default.version.major===50&&v.default.version.build<2661)),this._fillSilentAfterSeek=v.default.msedge||v.default.msie,this._mp3UseMpegAudio=!v.default.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return m.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},m.prototype.bindDataSource=function(y){return y.onDataAvailable=this.remux.bind(this),y.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(m.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(y){this._onInitSegment=y},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(y){this._onMediaSegment=y},enumerable:!1,configurable:!0}),m.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},m.prototype.seek=function(y){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},m.prototype.remux=function(y,b){if(!this._onMediaSegment)throw new g.IllegalStateException("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(y,b),this._remuxVideo(b),this._remuxAudio(y)},m.prototype._onTrackMetadataReceived=function(y,b){var R=null,T="mp4",w=b.codec;if(y==="audio")this._audioMeta=b,b.codec==="mp3"&&this._mp3UseMpegAudio?(T="mpeg",w="",R=new Uint8Array):R=f.default.generateInitSegment(b);else if(y==="video")this._videoMeta=b,R=f.default.generateInitSegment(b);else return;if(!this._onInitSegment)throw new g.IllegalStateException("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(y,{type:y,data:R.buffer,codec:w,container:y+"/"+T,mediaDuration:b.duration})},m.prototype._calculateDtsBase=function(y,b){this._dtsBaseInited||(y.samples&&y.samples.length&&(this._audioDtsBase=y.samples[0].dts),b.samples&&b.samples.length&&(this._videoDtsBase=b.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},m.prototype.flushStashedSamples=function(){var y=this._videoStashedLastSample,b=this._audioStashedLastSample,R={type:"video",id:1,sequenceNumber:0,samples:[],length:0};y!=null&&(R.samples.push(y),R.length=y.length);var T={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};b!=null&&(T.samples.push(b),T.length=b.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(R,!0),this._remuxAudio(T,!0)},m.prototype._remuxAudio=function(y,b){if(this._audioMeta!=null){var R=y,T=R.samples,w=void 0,C=-1,A=-1,L=this._audioMeta.refSampleDuration,D=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,P=this._dtsBaseInited&&this._audioNextDts===void 0,k=!1;if(!(!T||T.length===0)&&!(T.length===1&&!b)){var M=0,I=null,F=0;D?(M=0,F=R.length):(M=8,F=8+R.length);var $=null;if(T.length>1&&($=T.pop(),F-=$.length),this._audioStashedLastSample!=null){var N=this._audioStashedLastSample;this._audioStashedLastSample=null,T.unshift(N),F+=N.length}$!=null&&(this._audioStashedLastSample=$);var U=T[0].dts-this._dtsBase;if(this._audioNextDts)w=U-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())w=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(k=!0);else{var V=this._audioSegmentInfoList.getLastSampleBefore(U);if(V!=null){var J=U-(V.originalDts+V.duration);J<=3&&(J=0);var j=V.dts+V.duration+J;w=U-j}else w=0}if(k){var q=U-w,Z=this._videoSegmentInfoList.getLastSegmentBefore(U);if(Z!=null&&Z.beginDts<q){var X=p.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);if(X){var Y=Z.beginDts,re=q-Z.beginDts;u.default.v(this.TAG,"InsertPrefixSilentAudio: dts: "+Y+", duration: "+re),T.unshift({unit:X,dts:Y,pts:Y}),F+=X.byteLength}}else k=!1}for(var oe=[],ve=0;ve<T.length;ve++){var N=T[ve],be=N.unit,Oe=N.dts-this._dtsBase,Y=Oe,Pe=!1,Se=null,Te=0;if(!(Oe<-.001)){if(this._audioMeta.codec!=="mp3"){var ge=Oe,Ue=3;if(this._audioNextDts&&(ge=this._audioNextDts),w=Oe-ge,w<=-Ue*L){u.default.w(this.TAG,"Dropping 1 audio frame (originalDts: "+Oe+" ms ,curRefDts: "+ge+" ms)  due to dtsCorrection: "+w+" ms overlap.");continue}else if(w>=Ue*L&&this._fillAudioTimestampGap&&!v.default.safari){Pe=!0;var je=Math.floor(w/L);u.default.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.
`+("originalDts: "+Oe+" ms, curRefDts: "+ge+" ms, ")+("dtsCorrection: "+Math.round(w)+" ms, generate: "+je+" frames")),Y=Math.floor(ge),Te=Math.floor(ge+L)-Y;var X=p.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);X==null&&(u.default.w(this.TAG,"Unable to generate silent frame for "+(this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame")),X=be),Se=[];for(var Ie=0;Ie<je;Ie++){ge=ge+L;var De=Math.floor(ge),ze=Math.floor(ge+L)-De,ut={dts:De,pts:De,cts:0,unit:X,size:X.byteLength,duration:ze,originalDts:Oe,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};Se.push(ut),F+=ut.size}this._audioNextDts=ge+L}else Y=Math.floor(ge),Te=Math.floor(ge+L)-Y,this._audioNextDts=ge+L}else{if(Y=Oe-w,ve!==T.length-1){var Ft=T[ve+1].dts-this._dtsBase-w;Te=Ft-Y}else if($!=null){var Ft=$.dts-this._dtsBase-w;Te=Ft-Y}else oe.length>=1?Te=oe[oe.length-1].duration:Te=Math.floor(L);this._audioNextDts=Y+Te}C===-1&&(C=Y),oe.push({dts:Y,pts:Y,cts:0,unit:N.unit,size:N.unit.byteLength,duration:Te,originalDts:Oe,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),Pe&&oe.push.apply(oe,Se)}}if(oe.length===0){R.samples=[],R.length=0;return}D?I=new Uint8Array(F):(I=new Uint8Array(F),I[0]=F>>>24&255,I[1]=F>>>16&255,I[2]=F>>>8&255,I[3]=F&255,I.set(f.default.types.mdat,4));for(var ve=0;ve<oe.length;ve++){var be=oe[ve].unit;I.set(be,M),M+=be.byteLength}var rt=oe[oe.length-1];A=rt.dts+rt.duration;var et=new E.MediaSegmentInfo;et.beginDts=C,et.endDts=A,et.beginPts=C,et.endPts=A,et.originalBeginDts=oe[0].originalDts,et.originalEndDts=rt.originalDts+rt.duration,et.firstSample=new E.SampleInfo(oe[0].dts,oe[0].pts,oe[0].duration,oe[0].originalDts,!1),et.lastSample=new E.SampleInfo(rt.dts,rt.pts,rt.duration,rt.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(et),R.samples=oe,R.sequenceNumber++;var $e=null;D?$e=new Uint8Array:$e=f.default.moof(R,C),R.samples=[],R.length=0;var Ge={type:"audio",data:this._mergeBoxes($e,I).buffer,sampleCount:oe.length,info:et};D&&P&&(Ge.timestampOffset=C),this._onMediaSegment("audio",Ge)}}},m.prototype._remuxVideo=function(y,b){if(this._videoMeta!=null){var R=y,T=R.samples,w=void 0,C=-1,A=-1,L=-1,D=-1;if(!(!T||T.length===0)&&!(T.length===1&&!b)){var P=8,k=null,M=8+y.length,I=null;if(T.length>1&&(I=T.pop(),M-=I.length),this._videoStashedLastSample!=null){var F=this._videoStashedLastSample;this._videoStashedLastSample=null,T.unshift(F),M+=F.length}I!=null&&(this._videoStashedLastSample=I);var $=T[0].dts-this._dtsBase;if(this._videoNextDts)w=$-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())w=0;else{var N=this._videoSegmentInfoList.getLastSampleBefore($);if(N!=null){var U=$-(N.originalDts+N.duration);U<=3&&(U=0);var V=N.dts+N.duration+U;w=$-V}else w=0}for(var J=new E.MediaSegmentInfo,j=[],q=0;q<T.length;q++){var F=T[q],Z=F.dts-this._dtsBase,X=F.isKeyframe,Y=Z-w,re=F.cts,oe=Y+re;C===-1&&(C=Y,L=oe);var ve=0;if(q!==T.length-1){var be=T[q+1].dts-this._dtsBase-w;ve=be-Y}else if(I!=null){var be=I.dts-this._dtsBase-w;ve=be-Y}else j.length>=1?ve=j[j.length-1].duration:ve=Math.floor(this._videoMeta.refSampleDuration);if(X){var Oe=new E.SampleInfo(Y,oe,ve,F.dts,!0);Oe.fileposition=F.fileposition,J.appendSyncPoint(Oe)}j.push({dts:Y,pts:oe,cts:re,units:F.units,size:F.length,isKeyframe:X,duration:ve,originalDts:Z,flags:{isLeading:0,dependsOn:X?2:1,isDependedOn:X?1:0,hasRedundancy:0,isNonSync:X?0:1}})}k=new Uint8Array(M),k[0]=M>>>24&255,k[1]=M>>>16&255,k[2]=M>>>8&255,k[3]=M&255,k.set(f.default.types.mdat,4);for(var q=0;q<j.length;q++)for(var Pe=j[q].units;Pe.length;){var Se=Pe.shift(),Te=Se.data;k.set(Te,P),P+=Te.byteLength}var ge=j[j.length-1];if(A=ge.dts+ge.duration,D=ge.pts+ge.duration,this._videoNextDts=A,J.beginDts=C,J.endDts=A,J.beginPts=L,J.endPts=D,J.originalBeginDts=j[0].originalDts,J.originalEndDts=ge.originalDts+ge.duration,J.firstSample=new E.SampleInfo(j[0].dts,j[0].pts,j[0].duration,j[0].originalDts,j[0].isKeyframe),J.lastSample=new E.SampleInfo(ge.dts,ge.pts,ge.duration,ge.originalDts,ge.isKeyframe),this._isLive||this._videoSegmentInfoList.append(J),R.samples=j,R.sequenceNumber++,this._forceFirstIDR){var Ue=j[0].flags;Ue.dependsOn=2,Ue.isNonSync=0}var je=f.default.moof(R,C);R.samples=[],R.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(je,k).buffer,sampleCount:j.length,info:J})}}},m.prototype._mergeBoxes=function(y,b){var R=new Uint8Array(y.byteLength+b.byteLength);return R.set(y,0),R.set(b,y.byteLength),R},m}();l.default=_},"./src/utils/browser.js":function(c,l,d){d.r(l);var u={};function f(){var p=self.navigator.userAgent.toLowerCase(),v=/(edge)\/([\w.]+)/.exec(p)||/(opr)[\/]([\w.]+)/.exec(p)||/(chrome)[ \/]([\w.]+)/.exec(p)||/(iemobile)[\/]([\w.]+)/.exec(p)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(p)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(p)||/(webkit)[ \/]([\w.]+)/.exec(p)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(p)||/(msie) ([\w.]+)/.exec(p)||p.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(p)||p.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(p)||[],E=/(ipad)/.exec(p)||/(ipod)/.exec(p)||/(windows phone)/.exec(p)||/(iphone)/.exec(p)||/(kindle)/.exec(p)||/(android)/.exec(p)||/(windows)/.exec(p)||/(mac)/.exec(p)||/(linux)/.exec(p)||/(cros)/.exec(p)||[],g={browser:v[5]||v[3]||v[1]||"",version:v[2]||v[4]||"0",majorVersion:v[4]||v[2]||"0",platform:E[0]||""},_={};if(g.browser){_[g.browser]=!0;var m=g.majorVersion.split(".");_.version={major:parseInt(g.majorVersion,10),string:g.version},m.length>1&&(_.version.minor=parseInt(m[1],10)),m.length>2&&(_.version.build=parseInt(m[2],10))}if(g.platform&&(_[g.platform]=!0),(_.chrome||_.opr||_.safari)&&(_.webkit=!0),_.rv||_.iemobile){_.rv&&delete _.rv;var y="msie";g.browser=y,_[y]=!0}if(_.edge){delete _.edge;var b="msedge";g.browser=b,_[b]=!0}if(_.opr){var R="opera";g.browser=R,_[R]=!0}if(_.safari&&_.android){var T="android";g.browser=T,_[T]=!0}_.name=g.browser,_.platform=g.platform;for(var w in u)u.hasOwnProperty(w)&&delete u[w];Object.assign(u,_)}f(),l.default=u},"./src/utils/exception.js":function(c,l,d){d.r(l),d.d(l,{RuntimeException:function(){return f},IllegalStateException:function(){return p},InvalidArgumentException:function(){return v},NotImplementedException:function(){return E}});var u=function(){var g=function(_,m){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,b){y.__proto__=b}||function(y,b){for(var R in b)Object.prototype.hasOwnProperty.call(b,R)&&(y[R]=b[R])},g(_,m)};return function(_,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");g(_,m);function y(){this.constructor=_}_.prototype=m===null?Object.create(m):(y.prototype=m.prototype,new y)}}(),f=function(){function g(_){this._message=_}return Object.defineProperty(g.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),g.prototype.toString=function(){return this.name+": "+this.message},g}(),p=function(g){u(_,g);function _(m){return g.call(this,m)||this}return Object.defineProperty(_.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),_}(f),v=function(g){u(_,g);function _(m){return g.call(this,m)||this}return Object.defineProperty(_.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),_}(f),E=function(g){u(_,g);function _(m){return g.call(this,m)||this}return Object.defineProperty(_.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),_}(f)},"./src/utils/logger.js":function(c,l,d){d.r(l);var u=d("./node_modules/events/events.js"),f=d.n(u),p=function(){function v(){}return v.e=function(E,g){(!E||v.FORCE_GLOBAL_TAG)&&(E=v.GLOBAL_TAG);var _="["+E+"] > "+g;v.ENABLE_CALLBACK&&v.emitter.emit("log","error",_),v.ENABLE_ERROR&&(console.error?console.error(_):console.warn?console.warn(_):console.log(_))},v.i=function(E,g){(!E||v.FORCE_GLOBAL_TAG)&&(E=v.GLOBAL_TAG);var _="["+E+"] > "+g;v.ENABLE_CALLBACK&&v.emitter.emit("log","info",_),v.ENABLE_INFO&&(console.info?console.info(_):console.log(_))},v.w=function(E,g){(!E||v.FORCE_GLOBAL_TAG)&&(E=v.GLOBAL_TAG);var _="["+E+"] > "+g;v.ENABLE_CALLBACK&&v.emitter.emit("log","warn",_),v.ENABLE_WARN&&(console.warn?console.warn(_):console.log(_))},v.d=function(E,g){(!E||v.FORCE_GLOBAL_TAG)&&(E=v.GLOBAL_TAG);var _="["+E+"] > "+g;v.ENABLE_CALLBACK&&v.emitter.emit("log","debug",_),v.ENABLE_DEBUG&&(console.debug?console.debug(_):console.log(_))},v.v=function(E,g){(!E||v.FORCE_GLOBAL_TAG)&&(E=v.GLOBAL_TAG);var _="["+E+"] > "+g;v.ENABLE_CALLBACK&&v.emitter.emit("log","verbose",_),v.ENABLE_VERBOSE&&console.log(_)},v}();p.GLOBAL_TAG="flv.js",p.FORCE_GLOBAL_TAG=!1,p.ENABLE_ERROR=!0,p.ENABLE_INFO=!0,p.ENABLE_WARN=!0,p.ENABLE_DEBUG=!0,p.ENABLE_VERBOSE=!0,p.ENABLE_CALLBACK=!1,p.emitter=new(f()),l.default=p},"./src/utils/logging-control.js":function(c,l,d){d.r(l);var u=d("./node_modules/events/events.js"),f=d.n(u),p=d("./src/utils/logger.js"),v=function(){function E(){}return Object.defineProperty(E,"forceGlobalTag",{get:function(){return p.default.FORCE_GLOBAL_TAG},set:function(g){p.default.FORCE_GLOBAL_TAG=g,E._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(E,"globalTag",{get:function(){return p.default.GLOBAL_TAG},set:function(g){p.default.GLOBAL_TAG=g,E._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(E,"enableAll",{get:function(){return p.default.ENABLE_VERBOSE&&p.default.ENABLE_DEBUG&&p.default.ENABLE_INFO&&p.default.ENABLE_WARN&&p.default.ENABLE_ERROR},set:function(g){p.default.ENABLE_VERBOSE=g,p.default.ENABLE_DEBUG=g,p.default.ENABLE_INFO=g,p.default.ENABLE_WARN=g,p.default.ENABLE_ERROR=g,E._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(E,"enableDebug",{get:function(){return p.default.ENABLE_DEBUG},set:function(g){p.default.ENABLE_DEBUG=g,E._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(E,"enableVerbose",{get:function(){return p.default.ENABLE_VERBOSE},set:function(g){p.default.ENABLE_VERBOSE=g,E._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(E,"enableInfo",{get:function(){return p.default.ENABLE_INFO},set:function(g){p.default.ENABLE_INFO=g,E._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(E,"enableWarn",{get:function(){return p.default.ENABLE_WARN},set:function(g){p.default.ENABLE_WARN=g,E._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(E,"enableError",{get:function(){return p.default.ENABLE_ERROR},set:function(g){p.default.ENABLE_ERROR=g,E._notifyChange()},enumerable:!1,configurable:!0}),E.getConfig=function(){return{globalTag:p.default.GLOBAL_TAG,forceGlobalTag:p.default.FORCE_GLOBAL_TAG,enableVerbose:p.default.ENABLE_VERBOSE,enableDebug:p.default.ENABLE_DEBUG,enableInfo:p.default.ENABLE_INFO,enableWarn:p.default.ENABLE_WARN,enableError:p.default.ENABLE_ERROR,enableCallback:p.default.ENABLE_CALLBACK}},E.applyConfig=function(g){p.default.GLOBAL_TAG=g.globalTag,p.default.FORCE_GLOBAL_TAG=g.forceGlobalTag,p.default.ENABLE_VERBOSE=g.enableVerbose,p.default.ENABLE_DEBUG=g.enableDebug,p.default.ENABLE_INFO=g.enableInfo,p.default.ENABLE_WARN=g.enableWarn,p.default.ENABLE_ERROR=g.enableError,p.default.ENABLE_CALLBACK=g.enableCallback},E._notifyChange=function(){var g=E.emitter;if(g.listenerCount("change")>0){var _=E.getConfig();g.emit("change",_)}},E.registerListener=function(g){E.emitter.addListener("change",g)},E.removeListener=function(g){E.emitter.removeListener("change",g)},E.addLogListener=function(g){p.default.emitter.addListener("log",g),p.default.emitter.listenerCount("log")>0&&(p.default.ENABLE_CALLBACK=!0,E._notifyChange())},E.removeLogListener=function(g){p.default.emitter.removeListener("log",g),p.default.emitter.listenerCount("log")===0&&(p.default.ENABLE_CALLBACK=!1,E._notifyChange())},E}();v.emitter=new(f()),l.default=v},"./src/utils/polyfill.js":function(c,l,d){d.r(l);var u=function(){function f(){}return f.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(p,v){return p.__proto__=v,p},Object.assign=Object.assign||function(p){if(p==null)throw new TypeError("Cannot convert undefined or null to object");for(var v=Object(p),E=1;E<arguments.length;E++){var g=arguments[E];if(g!=null)for(var _ in g)g.hasOwnProperty(_)&&(v[_]=g[_])}return v},typeof self.Promise!="function"&&d("./node_modules/es6-promise/dist/es6-promise.js").polyfill()},f}();u.install(),l.default=u},"./src/utils/utf8-conv.js":function(c,l,d){d.r(l);function u(p,v,E){var g=p;if(v+E<g.length){for(;E--;)if((g[++v]&192)!==128)return!1;return!0}else return!1}function f(p){for(var v=[],E=p,g=0,_=p.length;g<_;){if(E[g]<128){v.push(String.fromCharCode(E[g])),++g;continue}else if(!(E[g]<192)){if(E[g]<224){if(u(E,g,1)){var m=(E[g]&31)<<6|E[g+1]&63;if(m>=128){v.push(String.fromCharCode(m&65535)),g+=2;continue}}}else if(E[g]<240){if(u(E,g,2)){var m=(E[g]&15)<<12|(E[g+1]&63)<<6|E[g+2]&63;if(m>=2048&&(m&63488)!==55296){v.push(String.fromCharCode(m&65535)),g+=3;continue}}}else if(E[g]<248&&u(E,g,3)){var m=(E[g]&7)<<18|(E[g+1]&63)<<12|(E[g+2]&63)<<6|E[g+3]&63;if(m>65536&&m<1114112){m-=65536,v.push(String.fromCharCode(m>>>10|55296)),v.push(String.fromCharCode(m&1023|56320)),g+=4;continue}}}v.push("�"),++g}return v.join("")}l.default=f}},r={};function n(c){var l=r[c];if(l!==void 0)return l.exports;var d=r[c]={exports:{}};return t[c].call(d.exports,d,d.exports,n),d.exports}n.m=t,function(){n.n=function(c){var l=c&&c.__esModule?function(){return c.default}:function(){return c};return n.d(l,{a:l}),l}}(),function(){n.d=function(c,l){for(var d in l)n.o(l,d)&&!n.o(c,d)&&Object.defineProperty(c,d,{enumerable:!0,get:l[d]})}}(),function(){n.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}()}(),function(){n.o=function(c,l){return Object.prototype.hasOwnProperty.call(c,l)}}(),function(){n.r=function(c){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})}}();var a=n("./src/index.js");return a}()})}($S)),$S.exports}yM();let bM=class{constructor(){this.events={}}on(i,e){this.events[i]||(this.events[i]=[]),this.events[i].push(e)}off(i,e){this.events[i]&&(this.events[i]=this.events[i].filter(t=>t!==e))}emit(i,...e){this.events[i]&&this.events[i].forEach(t=>t(...e))}};const He=Number.isFinite||function(i){return typeof i=="number"&&isFinite(i)},_M=Number.isSafeInteger||function(i){return typeof i=="number"&&Math.abs(i)<=SM},SM=Number.MAX_SAFE_INTEGER||9007199254740991;let Je=function(i){return i.NETWORK_ERROR="networkError",i.MEDIA_ERROR="mediaError",i.KEY_SYSTEM_ERROR="keySystemError",i.MUX_ERROR="muxError",i.OTHER_ERROR="otherError",i}({}),he=function(i){return i.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",i.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",i.KEY_SYSTEM_NO_SESSION="keySystemNoSession",i.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",i.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",i.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",i.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",i.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",i.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",i.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",i.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",i.MANIFEST_LOAD_ERROR="manifestLoadError",i.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",i.MANIFEST_PARSING_ERROR="manifestParsingError",i.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",i.LEVEL_EMPTY_ERROR="levelEmptyError",i.LEVEL_LOAD_ERROR="levelLoadError",i.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",i.LEVEL_PARSING_ERROR="levelParsingError",i.LEVEL_SWITCH_ERROR="levelSwitchError",i.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",i.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",i.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",i.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",i.FRAG_LOAD_ERROR="fragLoadError",i.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",i.FRAG_DECRYPT_ERROR="fragDecryptError",i.FRAG_PARSING_ERROR="fragParsingError",i.FRAG_GAP="fragGap",i.REMUX_ALLOC_ERROR="remuxAllocError",i.KEY_LOAD_ERROR="keyLoadError",i.KEY_LOAD_TIMEOUT="keyLoadTimeOut",i.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",i.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",i.BUFFER_APPEND_ERROR="bufferAppendError",i.BUFFER_APPENDING_ERROR="bufferAppendingError",i.BUFFER_STALLED_ERROR="bufferStalledError",i.BUFFER_FULL_ERROR="bufferFullError",i.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",i.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",i.ASSET_LIST_LOAD_ERROR="assetListLoadError",i.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",i.ASSET_LIST_PARSING_ERROR="assetListParsingError",i.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",i.INTERNAL_EXCEPTION="internalException",i.INTERNAL_ABORTED="aborted",i.ATTACH_MEDIA_ERROR="attachMediaError",i.UNKNOWN="unknown",i}({}),z=function(i){return i.MEDIA_ATTACHING="hlsMediaAttaching",i.MEDIA_ATTACHED="hlsMediaAttached",i.MEDIA_DETACHING="hlsMediaDetaching",i.MEDIA_DETACHED="hlsMediaDetached",i.MEDIA_ENDED="hlsMediaEnded",i.STALL_RESOLVED="hlsStallResolved",i.BUFFER_RESET="hlsBufferReset",i.BUFFER_CODECS="hlsBufferCodecs",i.BUFFER_CREATED="hlsBufferCreated",i.BUFFER_APPENDING="hlsBufferAppending",i.BUFFER_APPENDED="hlsBufferAppended",i.BUFFER_EOS="hlsBufferEos",i.BUFFERED_TO_END="hlsBufferedToEnd",i.BUFFER_FLUSHING="hlsBufferFlushing",i.BUFFER_FLUSHED="hlsBufferFlushed",i.MANIFEST_LOADING="hlsManifestLoading",i.MANIFEST_LOADED="hlsManifestLoaded",i.MANIFEST_PARSED="hlsManifestParsed",i.LEVEL_SWITCHING="hlsLevelSwitching",i.LEVEL_SWITCHED="hlsLevelSwitched",i.LEVEL_LOADING="hlsLevelLoading",i.LEVEL_LOADED="hlsLevelLoaded",i.LEVEL_UPDATED="hlsLevelUpdated",i.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",i.LEVELS_UPDATED="hlsLevelsUpdated",i.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",i.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",i.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",i.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",i.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",i.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",i.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",i.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",i.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",i.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",i.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",i.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",i.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",i.CUES_PARSED="hlsCuesParsed",i.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",i.INIT_PTS_FOUND="hlsInitPtsFound",i.FRAG_LOADING="hlsFragLoading",i.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",i.FRAG_LOADED="hlsFragLoaded",i.FRAG_DECRYPTED="hlsFragDecrypted",i.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",i.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",i.FRAG_PARSING_METADATA="hlsFragParsingMetadata",i.FRAG_PARSED="hlsFragParsed",i.FRAG_BUFFERED="hlsFragBuffered",i.FRAG_CHANGED="hlsFragChanged",i.FPS_DROP="hlsFpsDrop",i.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",i.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",i.ERROR="hlsError",i.DESTROYING="hlsDestroying",i.KEY_LOADING="hlsKeyLoading",i.KEY_LOADED="hlsKeyLoaded",i.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",i.BACK_BUFFER_REACHED="hlsBackBufferReached",i.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",i.ASSET_LIST_LOADING="hlsAssetListLoading",i.ASSET_LIST_LOADED="hlsAssetListLoaded",i.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",i.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",i.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",i.INTERSTITIAL_STARTED="hlsInterstitialStarted",i.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",i.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",i.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",i.INTERSTITIAL_ENDED="hlsInterstitialEnded",i.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",i.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",i.EVENT_CUE_ENTER="hlsEventCueEnter",i}({});var Un={AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},ot={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class ro{constructor(e,t=0,r=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=r}sample(e,t){const r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class EM{constructor(e,t,r,n=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new ro(e),this.fast_=new ro(t),this.defaultTTFB_=n,this.ttfb_=new ro(e)}update(e,t){const{slow_:r,fast_:n,ttfb_:a}=this;r.halfLife!==e&&(this.slow_=new ro(e,r.getEstimate(),r.getTotalWeight())),n.halfLife!==t&&(this.fast_=new ro(t,n.getEstimate(),n.getTotalWeight())),a.halfLife!==e&&(this.ttfb_=new ro(e,a.getEstimate(),a.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const r=8*t,n=e/1e3,a=r/n;this.fast_.sample(n,a),this.slow_.sample(n,a)}sampleTTFB(e){const t=e/1e3,r=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(r,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function RM(i,e,t){return(e=TM(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Yt(){return Yt=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},Yt.apply(null,arguments)}function zS(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),t.push.apply(t,r)}return t}function Vt(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?zS(Object(t),!0).forEach(function(r){RM(i,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):zS(Object(t)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(t,r))})}return i}function wM(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function TM(i){var e=wM(i,"string");return typeof e=="symbol"?e:e+""}let jn=class{constructor(i,e){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const t=`[${i}]:`;this.trace=aa,this.debug=e.debug.bind(null,t),this.log=e.log.bind(null,t),this.warn=e.warn.bind(null,t),this.info=e.info.bind(null,t),this.error=e.error.bind(null,t)}};const aa=function(){},CM={trace:aa,debug:aa,log:aa,warn:aa,info:aa,error:aa};function AM(){return Yt({},CM)}const xM=AM(),Gt=xM;function Cl(i=!0){return typeof self>"u"?void 0:(i||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function DM(i){return typeof self<"u"&&i===self.ManagedMediaSource}function pT(i,e){const t=Object.keys(i),r=Object.keys(e),n=t.length,a=r.length;return!n||!a||n===a&&!t.some(c=>r.indexOf(c)===-1)}function _i(i,e=!1){if(typeof TextDecoder<"u"){const d=new TextDecoder("utf-8").decode(i);if(e){const u=d.indexOf("\0");return u!==-1?d.substring(0,u):d}return d.replace(/\0/g,"")}const t=i.length;let r,n,a,c="",l=0;for(;l<t;){if(r=i[l++],r===0&&e)return c;if(!(r===0||r===3))switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:c+=String.fromCharCode(r);break;case 12:case 13:n=i[l++],c+=String.fromCharCode((r&31)<<6|n&63);break;case 14:n=i[l++],a=i[l++],c+=String.fromCharCode((r&15)<<12|(n&63)<<6|(a&63)<<0);break}}return c}const pn={hexDump:function(i){let e="";for(let t=0;t<i.length;t++){let r=i[t].toString(16);r.length<2&&(r="0"+r),e+=r}return e}};function LM(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var GS={exports:{}},HS;function OM(){return HS||(HS=1,function(i,e){(function(t){var r=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,n=/^(?=([^\/?#]*))\1([^]*)$/,a=/(?:\/|^)\.(?=\/)/g,c=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,l={buildAbsoluteURL:function(d,u,f){if(f=f||{},d=d.trim(),u=u.trim(),!u){if(!f.alwaysNormalize)return d;var p=l.parseURL(d);if(!p)throw new Error("Error trying to parse base URL.");return p.path=l.normalizePath(p.path),l.buildURLFromParts(p)}var v=l.parseURL(u);if(!v)throw new Error("Error trying to parse relative URL.");if(v.scheme)return f.alwaysNormalize?(v.path=l.normalizePath(v.path),l.buildURLFromParts(v)):u;var E=l.parseURL(d);if(!E)throw new Error("Error trying to parse base URL.");if(!E.netLoc&&E.path&&E.path[0]!=="/"){var g=n.exec(E.path);E.netLoc=g[1],E.path=g[2]}E.netLoc&&!E.path&&(E.path="/");var _={scheme:E.scheme,netLoc:v.netLoc,path:null,params:v.params,query:v.query,fragment:v.fragment};if(!v.netLoc&&(_.netLoc=E.netLoc,v.path[0]!=="/"))if(!v.path)_.path=E.path,v.params||(_.params=E.params,v.query||(_.query=E.query));else{var m=E.path,y=m.substring(0,m.lastIndexOf("/")+1)+v.path;_.path=l.normalizePath(y)}return _.path===null&&(_.path=f.alwaysNormalize?l.normalizePath(v.path):v.path),l.buildURLFromParts(_)},parseURL:function(d){var u=r.exec(d);return u?{scheme:u[1]||"",netLoc:u[2]||"",path:u[3]||"",params:u[4]||"",query:u[5]||"",fragment:u[6]||""}:null},normalizePath:function(d){for(d=d.split("").reverse().join("").replace(a,"");d.length!==(d=d.replace(c,"")).length;);return d.split("").reverse().join("")},buildURLFromParts:function(d){return d.scheme+d.netLoc+d.path+d.params+d.query+d.fragment}};i.exports=l})()}(GS)),GS.exports}OM();class IM{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var ei={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};function vi(i){return i.sn!=="initSegment"}const ef=Math.pow(2,32)-1,PM=[].push,mT={video:1,audio:2,id3:3,text:4};function vr(i){return String.fromCharCode.apply(null,i)}function gT(i,e){const t=i[e]<<8|i[e+1];return t<0?65536+t:t}function qe(i,e){const t=vT(i,e);return t<0?4294967296+t:t}function VS(i,e){let t=qe(i,e);return t*=Math.pow(2,32),t+=qe(i,e+4),t}function vT(i,e){return i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}function bm(i,e,t){i[e]=t>>24,i[e+1]=t>>16&255,i[e+2]=t>>8&255,i[e+3]=t&255}function kM(i){const e=i.byteLength;for(let t=0;t<e;){const r=qe(i,t);if(r>8&&i[t+4]===109&&i[t+5]===111&&i[t+6]===111&&i[t+7]===102)return!0;t=r>1?t+r:e}return!1}function nt(i,e){const t=[];if(!e.length)return t;const r=i.byteLength;for(let n=0;n<r;){const a=qe(i,n),c=vr(i.subarray(n+4,n+8)),l=a>1?n+a:r;if(c===e[0])if(e.length===1)t.push(i.subarray(n+8,l));else{const d=nt(i.subarray(n+8,l),e.slice(1));d.length&&PM.apply(t,d)}n=l}return t}function MM(i){const e=[],t=i[0];let r=8;const n=qe(i,r);r+=4;let a=0,c=0;t===0?(a=qe(i,r),c=qe(i,r+4),r+=8):(a=VS(i,r),c=VS(i,r+8),r+=16),r+=2;let l=i.length+c;const d=gT(i,r);r+=2;for(let u=0;u<d;u++){let f=r;const p=qe(i,f);f+=4;const v=p&2147483647;if((p&2147483648)>>>31===1)return Gt.warn("SIDX has hierarchical references (not supported)"),null;const E=qe(i,f);f+=4,e.push({referenceSize:v,subsegmentDuration:E,info:{duration:E/n,start:l,end:l+v-1}}),l+=v,f+=4,r=f}return{earliestPresentationTime:a,timescale:n,version:t,referencesCount:d,references:e}}function yT(i){const e=[],t=nt(i,["moov","trak"]);for(let r=0;r<t.length;r++){const n=t[r],a=nt(n,["tkhd"])[0];if(a){let c=a[0];const l=qe(a,c===0?12:20),d=nt(n,["mdia","mdhd"])[0];if(d){c=d[0];const u=qe(d,c===0?12:20),f=nt(n,["mdia","hdlr"])[0];if(f){const p=vr(f.subarray(8,12)),v={soun:ei.AUDIO,vide:ei.VIDEO}[p],E=nt(n,["mdia","minf","stbl","stsd"])[0],g=NM(E);v?(e[l]={timescale:u,type:v,stsd:g},e[v]=Vt({timescale:u,id:l},g)):e[l]={timescale:u,type:p,stsd:g}}}}}return nt(i,["moov","mvex","trex"]).forEach(r=>{const n=qe(r,4),a=e[n];a&&(a.default={duration:qe(r,12),flags:qe(r,20)})}),e}function NM(i){const e=i.subarray(8),t=e.subarray(86),r=vr(e.subarray(4,8));let n=r,a;const c=r==="enca"||r==="encv";if(c){const d=nt(e,[r])[0].subarray(r==="enca"?28:78);nt(d,["sinf"]).forEach(u=>{const f=nt(u,["schm"])[0];if(f){const p=vr(f.subarray(4,8));if(p==="cbcs"||p==="cenc"){const v=nt(u,["frma"])[0];v&&(n=vr(v))}}})}const l=n;switch(n){case"avc1":case"avc2":case"avc3":case"avc4":{const d=nt(t,["avcC"])[0];d&&d.length>3&&(n+="."+ed(d[1])+ed(d[2])+ed(d[3]),a=Ju(l==="avc1"?"dva1":"dvav",t));break}case"mp4a":{const d=nt(e,[r])[0],u=nt(d.subarray(28),["esds"])[0];if(u&&u.length>7){let f=4;if(u[f++]!==3)break;f=_m(u,f),f+=2;const p=u[f++];if(p&128&&(f+=2),p&64&&(f+=u[f++]),u[f++]!==4)break;f=_m(u,f);const v=u[f++];if(v===64)n+="."+ed(v);else break;if(f+=12,u[f++]!==5)break;f=_m(u,f);const E=u[f++];let g=(E&248)>>3;g===31&&(g+=1+((E&7)<<3)+((u[f]&224)>>5)),n+="."+g}break}case"hvc1":case"hev1":{const d=nt(t,["hvcC"])[0];if(d&&d.length>12){const u=d[1],f=["","A","B","C"][u>>6],p=u&31,v=qe(d,2),E=(u&32)>>5?"H":"L",g=d[12],_=d.subarray(6,12);n+="."+f+p,n+="."+BM(v).toString(16).toUpperCase(),n+="."+E+g;let m="";for(let y=_.length;y--;){const b=_[y];(b||m)&&(m="."+b.toString(16).toUpperCase()+m)}n+=m}a=Ju(l=="hev1"?"dvhe":"dvh1",t);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{n=Ju(n,t)||n;break}case"vp09":{const d=nt(t,["vpcC"])[0];if(d&&d.length>6){const u=d[4],f=d[5],p=d[6]>>4&15;n+="."+fn(u)+"."+fn(f)+"."+fn(p)}break}case"av01":{const d=nt(t,["av1C"])[0];if(d&&d.length>2){const u=d[1]>>>5,f=d[1]&31,p=d[2]>>>7?"H":"M",v=(d[2]&64)>>6,E=(d[2]&32)>>5,g=u===2&&v?E?12:10:v?10:8,_=(d[2]&16)>>4,m=(d[2]&8)>>3,y=(d[2]&4)>>2,b=d[2]&3;n+="."+u+"."+fn(f)+p+"."+fn(g)+"."+_+"."+m+y+b+"."+fn(1)+"."+fn(1)+"."+fn(1)+".0",a=Ju("dav1",t)}break}}return{codec:n,encrypted:c,supplemental:a}}function Ju(i,e){const t=nt(e,["dvvC"]),r=t.length?t[0]:nt(e,["dvcC"])[0];if(r){const n=r[2]>>1&127,a=r[2]<<5&32|r[3]>>3&31;return i+"."+fn(n)+"."+fn(a)}}function BM(i){let e=0;for(let t=0;t<32;t++)e|=(i>>t&1)<<31-t;return e>>>0}function _m(i,e){const t=e+5;for(;i[e++]&128&&e<t;);return e}function ed(i){return("0"+i.toString(16).toUpperCase()).slice(-2)}function fn(i){return(i<10?"0":"")+i}function FM(i,e){if(!i||!e)return i;const t=e.keyId;return t&&e.isCommonEncryption&&nt(i,["moov","trak"]).forEach(r=>{const n=nt(r,["mdia","minf","stbl","stsd"])[0].subarray(8);let a=nt(n,["enca"]);const c=a.length>0;c||(a=nt(n,["encv"])),a.forEach(l=>{const d=c?l.subarray(28):l.subarray(78);nt(d,["sinf"]).forEach(u=>{const f=bT(u);if(f){const p=f.subarray(8,24);p.some(v=>v!==0)||(Gt.log(`[eme] Patching keyId in 'enc${c?"a":"v"}>sinf>>tenc' box: ${pn.hexDump(p)} -> ${pn.hexDump(t)}`),f.set(t,8))}})})}),i}function bT(i){const e=nt(i,["schm"])[0];if(e){const t=vr(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return nt(i,["schi","tenc"])[0]}return null}function UM(i,e,t){const r={},n=nt(i,["moof","traf"]);for(let a=0;a<n.length;a++){const c=n[a],l=nt(c,["tfhd"])[0],d=qe(l,4),u=e[d];if(!u)continue;const f=r[d]||(r[d]={start:NaN,duration:0,sampleCount:0,timescale:u.timescale,type:u.type}),p=nt(c,["tfdt"])[0];if(p){const R=p[0];let T=qe(p,4);R===1&&(T===ef?t.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(T*=ef+1,T+=qe(p,8))),He(T)&&(!He(f.start)||T<f.start)&&(f.start=T)}const v=u.default,E=qe(l,0)|(v==null?void 0:v.flags);let g=(v==null?void 0:v.duration)||0;E&8&&(E&2?g=qe(l,12):g=qe(l,8));const _=nt(c,["trun"]);let m=f.start||0,y=0,b=g;for(let R=0;R<_.length;R++){const T=_[R],w=qe(T,4),C=f.sampleCount;f.sampleCount+=w;const A=T[3]&1,L=T[3]&4,D=T[2]&1,P=T[2]&2,k=T[2]&4,M=T[2]&8;let I=8,F=w;for(A&&(I+=4),L&&w&&(!(T[I+1]&1)&&f.keyFrameIndex===void 0&&(f.keyFrameIndex=C),I+=4,D?(b=qe(T,I),I+=4):b=g,P&&(I+=4),M&&(I+=4),m+=b,y+=b,F--);F--;)D?(b=qe(T,I),I+=4):b=g,P&&(I+=4),k&&(T[I+1]&1||f.keyFrameIndex===void 0&&(f.keyFrameIndex=f.sampleCount-(F+1),f.keyFrameStart=m),I+=4),M&&(I+=4),m+=b,y+=b;!y&&g&&(y+=g*w)}f.duration+=y}if(!Object.keys(r).some(a=>r[a].duration)){let a=1/0,c=0;const l=nt(i,["sidx"]);for(let d=0;d<l.length;d++){const u=MM(l[d]);if(u!=null&&u.references){a=Math.min(a,u.earliestPresentationTime/u.timescale);const f=u.references.reduce((p,v)=>p+v.info.duration||0,0);c=Math.max(c,f+u.earliestPresentationTime/u.timescale)}}c&&He(c)&&Object.keys(r).forEach(d=>{r[d].duration||(r[d].duration=c*r[d].timescale-r[d].start)})}return r}function $M(i,e,t){nt(e,["moof","traf"]).forEach(r=>{nt(r,["tfhd"]).forEach(n=>{const a=qe(n,4),c=i[a];if(!c)return;const l=c.timescale||9e4;nt(r,["tfdt"]).forEach(d=>{const u=d[0],f=t*l;if(f){let p=qe(d,4);if(u===0)p-=f,p=Math.max(p,0),bm(d,4,p);else{p*=Math.pow(2,32),p+=qe(d,8),p-=f,p=Math.max(p,0);const v=Math.floor(p/(ef+1)),E=Math.floor(p%(ef+1));bm(d,4,v),bm(d,8,E)}}})})})}function jM(i){const e={valid:null,remainder:null},t=nt(i,["moof"]);if(t.length<2)return e.remainder=i,e;const r=t[t.length-1];return e.valid=i.slice(0,r.byteOffset-8),e.remainder=i.slice(r.byteOffset-8),e}function Fi(i,e){const t=new Uint8Array(i.length+e.length);return t.set(i),t.set(e,i.length),t}function KS(i,e){const t=[],r=e.samples,n=e.timescale,a=e.id;let c=!1;return nt(r,["moof"]).map(l=>{const d=l.byteOffset-8;nt(l,["traf"]).map(u=>{const f=nt(u,["tfdt"]).map(p=>{const v=p[0];let E=qe(p,4);return v===1&&(E*=Math.pow(2,32),E+=qe(p,8)),E/n})[0];return f!==void 0&&(i=f),nt(u,["tfhd"]).map(p=>{const v=qe(p,4),E=qe(p,0)&16777215,g=(E&1)!==0,_=(E&2)!==0,m=(E&8)!==0;let y=0;const b=(E&16)!==0;let R=0;const T=(E&32)!==0;let w=8;v===a&&(g&&(w+=8),_&&(w+=4),m&&(y=qe(p,w),w+=4),b&&(R=qe(p,w),w+=4),T&&(w+=4),e.type==="video"&&(c=Lf(e.codec)),nt(u,["trun"]).map(C=>{const A=C[0],L=qe(C,0)&16777215,D=(L&1)!==0;let P=0;const k=(L&4)!==0,M=(L&256)!==0;let I=0;const F=(L&512)!==0;let $=0;const N=(L&1024)!==0,U=(L&2048)!==0;let V=0;const J=qe(C,4);let j=8;D&&(P=qe(C,j),j+=4),k&&(j+=4);let q=P+d;for(let Z=0;Z<J;Z++){if(M?(I=qe(C,j),j+=4):I=y,F?($=qe(C,j),j+=4):$=R,N&&(j+=4),U&&(A===0?V=qe(C,j):V=vT(C,j),j+=4),e.type===ei.VIDEO){let X=0;for(;X<$;){const Y=qe(r,q);if(q+=4,zM(c,r[q])){const re=r.subarray(q,q+Y);wv(re,c?2:1,i+V/n,t)}q+=Y,X+=Y+4}}i+=I/n}}))})})}),t}function Lf(i){if(!i)return!1;const e=i.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function zM(i,e){if(i){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function wv(i,e,t,r){const n=_T(i);let a=0;a+=e;let c=0,l=0,d=0;for(;a<n.length;){c=0;do{if(a>=n.length)break;d=n[a++],c+=d}while(d===255);l=0;do{if(a>=n.length)break;d=n[a++],l+=d}while(d===255);const u=n.length-a;let f=a;if(l<u)a+=l;else if(l>u){Gt.error(`Malformed SEI payload. ${l} is too small, only ${u} bytes left to parse.`);break}if(c===4){if(n[f++]===181){const p=gT(n,f);if(f+=2,p===49){const v=qe(n,f);if(f+=4,v===1195456820){const E=n[f++];if(E===3){const g=n[f++],_=31&g,m=64&g,y=m?2+_*3:0,b=new Uint8Array(y);if(m){b[0]=g;for(let R=1;R<y;R++)b[R]=n[f++]}r.push({type:E,payloadType:c,pts:t,bytes:b})}}}}}else if(c===5&&l>16){const p=[];for(let g=0;g<16;g++){const _=n[f++].toString(16);p.push(_.length==1?"0"+_:_),(g===3||g===5||g===7||g===9)&&p.push("-")}const v=l-16,E=new Uint8Array(v);for(let g=0;g<v;g++)E[g]=n[f++];r.push({payloadType:c,pts:t,uuid:p.join(""),userData:_i(E),userDataBytes:E})}}}function _T(i){const e=i.byteLength,t=[];let r=1;for(;r<e-2;)i[r]===0&&i[r+1]===0&&i[r+2]===3?(t.push(r+2),r+=2):r++;if(t.length===0)return i;const n=e-t.length,a=new Uint8Array(n);let c=0;for(r=0;r<n;c++,r++)c===t[0]&&(c++,t.shift()),a[r]=i[c];return a}function GM(i){const e=i[0];let t="",r="",n=0,a=0,c=0,l=0,d=0,u=0;if(e===0){for(;vr(i.subarray(u,u+1))!=="\0";)t+=vr(i.subarray(u,u+1)),u+=1;for(t+=vr(i.subarray(u,u+1)),u+=1;vr(i.subarray(u,u+1))!=="\0";)r+=vr(i.subarray(u,u+1)),u+=1;r+=vr(i.subarray(u,u+1)),u+=1,n=qe(i,12),a=qe(i,16),l=qe(i,20),d=qe(i,24),u=28}else if(e===1){u+=4,n=qe(i,u),u+=4;const p=qe(i,u);u+=4;const v=qe(i,u);for(u+=4,c=2**32*p+v,_M(c)||(c=Number.MAX_SAFE_INTEGER,Gt.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),l=qe(i,u),u+=4,d=qe(i,u),u+=4;vr(i.subarray(u,u+1))!=="\0";)t+=vr(i.subarray(u,u+1)),u+=1;for(t+=vr(i.subarray(u,u+1)),u+=1;vr(i.subarray(u,u+1))!=="\0";)r+=vr(i.subarray(u,u+1)),u+=1;r+=vr(i.subarray(u,u+1)),u+=1}const f=i.subarray(u,i.byteLength);return{schemeIdUri:t,value:r,timeScale:n,presentationTime:c,presentationTimeDelta:a,eventDuration:l,id:d,payload:f}}function HM(i,...e){const t=e.length;let r=8,n=t;for(;n--;)r+=e[n].byteLength;const a=new Uint8Array(r);for(a[0]=r>>24&255,a[1]=r>>16&255,a[2]=r>>8&255,a[3]=r&255,a.set(i,4),n=0,r=8;n<t;n++)a.set(e[n],r),r+=e[n].byteLength;return a}function VM(i,e,t){if(i.byteLength!==16)throw new RangeError("Invalid system id");let r,n;r=0,n=new Uint8Array;let a;r>0?(a=new Uint8Array(4),e.length>0&&new DataView(a.buffer).setUint32(0,e.length,!1)):a=new Uint8Array;const c=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(c.buffer).setUint32(0,t.byteLength,!1),HM([112,115,115,104],new Uint8Array([r,0,0,0]),i,a,n,c,t||new Uint8Array)}function KM(i){const e=[];if(i instanceof ArrayBuffer){const t=i.byteLength;let r=0;for(;r+32<t;){const n=new DataView(i,r),a=qM(n);e.push(a),r+=a.size}}return e}function qM(i){const e=i.getUint32(0),t=i.byteOffset,r=i.byteLength;if(r<e)return{offset:t,size:r};if(i.getUint32(4)!==1886614376)return{offset:t,size:e};const n=i.getUint32(8)>>>24;if(n!==0&&n!==1)return{offset:t,size:e};const a=i.buffer,c=pn.hexDump(new Uint8Array(a,t+12,16)),l=i.getUint32(28);let d=null,u=null;if(n===0){if(e-32<l||l<22)return{offset:t,size:e};u=new Uint8Array(a,t+32,l)}else if(n===1){if(!l||r<t+32+l*16+16)return{offset:t,size:e};d=[];for(let f=0;f<l;f++)d.push(new Uint8Array(a,t+32+f*16,16))}return{version:n,systemId:c,kids:d,data:u,offset:t,size:e}}const ST=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),$g={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function YM(i,e){const t=$g[e];return!!t&&!!t[i.slice(0,4)]}function WM(i,e,t=!0){return!i.split(",").some(r=>!ET(r,e,t))}function ET(i,e,t=!0){var r;const n=Cl(t);return(r=n==null?void 0:n.isTypeSupported(jg(i,e)))!=null?r:!1}function jg(i,e){return`${e}/mp4;codecs=${i}`}function qS(i){const e=ST();return i.split(",").reduce((t,r)=>{const n=e&&Lf(r)?9:$g.video[r];return n?(n*2+t)/(t?3:2):($g.audio[r]+t)/(t?2:1)},0)}const Sm={};function XM(i,e=!0){if(Sm[i])return Sm[i];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[i];for(let n=0;n<t.length;n++){var r;if(ET(t[n],"audio",e))return Sm[i]=t[n],t[n];if(t[n]==="mp3"&&(r=Cl(e))!=null&&r.isTypeSupported("audio/mpeg"))return""}return i}const QM=/flac|opus|mp4a\.40\.34/i;function zg(i,e=!0){return i.replace(QM,t=>XM(t.toLowerCase(),e))}function ZM(i,e){const t=[];if(i){const r=i.split(",");for(let n=0;n<r.length;n++)YM(r[n],"video")||t.push(r[n])}return e&&t.push(e),t.join(",")}function Em(i,e){if(i&&(i.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(i)!==-1))return i;if(e){const t=e.split(",");if(t.length>1){if(i){for(let r=t.length;r--;)if(t[r].substring(0,4)===i.substring(0,4))return t[r]}return t[0]}}return e||i}function JM(i){if(i.startsWith("av01.")){const e=i.split("."),t=["0","111","01","01","01","0"];for(let r=e.length;r>4&&r<10;r++)e[r]=t[r-4];return e.join(".")}return i}function YS(i){const e=Cl(i)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function RT(i){return i.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const wT={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function e3(i,e){return{supported:!1,configurations:e,decodingInfoResults:[{supported:!1,smooth:!1,powerEfficient:!1}],error:i}}const WS={};function t3(i,e,t,r,n,a){const c=i.audioCodec?i.audioGroups:null,l=a==null?void 0:a.audioCodec,d=a==null?void 0:a.channels,u=d?parseInt(d):l?1/0:2;let f=null;if(c!=null&&c.length)try{c.length===1&&c[0]?f=e.groups[c[0]].channels:f=c.reduce((p,v)=>{if(v){const E=e.groups[v];if(!E)throw new Error(`Audio track group ${v} not found`);Object.keys(E.channels).forEach(g=>{p[g]=(p[g]||0)+E.channels[g]})}return p},{2:0})}catch{return!0}return i.videoCodec!==void 0&&(i.width>1920&&i.height>1088||i.height>1920&&i.width>1088||i.frameRate>Math.max(r,30)||i.videoRange!=="SDR"&&i.videoRange!==t||i.bitrate>Math.max(n,8e6))||!!f&&He(u)&&Object.keys(f).some(p=>parseInt(p)>u)}function r3(i,e,t){const r=i.videoCodec,n=i.audioCodec;if(!r&&!n||!t)return Promise.resolve(wT);const a=[];if(r){const c={width:i.width,height:i.height,bitrate:Math.ceil(Math.max(i.bitrate*.9,i.averageBitrate)),framerate:i.frameRate||30},l=i.videoRange;l!=="SDR"&&(c.transferFunction=l.toLowerCase());const d=r.split(","),u=navigator.userAgent;if(d.some(f=>Lf(f))&&ST())return Promise.resolve(e3(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent sting: (${u})`),a));a.push.apply(a,d.map(f=>({type:"media-source",video:Vt(Vt({},c),{},{contentType:jg(JM(f),"video")})})))}return n&&i.audioGroups&&i.audioGroups.forEach(c=>{var l;c&&((l=e.groups[c])==null||l.tracks.forEach(d=>{if(d.groupId===c){const u=d.channels||"",f=parseFloat(u);He(f)&&f>2&&a.push.apply(a,n.split(",").map(p=>({type:"media-source",audio:{contentType:jg(p,"audio"),channels:""+f}})))}}))}),Promise.all(a.map(c=>{const l=i3(c);return WS[l]||(WS[l]=t.decodingInfo(c))})).then(c=>({supported:!c.some(l=>!l.supported),configurations:a,decodingInfoResults:c})).catch(c=>({supported:!1,configurations:a,decodingInfoResults:[],error:c}))}function i3(i){const{audio:e,video:t}=i,r=t||e;if(r){const n=RT(r.contentType);if(t)return`r${t.height}x${t.width}f${Math.ceil(t.framerate)}${t.transferFunction||"sd"}_${n}_${Math.ceil(t.bitrate/1e5)}`;if(e)return`c${e.channels}${e.spatialRendering?"s":"n"}_${n}`}return""}const XS=["NONE","TYPE-0","TYPE-1",null],n3=["SDR","PQ","HLG"];var Nd={No:"",Yes:"YES",v2:"v2"};function QS(i){const{canSkipUntil:e,canSkipDateRanges:t,age:r}=i,n=r<e/2;return e&&n?t?Nd.v2:Nd.Yes:Nd.No}class ZS{constructor(e,t,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=r}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class tf{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(r=>!!r).map(r=>r.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const r=(t=e.supplemental)==null?void 0:t.videoCodec;r&&r!==e.videoCodec&&(this.codecSet+=`,${r.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return JS(this._audioGroups,e)}hasSubtitleGroup(e){return JS(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let r=this._audioGroups;r||(r=this._audioGroups=[]),r.indexOf(t)===-1&&r.push(t)}else if(e==="text"){let r=this._subtitleGroups;r||(r=this._subtitleGroups=[]),r.indexOf(t)===-1&&r.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function JS(i,e){return!e||!i?!1:i.indexOf(e)!==-1}function s3(){if(typeof matchMedia=="function"){const i=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(i.media!==e.media)return i.matches===!0}return!1}function a3(i,e){let t=!1,r=[];if(i&&(t=i!=="SDR",r=[i]),e){r=e.allowedVideoRanges||n3.slice(0);const n=r.join("")!=="SDR"&&!e.videoCodec;t=e.preferHDR!==void 0?e.preferHDR:n&&s3(),t||(r=["SDR"])}return{preferHDR:t,allowedVideoRanges:r}}const o3=i=>{const e=new WeakSet;return(t,r)=>{if(i&&(r=i(t,r)),typeof r=="object"&&r!==null){if(e.has(r))return;e.add(r)}return r}},hr=(i,e)=>JSON.stringify(i,o3(e));function c3(i,e,t,r,n){const a=Object.keys(i),c=r==null?void 0:r.channels,l=r==null?void 0:r.audioCodec,d=n==null?void 0:n.videoCodec,u=c&&parseInt(c)===2;let f=!1,p=!1,v=1/0,E=1/0,g=1/0,_=1/0,m=0,y=[];const{preferHDR:b,allowedVideoRanges:R}=a3(e,n);for(let A=a.length;A--;){const L=i[a[A]];f||(f=L.channels[2]>0),v=Math.min(v,L.minHeight),E=Math.min(E,L.minFramerate),g=Math.min(g,L.minBitrate),R.filter(D=>L.videoRanges[D]>0).length>0&&(p=!0)}v=He(v)?v:0,E=He(E)?E:0;const T=Math.max(1080,v),w=Math.max(30,E);g=He(g)?g:t,t=Math.max(g,t),p||(e=void 0);const C=a.length>1;return{codecSet:a.reduce((A,L)=>{const D=i[L];if(L===A)return A;if(y=p?R.filter(P=>D.videoRanges[P]>0):[],C){if(D.minBitrate>t)return un(L,`min bitrate of ${D.minBitrate} > current estimate of ${t}`),A;if(!D.hasDefaultAudio)return un(L,"no renditions with default or auto-select sound found"),A;if(l&&L.indexOf(l.substring(0,4))%5!==0)return un(L,`audio codec preference "${l}" not found`),A;if(c&&!u){if(!D.channels[c])return un(L,`no renditions with ${c} channel sound found (channels options: ${Object.keys(D.channels)})`),A}else if((!l||u)&&f&&D.channels[2]===0)return un(L,"no renditions with stereo sound found"),A;if(D.minHeight>T)return un(L,`min resolution of ${D.minHeight} > maximum of ${T}`),A;if(D.minFramerate>w)return un(L,`min framerate of ${D.minFramerate} > maximum of ${w}`),A;if(!y.some(P=>D.videoRanges[P]>0))return un(L,`no variants with VIDEO-RANGE of ${hr(y)} found`),A;if(d&&L.indexOf(d.substring(0,4))%5!==0)return un(L,`video codec preference "${d}" not found`),A;if(D.maxScore<m)return un(L,`max score of ${D.maxScore} < selected max of ${m}`),A}return A&&(qS(L)>=qS(A)||D.fragmentError>i[A].fragmentError)?A:(_=D.minIndex,m=D.maxScore,L)},void 0),videoRanges:y,preferHDR:b,minFramerate:E,minBitrate:g,minIndex:_}}function un(i,e){Gt.log(`[abr] start candidates with "${i}" ignored because ${e}`)}function l3(i){return i.reduce((e,t)=>{let r=e.groups[t.groupId];r||(r=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),r.tracks.push(t);const n=t.channels||"2";return r.channels[n]=(r.channels[n]||0)+1,r.hasDefault=r.hasDefault||t.default,r.hasAutoSelect=r.hasAutoSelect||t.autoselect,r.hasDefault&&(e.hasDefaultAudio=!0),r.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function u3(i,e,t,r){return i.slice(t,r+1).reduce((n,a,c)=>{if(!a.codecSet)return n;const l=a.audioGroups;let d=n[a.codecSet];d||(n[a.codecSet]=d={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:c,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!l,fragmentError:0}),d.minBitrate=Math.min(d.minBitrate,a.bitrate);const u=Math.min(a.height,a.width);return d.minHeight=Math.min(d.minHeight,u),d.minFramerate=Math.min(d.minFramerate,a.frameRate),d.minIndex=Math.min(d.minIndex,c),d.maxScore=Math.max(d.maxScore,a.score),d.fragmentError+=a.fragmentError,d.videoRanges[a.videoRange]=(d.videoRanges[a.videoRange]||0)+1,l&&l.forEach(f=>{if(!f)return;const p=e.groups[f];p&&(d.hasDefaultAudio=d.hasDefaultAudio||e.hasDefaultAudio?p.hasDefault:p.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(p.channels).forEach(v=>{d.channels[v]=(d.channels[v]||0)+p.channels[v]}))}),n},{})}function eE(i){if(!i)return i;const{lang:e,assocLang:t,characteristics:r,channels:n,audioCodec:a}=i;return{lang:e,assocLang:t,characteristics:r,channels:n,audioCodec:a}}function vn(i,e,t){if("attrs"in i){const r=e.indexOf(i);if(r!==-1)return r}for(let r=0;r<e.length;r++){const n=e[r];if(ha(i,n,t))return r}return-1}function ha(i,e,t){const{groupId:r,name:n,lang:a,assocLang:c,default:l}=i,d=i.forced;return(r===void 0||e.groupId===r)&&(n===void 0||e.name===n)&&(a===void 0||d3(a,e.lang))&&(a===void 0||e.assocLang===c)&&(l===void 0||e.default===l)&&(d===void 0||e.forced===d)&&(!("characteristics"in i)||f3(i.characteristics||"",e.characteristics))&&(t===void 0||t(i,e))}function d3(i,e="--"){return i.length===e.length?i===e:i.startsWith(e)||e.startsWith(i)}function f3(i,e=""){const t=i.split(","),r=e.split(",");return t.length===r.length&&!t.some(n=>r.indexOf(n)===-1)}function oa(i,e){const{audioCodec:t,channels:r}=i;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(r===void 0||r===(e.channels||"2"))}function h3(i,e,t,r,n){const a=e[r],c=e.reduce((p,v,E)=>{const g=v.uri;return(p[g]||(p[g]=[])).push(E),p},{})[a.uri];c.length>1&&(r=Math.max.apply(Math,c));const l=a.videoRange,d=a.frameRate,u=a.codecSet.substring(0,4),f=tE(e,r,p=>{if(p.videoRange!==l||p.frameRate!==d||p.codecSet.substring(0,4)!==u)return!1;const v=p.audioGroups,E=t.filter(g=>!v||v.indexOf(g.groupId)!==-1);return vn(i,E,n)>-1});return f>-1?f:tE(e,r,p=>{const v=p.audioGroups,E=t.filter(g=>!v||v.indexOf(g.groupId)!==-1);return vn(i,E,n)>-1})}function tE(i,e,t){for(let r=e;r>-1;r--)if(t(i[r]))return r;for(let r=e+1;r<i.length;r++)if(t(i[r]))return r;return-1}function TT(i,e){var t;return!!i&&i!==((t=e.loadLevelObj)==null?void 0:t.uri)}class p3 extends jn{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var r;const{fragCurrent:n,partCurrent:a,hls:c}=this,{autoLevelEnabled:l,media:d}=c;if(!n||!d)return;const u=performance.now(),f=a?a.stats:n.stats,p=a?a.duration:n.duration,v=u-f.loading.start,E=c.minAutoLevel,g=n.level,_=this._nextAutoLevel;if(f.aborted||f.loaded&&f.loaded===f.total||g<=E){this.clearTimer(),this._nextAutoLevel=-1;return}if(!l)return;const m=_>-1&&_!==g,y=!!t||m;if(!y&&(d.paused||!d.playbackRate||!d.readyState))return;const b=c.mainForwardBufferInfo;if(!y&&b===null)return;const R=this.bwEstimator.getEstimateTTFB(),T=Math.abs(d.playbackRate);if(v<=Math.max(R,1e3*(p/(T*2))))return;const w=b?b.len/T:0,C=f.loading.first?f.loading.first-f.loading.start:-1,A=f.loaded&&C>-1,L=this.getBwEstimate(),D=c.levels,P=D[g],k=Math.max(f.loaded,Math.round(p*(n.bitrate||P.averageBitrate)/8));let M=A?v-C:v;M<1&&A&&(M=Math.min(v,f.loaded*8/L));const I=A?f.loaded*1e3/M:0,F=R/1e3,$=I?(k-f.loaded)/I:k*8/L+F;if($<=w)return;const N=I?I*8:L,U=((r=(t==null?void 0:t.details)||this.hls.latestLevelDetails)==null?void 0:r.live)===!0,V=this.hls.config.abrBandWidthUpFactor;let J=Number.POSITIVE_INFINITY,j;for(j=g-1;j>E;j--){const Y=D[j].maxBitrate,re=!D[j].details||U;if(J=this.getTimeToLoadFrag(F,N,p*Y,re),J<Math.min(w,p+F))break}if(J>=$||J>p*10)return;A?this.bwEstimator.sample(v-Math.min(R,C),f.loaded):this.bwEstimator.sampleTTFB(v);const q=D[j].maxBitrate;this.getBwEstimate()*V>q&&this.resetEstimator(q);const Z=this.findBestLevel(q,E,j,0,w,1,1);Z>-1&&(j=Z),this.warn(`Fragment ${n.sn}${a?" part "+a.index:""} of level ${g} is loading too slowly;
      Fragment duration: ${n.duration.toFixed(3)}
      Time to underbuffer: ${w.toFixed(3)} s
      Estimated load time for current fragment: ${$.toFixed(3)} s
      Estimated load time for down switch fragment: ${J.toFixed(3)} s
      TTFB estimate: ${C|0} ms
      Current BW estimate: ${He(L)?L|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${j} @ ${q|0} bps`),c.nextLoadLevel=c.nextAutoLevel=j,this.clearTimer();const X=()=>{if(this.clearTimer(),this.fragCurrent===n&&this.hls.loadLevel===j&&j>0){const Y=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${j>0?"and switching down":""}
      Fragment duration: ${n.duration.toFixed(3)} s
      Time to underbuffer: ${Y.toFixed(3)} s`),n.abortRequests(),this.fragCurrent=this.partCurrent=null,j>E){let re=this.findBestLevel(this.hls.levels[E].bitrate,E,j,0,Y,1,1);re===-1&&(re=E),this.hls.nextLoadLevel=this.hls.nextAutoLevel=re,this.resetEstimator(this.hls.levels[re].bitrate)}}};m||$>J*2?X():this.timer=self.setInterval(X,J*1e3),c.trigger(z.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,part:a,stats:f})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new EM(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(z.MANIFEST_LOADING,this.onManifestLoading,this),e.on(z.FRAG_LOADING,this.onFragLoading,this),e.on(z.FRAG_LOADED,this.onFragLoaded,this),e.on(z.FRAG_BUFFERED,this.onFragBuffered,this),e.on(z.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(z.LEVEL_LOADED,this.onLevelLoaded,this),e.on(z.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(z.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(z.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(z.MANIFEST_LOADING,this.onManifestLoading,this),e.off(z.FRAG_LOADING,this.onFragLoading,this),e.off(z.FRAG_LOADED,this.onFragLoaded,this),e.off(z.FRAG_BUFFERED,this.onFragBuffered,this),e.off(z.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(z.LEVEL_LOADED,this.onLevelLoaded,this),e.off(z.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(z.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(z.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const r=t.frag;if(!this.ignoreFragment(r)){if(!r.bitrateTest){var n;this.fragCurrent=r,this.partCurrent=(n=t.part)!=null?n:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case he.BUFFER_ADD_CODEC_ERROR:case he.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case he.FRAG_LOAD_TIMEOUT:{const r=t.frag,{fragCurrent:n,partCurrent:a}=this;if(r&&n&&r.sn===n.sn&&r.level===n.level){const c=performance.now(),l=a?a.stats:r.stats,d=c-l.loading.start,u=l.loading.first?l.loading.first-l.loading.start:-1;if(l.loaded&&u>-1){const f=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(d-Math.min(f,u),l.loaded)}else this.bwEstimator.sampleTTFB(d)}break}}}getTimeToLoadFrag(e,t,r,n){const a=e+r/t,c=n?e+this.lastLevelLoadSec:0;return a+c}onLevelLoaded(e,t){const r=this.hls.config,{loading:n}=t.stats,a=n.end-n.first;He(a)&&(this.lastLevelLoadSec=a/1e3),t.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:r}){const n=r?r.stats:t.stats;if(t.type===ot.MAIN&&this.bwEstimator.sampleTTFB(n.loading.first-n.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const a=r?r.duration:t.duration,c=this.hls.levels[t.level],l=(c.loaded?c.loaded.bytes:0)+n.loaded,d=(c.loaded?c.loaded.duration:0)+a;c.loaded={bytes:l,duration:d},c.realBitrate=Math.round(8*l/d)}if(t.bitrateTest){const a={stats:n,frag:t,part:r,id:t.type};this.onFragBuffered(z.FRAG_BUFFERED,a),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:r,part:n}=t,a=n!=null&&n.stats.loaded?n.stats:r.stats;if(a.aborted||this.ignoreFragment(r))return;const c=a.parsing.end-a.loading.start-Math.min(a.loading.first-a.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(c,a.loaded),a.bwEstimate=this.getBwEstimate(),r.bitrateTest?this.bitrateTestDelay=c/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==ot.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,r=this.getBwEstimate(),n=this.hls.config.maxStarvationDelay,a=this.findBestLevel(r,t,e,0,n,1,1);if(a>-1)return a;const c=this.hls.firstLevel,l=Math.min(Math.max(c,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${c} clamped to ${l}`),l}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,t=this.bwEstimator.canEstimate(),r=this.lastLoadedFragLevel>-1;if(e!==-1&&(!t||!r||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const n=t&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const a=this.hls.levels;if(a.length>Math.max(e,n)&&a[e].loadError<=a[n].loadError)return e}return this._nextAutoLevel=n,this.nextAutoLevelKey=this.getAutoLevelKey(),n}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:r}=this;if(r.levels.length<=1)return r.loadLevel;const{maxAutoLevel:n,config:a,minAutoLevel:c}=r,l=t?t.duration:e?e.duration:0,d=this.getBwEstimate(),u=this.getStarvationDelay();let f=a.abrBandWidthFactor,p=a.abrBandWidthUpFactor;if(u){const m=this.findBestLevel(d,c,n,u,0,f,p);if(m>=0)return this.rebufferNotice=-1,m}let v=l?Math.min(l,a.maxStarvationDelay):a.maxStarvationDelay;if(!u){const m=this.bitrateTestDelay;m&&(v=(l?Math.min(l,a.maxLoadingDelay):a.maxLoadingDelay)-m,this.info(`bitrate test took ${Math.round(1e3*m)}ms, set first fragment max fetchDuration to ${Math.round(1e3*v)} ms`),f=p=1)}const E=this.findBestLevel(d,c,n,u,v,f,p);if(this.rebufferNotice!==E&&(this.rebufferNotice=E,this.info(`${u?"rebuffering expected":"buffer is empty"}, optimal quality level ${E}`)),E>-1)return E;const g=r.levels[c],_=r.loadLevelObj;return _&&(g==null?void 0:g.bitrate)<_.bitrate?c:r.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const r=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,n=e.mainForwardBufferInfo;return(n?n.len:0)/r}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,r,n,a,c,l){var d;const u=n+a,f=this.lastLoadedFragLevel,p=f===-1?this.hls.firstLevel:f,{fragCurrent:v,partCurrent:E}=this,{levels:g,allAudioTracks:_,loadLevel:m,config:y}=this.hls;if(g.length===1)return 0;const b=g[p],R=!!((d=this.hls.latestLevelDetails)!=null&&d.live),T=m===-1||f===-1;let w,C="SDR",A=(b==null?void 0:b.frameRate)||0;const{audioPreference:L,videoPreference:D}=y,P=this.audioTracksByGroup||(this.audioTracksByGroup=l3(_));let k=-1;if(T){if(this.firstSelection!==-1)return this.firstSelection;const N=this.codecTiers||(this.codecTiers=u3(g,P,t,r)),U=c3(N,C,e,L,D),{codecSet:V,videoRanges:J,minFramerate:j,minBitrate:q,minIndex:Z,preferHDR:X}=U;k=Z,w=V,C=X?J[J.length-1]:J[0],A=j,e=Math.max(e,q),this.log(`picked start tier ${hr(U)}`)}else w=b==null?void 0:b.codecSet,C=b==null?void 0:b.videoRange;const M=E?E.duration:v?v.duration:0,I=this.bwEstimator.getEstimateTTFB()/1e3,F=[];for(let N=r;N>=t;N--){var $;const U=g[N],V=N>p;if(!U)continue;if(y.useMediaCapabilities&&!U.supportedResult&&!U.supportedPromise){const Y=navigator.mediaCapabilities;typeof(Y==null?void 0:Y.decodingInfo)=="function"&&(t3(U,P,C,A,e,L)||Lf(U.videoCodec))?(U.supportedPromise=r3(U,P,Y),U.supportedPromise.then(re=>{if(!this.hls)return;U.supportedResult=re;const oe=this.hls.levels,ve=oe.indexOf(U);re.error?this.warn(`MediaCapabilities decodingInfo error: "${re.error}" for level ${ve} ${hr(re)}`):re.supported||(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${ve} ${hr(re)}`),ve>-1&&oe.length>1&&(this.log(`Removing unsupported level ${ve}`),this.hls.removeLevel(ve),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))})):U.supportedResult=wT}if((w&&U.codecSet!==w||C&&U.videoRange!==C||V&&A>U.frameRate||!V&&A>0&&A<U.frameRate||U.supportedResult&&!(($=U.supportedResult.decodingInfoResults)!=null&&$[0].smooth))&&(!T||N!==k)){F.push(N);continue}const J=U.details,j=(E?J==null?void 0:J.partTarget:J==null?void 0:J.averagetargetduration)||M;let q;V?q=l*e:q=c*e;const Z=M&&n>=M*2&&a===0?U.averageBitrate:U.maxBitrate,X=this.getTimeToLoadFrag(I,q,Z*j,J===void 0);if(q>=Z&&(N===f||U.loadError===0&&U.fragmentError===0)&&(X<=I||!He(X)||R&&!this.bitrateTestDelay||X<u)){const Y=this.forcedAutoLevel;return N!==m&&(Y===-1||Y!==m)&&(F.length&&this.trace(`Skipped level(s) ${F.join(",")} of ${r} max with CODECS and VIDEO-RANGE:"${g[F[0]].codecs}" ${g[F[0]].videoRange}; not compatible with "${w}" ${C}`),this.info(`switch candidate:${p}->${N} adjustedbw(${Math.round(q)})-bitrate=${Math.round(q-Z)} ttfb:${I.toFixed(1)} avgDuration:${j.toFixed(1)} maxFetchDuration:${u.toFixed(1)} fetchDuration:${X.toFixed(1)} firstSelection:${T} codecSet:${U.codecSet} videoRange:${U.videoRange} hls.loadLevel:${m}`)),T&&(this.firstSelection=N),N}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:r}=this.hls;return Math.min(Math.max(e,r),t)}}const CT={search:function(i,e){let t=0,r=i.length-1,n=null,a=null;for(;t<=r;){n=(t+r)/2|0,a=i[n];const c=e(a);if(c>0)t=n+1;else if(c<0)r=n-1;else return a}return null}};function m3(i,e,t){if(e===null||!Array.isArray(i)||!i.length||!He(e))return null;const r=i[0].programDateTime;if(e<(r||0))return null;const n=i[i.length-1].endProgramDateTime;if(e>=(n||0))return null;for(let a=0;a<i.length;++a){const c=i[a];if(v3(e,t,c))return c}return null}function Co(i,e,t=0,r=0,n=.005){let a=null;if(i){a=e[1+i.sn-e[0].sn]||null;const l=i.endDTS-t;l>0&&l<15e-7&&(t+=15e-7),a&&i.level!==a.level&&a.end<=i.end&&(a=e[2+i.sn-e[0].sn]||null)}else t===0&&e[0].start===0&&(a=e[0]);if(a&&((!i||i.level===a.level)&&rE(t,r,a)===0||g3(a,i,Math.min(n,r))))return a;const c=CT.search(e,rE.bind(null,t,r));return c&&(c!==i||!a)?c:a}function g3(i,e,t){if(e&&e.start===0&&e.level<i.level&&(e.endPTS||0)>0){const r=e.tagList.reduce((n,a)=>(a[0]==="INF"&&(n+=parseFloat(a[1])),n),t);return i.start<=r}return!1}function rE(i=0,e=0,t){if(t.start<=i&&t.start+t.duration>i)return 0;const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-r<=i?1:t.start-r>i&&t.start?-1:0}function v3(i,e,t){const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-r>i}function AT(i,e,t){if(i&&i.startCC<=e&&i.endCC>=e){let r=i.fragments;const{fragmentHint:n}=i;n&&(r=r.concat(n));let a;return CT.search(r,c=>c.cc<e?1:c.cc>e?-1:(a=c,c.end<=t?1:c.start>t?-1:0)),a||null}return null}function rf(i){switch(i.details){case he.FRAG_LOAD_TIMEOUT:case he.KEY_LOAD_TIMEOUT:case he.LEVEL_LOAD_TIMEOUT:case he.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function iE(i,e){const t=rf(e);return i.default[`${t?"timeout":"error"}Retry`]}function Tv(i,e){const t=i.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*i.retryDelayMs,i.maxRetryDelayMs)}function nE(i){return Vt(Vt({},i),{errorRetry:null,timeoutRetry:null})}function nf(i,e,t,r){if(!i)return!1;const n=r==null?void 0:r.code,a=e<i.maxNumRetry&&(y3(n)||!!t);return i.shouldRetry?i.shouldRetry(i,e,t,r,a):a}function y3(i){return i===0&&navigator.onLine===!1||!!i&&(i<400||i>499)}var jr={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},Xi={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2};class b3 extends jn{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(z.ERROR,this.onError,this),e.on(z.MANIFEST_LOADING,this.onManifestLoading,this),e.on(z.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(z.ERROR,this.onError,this),e.off(z.ERROR,this.onErrorOut,this),e.off(z.MANIFEST_LOADING,this.onManifestLoading,this),e.off(z.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===ot.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var r;if(t.fatal)return;const n=this.hls,a=t.context;switch(t.details){case he.FRAG_LOAD_ERROR:case he.FRAG_LOAD_TIMEOUT:case he.KEY_LOAD_ERROR:case he.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case he.FRAG_PARSING_ERROR:if((r=t.frag)!=null&&r.gap){t.errorAction=Al();return}case he.FRAG_GAP:case he.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=jr.SendAlternateToPenaltyBox;return}case he.LEVEL_EMPTY_ERROR:case he.LEVEL_PARSING_ERROR:{var c,l;const u=t.parent===ot.MAIN?t.level:n.loadLevel;t.details===he.LEVEL_EMPTY_ERROR&&(c=t.context)!=null&&(l=c.levelDetails)!=null&&l.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,u):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,u))}return;case he.LEVEL_LOAD_ERROR:case he.LEVEL_LOAD_TIMEOUT:typeof(a==null?void 0:a.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,a.level));return;case he.AUDIO_TRACK_LOAD_ERROR:case he.AUDIO_TRACK_LOAD_TIMEOUT:case he.SUBTITLE_LOAD_ERROR:case he.SUBTITLE_TRACK_LOAD_TIMEOUT:if(a){const u=n.loadLevelObj;if(u&&(a.type===Un.AUDIO_TRACK&&u.hasAudioGroup(a.groupId)||a.type===Un.SUBTITLE_TRACK&&u.hasSubtitleGroup(a.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,n.loadLevel),t.errorAction.action=jr.SendAlternateToPenaltyBox,t.errorAction.flags=Xi.MoveAllAlternatesMatchingHost;return}}return;case he.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const u=n.loadLevelObj,f=u==null?void 0:u.attrs["HDCP-LEVEL"];f?t.errorAction={action:jr.SendAlternateToPenaltyBox,flags:Xi.MoveAllAlternatesMatchingHDCP,hdcpLevel:f}:this.keySystemError(t)}return;case he.BUFFER_ADD_CODEC_ERROR:case he.REMUX_ALLOC_ERROR:case he.BUFFER_APPEND_ERROR:if(!t.errorAction){var d;t.errorAction=this.getLevelSwitchAction(t,(d=t.level)!=null?d:n.loadLevel)}return;case he.INTERNAL_EXCEPTION:case he.BUFFER_APPENDING_ERROR:case he.BUFFER_FULL_ERROR:case he.LEVEL_SWITCH_ERROR:case he.BUFFER_STALLED_ERROR:case he.BUFFER_SEEK_OVER_HOLE:case he.BUFFER_NUDGE_ON_STALL:t.errorAction=Al();return}t.type===Je.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const r=this.hls,n=iE(r.config.playlistLoadPolicy,e),a=this.playlistError++;if(nf(n,a,rf(e),e.response))return{action:jr.RetryRequest,flags:Xi.None,retryConfig:n,retryCount:a};const c=this.getLevelSwitchAction(e,t);return n&&(c.retryConfig=n,c.retryCount=a),c}getFragRetryOrSwitchAction(e){const t=this.hls,r=this.getVariantLevelIndex(e.frag),n=t.levels[r],{fragLoadPolicy:a,keyLoadPolicy:c}=t.config,l=iE(e.details.startsWith("key")?c:a,e),d=t.levels.reduce((f,p)=>f+p.fragmentError,0);if(n&&(e.details!==he.FRAG_GAP&&n.fragmentError++,nf(l,d,rf(e),e.response)))return{action:jr.RetryRequest,flags:Xi.None,retryConfig:l,retryCount:d};const u=this.getLevelSwitchAction(e,r);return l&&(u.retryConfig=l,u.retryCount=d),u}getLevelSwitchAction(e,t){const r=this.hls;t==null&&(t=r.loadLevel);const n=this.hls.levels[t];if(n){var a,c;const u=e.details;n.loadError++,u===he.BUFFER_APPEND_ERROR&&n.fragmentError++;let f=-1;const{levels:p,loadLevel:v,minAutoLevel:E,maxAutoLevel:g}=r;!r.autoLevelEnabled&&!r.config.preserveManualLevelOnError&&(r.loadLevel=-1);const _=(a=e.frag)==null?void 0:a.type,m=(_===ot.AUDIO&&u===he.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(u===he.BUFFER_ADD_CODEC_ERROR||u===he.BUFFER_APPEND_ERROR))&&p.some(({audioCodec:T})=>n.audioCodec!==T),y=e.sourceBufferName==="video"&&(u===he.BUFFER_ADD_CODEC_ERROR||u===he.BUFFER_APPEND_ERROR)&&p.some(({codecSet:T,audioCodec:w})=>n.codecSet!==T&&n.audioCodec===w),{type:b,groupId:R}=(c=e.context)!=null?c:{};for(let T=p.length;T--;){const w=(T+v)%p.length;if(w!==v&&w>=E&&w<=g&&p[w].loadError===0){var l,d;const C=p[w];if(u===he.FRAG_GAP&&_===ot.MAIN&&e.frag){const A=p[w].details;if(A){const L=Co(e.frag,A.fragments,e.frag.start);if(L!=null&&L.gap)continue}}else if(b===Un.AUDIO_TRACK&&C.hasAudioGroup(R)||b===Un.SUBTITLE_TRACK&&C.hasSubtitleGroup(R)||_===ot.AUDIO&&(l=n.audioGroups)!=null&&l.some(A=>C.hasAudioGroup(A))||_===ot.SUBTITLE&&(d=n.subtitleGroups)!=null&&d.some(A=>C.hasSubtitleGroup(A))||m&&n.audioCodec===C.audioCodec||!m&&n.audioCodec!==C.audioCodec||y&&n.codecSet===C.codecSet)continue;f=w;break}}if(f>-1&&r.loadLevel!==f)return e.levelRetry=!0,this.playlistError=0,{action:jr.SendAlternateToPenaltyBox,flags:Xi.None,nextAutoLevel:f}}return{action:jr.SendAlternateToPenaltyBox,flags:Xi.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var r;switch((r=t.errorAction)==null?void 0:r.action){case jr.DoNothing:break;case jr.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==he.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,r=e.errorAction;if(!r)return;const{flags:n,hdcpLevel:a,nextAutoLevel:c}=r;switch(n){case Xi.None:this.switchLevel(e,c);break;case Xi.MoveAllAlternatesMatchingHDCP:a&&(t.maxHdcpLevel=XS[XS.indexOf(a)-1],r.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}r.resolved||this.switchLevel(e,c)}switchLevel(e,t){if(t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===he.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const r=RT(e.mimeType),n=this.hls.levels;for(let a=n.length;a--;)n[a][`${e.sourceBufferName}Codec`]===r&&this.hls.removeLevel(a)}}}function Al(i){const e={action:jr.DoNothing,flags:Xi.None};return i&&(e.resolved=!0),e}var Ni={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"},Ts={cbc:0,ctr:1};class _3{constructor(e,t,r){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=r}decrypt(e,t){switch(this.aesMode){case Ts.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case Ts.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function S3(i){const e=i.byteLength,t=e&&new DataView(i.buffer).getUint8(e-1);return t?i.slice(0,e-t):i}class E3{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),r=new Uint32Array(4);for(let n=0;n<4;n++)r[n]=t.getUint32(n*4);return r}initTable(){const e=this.sBox,t=this.invSBox,r=this.subMix,n=r[0],a=r[1],c=r[2],l=r[3],d=this.invSubMix,u=d[0],f=d[1],p=d[2],v=d[3],E=new Uint32Array(256);let g=0,_=0,m=0;for(m=0;m<256;m++)m<128?E[m]=m<<1:E[m]=m<<1^283;for(m=0;m<256;m++){let y=_^_<<1^_<<2^_<<3^_<<4;y=y>>>8^y&255^99,e[g]=y,t[y]=g;const b=E[g],R=E[b],T=E[R];let w=E[y]*257^y*16843008;n[g]=w<<24|w>>>8,a[g]=w<<16|w>>>16,c[g]=w<<8|w>>>24,l[g]=w,w=T*16843009^R*65537^b*257^g*16843008,u[y]=w<<24|w>>>8,f[y]=w<<16|w>>>16,p[y]=w<<8|w>>>24,v[y]=w,g?(g=b^E[E[E[T^b]]],_^=E[E[_]]):g=_=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let r=!0,n=0;for(;n<t.length&&r;)r=t[n]===this.key[n],n++;if(r)return;this.key=t;const a=this.keySize=t.length;if(a!==4&&a!==6&&a!==8)throw new Error("Invalid aes key size="+a);const c=this.ksRows=(a+6+1)*4;let l,d;const u=this.keySchedule=new Uint32Array(c),f=this.invKeySchedule=new Uint32Array(c),p=this.sBox,v=this.rcon,E=this.invSubMix,g=E[0],_=E[1],m=E[2],y=E[3];let b,R;for(l=0;l<c;l++){if(l<a){b=u[l]=t[l];continue}R=b,l%a===0?(R=R<<8|R>>>24,R=p[R>>>24]<<24|p[R>>>16&255]<<16|p[R>>>8&255]<<8|p[R&255],R^=v[l/a|0]<<24):a>6&&l%a===4&&(R=p[R>>>24]<<24|p[R>>>16&255]<<16|p[R>>>8&255]<<8|p[R&255]),u[l]=b=(u[l-a]^R)>>>0}for(d=0;d<c;d++)l=c-d,d&3?R=u[l]:R=u[l-4],d<4||l<=4?f[d]=R:f[d]=g[p[R>>>24]]^_[p[R>>>16&255]]^m[p[R>>>8&255]]^y[p[R&255]],f[d]=f[d]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,r){const n=this.keySize+6,a=this.invKeySchedule,c=this.invSBox,l=this.invSubMix,d=l[0],u=l[1],f=l[2],p=l[3],v=this.uint8ArrayToUint32Array_(r);let E=v[0],g=v[1],_=v[2],m=v[3];const y=new Int32Array(e),b=new Int32Array(y.length);let R,T,w,C,A,L,D,P,k,M,I,F,$,N;const U=this.networkToHostOrderSwap;for(;t<y.length;){for(k=U(y[t]),M=U(y[t+1]),I=U(y[t+2]),F=U(y[t+3]),A=k^a[0],L=F^a[1],D=I^a[2],P=M^a[3],$=4,N=1;N<n;N++)R=d[A>>>24]^u[L>>16&255]^f[D>>8&255]^p[P&255]^a[$],T=d[L>>>24]^u[D>>16&255]^f[P>>8&255]^p[A&255]^a[$+1],w=d[D>>>24]^u[P>>16&255]^f[A>>8&255]^p[L&255]^a[$+2],C=d[P>>>24]^u[A>>16&255]^f[L>>8&255]^p[D&255]^a[$+3],A=R,L=T,D=w,P=C,$=$+4;R=c[A>>>24]<<24^c[L>>16&255]<<16^c[D>>8&255]<<8^c[P&255]^a[$],T=c[L>>>24]<<24^c[D>>16&255]<<16^c[P>>8&255]<<8^c[A&255]^a[$+1],w=c[D>>>24]<<24^c[P>>16&255]<<16^c[A>>8&255]<<8^c[L&255]^a[$+2],C=c[P>>>24]<<24^c[A>>16&255]<<16^c[L>>8&255]<<8^c[D&255]^a[$+3],b[t]=U(R^E),b[t+1]=U(C^g),b[t+2]=U(w^_),b[t+3]=U(T^m),E=k,g=M,_=I,m=F,t=t+4}return b.buffer}}class R3{constructor(e,t,r){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=r}expandKey(){const e=w3(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function w3(i){switch(i){case Ts.cbc:return"AES-CBC";case Ts.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${i}`)}}const T3=16;class Cv{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const r=self.crypto;r&&(this.subtle=r.subtle||r.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const r=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?S3(r):r}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,r,n){return this.useSoftware?new Promise((a,c)=>{const l=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(l,t,r,n);const d=this.flush();d?a(d.buffer):c(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,r,n)}softwareDecrypt(e,t,r,n){const{currentIV:a,currentResult:c,remainderData:l}=this;if(n!==Ts.cbc||t.byteLength!==16)return Gt.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),l&&(e=Fi(l,e),this.remainderData=null);const d=this.getValidChunk(e);if(!d.length)return null;a&&(r=a);let u=this.softwareDecrypter;u||(u=this.softwareDecrypter=new E3),u.expandKey(t);const f=c;return this.currentResult=u.decrypt(d.buffer,0,r),this.currentIV=d.slice(-16).buffer,f||null}webCryptoDecrypt(e,t,r,n){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,r,n));this.key=t,this.fastAesKey=new R3(this.subtle,t,n)}return this.fastAesKey.expandKey().then(a=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new _3(this.subtle,new Uint8Array(r),n).decrypt(e.buffer,a)):Promise.reject(new Error("web crypto not initialized"))).catch(a=>(Gt.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${a.name}: ${a.message}`),this.onWebCryptoError(e,t,r,n)))}onWebCryptoError(e,t,r,n){const a=this.enableSoftwareAES;if(a){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,r,n);const c=this.flush();if(c)return c.buffer}throw new Error("WebCrypto"+(a?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const r=e.length-e.length%T3;return r!==e.length&&(t=e.slice(0,r),this.remainderData=e.slice(r)),t}logOnce(e){this.logEnabled&&(Gt.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const sE=Math.pow(2,17);class C3{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const r=e.url;if(!r)return Promise.reject(new vs({type:Je.NETWORK_ERROR,details:he.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${r?"part list":"url"}`),networkDetails:null}));this.abort();const n=this.config,a=n.fLoader,c=n.loader;return new Promise((l,d)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(g=>g[0]==="GAP")){d(oE(e));return}else e.gap=!1;const u=this.loader=a?new a(n):new c(n),f=aE(e);e.loader=u;const p=nE(n.fragLoadPolicy.default),v={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:sE};e.stats=u.stats;const E={onSuccess:(g,_,m,y)=>{this.resetLoader(e,u);let b=g.data;m.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(b.slice(0,16)),b=b.slice(16)),l({frag:e,part:null,payload:b,networkDetails:y})},onError:(g,_,m,y)=>{this.resetLoader(e,u),d(new vs({type:Je.NETWORK_ERROR,details:he.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:Vt({url:r,data:void 0},g),error:new Error(`HTTP Error ${g.code} ${g.text}`),networkDetails:m,stats:y}))},onAbort:(g,_,m)=>{this.resetLoader(e,u),d(new vs({type:Je.NETWORK_ERROR,details:he.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:m,stats:g}))},onTimeout:(g,_,m)=>{this.resetLoader(e,u),d(new vs({type:Je.NETWORK_ERROR,details:he.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${v.timeout}ms`),networkDetails:m,stats:g}))}};t&&(E.onProgress=(g,_,m,y)=>t({frag:e,part:null,payload:m,networkDetails:y})),u.load(f,v,E)})}loadPart(e,t,r){this.abort();const n=this.config,a=n.fLoader,c=n.loader;return new Promise((l,d)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){d(oE(e,t));return}const u=this.loader=a?new a(n):new c(n),f=aE(e,t);e.loader=u;const p=nE(n.fragLoadPolicy.default),v={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:sE};t.stats=u.stats,u.load(f,v,{onSuccess:(E,g,_,m)=>{this.resetLoader(e,u),this.updateStatsFromPart(e,t);const y={frag:e,part:t,payload:E.data,networkDetails:m};r(y),l(y)},onError:(E,g,_,m)=>{this.resetLoader(e,u),d(new vs({type:Je.NETWORK_ERROR,details:he.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:Vt({url:f.url,data:void 0},E),error:new Error(`HTTP Error ${E.code} ${E.text}`),networkDetails:_,stats:m}))},onAbort:(E,g,_)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,u),d(new vs({type:Je.NETWORK_ERROR,details:he.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:_,stats:E}))},onTimeout:(E,g,_)=>{this.resetLoader(e,u),d(new vs({type:Je.NETWORK_ERROR,details:he.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${v.timeout}ms`),networkDetails:_,stats:E}))}})})}updateStatsFromPart(e,t){const r=e.stats,n=t.stats,a=n.total;if(r.loaded+=n.loaded,a){const d=Math.round(e.duration/t.duration),u=Math.min(Math.round(r.loaded/a),d),f=(d-u)*Math.round(r.loaded/u);r.total=r.loaded+f}else r.total=Math.max(r.loaded,r.total);const c=r.loading,l=n.loading;c.start?c.first+=l.first-l.start:(c.start=l.start,c.first=l.first),c.end=l.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function aE(i,e=null){const t=e||i,r={frag:i,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},n=t.byteRangeStartOffset,a=t.byteRangeEndOffset;if(He(n)&&He(a)){var c;let l=n,d=a;if(i.sn==="initSegment"&&A3((c=i.decryptdata)==null?void 0:c.method)){const u=a-n;u%16&&(d=a+(16-u%16)),n!==0&&(r.resetIV=!0,l=n-16)}r.rangeStart=l,r.rangeEnd=d}return r}function oE(i,e){const t=new Error(`GAP ${i.gap?"tag":"attribute"} found`),r={type:Je.MEDIA_ERROR,details:he.FRAG_GAP,fatal:!1,frag:i,error:t,networkDetails:null};return e&&(r.part=e),(e||i).stats.aborted=!0,new vs(r)}function A3(i){return i==="AES-128"||i==="AES-256"}class vs extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class x3 extends jn{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class xT{constructor(e,t,r,n=0,a=-1,c=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=td(),this.buffering={audio:td(),video:td(),audiovideo:td()},this.level=e,this.sn=t,this.id=r,this.size=n,this.part=a,this.partial=c}}function td(){return{start:0,executeStart:0,executeEnd:0,end:0}}const cE={length:0,start:()=>0,end:()=>0};class Lt{static isBuffered(e,t){if(e){const r=Lt.getBuffered(e);for(let n=r.length;n--;)if(t>=r.start(n)&&t<=r.end(n))return!0}return!1}static bufferedRanges(e){if(e){const t=Lt.getBuffered(e);return Lt.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t}static bufferInfo(e,t,r){if(e){const n=Lt.bufferedRanges(e);if(n.length)return Lt.bufferedInfo(n,t,r)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,r){t=Math.max(0,t),e.length>1&&e.sort((f,p)=>f.start-p.start||p.end-f.end);let n=-1,a=[];if(r)for(let f=0;f<e.length;f++){t>=e[f].start&&t<=e[f].end&&(n=f);const p=a.length;if(p){const v=a[p-1].end;e[f].start-v<r?e[f].end>v&&(a[p-1].end=e[f].end):a.push(e[f])}else a.push(e[f])}else a=e;let c=0,l,d=t,u=t;for(let f=0;f<a.length;f++){const p=a[f].start,v=a[f].end;if(n===-1&&t>=p&&t<=v&&(n=f),t+r>=p&&t<v)d=p,u=v,c=u-t;else if(t+r<p){l=p;break}}return{len:c,start:d||0,end:u||0,nextStart:l,buffered:e,bufferedIndex:n}}static getBuffered(e){try{return e.buffered||cE}catch(t){return Gt.log("failed to get media.buffered",t),cE}}}const D3=/\{\$([a-zA-Z0-9-_]+)\}/g;function L3(i,e){if(i.variableList!==null||i.hasVariableRefs){const t=i.variableList;return e.replace(D3,r=>{const n=r.substring(2,r.length-1),a=t==null?void 0:t[n];return a===void 0?(i.playlistParsingError||(i.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${n}"`)),r):a})}return e}const O3=/^(\d+)x(\d+)$/,lE=/(.+?)=(".*?"|.*?)(?:,|$)/g;class Bl{constructor(e,t){typeof e=="string"&&(e=Bl.parseAttrList(e,t)),Yt(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const r=new Uint8Array(t.length/2);for(let n=0;n<t.length/2;n++)r[n]=parseInt(t.slice(n*2,n*2+2),16);return r}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const r=this[e];return r?parseFloat(r):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const r=this[e];return(r?r.split(/[ ,]+/):[]).reduce((n,a)=>(n[a.toLowerCase()]=!0,n),t)}bool(e){return this[e]==="YES"}decimalResolution(e){const t=O3.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let r;const n={},a='"';for(lE.lastIndex=0;(r=lE.exec(e))!==null;){const c=r[1].trim();let l=r[2];const d=l.indexOf(a)===0&&l.lastIndexOf(a)===l.length-1;let u=!1;if(d)l=l.slice(1,-1);else switch(c){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":u=!0}if(t&&(d||u))l=L3(t,l);else if(!u&&!d)switch(c){case"CLOSED-CAPTIONS":if(l==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":Gt.warn(`${e}: attribute ${c} is missing quotes`)}n[c]=l}return n}}const I3="com.apple.hls.interstitial";class P3{constructor(e,t,r=0){var n;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(t==null?void 0:t.tagAnchor)||null,this.tagOrder=(n=t==null?void 0:t.tagOrder)!=null?n:r,t){const a=t.attr;for(const c in a)if(Object.prototype.hasOwnProperty.call(e,c)&&e[c]!==a[c]){Gt.warn(`DATERANGE tag attribute: "${c}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=c;break}e=Yt(new Bl({}),a,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const a=(t==null?void 0:t.endDate)||new Date(this.attr["END-DATE"]);He(a.getTime())&&(this._endDate=a)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(Gt.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return t!==null?this._dateAtEnd=new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(He(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===I3}get isValid(){return!!this.id&&!this._badValueForSameId&&He(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}function vo(i){return i==="AES-128"||i==="AES-256"||i==="AES-256-CTR"}function Av(i){switch(i){case"AES-128":case"AES-256":return Ts.cbc;case"AES-256-CTR":return Ts.ctr;default:throw new Error(`invalid full segment method ${i}`)}}function xv(i){return Uint8Array.from(atob(i),e=>e.charCodeAt(0))}function Gg(i){return Uint8Array.from(unescape(encodeURIComponent(i)),e=>e.charCodeAt(0))}function k3(i){const e=Gg(i).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function M3(i){const e=function(t,r,n){const a=t[r];t[r]=t[n],t[n]=a};e(i,0,3),e(i,1,2),e(i,4,5),e(i,6,7)}function N3(i){const e=i.split(":");let t=null;if(e[0]==="data"&&e.length===2){const r=e[1].split(";"),n=r[r.length-1].split(",");if(n.length===2){const a=n[0]==="base64",c=n[1];a?(r.splice(-1,1),t=xv(c)):t=k3(c)}}return t}const sf=typeof self<"u"?self:void 0;var At={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Jr={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function Rm(i){switch(i){case Jr.FAIRPLAY:return At.FAIRPLAY;case Jr.PLAYREADY:return At.PLAYREADY;case Jr.WIDEVINE:return At.WIDEVINE;case Jr.CLEARKEY:return At.CLEARKEY}}var rd={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function wm(i){if(i===rd.WIDEVINE)return At.WIDEVINE;if(i===rd.PLAYREADY)return At.PLAYREADY;if(i===rd.CENC||i===rd.CLEARKEY)return At.CLEARKEY}function id(i){switch(i){case At.FAIRPLAY:return Jr.FAIRPLAY;case At.PLAYREADY:return Jr.PLAYREADY;case At.WIDEVINE:return Jr.WIDEVINE;case At.CLEARKEY:return Jr.CLEARKEY}}function nd(i){const{drmSystems:e,widevineLicenseUrl:t}=i,r=e?[At.FAIRPLAY,At.WIDEVINE,At.PLAYREADY,At.CLEARKEY].filter(n=>!!e[n]):[];return!r[At.WIDEVINE]&&t&&r.push(At.WIDEVINE),r}const DT=function(i){return sf!=null&&(i=sf.navigator)!=null&&i.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function B3(i,e,t,r){let n;switch(i){case At.FAIRPLAY:n=["cenc","sinf"];break;case At.WIDEVINE:case At.PLAYREADY:n=["cenc"];break;case At.CLEARKEY:n=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${i}`)}return F3(n,e,t,r)}function F3(i,e,t,r){return[{initDataTypes:i,persistentState:r.persistentState||"optional",distinctiveIdentifier:r.distinctiveIdentifier||"optional",sessionTypes:r.sessionTypes||[r.sessionType||"temporary"],audioCapabilities:e.map(n=>({contentType:`audio/mp4; codecs=${n}`,robustness:r.audioRobustness||"",encryptionScheme:r.audioEncryptionScheme||null})),videoCapabilities:t.map(n=>({contentType:`video/mp4; codecs=${n}`,robustness:r.videoRobustness||"",encryptionScheme:r.videoEncryptionScheme||null}))}]}function U3(i){var e;return i.sessionType==="persistent-license"||!!((e=i.sessionTypes)!=null&&e.some(t=>t==="persistent-license"))}function LT(i){const e=new Uint16Array(i.buffer,i.byteOffset,i.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),r=t.substring(t.indexOf("<"),t.length),n=new DOMParser().parseFromString(r,"text/xml").getElementsByTagName("KID")[0];if(n){const a=n.childNodes[0]?n.childNodes[0].nodeValue:n.getAttribute("VALUE");if(a){const c=xv(a).subarray(0,16);return M3(c),c}}return null}let sd={};class af{static clearKeyUriToKeyIdMap(){sd={}}constructor(e,t,r,n=[1],a=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=r,this.keyFormatVersions=n,this.iv=a,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!vo(e)}isSupported(){if(this.method){if(vo(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Jr.FAIRPLAY:case Jr.WIDEVINE:case Jr.PLAYREADY:case Jr.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(vo(this.method)&&this.uri&&!this.iv){typeof e!="number"&&(Gt.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const r=$3(e);return new af(this.method,this.uri,"identity",this.keyFormatVersions,r)}const t=N3(this.uri);if(t)switch(this.keyFormat){case Jr.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case Jr.PLAYREADY:{const r=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=VM(r,null,t),this.keyId=LT(t);break}default:{let r=t.subarray(0,16);if(r.length!==16){const n=new Uint8Array(16);n.set(r,16-r.length),r=n}this.keyId=r;break}}if(!this.keyId||this.keyId.byteLength!==16){let r=sd[this.uri];if(!r){const n=Object.keys(sd).length%Number.MAX_SAFE_INTEGER;r=new Uint8Array(16),new DataView(r.buffer,12,4).setUint32(0,n),sd[this.uri]=r}this.keyId=r}return this}}function $3(i){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=i>>8*(15-t)&255;return e}function j3(i,e){const t=i.length;if(!t)return;const r=i[t-1],n=e.live?1/0:e.totalduration,a=Object.keys(e.dateRanges);for(let c=a.length;c--;){const l=e.dateRanges[a[c]],d=l.startDate.getTime();l.tagAnchor=r.ref;for(let u=t;u--;){const f=z3(e,d,i,u,n);if(f!==-1){l.tagAnchor=e.fragments[f].ref;break}}}}function z3(i,e,t,r,n){const a=t[r];if(a){const l=a.programDateTime;if(e>=l||r===0){var c;const d=(((c=t[r+1])==null?void 0:c.start)||n)-a.start;if(e<=l+d*1e3){const u=t[r].sn-i.startSN,f=i.fragments;if(f.length>t.length){const p=(t[r+1]||f[f.length-1]).sn-i.startSN;for(let v=p;v>u;v--){const E=f[v].programDateTime;if(e>=E&&e<E+f[v].duration*1e3)return v}}return u}}}return-1}function G3(i,e,t){i.rawProgramDateTime?t.push(i):e!=null&&e.programDateTime&&(i.programDateTime=e.endProgramDateTime)}function Tm(i,e){const t=e.startPTS;if(He(t)){let r=0,n;e.sn>i.sn?(r=t-i.start,n=i):(r=i.start-t,n=e),n.duration!==r&&n.setDuration(r)}else e.sn>i.sn?i.cc===e.cc&&i.minEndPTS?e.setStart(i.start+(i.minEndPTS-i.start)):e.setStart(i.start+i.duration):e.setStart(Math.max(i.start-e.duration,0))}function OT(i,e,t,r,n,a){r-t<=0&&(Gt.warn("Fragment should have a positive duration",e),r=t+e.duration,a=n+e.duration);let c=t,l=r;const d=e.startPTS,u=e.endPTS;if(He(d)){const _=Math.abs(d-t);He(e.deltaPTS)?e.deltaPTS=Math.max(_,e.deltaPTS):e.deltaPTS=_,c=Math.max(t,d),t=Math.min(t,d),n=Math.min(n,e.startDTS),l=Math.min(r,u),r=Math.max(r,u),a=Math.max(a,e.endDTS)}const f=t-e.start;e.start!==0&&e.setStart(t),e.setDuration(r-e.start),e.startPTS=t,e.maxStartPTS=c,e.startDTS=n,e.endPTS=r,e.minEndPTS=l,e.endDTS=a;const p=e.sn;if(!i||p<i.startSN||p>i.endSN)return 0;let v;const E=p-i.startSN,g=i.fragments;for(g[E]=e,v=E;v>0;v--)Tm(g[v],g[v-1]);for(v=E;v<g.length-1;v++)Tm(g[v],g[v+1]);return i.fragmentHint&&Tm(g[g.length-1],i.fragmentHint),i.PTSKnown=i.alignedSliding=!0,f}function H3(i,e){if(i===e)return;let t=null;const r=i.fragments;for(let u=r.length-1;u>=0;u--){const f=r[u].initSegment;if(f){t=f;break}}i.fragmentHint&&delete i.fragmentHint.endPTS;let n;q3(i,e,(u,f,p,v)=>{if((!e.startCC||e.skippedSegments)&&f.cc!==u.cc){const E=u.cc-f.cc;for(let g=p;g<v.length;g++)v[g].cc+=E;e.endCC=v[v.length-1].cc}He(u.startPTS)&&He(u.endPTS)&&(f.setStart(f.startPTS=u.startPTS),f.startDTS=u.startDTS,f.maxStartPTS=u.maxStartPTS,f.endPTS=u.endPTS,f.endDTS=u.endDTS,f.minEndPTS=u.minEndPTS,f.setDuration(u.endPTS-u.startPTS),f.duration&&(n=f),e.PTSKnown=e.alignedSliding=!0),u.hasStreams&&(f.elementaryStreams=u.elementaryStreams),f.loader=u.loader,u.hasStats&&(f.stats=u.stats),u.initSegment&&(f.initSegment=u.initSegment,t=u.initSegment)});const a=e.fragments,c=e.fragmentHint?a.concat(e.fragmentHint):a;if(t&&c.forEach(u=>{var f;u&&(!u.initSegment||u.initSegment.relurl===((f=t)==null?void 0:f.relurl))&&(u.initSegment=t)}),e.skippedSegments){if(e.deltaUpdateFailed=a.some(u=>!u),e.deltaUpdateFailed){Gt.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let u=e.skippedSegments;u--;)a.shift();e.startSN=a[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=V3(i.dateRanges,e));const u=i.fragments.filter(f=>f.rawProgramDateTime);if(i.hasProgramDateTime&&!e.hasProgramDateTime)for(let f=1;f<c.length;f++)c[f].programDateTime===null&&G3(c[f],c[f-1],u);j3(u,e)}e.endCC=a[a.length-1].cc}if(!e.startCC){var l;const u=PT(i,e.startSN-1);e.startCC=(l=u==null?void 0:u.cc)!=null?l:a[0].cc}K3(i.partList,e.partList,(u,f)=>{f.elementaryStreams=u.elementaryStreams,f.stats=u.stats}),n?OT(e,n,n.startPTS,n.endPTS,n.startDTS,n.endDTS):IT(i,e),a.length&&(e.totalduration=e.edge-a[0].start),e.driftStartTime=i.driftStartTime,e.driftStart=i.driftStart;const d=e.advancedDateTime;if(e.advanced&&d){const u=e.edge;e.driftStart||(e.driftStartTime=d,e.driftStart=u),e.driftEndTime=d,e.driftEnd=u}else e.driftEndTime=i.driftEndTime,e.driftEnd=i.driftEnd,e.advancedDateTime=i.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=i.requestScheduled)}function V3(i,e){const{dateRanges:t,recentlyRemovedDateranges:r}=e,n=Yt({},i);r&&r.forEach(c=>{delete n[c]});const a=Object.keys(n).length;return a&&Object.keys(t).forEach(c=>{const l=n[c],d=new P3(t[c].attr,l);d.isValid?(n[c]=d,l||(d.tagOrder+=a)):Gt.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${hr(t[c].attr)}"`)}),n}function K3(i,e,t){if(i&&e){let r=0;for(let n=0,a=i.length;n<=a;n++){const c=i[n],l=e[n+r];c&&l&&c.index===l.index&&c.fragment.sn===l.fragment.sn?t(c,l):r--}}}function q3(i,e,t){const r=e.skippedSegments,n=Math.max(i.startSN,e.startSN)-e.startSN,a=(i.fragmentHint?1:0)+(r?e.endSN:Math.min(i.endSN,e.endSN))-e.startSN,c=e.startSN-i.startSN,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,d=i.fragmentHint?i.fragments.concat(i.fragmentHint):i.fragments;for(let u=n;u<=a;u++){const f=d[c+u];let p=l[u];if(r&&!p&&f&&(p=e.fragments[u]=f),f&&p){if(t(f,p,u,l),f.url&&f.url!==p.url){e.playlistParsingError=uE(`media sequence mismatch ${p.sn}:`,i,e,f,p);return}else if(f.cc!==p.cc){e.playlistParsingError=uE(`discontinuity sequence mismatch (${f.cc}!=${p.cc})`,i,e,f,p);return}}}}function uE(i,e,t,r,n){return new Error(`${i} ${n.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${t.startSN}
${t.m3u8}`)}function IT(i,e,t=!0){const r=e.startSN+e.skippedSegments-i.startSN,n=i.fragments,a=r>=0;let c=0;if(a&&r<n.length)c=n[r].start;else if(a&&e.startSN===i.endSN+1)c=i.fragmentEnd;else if(a&&t)c=i.fragmentStart+r*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)c=i.fragmentStart;else return;Hg(e,c)}function Hg(i,e){if(e){const t=i.fragments;for(let r=i.skippedSegments;r<t.length;r++)t[r].addStart(e);i.fragmentHint&&i.fragmentHint.addStart(e)}}function Y3(i,e=1/0){let t=1e3*i.targetduration;if(i.updated){const r=i.fragments;if(r.length&&t*4>e){const n=r[r.length-1].duration*1e3;n<t&&(t=n)}}else t/=2;return Math.round(t)}function PT(i,e,t){if(!i)return null;let r=i.fragments[e-i.startSN];return r||(r=i.fragmentHint,r&&r.sn===e)?r:e<i.startSN&&t&&t.sn===e?t:null}function dE(i,e,t){return i?kT(i.partList,e,t):null}function kT(i,e,t){if(i)for(let r=i.length;r--;){const n=i[r];if(n.index===t&&n.fragment.sn===e)return n}return null}function W3(i){i.forEach((e,t)=>{var r;(r=e.details)==null||r.fragments.forEach(n=>{n.level=t,n.initSegment&&(n.initSegment.level=t)})})}function ml(i,e){for(let r=0,n=i.length;r<n;r++){var t;if(((t=i[r])==null?void 0:t.cc)===e)return i[r]}return null}function X3(i,e){return!!(i&&e.startCC<i.endCC&&e.endCC>i.startCC)}function fE(i,e){if(i){const t=i.start+e;i.start=i.startPTS=t,i.endPTS=t+i.duration}}function MT(i,e){const t=e.fragments;for(let r=0,n=t.length;r<n;r++)fE(t[r],i);e.fragmentHint&&fE(e.fragmentHint,i),e.alignedSliding=!0}function Q3(i,e){i&&(NT(e,i),!e.alignedSliding&&i&&of(e,i),!e.alignedSliding&&i&&!e.skippedSegments&&IT(i,e,!1))}function NT(i,e){if(!X3(e,i))return;const t=Math.min(e.endCC,i.endCC),r=ml(e.fragments,t),n=ml(i.fragments,t);if(!r||!n)return;Gt.log(`Aligning playlist at start of dicontinuity sequence ${t}`);const a=r.start-n.start;MT(a,i)}function of(i,e){if(!i.hasProgramDateTime||!e.hasProgramDateTime)return;const t=i.fragments,r=e.fragments;if(!t.length||!r.length)return;let n,a;const c=Math.min(e.endCC,i.endCC);e.startCC<c&&i.startCC<c&&(n=ml(r,c),a=ml(t,c)),(!n||!a)&&(n=r[Math.floor(r.length/2)],a=ml(t,n.cc)||t[Math.floor(t.length/2)]);const l=n.programDateTime,d=a.programDateTime;if(!l||!d)return;const u=(d-l)/1e3-(a.start-n.start);MT(u,i)}const Z3={toString:function(i){let e="";const t=i.length;for(let r=0;r<t;r++)e+=`[${i.start(r).toFixed(3)}-${i.end(r).toFixed(3)}]`;return e}},Re={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class BT extends x3{constructor(e,t,r,n,a){super(n,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=Re.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:c,fragCurrent:l,media:d,mediaBuffer:u,state:f}=this,p=d?d.currentTime:0,v=Lt.bufferInfo(u||d,p,c.maxBufferHole);if(this.log(`media seeking to ${He(p)?p.toFixed(3):p}, state: ${f}`),this.state===Re.ENDED)this.resetLoadingState();else if(l){const E=c.maxFragLookUpTolerance,g=l.start-E,_=l.start+l.duration+E;if(!v.len||_<v.start||g>v.end){const m=p>_;(p<g||m)&&(m&&l.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),l.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(d){this.fragmentTracker.removeFragmentsInRange(p,1/0,this.playlistType,!0);const E=this.lastCurrentTime;if(p>E&&(this.lastCurrentTime=p),!this.loadingParts){const g=Math.max(v.end,p),_=this.shouldLoadParts(this.getLevelDetails(),g);_&&(this.log(`LL-Part loading ON after seeking to ${p.toFixed(2)} with buffer @${g.toFixed(2)}`),this.loadingParts=_)}}!this.hls.hasEnoughToStart&&!v.len&&(this.log(`setting startPosition to ${p} because of seek before start`),this.nextLoadPosition=this.startPosition=p),this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=a,this.hls=e,this.fragmentLoader=new C3(e.config),this.keyLoader=r,this.fragmentTracker=t,this.config=e.config,this.decrypter=new Cv(e.config)}registerListeners(){const{hls:e}=this;e.on(z.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(z.MANIFEST_LOADING,this.onManifestLoading,this),e.on(z.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(z.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(z.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(z.MANIFEST_LOADING,this.onManifestLoading,this),e.off(z.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(z.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===Re.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Re.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return t===-1&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const r=e.end||0,n=this.config.timelineOffset||0;if(r<=n)return!1;const a=e.buffered;this.config.maxBufferHole&&a&&a.length>1&&(e=Lt.bufferedInfo(a,e.start,0));const c=e.nextStart;if(c&&c>n&&c<t.edge||this.media.currentTime<e.start)return!1;const l=t.partList;if(l!=null&&l.length){const u=l[l.length-1];return Lt.isBuffered(this.media,u.start+u.duration/2)}const d=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(d)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levelLastLoaded)==null?void 0:e.details}}get timelineOffset(){const e=this.config.timelineOffset;if(e){var t;return((t=this.getLevelDetails())==null?void 0:t.appliedTimelineOffset)||e}return 0}onMediaAttached(e,t){const r=this.media=this.mediaBuffer=t.media;r.removeEventListener("seeking",this.onMediaSeeking),r.removeEventListener("ended",this.onMediaEnded),r.addEventListener("seeking",this.onMediaSeeking),r.addEventListener("ended",this.onMediaEnded);const n=this.config;this.levels&&n.autoStartLoad&&this.state===Re.STOPPED&&this.startLoad(n.startPosition)}onMediaDetaching(e,t){const r=!!t.transferMedia,n=this.media;if(n!==null){if(n.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),n.removeEventListener("seeking",this.onMediaSeeking),n.removeEventListener("ended",this.onMediaEnded),this.keyLoader&&!r&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,r){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=Re.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,r){this.startFragRequested=!0,this._loadFragForPlayback(e,t,r)}_loadFragForPlayback(e,t,r){const n=a=>{const c=a.frag;if(this.fragContextChanged(c)){this.warn(`${c.type} sn: ${c.sn}${a.part?" part: "+a.part.index:""} of ${this.fragInfo(c,!1,a.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(c);return}c.stats.chunkCount++,this._handleFragmentLoadProgress(a)};this._doFragLoad(e,t,r,n).then(a=>{if(!a)return;const c=this.state,l=a.frag;if(this.fragContextChanged(l)){(c===Re.FRAG_LOADING||!this.fragCurrent&&c===Re.PARSING)&&(this.fragmentTracker.removeFragment(l),this.state=Re.IDLE);return}"payload"in a&&(this.log(`Loaded ${l.type} sn: ${l.sn} of ${this.playlistLabel()} ${l.level}`),this.hls.trigger(z.FRAG_LOADED,a)),this._handleFragmentLoadComplete(a)}).catch(a=>{this.state===Re.STOPPED||this.state===Re.ERROR||(this.warn(`Frag error: ${(a==null?void 0:a.message)||a}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:r}=this;if(r.getState(e)===Ni.APPENDING){const n=e.type,a=this.getFwdBufferInfo(this.mediaBuffer,n),c=Math.max(e.duration,a?a.len:this.config.maxBufferLength),l=this.backtrackFragment;((l?e.sn-l.sn:0)===1||this.reduceMaxBufferLength(c,e.duration))&&r.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?r.removeAllFragments():r.hasParts(e.type)&&(r.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),r.getState(e)===Ni.PARTIAL&&r.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return(t==null?void 0:t.live)&&t.type!=="EVENT"&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,r=null){if(!(e-t))return;const n={startOffset:e,endOffset:t,type:r};this.hls.trigger(z.BUFFER_FLUSHING,n)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(r=>{const n=r==null?void 0:r.frag;if(!n||this.fragContextChanged(n)||!this.levels)throw new Error("init load aborted");return r}).then(r=>{const{hls:n}=this,{frag:a,payload:c}=r,l=a.decryptdata;if(c&&c.byteLength>0&&l!=null&&l.key&&l.iv&&vo(l.method)){const d=self.performance.now();return this.decrypter.decrypt(new Uint8Array(c),l.key.buffer,l.iv.buffer,Av(l.method)).catch(u=>{throw n.trigger(z.ERROR,{type:Je.MEDIA_ERROR,details:he.FRAG_DECRYPT_ERROR,fatal:!1,error:u,reason:u.message,frag:a}),u}).then(u=>{const f=self.performance.now();return n.trigger(z.FRAG_DECRYPTED,{frag:a,payload:u,stats:{tstart:d,tdecrypt:f}}),r.payload=u,this.completeInitSegmentLoad(r)})}return this.completeInitSegmentLoad(r)}).catch(r=>{this.state===Re.STOPPED||this.state===Re.ERROR||(this.warn(r),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const r=e.frag.stats;this.state!==Re.STOPPED&&(this.state=Re.IDLE),e.frag.data=new Uint8Array(e.payload),r.parsing.start=r.buffering.start=self.performance.now(),r.parsing.end=r.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const r=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${r?Z3.toString(Lt.getBuffered(r)):"(detached)"})`),vi(e)){var n;if(e.type!==ot.SUBTITLE){const c=e.elementaryStreams;if(!Object.keys(c).some(l=>!!c[l])){this.state=Re.IDLE;return}}const a=(n=this.levels)==null?void 0:n[e.level];a!=null&&a.fragmentError&&(this.log(`Resetting level fragment error count of ${a.fragmentError} on frag buffered`),a.fragmentError=0)}this.state=Re.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:r,part:n,partsLoaded:a}=e,c=!a||a.length===0||a.some(d=>!d),l=new xT(r.level,r.sn,r.stats.chunkCount+1,0,n?n.index:-1,!c);t.flush(l)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,r=null,n){var a;this.fragCurrent=e;const c=t==null?void 0:t.details;if(!this.levels||!c)throw new Error(`frag load aborted, missing level${c?"":" detail"}s`);let l=null;e.encrypted&&!((a=e.decryptdata)!=null&&a.key)?(this.log(`Loading key for ${e.sn} of [${c.startSN}-${c.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=Re.KEY_LOADING,this.fragCurrent=e,l=this.keyLoader.load(e).then(p=>{if(!this.fragContextChanged(p.frag))return this.hls.trigger(z.KEY_LOADED,p),this.state===Re.KEY_LOADING&&(this.state=Re.IDLE),p}),this.hls.trigger(z.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(l=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):e.encrypted||(l=this.keyLoader.loadClear(e,c.encryptedFragments),l&&this.log("[eme] blocking frag load until media-keys acquired"));const d=this.fragPrevious;if(vi(e)&&(!d||e.sn!==d.sn)){const p=this.shouldLoadParts(t.details,e.end);p!==this.loadingParts&&(this.log(`LL-Part loading ${p?"ON":"OFF"} loading sn ${d==null?void 0:d.sn}->${e.sn}`),this.loadingParts=p)}if(r=Math.max(e.start,r||0),this.loadingParts&&vi(e)){const p=c.partList;if(p&&n){r>e.end&&c.fragmentHint&&(e=c.fragmentHint);const v=this.getNextPart(p,e,r);if(v>-1){const E=p[v];e=this.fragCurrent=E.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${E.index} (${v}/${p.length-1}) of ${this.fragInfo(e,!1,E)}) cc: ${e.cc} [${c.startSN}-${c.endSN}], target: ${parseFloat(r.toFixed(3))}`),this.nextLoadPosition=E.start+E.duration,this.state=Re.FRAG_LOADING;let g;return l?g=l.then(_=>!_||this.fragContextChanged(_.frag)?null:this.doFragPartsLoad(e,E,t,n)).catch(_=>this.handleFragLoadError(_)):g=this.doFragPartsLoad(e,E,t,n).catch(_=>this.handleFragLoadError(_)),this.hls.trigger(z.FRAG_LOADING,{frag:e,part:E,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):g}else if(!e.url||this.loadedEndOfParts(p,r))return Promise.resolve(null)}}if(vi(e)&&this.loadingParts)this.log(`LL-Part loading OFF after next part miss @${r.toFixed(2)}`),this.loadingParts=!1;else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${c?"["+c.startSN+"-"+c.endSN+"]":""}, target: ${parseFloat(r.toFixed(3))}`),He(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=Re.FRAG_LOADING;const u=this.config.progressive;let f;return u&&l?f=l.then(p=>!p||this.fragContextChanged(p==null?void 0:p.frag)?null:this.fragmentLoader.load(e,n)).catch(p=>this.handleFragLoadError(p)):f=Promise.all([this.fragmentLoader.load(e,u?n:void 0),l]).then(([p])=>(!u&&p&&n&&n(p),p)).catch(p=>this.handleFragLoadError(p)),this.hls.trigger(z.FRAG_LOADING,{frag:e,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):f}doFragPartsLoad(e,t,r,n){return new Promise((a,c)=>{var l;const d=[],u=(l=r.details)==null?void 0:l.partList,f=p=>{this.fragmentLoader.loadPart(e,p,n).then(v=>{d[p.index]=v;const E=v.part;this.hls.trigger(z.FRAG_LOADED,v);const g=dE(r.details,e.sn,p.index+1)||kT(u,e.sn,p.index+1);if(g)f(g);else return a({frag:e,part:E,partsLoaded:d})}).catch(c)};f(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===he.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(z.ERROR,t)}else this.hls.trigger(z.ERROR,{type:Je.OTHER_ERROR,details:he.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==Re.PARSING){!this.fragCurrent&&this.state!==Re.STOPPED&&this.state!==Re.ERROR&&(this.state=Re.IDLE);return}const{frag:r,part:n,level:a}=t,c=self.performance.now();r.stats.parsing.end=c,n&&(n.stats.parsing.end=c);const l=this.getLevelDetails(),d=l&&r.sn>l.endSN||this.shouldLoadParts(l,r.end);d!==this.loadingParts&&(this.log(`LL-Part loading ${d?"ON":"OFF"} after parsing segment ending @${r.end.toFixed(2)}`),this.loadingParts=d),this.updateLevelTiming(r,n,a,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e!=null&&e.partList){var r;const a=e.partList[0],c=a.end+(((r=e.fragmentHint)==null?void 0:r.duration)||0);if(t>=c){var n;if((this.hls.hasEnoughToStart?((n=this.media)==null?void 0:n.currentTime)||this.lastCurrentTime:this.getLoadPosition())>a.start-a.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:r}=this,{level:n,sn:a,part:c}=e;if(!(t!=null&&t[n]))return this.warn(`Levels object was unset while buffering fragment ${a} of ${this.playlistLabel()} ${n}. The current chunk will not be buffered.`),null;const l=t[n],d=l.details,u=c>-1?dE(d,a,c):null,f=u?u.fragment:PT(d,a,r);return f?(r&&r!==f&&(f.stats=r.stats),{frag:f,part:u,level:l}):null}bufferFragmentData(e,t,r,n,a){var c;if(!e||this.state!==Re.PARSING)return;const{data1:l,data2:d}=e;let u=l;if(l&&d&&(u=Fi(l,d)),!((c=u)!=null&&c.length))return;const f={type:e.type,frag:t,part:r,chunkMeta:n,parent:t.type,data:u};if(this.hls.trigger(z.BUFFER_APPENDING,f),e.dropped&&e.independent&&!r){if(a)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Lt.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const r=t.currentTime,n=Lt.bufferInfo(t,r,0),a=e.duration,c=Math.min(this.config.maxFragLookUpTolerance*2,a*.25),l=Math.max(Math.min(e.start-c,n.end-c),r+c);e.start-l>c&&this.flushMainBuffer(l,e.start)}getFwdBufferInfo(e,t){var r;const n=this.getLoadPosition();if(!He(n))return null;const a=this.lastCurrentTime>n||(r=this.media)!=null&&r.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,n,t,a)}getFwdBufferInfoAtPos(e,t,r,n){const a=Lt.bufferInfo(e,t,n);if(a.len===0&&a.nextStart!==void 0){const c=this.fragmentTracker.getBufferedFrag(t,r);if(c&&(a.nextStart<=c.end||c.gap)){const l=Math.max(Math.min(a.nextStart,c.end)-t,n);return Lt.bufferInfo(e,t,l)}}return a}getMaxBufferLength(e){const{config:t}=this;let r;return e?r=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):r=t.maxBufferLength,Math.min(r,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const r=this.config,n=Math.max(Math.min(e-t,r.maxBufferLength),t),a=Math.max(e-t*3,r.maxMaxBufferLength/2,n);return a>=n?(r.maxMaxBufferLength=a,this.warn(`Reduce max buffer length to ${a}s`),!0):!1}getAppendedFrag(e,t=ot.MAIN){var r;const n=(r=this.fragmentTracker)==null?void 0:r.getAppendedFrag(e,t);return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const r=t.fragments,n=r.length;if(!n)return null;const{config:a}=this,c=r[0].start,l=a.lowLatencyMode&&!!t.partList;let d=null;if(t.live){const p=a.initialLiveManifestSize;if(n<p)return this.warn(`Not enough fragments to start playback (have: ${n}, need: ${p})`),null;if(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<c){var u;l&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),d=this.getInitialLiveFragment(t);const v=this.hls.startPosition,E=this.hls.liveSyncPosition,g=d?(v!==-1&&v>=c?v:E)||d.start:e;this.log(`Setting startPosition to ${g} to match start frag at live edge. mainStart: ${v} liveSyncPosition: ${E} frag.start: ${(u=d)==null?void 0:u.start}`),this.startPosition=this.nextLoadPosition=g}}else e<=c&&(d=r[0]);if(!d){const p=this.loadingParts?t.partEnd:t.fragmentEnd;d=this.getFragmentAtPosition(e,p,t)}let f=this.filterReplacedPrimary(d,t);if(!f&&d){const p=d.sn-t.startSN;f=this.filterReplacedPrimary(r[p+1]||null,t)}return this.mapToInitFragWhenRequired(f)}isLoopLoading(e,t){const r=this.fragmentTracker.getState(e);return(r===Ni.OK||r===Ni.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,r,n,a){let c=null;if(e.gap&&(c=this.getNextFragment(this.nextLoadPosition,t),c&&!c.gap&&r.nextStart)){const l=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,r.nextStart,n,0);if(l!==null&&r.len+l.len>=a){const d=c.sn;return this.loopSn!==d&&(this.log(`buffer full after gaps in "${n}" playlist starting at sn: ${d}`),this.loopSn=d),null}}return this.loopSn=void 0,c}get primaryPrefetch(){if(hE(this.hls.config)){var e,t;if(!((e=this.hls.interstitialsManager)==null||(t=e.playingItem)==null)&&t.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(hE(this.hls.config)&&e.type!==ot.SUBTITLE){const r=this.hls.interstitialsManager,n=r==null?void 0:r.bufferingItem;if(n){const c=n.event;if(c){if(c.appendInPlace||Math.abs(e.start-n.start)>1||n.start===0)return null}else if(e.end<=n.start&&(t==null?void 0:t.live)===!1||e.start>n.end&&n.nextEvent&&(n.nextEvent.appendInPlace||e.start-n.end>1))return null}const a=r==null?void 0:r.playerQueue;if(a)for(let c=a.length;c--;){const l=a[c].interstitial;if(l.appendInPlace&&e.start>=l.startTime&&e.end<=l.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,r){let n=-1,a=!1,c=!0;for(let l=0,d=e.length;l<d;l++){const u=e[l];if(c=c&&!u.independent,n>-1&&r<u.start)break;const f=u.loaded;f?n=-1:(a||u.independent||c)&&u.fragment===t&&(n=l),a=f}return n}loadedEndOfParts(e,t){const r=e[e.length-1];return r&&t>r.start&&r.loaded}getInitialLiveFragment(e){const t=e.fragments,r=this.fragPrevious;let n=null;if(r){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${r.programDateTime}`),n=m3(t,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!n){const a=r.sn+1;if(a>=e.startSN&&a<=e.endSN){const c=t[a-e.startSN];r.cc===c.cc&&(n=c,this.log(`Live playlist, switching playlist, load frag with next SN: ${n.sn}`))}n||(n=AT(e,r.cc,r.end),n&&this.log(`Live playlist, switching playlist, load frag with same CC: ${n.sn}`))}}else{const a=this.hls.liveSyncPosition;a!==null&&(n=this.getFragmentAtPosition(a,this.bitrateTest?e.fragmentEnd:e.edge,e))}return n}getFragmentAtPosition(e,t,r){const{config:n}=this;let{fragPrevious:a}=this,{fragments:c,endSN:l}=r;const{fragmentHint:d}=r,{maxFragLookUpTolerance:u}=n,f=r.partList,p=!!(this.loadingParts&&f!=null&&f.length&&d);p&&d&&!this.bitrateTest&&f[f.length-1].fragment.sn===d.sn&&(c=c.concat(d),l=d.sn);let v;if(e<t){var E;const g=e<this.lastCurrentTime||e>t-u||(E=this.media)!=null&&E.paused||!this.startFragRequested?0:u;v=Co(a,c,e,g)}else v=c[c.length-1];if(v){const g=v.sn-r.startSN,_=this.fragmentTracker.getState(v);if((_===Ni.OK||_===Ni.PARTIAL&&v.gap)&&(a=v),a&&v.sn===a.sn&&(!p||f[0].fragment.sn>v.sn||!r.live&&!p)&&a&&v.level===a.level){const m=c[g+1];v.sn<l&&this.fragmentTracker.getState(m)!==Ni.OK?v=m:v=null}}return v}alignPlaylists(e,t,r){const n=e.fragments.length;if(!n)return this.warn("No fragments in live playlist"),0;const a=e.fragmentStart,c=!t,l=e.alignedSliding&&He(a);if(c||!l&&!a){Q3(r,e);const d=e.fragmentStart;return this.log(`Live playlist sliding: ${d.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${n}`),d}return a}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let r=this.startPosition;r<t&&(r=-1);const n=this.timelineOffset;if(r===-1){const a=this.startTimeOffset!==null,c=a?this.startTimeOffset:e.startTimeOffset;c!==null&&He(c)?(r=t+c,c<0&&(r+=e.edge),r=Math.min(Math.max(t,r),t+e.totalduration),this.log(`Setting startPosition to ${r} for start time offset ${c} found in ${a?"multivariant":"media"} playlist`),this.startPosition=r):e.live?(r=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${r}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=r=0),this.lastCurrentTime=r+n}this.nextLoadPosition=r+n}getLoadPosition(){var e;const{media:t}=this;let r=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&t?r=t.currentTime:this.nextLoadPosition>=0&&(r=this.nextLoadPosition),r}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&vi(e)&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==Re.FRAG_LOADING_WAITING_RETRY)&&(this.state=Re.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const g=this.getCurrentContext(t.chunkMeta);g&&(t.frag=g.frag)}const r=t.frag;if(!r||r.type!==e||!this.levels)return;if(this.fragContextChanged(r)){var n;this.warn(`Frag load error must match current frag to retry ${r.url} > ${(n=this.fragCurrent)==null?void 0:n.url}`);return}const a=t.details===he.FRAG_GAP;a&&this.fragmentTracker.fragBuffered(r,!0);const c=t.errorAction,{action:l,flags:d,retryCount:u=0,retryConfig:f}=c||{},p=!!c&&!!f,v=p&&l===jr.RetryRequest,E=p&&!c.resolved&&d===Xi.MoveAllAlternatesMatchingHost;if(!v&&E&&vi(r)&&!r.endList)this.resetFragmentErrors(e),this.treatAsGap(r),c.resolved=!0;else if((v||E)&&u<f.maxNumRetry){this.resetStartWhenNotLoaded(this.levelLastLoaded);const g=Tv(f,u);this.warn(`Fragment ${r.sn} of ${e} ${r.level} errored with ${t.details}, retrying loading ${u+1}/${f.maxNumRetry} in ${g}ms`),c.resolved=!0,this.retryDate=self.performance.now()+g,this.state=Re.FRAG_LOADING_WAITING_RETRY}else if(f&&c)if(this.resetFragmentErrors(e),u<f.maxNumRetry)!a&&l!==jr.RemoveAlternatePermanently&&(c.resolved=!0);else{this.warn(`${t.details} reached or exceeded max retry (${u})`);return}else l===jr.SendAlternateToPenaltyBox?this.state=Re.WAITING_LEVEL:this.state=Re.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===Re.PARSING||this.state===Re.PARSED){const t=e.frag,r=e.parent,n=this.getFwdBufferInfo(this.mediaBuffer,r),a=n&&n.len>.5;a&&this.reduceMaxBufferLength(n.len,(t==null?void 0:t.duration)||10);const c=!a;return c&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${r} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),c}return!1}resetFragmentErrors(e){e===ot.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==Re.STOPPED&&(this.state=Re.IDLE)}afterBufferFlushed(e,t,r){if(!e)return;const n=Lt.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,n,r),this.state===Re.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==Re.STOPPED&&(this.state=Re.IDLE)}resetStartWhenNotLoaded(e){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const t=e?e.details:null;t!=null&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of ${this.playlistLabel()} ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,r,n){const a=r.details;if(!a){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((l,d)=>{const u=e.elementaryStreams[d];if(u){const f=u.endPTS-u.startPTS;if(f<=0)return this.warn(`Could not parse fragment ${e.sn} ${d} duration reliably (${f})`),l||!1;const p=n?0:OT(a,e,u.startPTS,u.endPTS,u.startDTS,u.endDTS);return this.hls.trigger(z.LEVEL_PTS_UPDATED,{details:a,level:r,drift:p,type:d,frag:e,start:u.startPTS,end:u.endPTS}),!0}return l},!1)){var c;if(r.fragmentError===0&&this.treatAsGap(e,r),((c=this.transmuxer)==null?void 0:c.error)===null){const l=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(l.message),this.hls.trigger(z.ERROR,{type:Je.MEDIA_ERROR,details:he.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${r.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=Re.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(z.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===ot.MAIN?"level":"track"}fragInfo(e,t=!0,r){var n,a;return`${this.playlistLabel()} ${e.level} (${r?"part":"frag"}:[${((n=t&&!r?e.startPTS:(r||e).start)!=null?n:NaN).toFixed(3)}-${((a=t&&!r?e.endPTS:(r||e).end)!=null?a:NaN).toFixed(3)}]${r&&e.type==="main"?"INDEPENDENT="+(r.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function hE(i){return!!i.interstitialsController&&i.enableInterstitialPlayback!==!1}class J3{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let r;if(e.length)e.length===1?r=e[0]:r=eN(e,t);else return new Uint8Array(0);return this.reset(),r}reset(){this.chunks.length=0,this.dataLength=0}}function eN(i,e){const t=new Uint8Array(e);let r=0;for(let n=0;n<i.length;n++){const a=i[n];t.set(a,r),r+=a.length}return t}var pE={exports:{}},mE;function tN(){return mE||(mE=1,function(i){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function n(d,u,f){this.fn=d,this.context=u,this.once=f||!1}function a(d,u,f,p,v){if(typeof f!="function")throw new TypeError("The listener must be a function");var E=new n(f,p||d,v),g=t?t+u:u;return d._events[g]?d._events[g].fn?d._events[g]=[d._events[g],E]:d._events[g].push(E):(d._events[g]=E,d._eventsCount++),d}function c(d,u){--d._eventsCount===0?d._events=new r:delete d._events[u]}function l(){this._events=new r,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],u,f;if(this._eventsCount===0)return d;for(f in u=this._events)e.call(u,f)&&d.push(t?f.slice(1):f);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(u)):d},l.prototype.listeners=function(d){var u=t?t+d:d,f=this._events[u];if(!f)return[];if(f.fn)return[f.fn];for(var p=0,v=f.length,E=new Array(v);p<v;p++)E[p]=f[p].fn;return E},l.prototype.listenerCount=function(d){var u=t?t+d:d,f=this._events[u];return f?f.fn?1:f.length:0},l.prototype.emit=function(d,u,f,p,v,E){var g=t?t+d:d;if(!this._events[g])return!1;var _=this._events[g],m=arguments.length,y,b;if(_.fn){switch(_.once&&this.removeListener(d,_.fn,void 0,!0),m){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,u),!0;case 3:return _.fn.call(_.context,u,f),!0;case 4:return _.fn.call(_.context,u,f,p),!0;case 5:return _.fn.call(_.context,u,f,p,v),!0;case 6:return _.fn.call(_.context,u,f,p,v,E),!0}for(b=1,y=new Array(m-1);b<m;b++)y[b-1]=arguments[b];_.fn.apply(_.context,y)}else{var R=_.length,T;for(b=0;b<R;b++)switch(_[b].once&&this.removeListener(d,_[b].fn,void 0,!0),m){case 1:_[b].fn.call(_[b].context);break;case 2:_[b].fn.call(_[b].context,u);break;case 3:_[b].fn.call(_[b].context,u,f);break;case 4:_[b].fn.call(_[b].context,u,f,p);break;default:if(!y)for(T=1,y=new Array(m-1);T<m;T++)y[T-1]=arguments[T];_[b].fn.apply(_[b].context,y)}}return!0},l.prototype.on=function(d,u,f){return a(this,d,u,f,!1)},l.prototype.once=function(d,u,f){return a(this,d,u,f,!0)},l.prototype.removeListener=function(d,u,f,p){var v=t?t+d:d;if(!this._events[v])return this;if(!u)return c(this,v),this;var E=this._events[v];if(E.fn)E.fn===u&&(!p||E.once)&&(!f||E.context===f)&&c(this,v);else{for(var g=0,_=[],m=E.length;g<m;g++)(E[g].fn!==u||p&&!E[g].once||f&&E[g].context!==f)&&_.push(E[g]);_.length?this._events[v]=_.length===1?_[0]:_:c(this,v)}return this},l.prototype.removeAllListeners=function(d){var u;return d?(u=t?t+d:d,this._events[u]&&c(this,u)):(this._events=new r,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=t,l.EventEmitter=l,i.exports=l}(pE)),pE.exports}var rN=tN(),FT=LM(rN);const cf="1.6.5",Ao={};function iN(){return typeof __HLS_WORKER_BUNDLE__=="function"}function nN(){const i=Ao[cf];if(i)return i.clientCount++,i;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),r={worker:new self.Worker(t),objectURL:t,clientCount:1};return Ao[cf]=r,r}function sN(i){const e=Ao[i];if(e)return e.clientCount++,e;const t=new self.URL(i,self.location.href).href,r={worker:new self.Worker(t),scriptURL:t,clientCount:1};return Ao[i]=r,r}function aN(i){const e=Ao[i||cf];if(e&&e.clientCount--===1){const{worker:t,objectURL:r}=e;delete Ao[i||cf],r&&self.URL.revokeObjectURL(r),t.terminate()}}function UT(i,e){return e+10<=i.length&&i[e]===51&&i[e+1]===68&&i[e+2]===73&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128}function Dv(i,e){return e+10<=i.length&&i[e]===73&&i[e+1]===68&&i[e+2]===51&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128}function Of(i,e){let t=0;return t=(i[e]&127)<<21,t|=(i[e+1]&127)<<14,t|=(i[e+2]&127)<<7,t|=i[e+3]&127,t}function xl(i,e){const t=e;let r=0;for(;Dv(i,e);){r+=10;const n=Of(i,e+6);r+=n,UT(i,e+10)&&(r+=10),e+=r}if(r>0)return i.subarray(t,t+r)}function oN(i,e,t,r){const n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],a=e[t+2],c=a>>2&15;if(c>12){const E=new Error(`invalid ADTS sampling index:${c}`);i.emit(z.ERROR,z.ERROR,{type:Je.MEDIA_ERROR,details:he.FRAG_PARSING_ERROR,fatal:!0,error:E,reason:E.message});return}const l=(a>>6&3)+1,d=e[t+3]>>6&3|(a&1)<<2,u="mp4a.40."+l,f=n[c];let p=c;(l===5||l===29)&&(p-=3);const v=[l<<3|(p&14)>>1,(p&1)<<7|d<<3];return Gt.log(`manifest codec:${r}, parsed codec:${u}, channels:${d}, rate:${f} (ADTS object type:${l} sampling index:${c})`),{config:v,samplerate:f,channelCount:d,codec:u,parsedCodec:u,manifestCodec:r}}function $T(i,e){return i[e]===255&&(i[e+1]&246)===240}function jT(i,e){return i[e+1]&1?7:9}function Lv(i,e){return(i[e+3]&3)<<11|i[e+4]<<3|(i[e+5]&224)>>>5}function cN(i,e){return e+5<i.length}function lf(i,e){return e+1<i.length&&$T(i,e)}function lN(i,e){return cN(i,e)&&$T(i,e)&&Lv(i,e)<=i.length-e}function uN(i,e){if(lf(i,e)){const t=jT(i,e);if(e+t>=i.length)return!1;const r=Lv(i,e);if(r<=t)return!1;const n=e+r;return n===i.length||lf(i,n)}return!1}function zT(i,e,t,r,n){if(!i.samplerate){const a=oN(e,t,r,n);if(!a)return;Yt(i,a)}}function GT(i){return 1024*9e4/i}function dN(i,e){const t=jT(i,e);if(e+t<=i.length){const r=Lv(i,e)-t;if(r>0)return{headerLength:t,frameLength:r}}}function HT(i,e,t,r,n){const a=GT(i.samplerate),c=r+n*a,l=dN(e,t);let d;if(l){const{frameLength:f,headerLength:p}=l,v=p+f,E=Math.max(0,t+v-e.length);E?(d=new Uint8Array(v-p),d.set(e.subarray(t+p,e.length),0)):d=e.subarray(t+p,t+v);const g={unit:d,pts:c};return E||i.samples.push(g),{sample:g,length:v,missing:E}}const u=e.length-t;return d=new Uint8Array(u),d.set(e.subarray(t,e.length),0),{sample:{unit:d,pts:c},length:u,missing:-1}}function fN(i,e){return Dv(i,e)&&Of(i,e+6)+10<=i.length-e}function hN(i){return i instanceof ArrayBuffer?i:i.byteOffset==0&&i.byteLength==i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer}function Cm(i,e=0,t=1/0){return pN(i,e,t,Uint8Array)}function pN(i,e,t,r){const n=mN(i);let a=1;"BYTES_PER_ELEMENT"in r&&(a=r.BYTES_PER_ELEMENT);const c=gN(i)?i.byteOffset:0,l=(c+i.byteLength)/a,d=(c+e)/a,u=Math.floor(Math.max(0,Math.min(d,l))),f=Math.floor(Math.min(u+Math.max(t,0),l));return new r(n,u,f-u)}function mN(i){return i instanceof ArrayBuffer?i:i.buffer}function gN(i){return i&&i.buffer instanceof ArrayBuffer&&i.byteLength!==void 0&&i.byteOffset!==void 0}function vN(i){const e={key:i.type,description:"",data:"",mimeType:null,pictureType:null},t=3;if(i.size<2)return;if(i.data[0]!==t){console.log("Ignore frame with unrecognized character encoding");return}const r=i.data.subarray(1).indexOf(0);if(r===-1)return;const n=_i(Cm(i.data,1,r)),a=i.data[2+r],c=i.data.subarray(3+r).indexOf(0);if(c===-1)return;const l=_i(Cm(i.data,3+r,c));let d;return n==="-->"?d=_i(Cm(i.data,4+r+c)):d=hN(i.data.subarray(4+r+c)),e.mimeType=n,e.pictureType=a,e.description=l,e.data=d,e}function yN(i){if(i.size<2)return;const e=_i(i.data,!0),t=new Uint8Array(i.data.subarray(e.length+1));return{key:i.type,info:e,data:t.buffer}}function bN(i){if(i.size<2)return;if(i.type==="TXXX"){let t=1;const r=_i(i.data.subarray(t),!0);t+=r.length+1;const n=_i(i.data.subarray(t));return{key:i.type,info:r,data:n}}const e=_i(i.data.subarray(1));return{key:i.type,info:"",data:e}}function _N(i){if(i.type==="WXXX"){if(i.size<2)return;let t=1;const r=_i(i.data.subarray(t),!0);t+=r.length+1;const n=_i(i.data.subarray(t));return{key:i.type,info:r,data:n}}const e=_i(i.data);return{key:i.type,info:"",data:e}}function SN(i){return i.type==="PRIV"?yN(i):i.type[0]==="W"?_N(i):i.type==="APIC"?vN(i):bN(i)}function EN(i){const e=String.fromCharCode(i[0],i[1],i[2],i[3]),t=Of(i,4),r=10;return{type:e,size:t,data:i.subarray(r,r+t)}}const ad=10,RN=10;function wN(i){let e=0;const t=[];for(;Dv(i,e);){const r=Of(i,e+6);i[e+5]>>6&1&&(e+=ad),e+=ad;const n=e+r;for(;e+RN<n;){const a=EN(i.subarray(e)),c=SN(a);c&&t.push(c),e+=a.size+ad}UT(i,e)&&(e+=ad)}return t}function TN(i){return i&&i.key==="PRIV"&&i.info==="com.apple.streaming.transportStreamTimestamp"}function CN(i){if(i.data.byteLength===8){const e=new Uint8Array(i.data),t=e[3]&1;let r=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return r/=45,t&&(r+=4772185884e-2),Math.round(r)}}function Ov(i){const e=wN(i);for(let t=0;t<e.length;t++){const r=e[t];if(TN(r))return CN(r)}}let xo=function(i){return i.audioId3="org.id3",i.dateRange="com.apple.quicktime.HLS",i.emsg="https://aomedia.org/emsg/ID3",i.misbklv="urn:misb:KLV:bin:1910.1",i}({});function mn(i="",e=9e4){return{type:i,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class Iv{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,r,n){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,r){}demux(e,t){this.cachedData&&(e=Fi(this.cachedData,e),this.cachedData=null);let r=xl(e,0),n=r?r.length:0,a;const c=this._audioTrack,l=this._id3Track,d=r?Ov(r):void 0,u=e.length;for((this.basePTS===null||this.frameIndex===0&&He(d))&&(this.basePTS=AN(d,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),r&&r.length>0&&l.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:xo.audioId3,duration:Number.POSITIVE_INFINITY});n<u;){if(this.canParse(e,n)){const f=this.appendFrame(c,e,n);f?(this.frameIndex++,this.lastPTS=f.sample.pts,n+=f.length,a=n):n=u}else fN(e,n)?(r=xl(e,n),l.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:xo.audioId3,duration:Number.POSITIVE_INFINITY}),n+=r.length,a=n):n++;if(n===u&&a!==u){const f=e.slice(a);this.cachedData?this.cachedData=Fi(this.cachedData,f):this.cachedData=f}}return{audioTrack:c,videoTrack:mn(),id3Track:l,textTrack:mn()}}demuxSampleAes(e,t,r){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:mn(),id3Track:this._id3Track,textTrack:mn()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const AN=(i,e,t)=>{if(He(i))return i*90;const r=t?t.baseTime*9e4/t.timescale:0;return e*9e4+r};let od=null;const xN=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],DN=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],LN=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],ON=[0,1,1,4];function VT(i,e,t,r,n){if(t+24>e.length)return;const a=KT(e,t);if(a&&t+a.frameLength<=e.length){const c=a.samplesPerFrame*9e4/a.sampleRate,l=r+n*c,d={unit:e.subarray(t,t+a.frameLength),pts:l,dts:l};return i.config=[],i.channelCount=a.channelCount,i.samplerate=a.sampleRate,i.samples.push(d),{sample:d,length:a.frameLength,missing:0}}}function KT(i,e){const t=i[e+1]>>3&3,r=i[e+1]>>1&3,n=i[e+2]>>4&15,a=i[e+2]>>2&3;if(t!==1&&n!==0&&n!==15&&a!==3){const c=i[e+2]>>1&1,l=i[e+3]>>6,d=t===3?3-r:r===3?3:4,u=xN[d*14+n-1]*1e3,f=DN[(t===3?0:t===2?1:2)*3+a],p=l===3?1:2,v=LN[t][r],E=ON[r],g=v*8*E,_=Math.floor(v*u/f+c)*E;if(od===null){const m=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);od=m?parseInt(m[1]):0}return od&&od<=87&&r===2&&u>=224e3&&l===0&&(i[e+3]=i[e+3]|128),{sampleRate:f,channelCount:p,frameLength:_,samplesPerFrame:g}}}function Pv(i,e){return i[e]===255&&(i[e+1]&224)===224&&(i[e+1]&6)!==0}function qT(i,e){return e+1<i.length&&Pv(i,e)}function IN(i,e){return Pv(i,e)&&4<=i.length-e}function YT(i,e){if(e+1<i.length&&Pv(i,e)){const t=KT(i,e);let r=4;t!=null&&t.frameLength&&(r=t.frameLength);const n=e+r;return n===i.length||qT(i,n)}return!1}class PN extends Iv{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,r,n){super.resetInitSegment(e,t,r,n),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:n,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const r=xl(e,0);let n=(r==null?void 0:r.length)||0;if(YT(e,n))return!1;for(let a=e.length;n<a;n++)if(uN(e,n))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return lN(e,t)}appendFrame(e,t,r){zT(e,this.observer,t,r,e.manifestCodec);const n=HT(e,t,r,this.basePTS,this.frameIndex);if(n&&n.missing===0)return n}}const WT=(i,e)=>{let t=0,r=5;e+=r;const n=new Uint32Array(1),a=new Uint32Array(1),c=new Uint8Array(1);for(;r>0;){c[0]=i[e];const l=Math.min(r,8),d=8-l;a[0]=4278190080>>>24+d<<d,n[0]=(c[0]&a[0])>>d,t=t?t<<l|n[0]:n[0],e+=1,r-=l}return t};class kN extends Iv{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,r,n){super.resetInitSegment(e,t,r,n),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:n,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,r){const n=XT(e,t,r,this.basePTS,this.frameIndex);if(n!==-1)return{sample:e.samples[e.samples.length-1],length:n,missing:0}}static probe(e){if(!e)return!1;const t=xl(e,0);if(!t)return!1;const r=t.length;return e[r]===11&&e[r+1]===119&&Ov(t)!==void 0&&WT(e,r)<16}}function XT(i,e,t,r,n){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const a=e[t+4]>>6;if(a>=3)return-1;const c=[48e3,44100,32e3][a],l=e[t+4]&63,d=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][l*3+a]*2;if(t+d>e.length)return-1;const u=e[t+6]>>5;let f=0;u===2?f+=2:(u&1&&u!==1&&(f+=2),u&4&&(f+=2));const p=(e[t+6]<<8|e[t+7])>>12-f&1,v=[2,1,2,3,3,4,4,5][u]+p,E=e[t+5]>>3,g=e[t+5]&7,_=new Uint8Array([a<<6|E<<1|g>>2,(g&3)<<6|u<<3|p<<2|l>>4,l<<4&224]),m=1536/c*9e4,y=r+n*m,b=e.subarray(t,t+d);return i.config=_,i.channelCount=v,i.samplerate=c,i.samples.push({unit:b,pts:y}),d}class MN extends Iv{resetInitSegment(e,t,r,n){super.resetInitSegment(e,t,r,n),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:n,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=xl(e,0);let r=(t==null?void 0:t.length)||0;if(t&&e[r]===11&&e[r+1]===119&&Ov(t)!==void 0&&WT(e,r)<=16)return!1;for(let n=e.length;r<n;r++)if(YT(e,r))return Gt.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return IN(e,t)}appendFrame(e,t,r){if(this.basePTS!==null)return VT(e,t,r,this.basePTS,this.frameIndex)}}const NN=/\/emsg[-/]ID3/i;class BN{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,r,n){const a=this.videoTrack=mn("video",1),c=this.audioTrack=mn("audio",1),l=this.txtTrack=mn("text",1);if(this.id3Track=mn("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const d=yT(e);if(d.video){const{id:u,timescale:f,codec:p,supplemental:v}=d.video;a.id=u,a.timescale=l.timescale=f,a.codec=p,a.supplemental=v}if(d.audio){const{id:u,timescale:f,codec:p}=d.audio;c.id=u,c.timescale=f,c.codec=p}l.id=mT.text,a.sampleDuration=0,a.duration=c.duration=n}resetContiguity(){this.remainderData=null}static probe(e){return kM(e)}demux(e,t){this.timeOffset=t;let r=e;const n=this.videoTrack,a=this.txtTrack;if(this.config.progressive){this.remainderData&&(r=Fi(this.remainderData,e));const l=jM(r);this.remainderData=l.remainder,n.samples=l.valid||new Uint8Array}else n.samples=r;const c=this.extractID3Track(n,t);return a.samples=KS(t,n),{videoTrack:n,audioTrack:this.audioTrack,id3Track:c,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,r=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const n=this.extractID3Track(t,this.timeOffset);return r.samples=KS(e,t),{videoTrack:t,audioTrack:mn(),id3Track:n,textTrack:mn()}}extractID3Track(e,t){const r=this.id3Track;if(e.samples.length){const n=nt(e.samples,["emsg"]);n&&n.forEach(a=>{const c=GM(a);if(NN.test(c.schemeIdUri)){const l=gE(c,t);let d=c.eventDuration===4294967295?Number.POSITIVE_INFINITY:c.eventDuration/c.timeScale;d<=.001&&(d=Number.POSITIVE_INFINITY);const u=c.payload;r.samples.push({data:u,len:u.byteLength,dts:l,pts:l,type:xo.emsg,duration:d})}else if(this.config.enableEmsgKLVMetadata&&c.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const l=gE(c,t);r.samples.push({data:c.payload,len:c.payload.byteLength,dts:l,pts:l,type:xo.misbklv,duration:Number.POSITIVE_INFINITY})}})}return r}demuxSampleAes(e,t,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function gE(i,e){return He(i.presentationTime)?i.presentationTime/i.timeScale:e+i.presentationTimeDelta/i.timeScale}class FN{constructor(e,t,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new Cv(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,Ts.cbc)}decryptAacSample(e,t,r){const n=e[t].unit;if(n.length<=16)return;const a=n.subarray(16,n.length-n.length%16),c=a.buffer.slice(a.byteOffset,a.byteOffset+a.length);this.decryptBuffer(c).then(l=>{const d=new Uint8Array(l);n.set(d,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,r)})}decryptAacSamples(e,t,r){for(;;t++){if(t>=e.length){r();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,r),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,r=new Int8Array(t);let n=0;for(let a=32;a<e.length-16;a+=160,n+=16)r.set(e.subarray(a,a+16),n);return r}getAvcDecryptedUnit(e,t){const r=new Uint8Array(t);let n=0;for(let a=32;a<e.length-16;a+=160,n+=16)e.set(r.subarray(n,n+16),a);return e}decryptAvcSample(e,t,r,n,a){const c=_T(a.data),l=this.getAvcEncryptedData(c);this.decryptBuffer(l.buffer).then(d=>{a.data=this.getAvcDecryptedUnit(c,d),this.decrypter.isSync()||this.decryptAvcSamples(e,t,r+1,n)})}decryptAvcSamples(e,t,r,n){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,r=0){if(t>=e.length){n();return}const a=e[t].units;for(;!(r>=a.length);r++){const c=a[r];if(!(c.data.length<=48||c.type!==1&&c.type!==5)&&(this.decryptAvcSample(e,t,r,n,c),!this.decrypter.isSync()))return}}}}class QT{constructor(){this.VideoSample=null}createVideoSample(e,t,r){return{key:e,frame:!1,pts:t,dts:r,units:[],length:0}}getLastNalUnit(e){var t;let r=this.VideoSample,n;if((!r||r.units.length===0)&&(r=e[e.length-1]),(t=r)!=null&&t.units){const a=r.units;n=a[a.length-1]}return n}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const r=t.samples,n=r.length;if(n){const a=r[n-1];e.pts=a.pts,e.dts=a.dts}else{t.dropped++;return}}t.samples.push(e)}}parseNALu(e,t,r){const n=t.byteLength;let a=e.naluState||0;const c=a,l=[];let d=0,u,f,p,v=-1,E=0;for(a===-1&&(v=0,E=this.getNALuType(t,0),a=0,d=1);d<n;){if(u=t[d++],!a){a=u?0:1;continue}if(a===1){a=u?0:2;continue}if(!u)a=3;else if(u===1){if(f=d-a-1,v>=0){const g={data:t.subarray(v,f),type:E};l.push(g)}else{const g=this.getLastNalUnit(e.samples);g&&(c&&d<=4-c&&g.state&&(g.data=g.data.subarray(0,g.data.byteLength-c)),f>0&&(g.data=Fi(g.data,t.subarray(0,f)),g.state=0))}d<n?(p=this.getNALuType(t,d),v=d,E=p,a=0):a=-1}else a=0}if(v>=0&&a>=0){const g={data:t.subarray(v,n),type:E,state:a};l.push(g)}if(l.length===0){const g=this.getLastNalUnit(e.samples);g&&(g.data=Fi(g.data,t))}return e.naluState=a,l}}class gl{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,r=e.byteLength-t,n=new Uint8Array(4),a=Math.min(4,t);if(a===0)throw new Error("no bytes available");n.set(e.subarray(r,r+a)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=a*8,this.bytesAvailable-=a}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const r=this.word>>>32-t;if(e>32&&Gt.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?r<<t|this.readBits(t):r}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class vE extends QT{parsePES(e,t,r,n){const a=this.parseNALu(e,r.data,n);let c=this.VideoSample,l,d=!1;r.data=null,c&&a.length&&!e.audFound&&(this.pushAccessUnit(c,e),c=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),a.forEach(u=>{var f,p;switch(u.type){case 1:{let _=!1;l=!0;const m=u.data;if(d&&m.length>4){const y=this.readSliceType(m);(y===2||y===4||y===7||y===9)&&(_=!0)}if(_){var v;(v=c)!=null&&v.frame&&!c.key&&(this.pushAccessUnit(c,e),c=this.VideoSample=null)}c||(c=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),c.frame=!0,c.key=_;break}case 5:l=!0,(f=c)!=null&&f.frame&&!c.key&&(this.pushAccessUnit(c,e),c=this.VideoSample=null),c||(c=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),c.key=!0,c.frame=!0;break;case 6:{l=!0,wv(u.data,1,r.pts,t.samples);break}case 7:{var E,g;l=!0,d=!0;const _=u.data,m=this.readSPS(_);if(!e.sps||e.width!==m.width||e.height!==m.height||((E=e.pixelRatio)==null?void 0:E[0])!==m.pixelRatio[0]||((g=e.pixelRatio)==null?void 0:g[1])!==m.pixelRatio[1]){e.width=m.width,e.height=m.height,e.pixelRatio=m.pixelRatio,e.sps=[_];const y=_.subarray(1,4);let b="avc1.";for(let R=0;R<3;R++){let T=y[R].toString(16);T.length<2&&(T="0"+T),b+=T}e.codec=b}break}case 8:l=!0,e.pps=[u.data];break;case 9:l=!0,e.audFound=!0,(p=c)!=null&&p.frame&&(this.pushAccessUnit(c,e),c=null),c||(c=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;case 12:l=!0;break;default:l=!1;break}c&&l&&c.units.push(u)}),n&&c&&(this.pushAccessUnit(c,e),this.VideoSample=null)}getNALuType(e,t){return e[t]&31}readSliceType(e){const t=new gl(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let r=8,n=8,a;for(let c=0;c<e;c++)n!==0&&(a=t.readEG(),n=(r+a+256)%256),r=n===0?r:n}readSPS(e){const t=new gl(e);let r=0,n=0,a=0,c=0,l,d,u;const f=t.readUByte.bind(t),p=t.readBits.bind(t),v=t.readUEG.bind(t),E=t.readBoolean.bind(t),g=t.skipBits.bind(t),_=t.skipEG.bind(t),m=t.skipUEG.bind(t),y=this.skipScalingList.bind(this);f();const b=f();if(p(5),g(3),f(),m(),b===100||b===110||b===122||b===244||b===44||b===83||b===86||b===118||b===128){const L=v();if(L===3&&g(1),m(),m(),g(1),E())for(d=L!==3?8:12,u=0;u<d;u++)E()&&(u<6?y(16,t):y(64,t))}m();const R=v();if(R===0)v();else if(R===1)for(g(1),_(),_(),l=v(),u=0;u<l;u++)_();m(),g(1);const T=v(),w=v(),C=p(1);C===0&&g(1),g(1),E()&&(r=v(),n=v(),a=v(),c=v());let A=[1,1];if(E()&&E())switch(f()){case 1:A=[1,1];break;case 2:A=[12,11];break;case 3:A=[10,11];break;case 4:A=[16,11];break;case 5:A=[40,33];break;case 6:A=[24,11];break;case 7:A=[20,11];break;case 8:A=[32,11];break;case 9:A=[80,33];break;case 10:A=[18,11];break;case 11:A=[15,11];break;case 12:A=[64,33];break;case 13:A=[160,99];break;case 14:A=[4,3];break;case 15:A=[3,2];break;case 16:A=[2,1];break;case 255:{A=[f()<<8|f(),f()<<8|f()];break}}return{width:Math.ceil((T+1)*16-r*2-n*2),height:(2-C)*(w+1)*16-(C?2:4)*(a+c),pixelRatio:A}}}class yE extends QT{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,r,n){const a=this.parseNALu(e,r.data,n);let c=this.VideoSample,l,d=!1;r.data=null,c&&a.length&&!e.audFound&&(this.pushAccessUnit(c,e),c=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),a.forEach(u=>{var f,p;switch(u.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:c||(c=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),c.frame=!0,l=!0;break;case 16:case 17:case 18:case 21:if(l=!0,d){var v;(v=c)!=null&&v.frame&&!c.key&&(this.pushAccessUnit(c,e),c=this.VideoSample=null)}c||(c=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),c.key=!0,c.frame=!0;break;case 19:case 20:l=!0,(f=c)!=null&&f.frame&&!c.key&&(this.pushAccessUnit(c,e),c=this.VideoSample=null),c||(c=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),c.key=!0,c.frame=!0;break;case 39:l=!0,wv(u.data,2,r.pts,t.samples);break;case 32:l=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=Yt(e.params,this.readVPS(u.data)),this.initVPS=u.data),e.vps=[u.data];break;case 33:if(l=!0,d=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],u.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const E=this.readSPS(u.data);e.width=E.width,e.height=E.height,e.pixelRatio=E.pixelRatio,e.codec=E.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const g in E.params)e.params[g]=E.params[g]}this.pushParameterSet(e.sps,u.data,e.vps),c||(c=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),c.key=!0;break;case 34:if(l=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const E=this.readPPS(u.data);for(const g in E)e.params[g]=E[g]}this.pushParameterSet(e.pps,u.data,e.vps)}break;case 35:l=!0,e.audFound=!0,(p=c)!=null&&p.frame&&(this.pushAccessUnit(c,e),c=null),c||(c=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;default:l=!1;break}c&&l&&c.units.push(u)}),n&&c&&(this.pushAccessUnit(c,e),this.VideoSample=null)}pushParameterSet(e,t,r){(r&&r[0]===this.initVPS||!r&&!e.length)&&e.push(t)}getNALuType(e,t){return(e[t]&126)>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let r=0;for(let n=0;n<e.byteLength;n++)n>=2&&e[n]===3&&e[n-1]===0&&e[n-2]===0||(t[r]=e[n],r++);return new Uint8Array(t.buffer,0,r)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new gl(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const r=t.readBits(3),n=t.readBoolean();return{numTemporalLayers:r+1,temporalIdNested:n}}readSPS(e){const t=new gl(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const r=t.readBits(3);t.readBoolean();const n=t.readBits(2),a=t.readBoolean(),c=t.readBits(5),l=t.readUByte(),d=t.readUByte(),u=t.readUByte(),f=t.readUByte(),p=t.readUByte(),v=t.readUByte(),E=t.readUByte(),g=t.readUByte(),_=t.readUByte(),m=t.readUByte(),y=t.readUByte(),b=[],R=[];for(let Se=0;Se<r;Se++)b.push(t.readBoolean()),R.push(t.readBoolean());if(r>0)for(let Se=r;Se<8;Se++)t.readBits(2);for(let Se=0;Se<r;Se++)b[Se]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),R[Se]&&t.readUByte();t.readUEG();const T=t.readUEG();T==3&&t.skipBits(1);const w=t.readUEG(),C=t.readUEG(),A=t.readBoolean();let L=0,D=0,P=0,k=0;A&&(L+=t.readUEG(),D+=t.readUEG(),P+=t.readUEG(),k+=t.readUEG());const M=t.readUEG(),I=t.readUEG(),F=t.readUEG(),$=t.readBoolean();for(let Se=$?0:r;Se<=r;Se++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let Se=0;Se<4;Se++)for(let Te=0;Te<(Se===3?2:6);Te++)if(!t.readBoolean())t.readUEG();else{const ge=Math.min(64,1<<4+(Se<<1));Se>1&&t.readEG();for(let Ue=0;Ue<ge;Ue++)t.readEG()}t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const N=t.readUEG();let U=0;for(let Se=0;Se<N;Se++){let Te=!1;if(Se!==0&&(Te=t.readBoolean()),Te){Se===N&&t.readUEG(),t.readBoolean(),t.readUEG();let ge=0;for(let Ue=0;Ue<=U;Ue++){const je=t.readBoolean();let Ie=!1;je||(Ie=t.readBoolean()),(je||Ie)&&ge++}U=ge}else{const ge=t.readUEG(),Ue=t.readUEG();U=ge+Ue;for(let je=0;je<ge;je++)t.readUEG(),t.readBoolean();for(let je=0;je<Ue;je++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const Se=t.readUEG();for(let Te=0;Te<Se;Te++){for(let ge=0;ge<F+4;ge++)t.readBits(1);t.readBits(1)}}let V=0,J=1,j=1,q=!0,Z=1,X=0;t.readBoolean(),t.readBoolean();let Y=!1;if(t.readBoolean()){if(t.readBoolean()){const Se=t.readUByte(),Te=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],ge=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];Se>0&&Se<16?(J=Te[Se-1],j=ge[Se-1]):Se===255&&(J=t.readBits(16),j=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),Y=t.readBoolean(),Y&&(L+=t.readUEG(),D+=t.readUEG(),P+=t.readUEG(),k+=t.readUEG()),t.readBoolean()&&(Z=t.readBits(32),X=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const Se=t.readBoolean(),Te=t.readBoolean();let ge=!1;(Se||Te)&&(ge=t.readBoolean(),ge&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),ge&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let Ue=0;Ue<=r;Ue++){q=t.readBoolean();const je=q||t.readBoolean();let Ie=!1;je?t.readEG():Ie=t.readBoolean();const De=Ie?1:t.readUEG()+1;if(Se)for(let ze=0;ze<De;ze++)t.readUEG(),t.readUEG(),ge&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(Te)for(let ze=0;ze<De;ze++)t.readUEG(),t.readUEG(),ge&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),V=t.readUEG())}let re=w,oe=C;if(A||Y){let Se=1,Te=1;T===1?Se=Te=2:T==2&&(Se=2),re=w-Se*D-Se*L,oe=C-Te*k-Te*P}const ve=n?["A","B","C"][n]:"",be=l<<24|d<<16|u<<8|f;let Oe=0;for(let Se=0;Se<32;Se++)Oe=(Oe|(be>>Se&1)<<31-Se)>>>0;let Pe=Oe.toString(16);return c===1&&Pe==="2"&&(Pe="6"),{codecString:`hvc1.${ve}${c}.${Pe}.${a?"H":"L"}${y}.B0`,params:{general_tier_flag:a,general_profile_idc:c,general_profile_space:n,general_profile_compatibility_flags:[l,d,u,f],general_constraint_indicator_flags:[p,v,E,g,_,m],general_level_idc:y,bit_depth:M+8,bit_depth_luma_minus8:M,bit_depth_chroma_minus8:I,min_spatial_segmentation_idc:V,chroma_format_idc:T,frame_rate:{fixed:q,fps:X/Z}},width:re,height:oe,pixelRatio:[J,j]}}readPPS(e){const t=new gl(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const r=t.readBoolean(),n=t.readBoolean();let a=1;return n&&r?a=0:n?a=3:r&&(a=2),{parallelismType:a}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const Ar=188;class ys{constructor(e,t,r,n){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.logger=n,this.videoParser=null}static probe(e,t){const r=ys.syncOffset(e);return r>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${r}`),r!==-1}static syncOffset(e){const t=e.length;let r=Math.min(Ar*5,t-Ar)+1,n=0;for(;n<r;){let a=!1,c=-1,l=0;for(let d=n;d<t;d+=Ar)if(e[d]===71&&(t-d===Ar||e[d+Ar]===71)){if(l++,c===-1&&(c=d,c!==0&&(r=Math.min(c+Ar*99,e.length-Ar)+1)),a||(a=Vg(e,d)===0),a&&l>1&&(c===0&&l>2||d+Ar>r))return c}else{if(l)return-1;break}n++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:mT[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,r,n){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=ys.createTrack("video"),this._videoTrack.duration=n,this._audioTrack=ys.createTrack("audio",n),this._id3Track=ys.createTrack("id3"),this._txtTrack=ys.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=r}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:r}=this;e&&(e.pesData=null),t&&(t.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,r=!1,n=!1){r||(this.sampleAes=null);let a;const c=this._videoTrack,l=this._audioTrack,d=this._id3Track,u=this._txtTrack;let f=c.pid,p=c.pesData,v=l.pid,E=d.pid,g=l.pesData,_=d.pesData,m=null,y=this.pmtParsed,b=this._pmtId,R=e.length;if(this.remainderData&&(e=Fi(this.remainderData,e),R=e.length,this.remainderData=null),R<Ar&&!n)return this.remainderData=e,{audioTrack:l,videoTrack:c,id3Track:d,textTrack:u};const T=Math.max(0,ys.syncOffset(e));R-=(R-T)%Ar,R<e.byteLength&&!n&&(this.remainderData=new Uint8Array(e.buffer,R,e.buffer.byteLength-R));let w=0;for(let A=T;A<R;A+=Ar)if(e[A]===71){const L=!!(e[A+1]&64),D=Vg(e,A),P=(e[A+3]&48)>>4;let k;if(P>1){if(k=A+5+e[A+4],k===A+Ar)continue}else k=A+4;switch(D){case f:if(L){if(p&&(a=io(p,this.logger))){if(this.videoParser===null)switch(c.segmentCodec){case"avc":this.videoParser=new vE;break;case"hevc":this.videoParser=new yE;break}this.videoParser!==null&&this.videoParser.parsePES(c,u,a,!1)}p={data:[],size:0}}p&&(p.data.push(e.subarray(k,A+Ar)),p.size+=A+Ar-k);break;case v:if(L){if(g&&(a=io(g,this.logger)))switch(l.segmentCodec){case"aac":this.parseAACPES(l,a);break;case"mp3":this.parseMPEGPES(l,a);break;case"ac3":this.parseAC3PES(l,a);break}g={data:[],size:0}}g&&(g.data.push(e.subarray(k,A+Ar)),g.size+=A+Ar-k);break;case E:L&&(_&&(a=io(_,this.logger))&&this.parseID3PES(d,a),_={data:[],size:0}),_&&(_.data.push(e.subarray(k,A+Ar)),_.size+=A+Ar-k);break;case 0:L&&(k+=e[k]+1),b=this._pmtId=UN(e,k);break;case b:{L&&(k+=e[k]+1);const M=$N(e,k,this.typeSupported,r,this.observer,this.logger);f=M.videoPid,f>0&&(c.pid=f,c.segmentCodec=M.segmentVideoCodec),v=M.audioPid,v>0&&(l.pid=v,l.segmentCodec=M.segmentAudioCodec),E=M.id3Pid,E>0&&(d.pid=E),m!==null&&!y&&(this.logger.warn(`MPEG-TS PMT found at ${A} after unknown PID '${m}'. Backtracking to sync byte @${T} to parse all TS packets.`),m=null,A=T-188),y=this.pmtParsed=!0;break}case 17:case 8191:break;default:m=D;break}}else w++;w>0&&Kg(this.observer,new Error(`Found ${w} TS packet/s that do not start with 0x47`),void 0,this.logger),c.pesData=p,l.pesData=g,d.pesData=_;const C={audioTrack:l,videoTrack:c,id3Track:d,textTrack:u};return n&&this.extractRemainingSamples(C),C}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:r,id3Track:n,textTrack:a}=e,c=r.pesData,l=t.pesData,d=n.pesData;let u;if(c&&(u=io(c,this.logger))){if(this.videoParser===null)switch(r.segmentCodec){case"avc":this.videoParser=new vE;break;case"hevc":this.videoParser=new yE;break}this.videoParser!==null&&(this.videoParser.parsePES(r,a,u,!0),r.pesData=null)}else r.pesData=c;if(l&&(u=io(l,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,u);break;case"mp3":this.parseMPEGPES(t,u);break;case"ac3":this.parseAC3PES(t,u);break}t.pesData=null}else l!=null&&l.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=l;d&&(u=io(d,this.logger))?(this.parseID3PES(n,u),n.pesData=null):n.pesData=d}demuxSampleAes(e,t,r){const n=this.demux(e,r,!0,!this.config.progressive),a=this.sampleAes=new FN(this.observer,this.config,t);return this.decrypt(n,a)}decrypt(e,t){return new Promise(r=>{const{audioTrack:n,videoTrack:a}=e;n.samples&&n.segmentCodec==="aac"?t.decryptAacSamples(n.samples,0,()=>{a.samples?t.decryptAvcSamples(a.samples,0,0,()=>{r(e)}):r(e)}):a.samples&&t.decryptAvcSamples(a.samples,0,0,()=>{r(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let r=0;const n=this.aacOverFlow;let a=t.data;if(n){this.aacOverFlow=null;const p=n.missing,v=n.sample.unit.byteLength;if(p===-1)a=Fi(n.sample.unit,a);else{const E=v-p;n.sample.unit.set(a.subarray(0,p),E),e.samples.push(n.sample),r=n.missing}}let c,l;for(c=r,l=a.length;c<l-1&&!lf(a,c);c++);if(c!==r){let p;const v=c<l-1;if(v?p=`AAC PES did not start with ADTS header,offset:${c}`:p="No ADTS header found in AAC PES",Kg(this.observer,new Error(p),v,this.logger),!v)return}zT(e,this.observer,a,c,this.audioCodec);let d;if(t.pts!==void 0)d=t.pts;else if(n){const p=GT(e.samplerate);d=n.sample.pts+p}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let u=0,f;for(;c<l;)if(f=HT(e,a,c,d,u),c+=f.length,f.missing){this.aacOverFlow=f;break}else for(u++;c<l-1&&!lf(a,c);c++);}parseMPEGPES(e,t){const r=t.data,n=r.length;let a=0,c=0;const l=t.pts;if(l===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;c<n;)if(qT(r,c)){const d=VT(e,r,c,l,a);if(d)c+=d.length,a++;else break}else c++}parseAC3PES(e,t){{const r=t.data,n=t.pts;if(n===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const a=r.length;let c=0,l=0,d;for(;l<a&&(d=XT(e,r,l,n,c++))>0;)l+=d}}parseID3PES(e,t){if(t.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const r=Yt({},t,{type:this._videoTrack?xo.emsg:xo.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(r)}}function Vg(i,e){return((i[e+1]&31)<<8)+i[e+2]}function UN(i,e){return(i[e+10]&31)<<8|i[e+11]}function $N(i,e,t,r,n,a){const c={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},l=(i[e+1]&15)<<8|i[e+2],d=e+3+l-4,u=(i[e+10]&15)<<8|i[e+11];for(e+=12+u;e<d;){const f=Vg(i,e),p=(i[e+3]&15)<<8|i[e+4];switch(i[e]){case 207:if(!r){Am("ADTS AAC",a);break}case 15:c.audioPid===-1&&(c.audioPid=f);break;case 21:c.id3Pid===-1&&(c.id3Pid=f);break;case 219:if(!r){Am("H.264",a);break}case 27:c.videoPid===-1&&(c.videoPid=f);break;case 3:case 4:!t.mpeg&&!t.mp3?a.log("MPEG audio found, not supported in this browser"):c.audioPid===-1&&(c.audioPid=f,c.segmentAudioCodec="mp3");break;case 193:if(!r){Am("AC-3",a);break}case 129:t.ac3?c.audioPid===-1&&(c.audioPid=f,c.segmentAudioCodec="ac3"):a.log("AC-3 audio found, not supported in this browser");break;case 6:if(c.audioPid===-1&&p>0){let v=e+5,E=p;for(;E>2;){switch(i[v]){case 106:t.ac3!==!0?a.log("AC-3 audio found, not supported in this browser for now"):(c.audioPid=f,c.segmentAudioCodec="ac3");break}const g=i[v+1]+2;v+=g,E-=g}}break;case 194:case 135:return Kg(n,new Error("Unsupported EC-3 in M2TS found"),void 0,a),c;case 36:c.videoPid===-1&&(c.videoPid=f,c.segmentVideoCodec="hevc",a.log("HEVC in M2TS found"));break}e+=p+5}return c}function Kg(i,e,t,r){r.warn(`parsing error: ${e.message}`),i.emit(z.ERROR,z.ERROR,{type:Je.MEDIA_ERROR,details:he.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function Am(i,e){e.log(`${i} with AES-128-CBC encryption found in unencrypted stream`)}function io(i,e){let t=0,r,n,a,c,l;const d=i.data;if(!i||i.size===0)return null;for(;d[0].length<19&&d.length>1;)d[0]=Fi(d[0],d[1]),d.splice(1,1);if(r=d[0],(r[0]<<16)+(r[1]<<8)+r[2]===1){if(n=(r[4]<<8)+r[5],n&&n>i.size-6)return null;const u=r[7];u&192&&(c=(r[9]&14)*536870912+(r[10]&255)*4194304+(r[11]&254)*16384+(r[12]&255)*128+(r[13]&254)/2,u&64?(l=(r[14]&14)*536870912+(r[15]&255)*4194304+(r[16]&254)*16384+(r[17]&255)*128+(r[18]&254)/2,c-l>60*9e4&&(e.warn(`${Math.round((c-l)/9e4)}s delta between PTS and DTS, align them`),c=l)):l=c),a=r[8];let f=a+9;if(i.size<=f)return null;i.size-=f;const p=new Uint8Array(i.size);for(let v=0,E=d.length;v<E;v++){r=d[v];let g=r.byteLength;if(f)if(f>g){f-=g;continue}else r=r.subarray(f),g-=f,f=0;p.set(r,t),t+=g}return n&&(n-=a+3),{data:p,pts:c,dts:l,len:n}}return null}class jN{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const hs=Math.pow(2,32)-1;class te{static init(){te.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in te.types)te.types.hasOwnProperty(e)&&(te.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);te.HDLR_TYPES={video:t,audio:r};const n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);te.STTS=te.STSC=te.STCO=a,te.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),te.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),te.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),te.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const c=new Uint8Array([105,115,111,109]),l=new Uint8Array([97,118,99,49]),d=new Uint8Array([0,0,0,1]);te.FTYP=te.box(te.types.ftyp,c,d,c,l),te.DINF=te.box(te.types.dinf,te.box(te.types.dref,n))}static box(e,...t){let r=8,n=t.length;const a=n;for(;n--;)r+=t[n].byteLength;const c=new Uint8Array(r);for(c[0]=r>>24&255,c[1]=r>>16&255,c[2]=r>>8&255,c[3]=r&255,c.set(e,4),n=0,r=8;n<a;n++)c.set(t[n],r),r+=t[n].byteLength;return c}static hdlr(e){return te.box(te.types.hdlr,te.HDLR_TYPES[e])}static mdat(e){return te.box(te.types.mdat,e)}static mdhd(e,t){t*=e;const r=Math.floor(t/(hs+1)),n=Math.floor(t%(hs+1));return te.box(te.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,n>>24,n>>16&255,n>>8&255,n&255,85,196,0,0]))}static mdia(e){return te.box(te.types.mdia,te.mdhd(e.timescale||0,e.duration||0),te.hdlr(e.type),te.minf(e))}static mfhd(e){return te.box(te.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?te.box(te.types.minf,te.box(te.types.smhd,te.SMHD),te.DINF,te.stbl(e)):te.box(te.types.minf,te.box(te.types.vmhd,te.VMHD),te.DINF,te.stbl(e))}static moof(e,t,r){return te.box(te.types.moof,te.mfhd(e),te.traf(r,t))}static moov(e){let t=e.length;const r=[];for(;t--;)r[t]=te.trak(e[t]);return te.box.apply(null,[te.types.moov,te.mvhd(e[0].timescale||0,e[0].duration||0)].concat(r).concat(te.mvex(e)))}static mvex(e){let t=e.length;const r=[];for(;t--;)r[t]=te.trex(e[t]);return te.box.apply(null,[te.types.mvex,...r])}static mvhd(e,t){t*=e;const r=Math.floor(t/(hs+1)),n=Math.floor(t%(hs+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,n>>24,n>>16&255,n>>8&255,n&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return te.box(te.types.mvhd,a)}static sdtp(e){const t=e.samples||[],r=new Uint8Array(4+t.length);let n,a;for(n=0;n<t.length;n++)a=t[n].flags,r[n+4]=a.dependsOn<<4|a.isDependedOn<<2|a.hasRedundancy;return te.box(te.types.sdtp,r)}static stbl(e){return te.box(te.types.stbl,te.stsd(e),te.box(te.types.stts,te.STTS),te.box(te.types.stsc,te.STSC),te.box(te.types.stsz,te.STSZ),te.box(te.types.stco,te.STCO))}static avc1(e){let t=[],r=[],n,a,c;for(n=0;n<e.sps.length;n++)a=e.sps[n],c=a.byteLength,t.push(c>>>8&255),t.push(c&255),t=t.concat(Array.prototype.slice.call(a));for(n=0;n<e.pps.length;n++)a=e.pps[n],c=a.byteLength,r.push(c>>>8&255),r.push(c&255),r=r.concat(Array.prototype.slice.call(a));const l=te.box(te.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(r))),d=e.width,u=e.height,f=e.pixelRatio[0],p=e.pixelRatio[1];return te.box(te.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>8&255,d&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),l,te.box(te.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),te.box(te.types.pasp,new Uint8Array([f>>24,f>>16&255,f>>8&255,f&255,p>>24,p>>16&255,p>>8&255,p&255])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return te.box(te.types.mp4a,te.audioStsd(e),te.box(te.types.esds,te.esds(e)))}static mp3(e){return te.box(te.types[".mp3"],te.audioStsd(e))}static ac3(e){return te.box(te.types["ac-3"],te.audioStsd(e),te.box(te.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if(e.type==="audio"){if(t==="aac")return te.box(te.types.stsd,te.STSD,te.mp4a(e));if(t==="ac3"&&e.config)return te.box(te.types.stsd,te.STSD,te.ac3(e));if(t==="mp3"&&e.codec==="mp3")return te.box(te.types.stsd,te.STSD,te.mp3(e))}else if(e.pps&&e.sps){if(t==="avc")return te.box(te.types.stsd,te.STSD,te.avc1(e));if(t==="hevc"&&e.vps)return te.box(te.types.stsd,te.STSD,te.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,r=(e.duration||0)*(e.timescale||0),n=e.width||0,a=e.height||0,c=Math.floor(r/(hs+1)),l=Math.floor(r%(hs+1));return te.box(te.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,c>>24,c>>16&255,c>>8&255,c&255,l>>24,l>>16&255,l>>8&255,l&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,n&255,0,0,a>>8&255,a&255,0,0]))}static traf(e,t){const r=te.sdtp(e),n=e.id,a=Math.floor(t/(hs+1)),c=Math.floor(t%(hs+1));return te.box(te.types.traf,te.box(te.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255])),te.box(te.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,c>>24,c>>16&255,c>>8&255,c&255])),te.trun(e,r.length+16+20+8+16+8+8),r)}static trak(e){return e.duration=e.duration||4294967295,te.box(te.types.trak,te.tkhd(e),te.mdia(e))}static trex(e){const t=e.id;return te.box(te.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const r=e.samples||[],n=r.length,a=12+16*n,c=new Uint8Array(a);let l,d,u,f,p,v;for(t+=8+a,c.set([e.type==="video"?1:0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,n&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),l=0;l<n;l++)d=r[l],u=d.duration,f=d.size,p=d.flags,v=d.cts,c.set([u>>>24&255,u>>>16&255,u>>>8&255,u&255,f>>>24&255,f>>>16&255,f>>>8&255,f&255,p.isLeading<<2|p.dependsOn,p.isDependedOn<<6|p.hasRedundancy<<4|p.paddingValue<<1|p.isNonSync,p.degradPrio&61440,p.degradPrio&15,v>>>24&255,v>>>16&255,v>>>8&255,v&255],12+16*l);return te.box(te.types.trun,c)}static initSegment(e){te.types||te.init();const t=te.moov(e);return Fi(te.FTYP,t)}static hvc1(e){const t=e.params,r=[e.vps,e.sps,e.pps],n=4,a=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),n-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),r.length]);let c=a.length;for(let g=0;g<r.length;g+=1){c+=3;for(let _=0;_<r[g].length;_+=1)c+=2+r[g][_].length}const l=new Uint8Array(c);l.set(a,0),c=a.length;const d=r.length-1;for(let g=0;g<r.length;g+=1){l.set(new Uint8Array([32+g|(g===d?128:0),0,r[g].length]),c),c+=3;for(let _=0;_<r[g].length;_+=1)l.set(new Uint8Array([r[g][_].length>>8,r[g][_].length&255]),c),c+=2,l.set(r[g][_],c),c+=r[g][_].length}const u=te.box(te.types.hvcC,l),f=e.width,p=e.height,v=e.pixelRatio[0],E=e.pixelRatio[1];return te.box(te.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,f>>8&255,f&255,p>>8&255,p&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u,te.box(te.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),te.box(te.types.pasp,new Uint8Array([v>>24,v>>16&255,v>>8&255,v&255,E>>24,E>>16&255,E>>8&255,E&255])))}}te.types=void 0;te.HDLR_TYPES=void 0;te.STTS=void 0;te.STSC=void 0;te.STCO=void 0;te.STSZ=void 0;te.VMHD=void 0;te.SMHD=void 0;te.STSD=void 0;te.FTYP=void 0;te.DINF=void 0;const ZT=9e4;function kv(i,e,t=1,r=!1){const n=i*e*t;return r?Math.round(n):n}function zN(i,e,t=1,r=!1){return kv(i,e,1/t,r)}function Ic(i,e=!1){return kv(i,1e3,1/ZT,e)}function GN(i,e=1){return kv(i,ZT,1/e)}const HN=10*1e3,VN=1024,KN=1152,qN=1536;let no=null,xm=null;function bE(i,e,t,r){return{duration:e,size:t,cts:r,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:i?2:1,isNonSync:i?0:1}}}class Bd{constructor(e,t,r,n){if(this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.logger=n,this.ISGenerated=!1,no===null){const a=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);no=a?parseInt(a[1]):0}if(xm===null){const a=navigator.userAgent.match(/Safari\/(\d+)/i);xm=a?parseInt(a[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){this.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const r=e[0].pts,n=e.reduce((a,c)=>{let l=c.pts,d=l-a;return d<-4294967296&&(t=!0,l=Mi(l,r),d=l-a),d>0?a:l},r);return t&&this.logger.debug("PTS rollover detected"),n}remux(e,t,r,n,a,c,l,d){let u,f,p,v,E,g,_=a,m=a;const y=e.pid>-1,b=t.pid>-1,R=t.samples.length,T=e.samples.length>0,w=l&&R>0||R>1;if((!y||T)&&(!b||w)||this.ISGenerated||l){if(this.ISGenerated){var C,A,L,D;const I=this.videoTrackConfig;(I&&(t.width!==I.width||t.height!==I.height||((C=t.pixelRatio)==null?void 0:C[0])!==((A=I.pixelRatio)==null?void 0:A[0])||((L=t.pixelRatio)==null?void 0:L[1])!==((D=I.pixelRatio)==null?void 0:D[1]))||!I&&w||this.nextAudioPts===null&&T)&&this.resetInitSegment()}this.ISGenerated||(p=this.generateIS(e,t,a,c));const P=this.isVideoContiguous;let k=-1,M;if(w&&(k=YN(t.samples),!P&&this.config.forceKeyFrameOnDiscontinuity))if(g=!0,k>0){this.logger.warn(`[mp4-remuxer]: Dropped ${k} out of ${R} video samples due to a missing keyframe`);const I=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(k),t.dropped+=k,m+=(t.samples[0].pts-I)/t.inputTimeScale,M=m}else k===-1&&(this.logger.warn(`[mp4-remuxer]: No keyframe found out of ${R} video samples`),g=!1);if(this.ISGenerated){if(T&&w){const I=this.getVideoStartPts(t.samples),F=(Mi(e.samples[0].pts,I)-I)/t.inputTimeScale;_+=Math.max(0,F),m+=Math.max(0,-F)}if(T){if(e.samplerate||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),p=this.generateIS(e,t,a,c)),f=this.remuxAudio(e,_,this.isAudioContiguous,c,b||w||d===ot.AUDIO?m:void 0),w){const I=f?f.endPTS-f.startPTS:0;t.inputTimeScale||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),p=this.generateIS(e,t,a,c)),u=this.remuxVideo(t,m,P,I)}}else w&&(u=this.remuxVideo(t,m,P,0));u&&(u.firstKeyFrame=k,u.independent=k!==-1,u.firstKeyFramePTS=M)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(r.samples.length&&(E=JT(r,a,this._initPTS,this._initDTS)),n.samples.length&&(v=eC(n,a,this._initPTS))),{audio:f,video:u,initSegment:p,independent:g,text:v,id3:E}}generateIS(e,t,r,n){const a=e.samples,c=t.samples,l=this.typeSupported,d={},u=this._initPTS;let f=!u||n,p="audio/mp4",v,E,g,_;if(f&&(v=E=1/0),e.config&&a.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":l.mpeg?(p="audio/mpeg",e.codec=""):l.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}d.audio={id:"audio",container:p,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&l.mpeg?new Uint8Array(0):te.initSegment([e]),metadata:{channelCount:e.channelCount}},f&&(_=e.id,g=e.inputTimeScale,!u||g!==u.timescale?v=E=a[0].pts-Math.round(g*r):f=!1)}if(t.sps&&t.pps&&c.length){if(t.timescale=t.inputTimeScale,d.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:te.initSegment([t]),metadata:{width:t.width,height:t.height}},f)if(_=t.id,g=t.inputTimeScale,!u||g!==u.timescale){const m=this.getVideoStartPts(c),y=Math.round(g*r);E=Math.min(E,Mi(c[0].dts,m)-y),v=Math.min(v,m-y)}else f=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(d).length)return this.ISGenerated=!0,f?(this._initPTS={baseTime:v,timescale:g},this._initDTS={baseTime:E,timescale:g}):v=g=void 0,{tracks:d,initPTS:v,timescale:g,trackId:_}}remuxVideo(e,t,r,n){const a=e.inputTimeScale,c=e.samples,l=[],d=c.length,u=this._initPTS;let f=this.nextAvcDts,p=8,v=this.videoSampleDuration,E,g,_=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,y=!1;if(!r||f===null){const U=t*a,V=c[0].pts-Mi(c[0].dts,c[0].pts);no&&f!==null&&Math.abs(U-V-f)<15e3?r=!0:f=U-V}const b=u.baseTime*a/u.timescale;for(let U=0;U<d;U++){const V=c[U];V.pts=Mi(V.pts-b,f),V.dts=Mi(V.dts-b,f),V.dts<c[U>0?U-1:U].dts&&(y=!0)}y&&c.sort(function(U,V){const J=U.dts-V.dts,j=U.pts-V.pts;return J||j}),E=c[0].dts,g=c[c.length-1].dts;const R=g-E,T=R?Math.round(R/(d-1)):v||e.inputTimeScale/30;if(r){const U=E-f,V=U>T,J=U<-1;if((V||J)&&(V?this.logger.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Ic(U,!0)} ms (${U}dts) hole between fragments detected at ${t.toFixed(3)}`):this.logger.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Ic(-U,!0)} ms (${U}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!J||f>=c[0].pts||no)){E=f;const j=c[0].pts-U;if(V)c[0].dts=E,c[0].pts=j;else{let q=!0;for(let Z=0;Z<c.length&&!(c[Z].dts>j&&q);Z++){const X=c[Z].pts;if(c[Z].dts-=U,c[Z].pts-=U,Z<c.length-1){const Y=c[Z+1].pts,re=c[Z].pts,oe=Y<=re,ve=Y<=X;q=oe==ve}}}this.logger.log(`Video: Initial PTS/DTS adjusted: ${Ic(j,!0)}/${Ic(E,!0)}, delta: ${Ic(U,!0)} ms`)}}E=Math.max(0,E);let w=0,C=0,A=E;for(let U=0;U<d;U++){const V=c[U],J=V.units,j=J.length;let q=0;for(let Z=0;Z<j;Z++)q+=J[Z].data.length;C+=q,w+=j,V.length=q,V.dts<A?(V.dts=A,A+=T/4|0||1):A=V.dts,_=Math.min(V.pts,_),m=Math.max(V.pts,m)}g=c[d-1].dts;const L=C+4*w+8;let D;try{D=new Uint8Array(L)}catch(U){this.observer.emit(z.ERROR,z.ERROR,{type:Je.MUX_ERROR,details:he.REMUX_ALLOC_ERROR,fatal:!1,error:U,bytes:L,reason:`fail allocating video mdat ${L}`});return}const P=new DataView(D.buffer);P.setUint32(0,L),D.set(te.types.mdat,4);let k=!1,M=Number.POSITIVE_INFINITY,I=Number.POSITIVE_INFINITY,F=Number.NEGATIVE_INFINITY,$=Number.NEGATIVE_INFINITY;for(let U=0;U<d;U++){const V=c[U],J=V.units;let j=0;for(let X=0,Y=J.length;X<Y;X++){const re=J[X],oe=re.data,ve=re.data.byteLength;P.setUint32(p,ve),p+=4,D.set(oe,p),p+=ve,j+=4+ve}let q;if(U<d-1)v=c[U+1].dts-V.dts,q=c[U+1].pts-V.pts;else{const X=this.config,Y=U>0?V.dts-c[U-1].dts:T;if(q=U>0?V.pts-c[U-1].pts:T,X.stretchShortVideoTrack&&this.nextAudioPts!==null){const re=Math.floor(X.maxBufferHole*a),oe=(n?_+n*a:this.nextAudioPts)-V.pts;oe>re?(v=oe-Y,v<0?v=Y:k=!0,this.logger.log(`[mp4-remuxer]: It is approximately ${oe/90} ms to the next segment; using duration ${v/90} ms for the last video frame.`)):v=Y}else v=Y}const Z=Math.round(V.pts-V.dts);M=Math.min(M,v),F=Math.max(F,v),I=Math.min(I,q),$=Math.max($,q),l.push(bE(V.key,v,j,Z))}if(l.length){if(no){if(no<70){const U=l[0].flags;U.dependsOn=2,U.isNonSync=0}}else if(xm&&$-I<F-M&&T/F<.025&&l[0].cts===0){this.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let U=E;for(let V=0,J=l.length;V<J;V++){const j=U+l[V].duration,q=U+l[V].cts;if(V<J-1){const Z=j+l[V+1].cts;l[V].duration=Z-q}else l[V].duration=V?l[V-1].duration:T;l[V].cts=0,U=j}}}v=k||!v?T:v,this.nextAvcDts=f=g+v,this.videoSampleDuration=v,this.isVideoContiguous=!0;const N={data1:te.moof(e.sequenceNumber++,E,Yt(e,{samples:l})),data2:D,startPTS:_/a,endPTS:(m+v)/a,startDTS:E/a,endDTS:f/a,type:"video",hasAudio:!1,hasVideo:!0,nb:l.length,dropped:e.dropped};return e.samples=[],e.dropped=0,N}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return KN;case"ac3":return qN;default:return VN}}remuxAudio(e,t,r,n,a){const c=e.inputTimeScale,l=e.samplerate?e.samplerate:c,d=c/l,u=this.getSamplesPerFrame(e),f=u*d,p=this._initPTS,v=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,E=[],g=a!==void 0;let _=e.samples,m=v?0:8,y=this.nextAudioPts||-1;const b=t*c,R=p.baseTime*c/p.timescale;if(this.isAudioContiguous=r=r||_.length&&y>0&&(n&&Math.abs(b-y)<9e3||Math.abs(Mi(_[0].pts-R,b)-y)<20*f),_.forEach(function($){$.pts=Mi($.pts-R,b)}),!r||y<0){if(_=_.filter($=>$.pts>=0),!_.length)return;a===0?y=0:n&&!g?y=Math.max(0,b):y=_[0].pts}if(e.segmentCodec==="aac"){const $=this.config.maxAudioFramesDrift;for(let N=0,U=y;N<_.length;N++){const V=_[N],J=V.pts,j=J-U,q=Math.abs(1e3*j/c);if(j<=-$*f&&g)N===0&&(this.logger.warn(`Audio frame @ ${(J/c).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*j/c)} ms.`),this.nextAudioPts=y=U=J);else if(j>=$*f&&q<HN&&g){let Z=Math.round(j/f);U=J-Z*f,U<0&&(Z--,U+=f),N===0&&(this.nextAudioPts=y=U),this.logger.warn(`[mp4-remuxer]: Injecting ${Z} audio frame @ ${(U/c).toFixed(3)}s due to ${Math.round(1e3*j/c)} ms gap.`);for(let X=0;X<Z;X++){const Y=Math.max(U,0);let re=jN.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);re||(this.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),re=V.unit.subarray()),_.splice(N,0,{unit:re,pts:Y}),U+=f,N++}}V.pts=U,U+=f}}let T=null,w=null,C,A=0,L=_.length;for(;L--;)A+=_[L].unit.byteLength;for(let $=0,N=_.length;$<N;$++){const U=_[$],V=U.unit;let J=U.pts;if(w!==null){const q=E[$-1];q.duration=Math.round((J-w)/d)}else if(r&&e.segmentCodec==="aac"&&(J=y),T=J,A>0){A+=m;try{C=new Uint8Array(A)}catch(q){this.observer.emit(z.ERROR,z.ERROR,{type:Je.MUX_ERROR,details:he.REMUX_ALLOC_ERROR,fatal:!1,error:q,bytes:A,reason:`fail allocating audio mdat ${A}`});return}v||(new DataView(C.buffer).setUint32(0,A),C.set(te.types.mdat,4))}else return;C.set(V,m);const j=V.byteLength;m+=j,E.push(bE(!0,u,j,0)),w=J}const D=E.length;if(!D)return;const P=E[E.length-1];this.nextAudioPts=y=w+d*P.duration;const k=v?new Uint8Array(0):te.moof(e.sequenceNumber++,T/d,Yt({},e,{samples:E}));e.samples=[];const M=T/c,I=y/c,F={data1:k,data2:C,startPTS:M,endPTS:I,startDTS:M,endDTS:I,type:"audio",hasAudio:!0,hasVideo:!1,nb:D};return this.isAudioContiguous=!0,F}}function Mi(i,e){let t;if(e===null)return i;for(e<i?t=-8589934592:t=8589934592;Math.abs(i-e)>4294967296;)i+=t;return i}function YN(i){for(let e=0;e<i.length;e++)if(i[e].key)return e;return-1}function JT(i,e,t,r){const n=i.samples.length;if(!n)return;const a=i.inputTimeScale;for(let l=0;l<n;l++){const d=i.samples[l];d.pts=Mi(d.pts-t.baseTime*a/t.timescale,e*a)/a,d.dts=Mi(d.dts-r.baseTime*a/r.timescale,e*a)/a}const c=i.samples;return i.samples=[],{samples:c}}function eC(i,e,t){const r=i.samples.length;if(!r)return;const n=i.inputTimeScale;for(let c=0;c<r;c++){const l=i.samples[c];l.pts=Mi(l.pts-t.baseTime*n/t.timescale,e*n)/n}i.samples.sort((c,l)=>c.pts-l.pts);const a=i.samples;return i.samples=[],{samples:a}}class WN{constructor(e,t,r,n){this.logger=void 0,this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1,this.logger=n}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,r,n){this.audioCodec=t,this.videoCodec=r,this.generateInitSegment(FM(e,n)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:r}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const n=this.initData=yT(e);n.audio&&(t=_E(n.audio,ei.AUDIO,this.logger)),n.video&&(r=_E(n.video,ei.VIDEO,this.logger));const a={};n.audio&&n.video?a.audiovideo={container:"video/mp4",codec:t+","+r,supplemental:n.video.supplemental,initSegment:e,id:"main"}:n.audio?a.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:n.video?a.video={container:"video/mp4",codec:r,supplemental:n.video.supplemental,initSegment:e,id:"main"}:this.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=a}remux(e,t,r,n,a,c){var l,d;let{initPTS:u,lastEndTime:f}=this;const p={audio:void 0,video:void 0,text:n,id3:r,initSegment:void 0};He(f)||(f=this.lastEndTime=a||0);const v=t.samples;if(!(v!=null&&v.length))return p;const E={initPTS:void 0,timescale:void 0,trackId:void 0};let g=this.initData;if((l=g)!=null&&l.length||(this.generateInitSegment(v),g=this.initData),!((d=g)!=null&&d.length))return this.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),p;this.emitInitSegment&&(E.tracks=this.initTracks,this.emitInitSegment=!1);const _=UM(v,g,this.logger),m=g.audio?_[g.audio.id]:null,y=g.video?_[g.video.id]:null,b=cd(y,1/0),R=cd(m,1/0),T=cd(y,0,!0),w=cd(m,0,!0);let C,A=a,L=0;if(m&&(!y||!u&&R<b||u&&u.trackId===g.audio.id)?(E.trackId=g.audio.id,C=m,L=w-R):y&&(E.trackId=g.video.id,C=y,L=T-b),C){const N=C.timescale;A=C.start/N,E.timescale=N,u||(E.initPTS=C.start-a*N,this.initPTS=u={baseTime:E.initPTS,timescale:N,trackId:E.trackId})}(c||!u)&&(XN(u,A,a,L)||E.timescale!==u.timescale)&&(E.initPTS=A-a,u&&u.timescale===1&&this.logger.warn(`Adjusting initPTS @${a} from ${u.baseTime/u.timescale} to ${E.initPTS}`),this.initPTS=u={baseTime:E.initPTS,timescale:1});const D=e?A-u.baseTime/u.timescale:f;$M(g,v,u.baseTime/u.timescale);const P=D+L;L>0?this.lastEndTime=P:(this.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const k=!!g.audio,M=!!g.video;let I="";k&&(I+="audio"),M&&(I+="video");const F={data1:v,startPTS:D,startDTS:D,endPTS:P,endDTS:P,type:I,hasAudio:k,hasVideo:M,nb:1,dropped:0};p.audio=k&&!M?F:void 0,p.video=M?F:void 0;const $=y==null?void 0:y.sampleCount;if($){const N=y.keyFrameIndex,U=N!==-1;F.nb=$,F.dropped=N===0||this.isVideoContiguous?0:U?N:$,F.independent=U,F.firstKeyFrame=N,U&&y.keyFrameStart&&(F.firstKeyFramePTS=y.keyFrameStart-u.baseTime/u.timescale),this.isVideoContiguous||(p.independent=U),this.isVideoContiguous||(this.isVideoContiguous=U),F.dropped&&this.logger.warn(`fmp4 does not start with IDR: firstIDR ${N}/${$} dropped: ${F.dropped} pts: ${F.firstKeyFramePTS||"NA"}`)}return p.initSegment=E,p.id3=JT(r,a,u,u),n.samples.length&&(p.text=eC(n,a,u)),p}}function cd(i,e,t=!1){return(i==null?void 0:i.start)!==void 0?(i.start+(t?i.duration:0))/i.timescale:e}function XN(i,e,t,r){if(i===null)return!0;const n=Math.max(r,1),a=e-i.baseTime/i.timescale;return Math.abs(a-t)>n}function _E(i,e,t){const r=i==null?void 0:i.codec;return r&&r.length>4?r:e===ei.AUDIO?r==="ec-3"||r==="ac-3"||r==="alac"?r:r==="fLaC"||r==="Opus"?zg(r,!1):(t.warn(`Unhandled audio codec "${r}" in mp4 MAP`),r||"mp4a"):(t.warn(`Unhandled video codec "${r}" in mp4 MAP`),r||"avc1")}let Fn;try{Fn=self.performance.now.bind(self.performance)}catch{Fn=Date.now}const Fd=[{demux:BN,remux:WN},{demux:ys,remux:Bd},{demux:PN,remux:Bd},{demux:MN,remux:Bd}];Fd.splice(2,0,{demux:kN,remux:Bd});class SE{constructor(e,t,r,n,a,c){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=r,this.id=a,this.logger=c}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,r,n){const a=r.transmuxing;a.executeStart=Fn();let c=new Uint8Array(e);const{currentTransmuxState:l,transmuxConfig:d}=this;n&&(this.currentTransmuxState=n);const{contiguous:u,discontinuity:f,trackSwitch:p,accurateTimeOffset:v,timeOffset:E,initSegmentChange:g}=n||l,{audioCodec:_,videoCodec:m,defaultInitPts:y,duration:b,initSegmentData:R}=d,T=QN(c,t);if(T&&vo(T.method)){const L=this.getDecrypter(),D=Av(T.method);if(L.isSync()){let P=L.softwareDecrypt(c,T.key.buffer,T.iv.buffer,D);if(r.part>-1){const k=L.flush();P=k&&k.buffer}if(!P)return a.executeEnd=Fn(),Dm(r);c=new Uint8Array(P)}else return this.asyncResult=!0,this.decryptionPromise=L.webCryptoDecrypt(c,T.key.buffer,T.iv.buffer,D).then(P=>{const k=this.push(P,null,r);return this.decryptionPromise=null,k}),this.decryptionPromise}const w=this.needsProbing(f,p);if(w){const L=this.configureTransmuxer(c);if(L)return this.logger.warn(`[transmuxer] ${L.message}`),this.observer.emit(z.ERROR,z.ERROR,{type:Je.MEDIA_ERROR,details:he.FRAG_PARSING_ERROR,fatal:!1,error:L,reason:L.message}),a.executeEnd=Fn(),Dm(r)}(f||p||g||w)&&this.resetInitSegment(R,_,m,b,t),(f||g||w)&&this.resetInitialTimestamp(y),u||this.resetContiguity();const C=this.transmux(c,T,E,v,r);this.asyncResult=uf(C);const A=this.currentTransmuxState;return A.contiguous=!0,A.discontinuity=!1,A.trackSwitch=!1,a.executeEnd=Fn(),C}flush(e){const t=e.transmuxing;t.executeStart=Fn();const{decrypter:r,currentTransmuxState:n,decryptionPromise:a}=this;if(a)return this.asyncResult=!0,a.then(()=>this.flush(e));const c=[],{timeOffset:l}=n;if(r){const p=r.flush();p&&c.push(this.push(p.buffer,null,e))}const{demuxer:d,remuxer:u}=this;if(!d||!u){t.executeEnd=Fn();const p=[Dm(e)];return this.asyncResult?Promise.resolve(p):p}const f=d.flush(l);return uf(f)?(this.asyncResult=!0,f.then(p=>(this.flushRemux(c,p,e),c))):(this.flushRemux(c,f,e),this.asyncResult?Promise.resolve(c):c)}flushRemux(e,t,r){const{audioTrack:n,videoTrack:a,id3Track:c,textTrack:l}=t,{accurateTimeOffset:d,timeOffset:u}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${r.sn}${r.part>-1?" part: "+r.part:""} of ${this.id===ot.MAIN?"level":"track"} ${r.level}`);const f=this.remuxer.remux(n,a,c,l,u,d,!0,this.id);e.push({remuxResult:f,chunkMeta:r}),r.transmuxing.executeEnd=Fn()}resetInitialTimestamp(e){const{demuxer:t,remuxer:r}=this;!t||!r||(t.resetTimeStamp(e),r.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,r,n,a){const{demuxer:c,remuxer:l}=this;!c||!l||(c.resetInitSegment(e,t,r,n),l.resetInitSegment(e,t,r,a))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,r,n,a){let c;return t&&t.method==="SAMPLE-AES"?c=this.transmuxSampleAes(e,t,r,n,a):c=this.transmuxUnencrypted(e,r,n,a),c}transmuxUnencrypted(e,t,r,n){const{audioTrack:a,videoTrack:c,id3Track:l,textTrack:d}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(a,c,l,d,t,r,!1,this.id),chunkMeta:n}}transmuxSampleAes(e,t,r,n,a){return this.demuxer.demuxSampleAes(e,t,r).then(c=>({remuxResult:this.remuxer.remux(c.audioTrack,c.videoTrack,c.id3Track,c.textTrack,r,n,!1,this.id),chunkMeta:a}))}configureTransmuxer(e){const{config:t,observer:r,typeSupported:n}=this;let a;for(let p=0,v=Fd.length;p<v;p++){var c;if((c=Fd[p].demux)!=null&&c.probe(e,this.logger)){a=Fd[p];break}}if(!a)return new Error("Failed to find demuxer by probing fragment data");const l=this.demuxer,d=this.remuxer,u=a.remux,f=a.demux;(!d||!(d instanceof u))&&(this.remuxer=new u(r,t,n,this.logger)),(!l||!(l instanceof f))&&(this.demuxer=new f(r,t,n,this.logger),this.probe=f.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Cv(this.config)),e}}function QN(i,e){let t=null;return i.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const Dm=i=>({remuxResult:{},chunkMeta:i});function uf(i){return"then"in i&&i.then instanceof Function}class ZN{constructor(e,t,r,n,a){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=r,this.duration=n,this.defaultInitPts=a||null}}class JN{constructor(e,t,r,n,a,c){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=r,this.trackSwitch=n,this.timeOffset=a,this.initSegmentChange=c}}let EE=0;class e4{constructor(e,t,r,n){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=EE++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=d=>{const u=d.data,f=this.hls;if(!(!f||!(u!=null&&u.event)||u.instanceNo!==this.instanceNo))switch(u.event){case"init":{var p;const v=(p=this.workerContext)==null?void 0:p.objectURL;v&&self.URL.revokeObjectURL(v);break}case"transmuxComplete":{this.handleTransmuxComplete(u.data);break}case"flush":{this.onFlush(u.data);break}case"workerLog":{f.logger[u.data.logType]&&f.logger[u.data.logType](u.data.message);break}default:{u.data=u.data||{},u.data.frag=this.frag,u.data.part=this.part,u.data.id=this.id,f.trigger(u.event,u.data);break}}},this.onWorkerError=d=>{if(!this.hls)return;const u=new Error(`${d.message}  (${d.filename}:${d.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(z.ERROR,{type:Je.OTHER_ERROR,details:he.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:u})};const a=e.config;this.hls=e,this.id=t,this.useWorker=!!a.enableWorker,this.onTransmuxComplete=r,this.onFlush=n;const c=(d,u)=>{u=u||{},u.frag=this.frag||void 0,d===z.ERROR&&(u=u,u.parent=this.id,u.part=this.part,this.error=u.error),this.hls.trigger(d,u)};this.observer=new FT,this.observer.on(z.FRAG_DECRYPTED,c),this.observer.on(z.ERROR,c);const l=YS(a.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const d=this.hls.logger;if(a.workerPath||iN()){try{a.workerPath?(d.log(`loading Web Worker ${a.workerPath} for "${t}"`),this.workerContext=sN(a.workerPath)):(d.log(`injecting Web Worker for "${t}"`),this.workerContext=nN());const{worker:u}=this.workerContext;u.addEventListener("message",this.onWorkerMessage),u.addEventListener("error",this.onWorkerError),u.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:l,id:t,config:hr(a)})}catch(u){d.warn(`Error setting up "${t}" Web Worker, fallback to inline`,u),this.terminateWorker(),this.error=null,this.transmuxer=new SE(this.observer,l,a,"",t,e.logger)}return}}this.transmuxer=new SE(this.observer,l,a,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=EE++;const t=this.hls.config,r=YS(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:r,id:this.id,config:hr(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),aN(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,r,n,a,c,l,d,u,f){var p,v;u.transmuxing.start=self.performance.now();const{instanceNo:E,transmuxer:g}=this,_=c?c.start:a.start,m=a.decryptdata,y=this.frag,b=!(y&&a.cc===y.cc),R=!(y&&u.level===y.level),T=y?u.sn-y.sn:-1,w=this.part?u.part-this.part.index:-1,C=T===0&&u.id>1&&u.id===(y==null?void 0:y.stats.chunkCount),A=!R&&(T===1||T===0&&(w===1||C&&w<=0)),L=self.performance.now();(R||T||a.stats.parsing.start===0)&&(a.stats.parsing.start=L),c&&(w||!A)&&(c.stats.parsing.start=L);const D=!(y&&((p=a.initSegment)==null?void 0:p.url)===((v=y.initSegment)==null?void 0:v.url)),P=new JN(b,A,d,R,_,D);if(!A||b||D){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${a.type} sn: ${u.sn}${u.part>-1?" part: "+u.part:""} ${this.id===ot.MAIN?"level":"track"}: ${u.level} id: ${u.id}
        discontinuity: ${b}
        trackSwitch: ${R}
        contiguous: ${A}
        accurateTimeOffset: ${d}
        timeOffset: ${_}
        initSegmentChange: ${D}`);const k=new ZN(r,n,t,l,f);this.configureTransmuxer(k)}if(this.frag=a,this.part=c,this.workerContext)this.workerContext.worker.postMessage({instanceNo:E,cmd:"demux",data:e,decryptdata:m,chunkMeta:u,state:P},e instanceof ArrayBuffer?[e]:[]);else if(g){const k=g.push(e,m,u,P);uf(k)?k.then(M=>{this.handleTransmuxComplete(M)}).catch(M=>{this.transmuxerError(M,u,"transmuxer-interface push error")}):this.handleTransmuxComplete(k)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:r}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(r){const n=r.flush(e);uf(n)?n.then(a=>{this.handleFlushResult(a,e)}).catch(a=>{this.transmuxerError(a,e,"transmuxer-interface flush error")}):this.handleFlushResult(n,e)}}transmuxerError(e,t,r){this.hls&&(this.error=e,this.hls.trigger(z.ERROR,{type:Je.MEDIA_ERROR,details:he.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:r}))}handleFlushResult(e,t){e.forEach(r=>{this.handleTransmuxComplete(r)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:r}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):r&&r.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const RE=100;class t4 extends BT{constructor(e,t,r){super(e,t,r,"audio-stream-controller",ot.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(z.LEVEL_LOADED,this.onLevelLoaded,this),e.on(z.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(z.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(z.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(z.BUFFER_RESET,this.onBufferReset,this),e.on(z.BUFFER_CREATED,this.onBufferCreated,this),e.on(z.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(z.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(z.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(z.FRAG_LOADING,this.onFragLoading,this),e.on(z.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(z.LEVEL_LOADED,this.onLevelLoaded,this),e.off(z.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(z.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(z.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(z.BUFFER_RESET,this.onBufferReset,this),e.off(z.BUFFER_CREATED,this.onBufferCreated,this),e.off(z.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(z.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(z.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(z.FRAG_LOADING,this.onFragLoading,this),e.off(z.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:r,initPTS:n,timescale:a}){if(r===ot.MAIN){const c=t.cc,l=this.fragCurrent;if(this.initPTS[c]={baseTime:n,timescale:a},this.log(`InitPTS for cc: ${c} found from main: ${n}/${a}`),this.mainAnchor=t,this.state===Re.WAITING_INIT_PTS){const d=this.waitingData;(!d&&!this.loadingParts||d&&d.frag.cc!==c)&&this.syncWithAnchor(t,d==null?void 0:d.frag)}else!this.hls.hasEnoughToStart&&l&&l.cc!==c?(l.abortRequests(),this.syncWithAnchor(t,l)):this.state===Re.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var r;const n=((r=this.mainFragLoading)==null?void 0:r.frag)||null;if(t&&(n==null?void 0:n.cc)===t.cc)return;const a=(n||e).cc,c=this.getLevelDetails(),l=this.getLoadPosition(),d=AT(c,a,l);d&&(this.log(`Waiting fragment cc (${t==null?void 0:t.cc}) cancelled because video is at cc ${e.cc}`),this.startFragRequested=!1,this.nextLoadPosition=d.start,this.resetLoadingState(),this.state===Re.IDLE&&this.doTickIdle())}startLoad(e,t){if(!this.levels){this.startPosition=e,this.state=Re.STOPPED;return}const r=this.lastCurrentTime;this.stopLoad(),this.setInterval(RE),r>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),e=r,this.state=Re.IDLE):this.state=Re.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case Re.IDLE:this.doTickIdle();break;case Re.WAITING_TRACK:{const{levels:t,trackId:r}=this,n=t==null?void 0:t[r],a=n==null?void 0:n.details;if(a&&!this.waitForLive(n)){if(this.waitForCdnTuneIn(a))break;this.state=Re.WAITING_INIT_PTS}break}case Re.FRAG_LOADING_WAITING_RETRY:{var e;const t=performance.now(),r=this.retryDate;if(!r||t>=r||(e=this.media)!=null&&e.seeking){const{levels:n,trackId:a}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((n==null?void 0:n[a])||null),this.state=Re.IDLE}break}case Re.WAITING_INIT_PTS:{const t=this.waitingData;if(t){const{frag:r,part:n,cache:a,complete:c}=t,l=this.mainAnchor;if(this.initPTS[r.cc]!==void 0){this.waitingData=null,this.state=Re.FRAG_LOADING;const d=a.flush().buffer,u={frag:r,part:n,payload:d,networkDetails:null};this._handleFragmentLoadProgress(u),c&&super._handleFragmentLoadComplete(u)}else l&&l.cc!==t.frag.cc&&this.syncWithAnchor(l,t.frag)}else this.state=Re.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:r,media:n,trackId:a}=this,c=t.config;if(!this.buffering||!n&&!this.primaryPrefetch&&(this.startFragRequested||!c.startFragPrefetch)||!(r!=null&&r[a]))return;const l=r[a],d=l.details;if(!d||this.waitForLive(l)||this.waitForCdnTuneIn(d)){this.state=Re.WAITING_TRACK,this.startFragRequested=!1;return}const u=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&u&&(this.bufferFlushed=!1,this.afterBufferFlushed(u,ei.AUDIO,ot.AUDIO));const f=this.getFwdBufferInfo(u,ot.AUDIO);if(f===null)return;if(!this.switchingTrack&&this._streamEnded(f,d)){t.trigger(z.BUFFER_EOS,{type:"audio"}),this.state=Re.ENDED;return}const p=f.len,v=t.maxBufferLength,E=d.fragments,g=E[0].start,_=this.getLoadPosition(),m=this.flushing?_:f.end;if(this.switchingTrack&&n){const R=_;d.PTSKnown&&R<g&&(f.end>g||f.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=g+.05)}if(p>=v&&!this.switchingTrack&&m<E[E.length-1].start)return;let y=this.getNextFragment(m,d);if(y&&this.isLoopLoading(y,m)&&(y=this.getNextFragmentLoopLoading(y,d,f,ot.MAIN,v)),!y){this.bufferFlushed=!0;return}let b=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&b&&vi(y)&&!y.endList&&(!d.live||!this.loadingParts&&m<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(b)===Ni.OK&&(this.mainFragLoading=b=null),b&&vi(b))){if(y.start>b.end){const R=this.fragmentTracker.getFragAtPos(m,ot.MAIN);R&&R.end>b.end&&(b=R,this.mainFragLoading={frag:R,targetBufferTime:null})}if(y.start>b.end)return}this.loadFragment(y,l,m)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(r=>new tf(r))}onAudioTrackSwitching(e,t){const r=!!t.url;this.trackId=t.id;const{fragCurrent:n}=this;n&&(n.abortRequests(),this.removeUnbufferedFrags(n.start)),this.resetLoadingState(),r?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==Re.STOPPED&&(this.setInterval(RE),this.state=Re.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const r=this.cachedTrackLoadedData;r&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(z.AUDIO_TRACK_LOADED,r))}onAudioTrackLoaded(e,t){var r;const{levels:n}=this,{details:a,id:c,groupId:l,track:d}=t;if(!n){this.warn(`Audio tracks reset while loading track ${c} "${d.name}" of "${l}"`);return}const u=this.mainDetails;if(!u||a.endCC>u.endCC||u.expired){this.cachedTrackLoadedData=t,this.state!==Re.STOPPED&&(this.state=Re.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${c} "${d.name}" of "${l}" loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`);const f=n[c];let p=0;if(a.live||(r=f.details)!=null&&r.live){if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;if(f.details){var v;p=this.alignPlaylists(a,f.details,(v=this.levelLastLoaded)==null?void 0:v.details)}a.alignedSliding||(NT(a,u),a.alignedSliding||of(a,u),p=a.fragmentStart)}f.details=a,this.levelLastLoaded=f,this.startFragRequested||this.setStartPosition(u,p),this.hls.trigger(z.AUDIO_TRACK_UPDATED,{details:a,id:c,groupId:t.groupId}),this.state===Re.WAITING_TRACK&&!this.waitForCdnTuneIn(a)&&(this.state=Re.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const r=e.frag,{part:n,payload:a}=e,{config:c,trackId:l,levels:d}=this;if(!d){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const u=d[l];if(!u){this.warn("Audio track is undefined on fragment load progress");return}const f=u.details;if(!f){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(r.start);return}const p=c.defaultAudioCodec||u.audioCodec||"mp4a.40.2";let v=this.transmuxer;v||(v=this.transmuxer=new e4(this.hls,ot.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const E=this.initPTS[r.cc],g=(t=r.initSegment)==null?void 0:t.data;if(E!==void 0){const _=n?n.index:-1,m=_!==-1,y=new xT(r.level,r.sn,r.stats.chunkCount,a.byteLength,_,m);v.push(a,g,p,"",r,n,f.totalduration,!1,y,E)}else{this.log(`Unknown video PTS for cc ${r.cc}, waiting for video PTS before demuxing audio frag ${r.sn} of [${f.startSN} ,${f.endSN}],track ${l}`);const{cache:_}=this.waitingData=this.waitingData||{frag:r,part:n,cache:new J3,complete:!1};_.push(new Uint8Array(a)),this.state!==Re.STOPPED&&(this.state=Re.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const r=t.tracks.audio;r&&(this.mediaBuffer=r.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===ot.MAIN&&vi(t.frag)&&(this.mainFragLoading=t,this.state===Re.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:r,part:n}=t;if(r.type!==ot.AUDIO){!this.audioOnly&&r.type===ot.MAIN&&!r.elementaryStreams.video&&!r.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${n?" p: "+n.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(vi(r)){this.fragPrevious=r;const a=this.switchingTrack;a&&(this.bufferedTrack=a,this.switchingTrack=null,this.hls.trigger(z.AUDIO_TRACK_SWITCHED,Vt({},a)))}this.fragBufferedComplete(r,n),this.media&&this.tick()}onError(e,t){var r;if(t.fatal){this.state=Re.ERROR;return}switch(t.details){case he.FRAG_GAP:case he.FRAG_PARSING_ERROR:case he.FRAG_DECRYPT_ERROR:case he.FRAG_LOAD_ERROR:case he.FRAG_LOAD_TIMEOUT:case he.KEY_LOAD_ERROR:case he.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ot.AUDIO,t);break;case he.AUDIO_TRACK_LOAD_ERROR:case he.AUDIO_TRACK_LOAD_TIMEOUT:case he.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===Re.WAITING_TRACK&&((r=t.context)==null?void 0:r.type)===Un.AUDIO_TRACK&&(this.state=Re.IDLE);break;case he.BUFFER_ADD_CODEC_ERROR:case he.BUFFER_APPEND_ERROR:if(t.parent!=="audio")return;this.resetLoadingState();break;case he.BUFFER_FULL_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case he.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==ei.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==ei.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===Re.ENDED&&(this.state=Re.IDLE);const r=this.mediaBuffer||this.media;r&&(this.afterBufferFlushed(r,t,ot.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const r="audio",{hls:n}=this,{remuxResult:a,chunkMeta:c}=e,l=this.getCurrentContext(c);if(!l){this.resetWhenMissingContext(c);return}const{frag:d,part:u,level:f}=l,{details:p}=f,{audio:v,text:E,id3:g,initSegment:_}=a;if(this.fragContextChanged(d)||!p){this.fragmentTracker.removeFragment(d);return}if(this.state=Re.PARSING,this.switchingTrack&&v&&this.completeAudioSwitch(this.switchingTrack),_!=null&&_.tracks){const m=d.initSegment||d;this._bufferInitSegment(f,_.tracks,m,c),n.trigger(z.FRAG_PARSING_INIT_SEGMENT,{frag:m,id:r,tracks:_.tracks})}if(v){const{startPTS:m,endPTS:y,startDTS:b,endDTS:R}=v;u&&(u.elementaryStreams[ei.AUDIO]={startPTS:m,endPTS:y,startDTS:b,endDTS:R}),d.setElementaryStreamInfo(ei.AUDIO,m,y,b,R),this.bufferFragmentData(v,d,u,c)}if(g!=null&&(t=g.samples)!=null&&t.length){const m=Yt({id:r,frag:d,details:p},g);n.trigger(z.FRAG_PARSING_METADATA,m)}if(E){const m=Yt({id:r,frag:d,details:p},E);n.trigger(z.FRAG_PARSING_USERDATA,m)}}_bufferInitSegment(e,t,r,n){if(this.state!==Re.PARSING||(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio))return;const a=t.audio;a.id=ot.AUDIO;const c=e.audioCodec;this.log(`Init audio buffer, container:${a.container}, codecs[level/parsed]=[${c}/${a.codec}]`),c&&c.split(",").length===1&&(a.levelCodec=c),this.hls.trigger(z.BUFFER_CODECS,t);const l=a.initSegment;if(l!=null&&l.byteLength){const d={type:"audio",frag:r,part:null,chunkMeta:n,parent:r.type,data:l};this.hls.trigger(z.BUFFER_APPENDING,d)}this.tickImmediate()}loadFragment(e,t,r){const n=this.fragmentTracker.getState(e);if(this.switchingTrack||n===Ni.NOT_LOADED||n===Ni.PARTIAL){var a;if(!vi(e))this._loadInitSegment(e,t);else if((a=t.details)!=null&&a.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=Re.WAITING_INIT_PTS;const c=this.mainDetails;c&&c.fragmentStart!==t.details.fragmentStart&&of(t.details,c)}else super.loadFragment(e,t,r)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:r,assocLang:n,characteristics:a,audioCodec:c,channels:l}=this.bufferedTrack;ha({name:t,lang:r,assocLang:n,characteristics:a,audioCodec:c,channels:l},e,oa)||(TT(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(z.AUDIO_TRACK_SWITCHED,Vt({},e))}}class tC extends jn{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,r){const n=t==null?void 0:t.renditionReports;if(n){let a=-1;for(let c=0;c<n.length;c++){const l=n[c];let d;try{d=new self.URL(l.URI,t.url).href}catch(u){this.warn(`Could not construct new URL for Rendition Report: ${u}`),d=l.URI||""}if(d===e){a=c;break}else d===e.substring(0,d.length)&&(a=c)}if(a!==-1){const c=n[a],l=parseInt(c["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let d=parseInt(c["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const f=Math.min(t.age-t.partTarget,t.targetduration);d>=0&&f>t.partTarget&&(d+=1)}const u=r&&QS(r);return new ZS(l,d>=0?d:void 0,u)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(r){this.warn(`Could not construct new URL with HLS Delivery Directives: ${r}`)}return e}playlistLoaded(e,t,r){const{details:n,stats:a}=t,c=self.performance.now(),l=a.loading.first?Math.max(0,c-a.loading.first):0;n.advancedDateTime=Date.now()-l;const d=this.hls.config.timelineOffset;if(d!==n.appliedTimelineOffset){const f=Math.max(d||0,0);n.appliedTimelineOffset=f,n.fragments.forEach(p=>{p.start=p.playlistOffset+f})}if(n.live||r!=null&&r.live){const f="levelInfo"in t?t.levelInfo:t.track;if(n.reloaded(r),r&&n.fragments.length>0){H3(r,n);const b=n.playlistParsingError;if(b){this.warn(b);const R=this.hls;if(!R.config.ignorePlaylistParsingErrors){var u;const{networkDetails:T}=t;R.trigger(z.ERROR,{type:Je.NETWORK_ERROR,details:he.LEVEL_PARSING_ERROR,fatal:!1,url:n.url,error:b,reason:b.message,level:t.level||void 0,parent:(u=n.fragments[0])==null?void 0:u.type,networkDetails:T,stats:a});return}n.playlistParsingError=null}}n.requestScheduled===-1&&(n.requestScheduled=a.loading.start);const p=this.hls.mainForwardBufferInfo,v=p?p.end-p.len:0,E=(n.edge-v)*1e3,g=Y3(n,E);if(n.requestScheduled+g<c?n.requestScheduled=c:n.requestScheduled+=g,this.log(`live playlist ${e} ${n.advanced?"REFRESHED "+n.lastPartSn+"-"+n.lastPartIndex:n.updated?"UPDATED":"MISSED"}`),!this.canLoad||!n.live)return;let _,m,y;if(n.canBlockReload&&n.endSN&&n.advanced){const b=this.hls.config.lowLatencyMode,R=n.lastPartSn,T=n.endSN,w=n.lastPartIndex,C=w!==-1,A=R===T;C?A?(m=T+1,y=b?0:w):(m=R,y=b?w+1:n.maxPartIndex):m=T+1;const L=n.age,D=L+n.ageHeader;let P=Math.min(D-n.partTarget,n.targetduration*1.5);if(P>0){if(D>n.targetduration*3)this.log(`Playlist last advanced ${L.toFixed(2)}s ago. Omitting segment and part directives.`),m=void 0,y=void 0;else if(r!=null&&r.tuneInGoal&&D-n.partTarget>r.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${r.tuneInGoal} to: ${P} with playlist age: ${n.age}`),P=0;else{const k=Math.floor(P/n.targetduration);if(m+=k,y!==void 0){const M=Math.round(P%n.targetduration/n.partTarget);y+=M}this.log(`CDN Tune-in age: ${n.ageHeader}s last advanced ${L.toFixed(2)}s goal: ${P} skip sn ${k} to part ${y}`)}n.tuneInGoal=P}if(_=this.getDeliveryDirectives(n,t.deliveryDirectives,m,y),b||!A){n.requestScheduled=c,this.loadingPlaylist(f,_);return}}else(n.canBlockReload||n.canSkipUntil)&&(_=this.getDeliveryDirectives(n,t.deliveryDirectives,m,y));_&&m!==void 0&&n.canBlockReload&&(n.requestScheduled=a.loading.first+Math.max(g-l*2,g/2)),this.scheduleLoading(f,_,n)}else this.clearTimer()}scheduleLoading(e,t,r){const n=r||e.details;if(!n){this.loadingPlaylist(e,t);return}const a=self.performance.now(),c=n.requestScheduled;if(a>=c){this.loadingPlaylist(e,t);return}const l=c-a;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(l)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),l)}getDeliveryDirectives(e,t,r,n){let a=QS(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(r=t.msn,n=t.part,a=Nd.No),new ZS(r,n,a)}checkRetry(e){const t=e.details,r=rf(e),n=e.errorAction,{action:a,retryCount:c=0,retryConfig:l}=n||{},d=!!n&&!!l&&(a===jr.RetryRequest||!n.resolved&&a===jr.SendAlternateToPenaltyBox);if(d){var u;if(c>=l.maxNumRetry)return!1;if(r&&(u=e.context)!=null&&u.deliveryDirectives)this.warn(`Retrying playlist loading ${c+1}/${l.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const f=Tv(l,c);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),f),this.warn(`Retrying playlist loading ${c+1}/${l.maxNumRetry} after "${t}" in ${f}ms`)}e.levelRetry=!0,n.resolved=!0}return d}}function rC(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!Dl(i[t].attrs,e[t].attrs))return!1;return!0}function Dl(i,e,t){const r=i["STABLE-RENDITION-ID"];return r&&!t?r===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(n=>i[n]!==e[n])}function qg(i,e){return e.label.toLowerCase()===i.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(i.lang||"").toLowerCase())}class r4 extends tC{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(z.MANIFEST_LOADING,this.onManifestLoading,this),e.on(z.MANIFEST_PARSED,this.onManifestParsed,this),e.on(z.LEVEL_LOADING,this.onLevelLoading,this),e.on(z.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(z.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(z.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(z.MANIFEST_LOADING,this.onManifestLoading,this),e.off(z.MANIFEST_PARSED,this.onManifestParsed,this),e.off(z.LEVEL_LOADING,this.onLevelLoading,this),e.off(z.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(z.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(z.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:r,groupId:n,details:a}=t,c=this.tracksInGroup[r];if(!c||c.groupId!==n){this.warn(`Audio track with id:${r} and group:${n} not found in active group ${c==null?void 0:c.groupId}`);return}const l=c.details;c.details=t.details,this.log(`Audio track ${r} "${c.name}" lang:${c.lang} group:${n} loaded [${a.startSN}-${a.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,l)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const r=t.audioGroups||null,n=this.groupIds;let a=this.currentTrack;if(!r||(n==null?void 0:n.length)!==(r==null?void 0:r.length)||r!=null&&r.some(l=>(n==null?void 0:n.indexOf(l))===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const l=this.tracks.filter(v=>!r||r.indexOf(v.groupId)!==-1);if(l.length)this.selectDefaultTrack&&!l.some(v=>v.default)&&(this.selectDefaultTrack=!1),l.forEach((v,E)=>{v.id=E});else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=l;const d=this.hls.config.audioPreference;if(!a&&d){const v=vn(d,l,oa);if(v>-1)a=l[v];else{const E=vn(d,this.tracks);a=this.tracks[E]}}let u=this.findTrackId(a);u===-1&&a&&(u=this.findTrackId(null));const f={audioTracks:l};this.log(`Updating audio tracks, ${l.length} track(s) found in group(s): ${r==null?void 0:r.join(",")}`),this.hls.trigger(z.AUDIO_TRACKS_UPDATED,f);const p=this.trackId;if(u!==-1&&p===-1)this.setAudioTrack(u);else if(l.length&&p===-1){var c;const v=new Error(`No audio track selected for current audio group-ID(s): ${(c=this.groupIds)==null?void 0:c.join(",")} track count: ${l.length}`);this.warn(v.message),this.hls.trigger(z.ERROR,{type:Je.MEDIA_ERROR,details:he.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:v})}}}onError(e,t){t.fatal||!t.context||t.context.type===Un.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const r=this.allAudioTracks;if(this.selectDefaultTrack=!1,r.length){const n=this.currentTrack;if(n&&ha(e,n,oa))return n;const a=vn(e,this.tracksInGroup,oa);if(a>-1){const c=this.tracksInGroup[a];return this.setAudioTrack(a),c}else if(n){let c=t.loadLevel;c===-1&&(c=t.firstAutoLevel);const l=h3(e,t.levels,r,c,oa);if(l===-1)return null;t.nextLoadLevel=l}if(e.channels||e.audioCodec){const c=vn(e,r);if(c>-1)return r[c]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const r=this.currentTrack,n=t[e],a=n.details&&!n.details.live;if(e===this.trackId&&n===r&&a||(this.log(`Switching to audio-track ${e} "${n.name}" lang:${n.lang} group:${n.groupId} channels:${n.channels}`),this.trackId=e,this.currentTrack=n,this.hls.trigger(z.AUDIO_TRACK_SWITCHING,Vt({},n)),a))return;const c=this.switchParams(n.url,r==null?void 0:r.details,n.details);this.loadPlaylist(c)}findTrackId(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const n=t[r];if(!(this.selectDefaultTrack&&!n.default)&&(!e||ha(e,n,oa)))return r}if(e){const{name:r,lang:n,assocLang:a,characteristics:c,audioCodec:l,channels:d}=e;for(let u=0;u<t.length;u++){const f=t[u];if(ha({name:r,lang:n,assocLang:a,characteristics:c,audioCodec:l,channels:d},f,oa))return u}for(let u=0;u<t.length;u++){const f=t[u];if(Dl(e.attrs,f.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return u}for(let u=0;u<t.length;u++){const f=t[u];if(Dl(e.attrs,f.attrs,["LANGUAGE"]))return u}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&TT(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=e.id,n=e.groupId,a=this.getUrlWithDirectives(e.url,t),c=e.details,l=c==null?void 0:c.age;this.log(`Loading audio-track ${r} "${e.name}" lang:${e.lang} group:${n}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${l&&c.live?" age "+l.toFixed(1)+(c.type&&" "+c.type||""):""} ${a}`),this.hls.trigger(z.AUDIO_TRACK_LOADING,{url:a,id:r,groupId:n,deliveryDirectives:t||null,track:e})}}class i4{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,r){if(this.queues===null||this.tracks===null)return;const n=this.queues[t];n.push(e),n.length===1&&!r&&this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const r={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(r,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const r={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(r)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const r=(t=e[0])==null?void 0:t.label;(r==="async-blocker"||r==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){this.queues!==null&&this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const t=this.queues[e];if(t.length){const n=t[0];try{n.execute()}catch(a){var r;if(n.onError(a),this.queues===null||this.tracks===null)return;const c=(r=this.tracks[e])==null?void 0:r.buffer;c!=null&&c.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return((t=this.queues)==null?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return e===null||t===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var t,r;return(t=this.queues)!=null&&t[e]||(r=this.tracks)!=null&&r[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const r=(t=this.tracks)==null?void 0:t[e],n=r==null?void 0:r.buffer;return n?`SourceBuffer${n.updating?" updating":""}${r.ended?" ended":""}${r.ending?" ending":""}`:"none"}listOps(e){var t;return((t=this.queues)==null?void 0:t[e].map(r=>r.label).join(", "))||""}}const wE=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,iC="HlsJsTrackRemovedError";class n4 extends Error{constructor(e){super(e),this.name=iC}}class s4 extends jn{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=r=>{var n;this.hls&&((n=this.mediaSource)==null?void 0:n.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=r=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=r=>{const{media:n,mediaSource:a}=this;r&&this.log("Media source opened"),!(!n||!a)&&(a.removeEventListener("sourceopen",this._onMediaSourceOpen),n.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(z.MEDIA_ATTACHED,{media:n,mediaSource:a}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:r,_objectUrl:n}=this;r!==n&&this.error(`Media element src was set while attaching MediaSource (${n} > ${r})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=DM(Cl(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(z.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(z.MANIFEST_LOADING,this.onManifestLoading,this),e.on(z.MANIFEST_PARSED,this.onManifestParsed,this),e.on(z.BUFFER_RESET,this.onBufferReset,this),e.on(z.BUFFER_APPENDING,this.onBufferAppending,this),e.on(z.BUFFER_CODECS,this.onBufferCodecs,this),e.on(z.BUFFER_EOS,this.onBufferEos,this),e.on(z.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(z.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(z.FRAG_PARSED,this.onFragParsed,this),e.on(z.FRAG_CHANGED,this.onFragChanged,this),e.on(z.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(z.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(z.MANIFEST_LOADING,this.onManifestLoading,this),e.off(z.MANIFEST_PARSED,this.onManifestParsed,this),e.off(z.BUFFER_RESET,this.onBufferReset,this),e.off(z.BUFFER_APPENDING,this.onBufferAppending,this),e.off(z.BUFFER_CODECS,this.onBufferCodecs,this),e.off(z.BUFFER_EOS,this.onBufferEos,this),e.off(z.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(z.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(z.FRAG_PARSED,this.onFragParsed,this),e.off(z.FRAG_CHANGED,this.onFragChanged,this),e.off(z.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const r={};if(this.operationQueue){const a=this.isUpdating();a||this.operationQueue.removeBlockers();const c=this.isQueued();(a||c)&&this.warn(`Transfering MediaSource with${c?" operations in queue":""}${a?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const n=this.transferData;return!this.sourceBufferCount&&n&&n.mediaSource===t?Yt(r,n.tracks):this.sourceBuffers.forEach(a=>{const[c]=a;c&&(r[c]=Yt({},this.tracks[c]),this.removeBuffer(c)),a[0]=a[1]=null}),{media:e,mediaSource:t,tracks:r}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var r;let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsTotal=n,this.log(`${n} bufferCodec event(s) expected.`),(r=this.transferData)!=null&&r.mediaSource&&this.sourceBufferCount&&n&&this.bufferCreated()}onMediaAttaching(e,t){const r=this.media=t.media,n=Cl(this.appendSource);if(this.transferData=this.overrides=void 0,r&&n){const a=!!t.mediaSource;(a||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const c=this.mediaSource=t.mediaSource||new n;if(this.assignMediaSource(c),a)this._objectUrl=r.src,this.attachTransferred();else{const l=this._objectUrl=self.URL.createObjectURL(c);if(this.appendSource)try{r.removeAttribute("src");const d=self.ManagedMediaSource;r.disableRemotePlayback=r.disableRemotePlayback||d&&c instanceof d,TE(r),a4(r,l),r.load()}catch{r.src=l}else r.src=l}r.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,r;this.log(`${((t=this.transferData)==null?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${(r=e.constructor)==null?void 0:r.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const r=this.tracks,n=t.tracks,a=n?Object.keys(n):null,c=a?a.length:0,l=()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()};if(n&&a&&c){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${hr(r,(d,u)=>d==="initSegment"?void 0:u)};
transfer tracks: ${hr(n,(d,u)=>d==="initSegment"?void 0:u)}}`),!pT(n,r)){t.mediaSource=null,t.tracks=void 0;const d=e.currentTime,u=this.details,f=Math.max(d,(u==null?void 0:u.fragments[0].start)||0);if(f-d>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${d} -> ${f}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(n)}"->"${Object.keys(r)}") start time: ${f} currentTime: ${d}`),this.onMediaDetaching(z.MEDIA_DETACHING,{}),this.onMediaAttaching(z.MEDIA_ATTACHING,t),e.currentTime=f;return}this.transferData=void 0,a.forEach(d=>{const u=d,f=n[u];if(f){const p=f.buffer;if(p){const v=this.fragmentTracker,E=f.id;if(v.hasFragments(E)||v.hasParts(E)){const m=Lt.getBuffered(p);v.detectEvictedFragments(u,m,E,null,!0)}const g=Lm(u),_=[u,p];this.sourceBuffers[g]=_,p.updating&&this.operationQueue&&this.operationQueue.prependBlocker(u),this.trackSourceBuffer(u,f)}}}),l(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),l()}get mediaSourceOpenOrEnded(){var e;const t=(e=this.mediaSource)==null?void 0:e.readyState;return t==="open"||t==="ended"}onMediaDetaching(e,t){const r=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:n,mediaSource:a,_objectUrl:c}=this;if(a){if(this.log(`media source ${r?"transferring":"detaching"}`),r)this.sourceBuffers.forEach(([l])=>{l&&this.removeBuffer(l)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const l=a.readyState==="open";try{const d=a.sourceBuffers;for(let u=d.length;u--;)l&&d[u].abort(),a.removeSourceBuffer(d[u]);l&&a.endOfStream()}catch(d){this.warn(`onMediaDetaching: ${d.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}a.removeEventListener("sourceopen",this._onMediaSourceOpen),a.removeEventListener("sourceended",this._onMediaSourceEnded),a.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(a.removeEventListener("startstreaming",this._onStartStreaming),a.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}n&&(n.removeEventListener("emptied",this._onMediaEmptied),r||(c&&self.URL.revokeObjectURL(c),this.mediaSrc===c?(n.removeAttribute("src"),this.appendSource&&TE(n),n.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(z.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const r=(t=this.tracks[e])==null?void 0:t.buffer;if(this.removeBuffer(e),r)try{var n;(n=this.mediaSource)!=null&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(r)}catch(a){this.warn(`onBufferReset ${e}`,a)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[Lm(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new i4(this.tracks)}onBufferCodecs(e,t){const r=this.tracks,n=Object.keys(t);this.log(`BUFFER_CODECS: "${n}" (current SB count ${this.sourceBufferCount})`);const a="audiovideo"in t&&(r.audio||r.video)||r.audiovideo&&("audio"in t||"video"in t),c=!a&&this.sourceBufferCount&&this.media&&n.some(l=>!r[l]);if(a||c){this.warn(`Unsupported transition between "${Object.keys(r)}" and "${n}" SourceBuffers`);return}n.forEach(l=>{var d,u,f;const p=t[l],{id:v,codec:E,levelCodec:g,container:_,metadata:m,supplemental:y}=p;let b=r[l];const R=(d=this.transferData)==null||(u=d.tracks)==null?void 0:u[l],T=R!=null&&R.buffer?R:b,w=(T==null?void 0:T.pendingCodec)||(T==null?void 0:T.codec),C=T==null?void 0:T.levelCodec;b||(b=r[l]={buffer:void 0,listeners:[],codec:E,supplemental:y,container:_,levelCodec:g,metadata:m,id:v});const A=Em(w,C),L=A==null?void 0:A.replace(wE,"$1");let D=Em(E,g);const P=(f=D)==null?void 0:f.replace(wE,"$1");D&&A&&L!==P&&(l.slice(0,5)==="audio"&&(D=zg(D,this.appendSource)),this.log(`switching codec ${w} to ${D}`),D!==(b.pendingCodec||b.codec)&&(b.pendingCodec=D),b.container=_,this.appendChangeType(l,_,D))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&this.mediaSourceOpenOrEnded&&this.checkPendingTracks()}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const r=this.tracks[t];return e[t]={id:r.id,container:r.container,codec:r.codec,levelCodec:r.levelCodec},e},{})}appendChangeType(e,t,r){const n=`${t};codecs=${r}`,a={label:`change-type=${n}`,execute:()=>{const c=this.tracks[e];if(c){const l=c.buffer;l!=null&&l.changeType&&(this.log(`changing ${e} sourceBuffer type to ${n}`),l.changeType(n),c.codec=r,c.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:c=>{this.warn(`Failed to change ${e} SourceBuffer type`,c)}};this.append(a,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const r=e.start,n=r+e.duration*.05;if(((t=this.fragmentTracker.getAppendedFrag(r,ot.MAIN))==null?void 0:t.gap)===!0)return;const a={label:"block-audio",execute:()=>{var c;const l=this.tracks.video;(this.lastVideoAppendEnd>n||l!=null&&l.buffer&&Lt.isBuffered(l.buffer,n)||((c=this.fragmentTracker.getAppendedFrag(n,ot.MAIN))==null?void 0:c.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:c=>{this.warn("Error executing block-audio operation",c)}};this.blockedAudioAppend={op:a,frag:e},this.append(a,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:r}=this,{data:n,type:a,parent:c,frag:l,part:d,chunkMeta:u}=t,f=u.buffering[a],p=l.sn,v=self.performance.now();f.start=v;const E=l.stats.buffering,g=d?d.stats.buffering:null;E.start===0&&(E.start=v),g&&g.start===0&&(g.start=v);const _=r.audio;let m=!1;a==="audio"&&(_==null?void 0:_.container)==="audio/mpeg"&&(m=!this.lastMpegAudioChunk||u.id===1||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);const y=this.tracks.video,b=y==null?void 0:y.buffer;if(b&&p!=="initSegment"){const w=d||l,C=this.blockedAudioAppend;if(a==="audio"&&c!=="main"&&!this.blockedAudioAppend){const A=w.start+w.duration*.05,L=b.buffered,D=this.currentOp("video");!L.length&&!D?this.blockAudio(w):!D&&!Lt.isBuffered(b,A)&&this.lastVideoAppendEnd<A&&this.blockAudio(w)}else if(a==="video"){const A=w.end;if(C){const L=C.frag.start;(A>L||A<this.lastVideoAppendEnd||Lt.isBuffered(b,L))&&this.unblockAudio()}this.lastVideoAppendEnd=A}}const R=(d||l).start,T={label:`append-${a}`,execute:()=>{if(f.executeStart=self.performance.now(),m){const w=this.tracks[a];if(w){const C=w.buffer;if(C){const A=R-C.timestampOffset;Math.abs(A)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${R} (delta: ${A}) sn: ${p})`),C.timestampOffset=R)}}}this.appendExecutor(n,a)},onStart:()=>{},onComplete:()=>{const w=self.performance.now();f.executeEnd=f.end=w,E.first===0&&(E.first=w),g&&g.first===0&&(g.first=w);const C={};this.sourceBuffers.forEach(([A,L])=>{A&&(C[A]=Lt.getBuffered(L))}),this.appendErrors[a]=0,a==="audio"||a==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(z.BUFFER_APPENDED,{type:a,frag:l,part:d,chunkMeta:u,parent:l.type,timeRanges:C})},onError:w=>{var C;const A={type:Je.MEDIA_ERROR,parent:l.type,details:he.BUFFER_APPEND_ERROR,sourceBufferName:a,frag:l,part:d,chunkMeta:u,error:w,err:w,fatal:!1},L=(C=this.media)==null?void 0:C.error;if(w.code===DOMException.QUOTA_EXCEEDED_ERR)A.details=he.BUFFER_FULL_ERROR;else if(w.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!L)A.errorAction=Al(!0);else if(w.name===iC&&this.sourceBufferCount===0)A.errorAction=Al(!0);else{const D=++this.appendErrors[a];this.warn(`Failed ${D}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${a}" sourceBuffer (${L||"no media error"})`),(D>=this.hls.config.appendErrorMaxRetry||L)&&(A.fatal=!0)}this.hls.trigger(z.ERROR,A)}};this.append(T,a,this.isPending(this.tracks[a]))}getFlushOp(e,t,r){return this.log(`queuing "${e}" remove ${t}-${r}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,r)},onStart:()=>{},onComplete:()=>{this.hls.trigger(z.BUFFER_FLUSHED,{type:e})},onError:n=>{this.warn(`Failed to remove ${t}-${r} from "${e}" SourceBuffer`,n)}}}onBufferFlushing(e,t){const{type:r,startOffset:n,endOffset:a}=t;r?this.append(this.getFlushOp(r,n,a),r):this.sourceBuffers.forEach(([c])=>{c&&this.append(this.getFlushOp(c,n,a),c)})}onFragParsed(e,t){const{frag:r,part:n}=t,a=[],c=n?n.elementaryStreams:r.elementaryStreams;c[ei.AUDIOVIDEO]?a.push("audiovideo"):(c[ei.AUDIO]&&a.push("audio"),c[ei.VIDEO]&&a.push("video"));const l=()=>{const d=self.performance.now();r.stats.buffering.end=d,n&&(n.stats.buffering.end=d);const u=n?n.stats:r.stats;this.hls.trigger(z.FRAG_BUFFERED,{frag:r,part:n,stats:u,id:r.type})};a.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${r.type} level: ${r.level} sn: ${r.sn}`),this.blockBuffers(l,a).catch(d=>{this.warn(`Fragment buffered callback ${d}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{var t,r;return e&&(!((t=this.tracks[e])!=null&&t.ended)||((r=this.tracks[e])==null?void 0:r.ending))})}onBufferEos(e,t){var r;this.sourceBuffers.forEach(([a])=>{if(a){const c=this.tracks[a];(!t.type||t.type===a)&&(c.ending=!0,c.ended||(c.ended=!0,this.log(`${a} buffer reached EOS`)))}});const n=((r=this.overrides)==null?void 0:r.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([a])=>{var c;return a&&!((c=this.tracks[a])!=null&&c.ended)})&&(n?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:a}=this;if(!a||a.readyState!=="open"){a&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${a.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),a.endOfStream(),this.hls.trigger(z.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(z.BUFFERED_TO_END,void 0)))}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){const e=this.getDurationAndRange();e&&this.blockUntilOpen(()=>this.updateMediaSource(e))}onError(e,t){if(t.details===he.BUFFER_APPEND_ERROR&&t.frag){var r;const n=(r=t.errorAction)==null?void 0:r.nextAutoLevel;He(n)&&n!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:r}=this;if(!r||t===null||!this.sourceBufferCount)return;const n=e.config,a=r.currentTime,c=t.levelTargetDuration,l=t.live&&n.liveBackBufferLength!==null?n.liveBackBufferLength:n.backBufferLength;if(He(l)&&l>=0){const d=Math.max(l,c),u=Math.floor(a/c)*c-d;this.flushBackBuffer(a,c,u)}if(He(n.frontBufferFlushThreshold)&&n.frontBufferFlushThreshold>0){const d=Math.max(n.maxBufferLength,n.frontBufferFlushThreshold),u=Math.max(d,c),f=Math.floor(a/c)*c+u;this.flushFrontBuffer(a,c,f)}}flushBackBuffer(e,t,r){this.sourceBuffers.forEach(([n,a])=>{if(a){const l=Lt.getBuffered(a);if(l.length>0&&r>l.start(0)){var c;this.hls.trigger(z.BACK_BUFFER_REACHED,{bufferEnd:r});const d=this.tracks[n];if((c=this.details)!=null&&c.live)this.hls.trigger(z.LIVE_BACK_BUFFER_REACHED,{bufferEnd:r});else if(d!=null&&d.ended){this.log(`Cannot flush ${n} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(z.BUFFER_FLUSHING,{startOffset:0,endOffset:r,type:n})}}})}flushFrontBuffer(e,t,r){this.sourceBuffers.forEach(([n,a])=>{if(a){const c=Lt.getBuffered(a),l=c.length;if(l<2)return;const d=c.start(l-1),u=c.end(l-1);if(r>d||e>=d&&e<=u)return;this.hls.trigger(z.BUFFER_FLUSHING,{startOffset:d,endOffset:1/0,type:n})}})}getDurationAndRange(){var e;const{details:t,mediaSource:r}=this;if(!t||!this.media||(r==null?void 0:r.readyState)!=="open")return null;const n=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&t.live&&r.setLiveSeekableRange){const d=Math.max(0,t.fragmentStart),u=Math.max(d,n);return{duration:1/0,start:d,end:u}}return{duration:1/0}}const a=(e=this.overrides)==null?void 0:e.duration;if(a)return He(a)?{duration:a}:null;const c=this.media.duration,l=He(r.duration)?r.duration:0;return n>l&&n>c||!He(c)?{duration:n}:null}updateMediaSource({duration:e,start:t,end:r}){const n=this.mediaSource;!this.media||!n||n.readyState!=="open"||(n.duration!==e&&(He(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),n.duration=e),t!==void 0&&r!==void 0&&(this.log(`MediaSource duration is set to ${n.duration}. Setting seekable range to ${t}-${r}.`),n.setLiveSeekableRange(t,r)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:r}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${hr(r)}`),this.tracksReady){var n;const a=(n=this.transferData)==null?void 0:n.tracks;a&&Object.keys(a).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,r])=>{if(t){const n=this.tracks[t];e[t]={buffer:r,container:n.container,codec:n.codec,supplemental:n.supplemental,levelCodec:n.levelCodec,id:n.id,metadata:n.metadata}}}),this.hls.trigger(z.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([t])=>{this.executeNext(t)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(z.ERROR,{type:Je.MEDIA_ERROR,details:he.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:r}=this;if(!r)throw new Error("createSourceBuffers called when mediaSource was null");for(const a in e){const c=a,l=e[c];if(this.isPending(l)){const d=this.getTrackCodec(l,c),u=`${l.container};codecs=${d}`;l.codec=d,this.log(`creating sourceBuffer(${u})${this.currentOp(c)?" Queued":""} ${hr(l)}`);try{const f=r.addSourceBuffer(u),p=Lm(c),v=[c,f];t[p]=v,l.buffer=f}catch(f){var n;this.error(`error while trying to add sourceBuffer: ${f.message}`),this.shiftAndExecuteNext(c),(n=this.operationQueue)==null||n.removeBlockers(),delete this.tracks[c],this.hls.trigger(z.ERROR,{type:Je.MEDIA_ERROR,details:he.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:f,sourceBufferName:c,mimeType:u,parent:l.id});return}this.trackSourceBuffer(c,l)}}this.bufferCreated()}getTrackCodec(e,t){const r=e.supplemental;let n=e.codec;r&&(t==="video"||t==="audiovideo")&&WM(r,"video")&&(n=ZM(n,r));const a=Em(n,e.levelCodec);return a?t.slice(0,5)==="audio"?zg(a,this.appendSource):a:""}trackSourceBuffer(e,t){const r=t.buffer;if(!r)return;const n=this.getTrackCodec(t,e);this.tracks[e]={buffer:r,codec:n,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(a,c)=>{const l=c.removedRanges;l!=null&&l.length&&this.hls.trigger(z.BUFFER_FLUSHED,{type:a})})}get mediaSrc(){var e,t;const r=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return r==null?void 0:r.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const r=this.currentOp(e);r&&(r.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var r;const n=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(r=this.mediaSource)==null?void 0:r.readyState}`);this.error(`${n}`,t),this.hls.trigger(z.ERROR,{type:Je.MEDIA_ERROR,details:he.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:n,fatal:!1});const a=this.currentOp(e);a&&a.onError(n)}removeExecutor(e,t,r){const{media:n,mediaSource:a}=this,c=this.tracks[e],l=c==null?void 0:c.buffer;if(!n||!a||!l){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const d=He(n.duration)?n.duration:1/0,u=He(a.duration)?a.duration:1/0,f=Math.max(0,t),p=Math.min(r,d,u);p>f&&(!c.ending||c.ended)?(c.ended=!1,this.log(`Removing [${f},${p}] from the ${e} SourceBuffer`),l.remove(f,p)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const r=this.tracks[t],n=r==null?void 0:r.buffer;if(!n)throw new n4(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);r.ending=!1,r.ended=!1,n.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:r}=this,n=t.map(a=>this.appendBlocker(a));return t.length>1&&this.blockedAudioAppend&&this.unblockAudio(),Promise.all(n).then(a=>{r===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(t=>{var r;const n=(r=this.tracks[t])==null?void 0:r.buffer;!n||n.updating||this.shiftAndExecuteNext(t)})}append(e,t,r){this.operationQueue&&this.operationQueue.append(e,t,r)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,r){const n=this.tracks[e];if(!n)return;const a=n.buffer;if(!a)return;const c=r.bind(this,e);n.listeners.push({event:t,listener:c}),a.addEventListener(t,c)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const r=t.buffer;r&&(t.listeners.forEach(n=>{r.removeEventListener(n.event,n.listener)}),t.listeners.length=0)}}function TE(i){const e=i.querySelectorAll("source");[].slice.call(e).forEach(t=>{i.removeChild(t)})}function a4(i,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,i.appendChild(t)}function Lm(i){return i==="audio"?1:0}class Mv{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(z.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(z.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(z.MANIFEST_PARSED,this.onManifestParsed,this),e.on(z.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(z.BUFFER_CODECS,this.onBufferCodecs,this),e.on(z.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(z.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(z.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(z.MANIFEST_PARSED,this.onManifestParsed,this),e.off(z.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(z.BUFFER_CODECS,this.onBufferCodecs,this),e.off(z.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const r=this.hls.levels[t.droppedLevel];this.isLevelAllowed(r)&&this.restrictedLevels.push({bitrate:r.bitrate,height:r.height,width:r.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const r=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,r.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&He(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,r=this.getMaxLevel(e.length-1);r!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${r}: ${e[r].height}p@${e[r].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=r,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const r=t.filter((n,a)=>this.isLevelAllowed(n)&&a<=e);return this.clientRect=null,Mv.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,!t.width&&!t.height&&(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(t=>e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height)}static getMaxLevelByMediaSize(e,t,r){if(!(e!=null&&e.length))return-1;const n=(l,d)=>d?l.width!==d.width||l.height!==d.height:!0;let a=e.length-1;const c=Math.max(t,r);for(let l=0;l<e.length;l+=1){const d=e[l];if((d.width>=c||d.height>=c)&&n(d,e[l+1])){a=l;break}}return a}}const o4={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},Zr=o4,c4={HLS:"h"},l4=c4,u4="CMCD-Object",d4="CMCD-Request",f4="CMCD-Session",h4="CMCD-Status",ul={OBJECT:u4,REQUEST:d4,SESSION:f4,STATUS:h4},p4={[ul.OBJECT]:["br","d","ot","tb"],[ul.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[ul.SESSION]:["cid","pr","sf","sid","st","v"],[ul.STATUS]:["bs","rtp"]};class Do{constructor(e,t){Array.isArray(e)&&(e=e.map(r=>r instanceof Do?r:new Do(r))),this.value=e,this.params=t}}const m4="Dict";function g4(i){return Array.isArray(i)?JSON.stringify(i):i instanceof Map?"Map{}":i instanceof Set?"Set{}":typeof i=="object"?JSON.stringify(i):String(i)}function v4(i,e,t,r){return new Error(`failed to ${i} "${g4(e)}" as ${t}`,{cause:r})}function _n(i,e,t){return v4("serialize",i,e,t)}class nC{constructor(e){this.description=e}}const CE="Bare Item",y4="Boolean";function b4(i){if(typeof i!="boolean")throw _n(i,y4);return i?"?1":"?0"}function _4(i){return btoa(String.fromCharCode(...i))}const S4="Byte Sequence";function E4(i){if(ArrayBuffer.isView(i)===!1)throw _n(i,S4);return`:${_4(i)}:`}const R4="Integer";function w4(i){return i<-999999999999999||999999999999999<i}function sC(i){if(w4(i))throw _n(i,R4);return i.toString()}function T4(i){return`@${sC(i.getTime()/1e3)}`}function aC(i,e){if(i<0)return-aC(-i,e);const t=Math.pow(10,e);if(Math.abs(i*t%1-.5)<Number.EPSILON){const r=Math.floor(i*t);return(r%2===0?r:r+1)/t}else return Math.round(i*t)/t}const C4="Decimal";function A4(i){const e=aC(i,3);if(Math.floor(Math.abs(e)).toString().length>12)throw _n(i,C4);const t=e.toString();return t.includes(".")?t:`${t}.0`}const x4="String",D4=/[\x00-\x1f\x7f]+/;function L4(i){if(D4.test(i))throw _n(i,x4);return`"${i.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function O4(i){return i.description||i.toString().slice(7,-1)}const I4="Token";function AE(i){const e=O4(i);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw _n(e,I4);return e}function Yg(i){switch(typeof i){case"number":if(!He(i))throw _n(i,CE);return Number.isInteger(i)?sC(i):A4(i);case"string":return L4(i);case"symbol":return AE(i);case"boolean":return b4(i);case"object":if(i instanceof Date)return T4(i);if(i instanceof Uint8Array)return E4(i);if(i instanceof nC)return AE(i);default:throw _n(i,CE)}}const P4="Key";function Wg(i){if(/^[a-z*][a-z0-9\-_.*]*$/.test(i)===!1)throw _n(i,P4);return i}function Nv(i){return i==null?"":Object.entries(i).map(([e,t])=>t===!0?`;${Wg(e)}`:`;${Wg(e)}=${Yg(t)}`).join("")}function oC(i){return i instanceof Do?`${Yg(i.value)}${Nv(i.params)}`:Yg(i)}function k4(i){return`(${i.value.map(oC).join(" ")})${Nv(i.params)}`}function M4(i,e={whitespace:!0}){if(typeof i!="object")throw _n(i,m4);const t=i instanceof Map?i.entries():Object.entries(i),r=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([n,a])=>{a instanceof Do||(a=new Do(a));let c=Wg(n);return a.value===!0?c+=Nv(a.params):(c+="=",Array.isArray(a.value)?c+=k4(a):c+=oC(a)),c}).join(`,${r}`)}function N4(i,e){return M4(i,e)}function B4(i){return i==="ot"||i==="sf"||i==="st"}function F4(i){return typeof i=="number"?He(i):i!=null&&i!==""&&i!==!1}function U4(i,e){const t=new URL(i),r=new URL(e);if(t.origin!==r.origin)return i;const n=t.pathname.split("/").slice(1),a=r.pathname.split("/").slice(1,-1);for(;n[0]===a[0];)n.shift(),a.shift();for(;a.length;)a.shift(),n.unshift("..");return n.join("/")}const Ud=i=>Math.round(i),$4=(i,e)=>(e!=null&&e.baseUrl&&(i=U4(i,e.baseUrl)),encodeURIComponent(i)),ld=i=>Ud(i/100)*100,j4={br:Ud,d:Ud,bl:ld,dl:ld,mtp:ld,nor:$4,rtp:ld,tb:Ud};function z4(i,e){const t={};if(i==null||typeof i!="object")return t;const r=Object.keys(i).sort(),n=Yt({},j4,e==null?void 0:e.formatters),a=e==null?void 0:e.filter;return r.forEach(c=>{if(a!=null&&a(c))return;let l=i[c];const d=n[c];d&&(l=d(l,e)),!(c==="v"&&l===1)&&(c=="pr"&&l===1||F4(l)&&(B4(c)&&typeof l=="string"&&(l=new nC(l)),t[c]=l))}),t}function cC(i,e={}){return i?N4(z4(i,e),Yt({whitespace:!1},e)):""}function G4(i,e={}){const t={};if(!i)return t;const r=Object.entries(i),n=Object.entries(p4).concat(Object.entries((e==null?void 0:e.customHeaderMap)||{})),a=r.reduce((c,l)=>{var d,u;const[f,p]=l,v=((d=n.find(E=>E[1].includes(f)))===null||d===void 0?void 0:d[0])||ul.REQUEST;return(u=c[v])!==null&&u!==void 0||(c[v]={}),c[v][f]=p,c},{});return Object.entries(a).reduce((c,[l,d])=>(c[l]=cC(d,e),c),t)}function H4(i,e,t){return Yt(i,G4(e,t))}const V4="CMCD";function K4(i,e={}){if(!i)return"";const t=cC(i,e);return`${V4}=${encodeURIComponent(t)}`}const xE=/CMCD=[^&#]+/;function q4(i,e,t){const r=K4(e,t);if(!r)return i;if(xE.test(i))return i.replace(xE,r);const n=i.includes("?")?"&":"?";return`${i}${n}${r}`}class Y4{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=n=>{try{this.apply(n,{ot:Zr.MANIFEST,su:!this.initialized})}catch(a){this.hls.logger.warn("Could not generate manifest CMCD data.",a)}},this.applyFragmentData=n=>{try{const{frag:a,part:c}=n,l=this.hls.levels[a.level],d=this.getObjectType(a),u={d:(c||a).duration*1e3,ot:d};(d===Zr.VIDEO||d===Zr.AUDIO||d==Zr.MUXED)&&(u.br=l.bitrate/1e3,u.tb=this.getTopBandwidth(d)/1e3,u.bl=this.getBufferLength(d));const f=c?this.getNextPart(c):this.getNextFrag(a);f!=null&&f.url&&f.url!==a.url&&(u.nor=f.url),this.apply(n,u)}catch(a){this.hls.logger.warn("Could not generate segment CMCD data.",a)}},this.hls=e;const t=this.config=e.config,{cmcd:r}=t;r!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=r.sessionId||e.sessionId,this.cid=r.contentId,this.useHeaders=r.useHeaders===!0,this.includeKeys=r.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(z.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(z.MEDIA_DETACHED,this.onMediaDetached,this),e.on(z.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(z.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(z.MEDIA_DETACHED,this.onMediaDetached,this),e.off(z.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var r,n;this.audioBuffer=(r=t.tracks.audio)==null?void 0:r.buffer,this.videoBuffer=(n=t.tracks.video)==null?void 0:n.buffer}createData(){var e;return{v:1,sf:l4.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Yt(t,this.createData());const r=t.ot===Zr.INIT||t.ot===Zr.VIDEO||t.ot===Zr.MUXED;this.starved&&r&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:n}=this;n&&(t=Object.keys(t).reduce((c,l)=>(n.includes(l)&&(c[l]=t[l]),c),{}));const a={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),H4(e.headers,t,a)):e.url=q4(e.url,t,a)}getNextFrag(e){var t;const r=(t=this.hls.levels[e.level])==null?void 0:t.details;if(r){const n=e.sn-r.startSN;return r.fragments[n+1]}}getNextPart(e){var t,r;const{index:n,fragment:a}=e,c=(t=this.hls.levels[a.level])==null||(r=t.details)==null?void 0:r.partList;if(c){const{sn:l}=a;for(let d=c.length-1;d>=0;d--){const u=c[d];if(u.index===n&&u.fragment.sn===l)return c[d+1]}}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return Zr.TIMED_TEXT;if(e.sn==="initSegment")return Zr.INIT;if(t==="audio")return Zr.AUDIO;if(t==="main")return this.hls.audioTracks.length?Zr.VIDEO:Zr.MUXED}getTopBandwidth(e){let t=0,r;const n=this.hls;if(e===Zr.AUDIO)r=n.audioTracks;else{const a=n.maxAutoLevel,c=a>-1?a+1:n.levels.length;r=n.levels.slice(0,c)}return r.forEach(a=>{a.bitrate>t&&(t=a.bitrate)}),t>0?t:NaN}getBufferLength(e){const t=this.media,r=e===Zr.AUDIO?this.audioBuffer:this.videoBuffer;return!r||!t?NaN:Lt.bufferInfo(r,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,r=e||this.config.loader;return class{constructor(n){this.loader=void 0,this.loader=new r(n)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(n,a,c){t(n),this.loader.load(n,a,c)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,r=e||this.config.loader;return class{constructor(n){this.loader=void 0,this.loader=new r(n)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(n,a,c){t(n),this.loader.load(n,a,c)}}}}const W4=3e5;class X4 extends jn{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(z.MANIFEST_LOADING,this.onManifestLoading,this),e.on(z.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(z.MANIFEST_PARSED,this.onManifestParsed,this),e.on(z.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(z.MANIFEST_LOADING,this.onManifestLoading,this),e.off(z.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(z.MANIFEST_PARSED,this.onManifestParsed,this),e.off(z.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(r=>r!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:r}=t;r!==null&&(this.pathwayId=r.pathwayId,this.uri=r.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:r}=t;if((r==null?void 0:r.action)===jr.SendAlternateToPenaltyBox&&r.flags===Xi.MoveAllAlternatesMatchingHost){const n=this.levels;let a=this._pathwayPriority,c=this.pathwayId;if(t.context){const{groupId:l,pathwayId:d,type:u}=t.context;l&&n?c=this.getPathwayForGroupId(l,u,c):d&&(c=d)}c in this.penalizedPathways||(this.penalizedPathways[c]=performance.now()),!a&&n&&(a=this.pathways()),a&&a.length>1&&(this.updatePathwayPriority(a),r.resolved=this.pathwayId!==c),r.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${c} levels: ${n&&n.length} priorities: ${hr(a)} penalized: ${hr(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const r=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${r}"`),t=this.getLevelsForPathway(r),this.pathwayId=r}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let t;const r=this.penalizedPathways,n=performance.now();Object.keys(r).forEach(a=>{n-r[a]>W4&&delete r[a]});for(let a=0;a<e.length;a++){const c=e[a];if(c in r)continue;if(c===this.pathwayId)return;const l=this.hls.nextLoadLevel,d=this.hls.levels[l];if(t=this.getLevelsForPathway(c),t.length>0){this.log(`Setting Pathway to "${c}"`),this.pathwayId=c,W3(t),this.hls.trigger(z.LEVELS_UPDATED,{levels:t});const u=this.hls.levels[l];d&&u&&this.levels&&(u.attrs["STABLE-VARIANT-ID"]!==d.attrs["STABLE-VARIANT-ID"]&&u.bitrate!==d.bitrate&&this.log(`Unstable Pathways change from bitrate ${d.bitrate} to ${u.bitrate}`),this.hls.nextLoadLevel=l);break}}}getPathwayForGroupId(e,t,r){const n=this.getLevelsForPathway(r).concat(this.levels||[]);for(let a=0;a<n.length;a++)if(t===Un.AUDIO_TRACK&&n[a].hasAudioGroup(e)||t===Un.SUBTITLE_TRACK&&n[a].hasSubtitleGroup(e))return n[a].pathwayId;return r}clonePathways(e){const t=this.levels;if(!t)return;const r={},n={};e.forEach(a=>{const{ID:c,"BASE-ID":l,"URI-REPLACEMENT":d}=a;if(t.some(f=>f.pathwayId===c))return;const u=this.getLevelsForPathway(l).map(f=>{const p=new Bl(f.attrs);p["PATHWAY-ID"]=c;const v=p.AUDIO&&`${p.AUDIO}_clone_${c}`,E=p.SUBTITLES&&`${p.SUBTITLES}_clone_${c}`;v&&(r[p.AUDIO]=v,p.AUDIO=v),E&&(n[p.SUBTITLES]=E,p.SUBTITLES=E);const g=lC(f.uri,p["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",d),_=new tf({attrs:p,audioCodec:f.audioCodec,bitrate:f.bitrate,height:f.height,name:f.name,url:g,videoCodec:f.videoCodec,width:f.width});if(f.audioGroups)for(let m=1;m<f.audioGroups.length;m++)_.addGroupId("audio",`${f.audioGroups[m]}_clone_${c}`);if(f.subtitleGroups)for(let m=1;m<f.subtitleGroups.length;m++)_.addGroupId("text",`${f.subtitleGroups[m]}_clone_${c}`);return _});t.push(...u),DE(this.audioTracks,r,d,c),DE(this.subtitleTracks,n,d,c)})}loadSteeringManifest(e){const t=this.hls.config,r=t.loader;this.loader&&this.loader.destroy(),this.loader=new r(t);let n;try{n=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(n.protocol!=="data:"){const f=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;n.searchParams.set("_HLS_pathway",this.pathwayId),n.searchParams.set("_HLS_throughput",""+f)}const a={responseType:"json",url:n.href},c=t.steeringManifestLoadPolicy.default,l=c.errorRetry||c.timeoutRetry||{},d={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:l.maxNumRetry||0,retryDelay:l.retryDelayMs||0,maxRetryDelay:l.maxRetryDelayMs||0},u={onSuccess:(f,p,v,E)=>{this.log(`Loaded steering manifest: "${n}"`);const g=f.data;if((g==null?void 0:g.VERSION)!==1){this.log(`Steering VERSION ${g.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=g.TTL;const{"RELOAD-URI":_,"PATHWAY-CLONES":m,"PATHWAY-PRIORITY":y}=g;if(_)try{this.uri=new self.URL(_,n).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${_}`);return}this.scheduleRefresh(this.uri||v.url),m&&this.clonePathways(m);const b={steeringManifest:g,url:n.toString()};this.hls.trigger(z.STEERING_MANIFEST_LOADED,b),y&&this.updatePathwayPriority(y)},onError:(f,p,v,E)=>{if(this.log(`Error loading steering manifest: ${f.code} ${f.text} (${p.url})`),this.stopLoad(),f.code===410){this.enabled=!1,this.log(`Steering manifest ${p.url} no longer available`);return}let g=this.timeToLoad*1e3;if(f.code===429){const _=this.loader;if(typeof(_==null?void 0:_.getResponseHeader)=="function"){const m=_.getResponseHeader("Retry-After");m&&(g=parseFloat(m)*1e3)}this.log(`Steering manifest ${p.url} rate limited`);return}this.scheduleRefresh(this.uri||p.url,g)},onTimeout:(f,p,v)=>{this.log(`Timeout loading steering manifest (${p.url})`),this.scheduleRefresh(this.uri||p.url)}};this.log(`Requesting steering manifest: ${n}`),this.loader.load(a,d,u)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var r;const n=(r=this.hls)==null?void 0:r.media;if(n&&!n.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function DE(i,e,t,r){i&&Object.keys(e).forEach(n=>{const a=i.filter(c=>c.groupId===n).map(c=>{const l=Yt({},c);return l.details=void 0,l.attrs=new Bl(l.attrs),l.url=l.attrs.URI=lC(c.url,c.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),l.groupId=l.attrs["GROUP-ID"]=e[n],l.attrs["PATHWAY-ID"]=r,l});i.push(...a)})}function lC(i,e,t,r){const{HOST:n,PARAMS:a,[t]:c}=r;let l;e&&(l=c==null?void 0:c[e],l&&(i=l));const d=new self.URL(i);return n&&!l&&(d.host=n),a&&Object.keys(a).sort().forEach(u=>{u&&d.searchParams.set(u,a[u])}),d.href}function Es(i,e,t){ua(i,e,t),i.addEventListener(e,t)}function ua(i,e,t){i.removeEventListener(e,t)}class yo extends jn{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=yo.CDMCleanupPromise?[yo.CDMCleanupPromise]:[],this.onMediaEncrypted=t=>{const{initDataType:r,initData:n}=t,a=`"${t.type}" event: init data type: "${r}"`;if(this.debug(a),n!==null){if(!this.keyFormatPromise){let c=Object.keys(this.keySystemAccessPromises);c.length||(c=nd(this.config));const l=c.map(id).filter(d=>!!d);this.keyFormatPromise=this.getKeyFormatPromise(l)}this.keyFormatPromise.then(c=>{const l=Rm(c);let d,u;if(r==="sinf"){if(l!==At.FAIRPLAY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${r}" for selected key-system ${l}`);return}const g=vr(new Uint8Array(n));try{const _=xv(JSON.parse(g).sinf),m=bT(_);if(!m)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");d=new Uint8Array(m.subarray(8,24)),u=At.FAIRPLAY}catch(_){this.warn(`${a} Failed to parse sinf: ${_}`);return}}else{if(l!==At.WIDEVINE&&l!==At.PLAYREADY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${r}" for selected key-system ${l}`);return}const g=KM(n),_=g.filter(y=>!!y.systemId&&wm(y.systemId)===l);_.length>1&&this.warn(`${a} Using first of ${_.length} pssh found for selected key-system ${l}`);const m=_[0];if(!m){g.length===0||g.some(y=>!y.systemId)?this.warn(`${a} contains incomplete or invalid pssh data`):this.log(`ignoring ${a} for ${g.map(y=>wm(y.systemId)).join(",")} pssh data in favor of playlist keys`);return}if(u=wm(m.systemId),m.version===0&&m.data)if(u===At.WIDEVINE){const y=m.data.length-22;d=new Uint8Array(m.data.subarray(y,y+16))}else u===At.PLAYREADY&&(d=LT(m.data))}if(!u||!d)return;const f=pn.hexDump(d),{keyIdToKeySessionPromise:p,mediaKeySessions:v}=this;let E=p[f];for(let g=0;g<v.length;g++){const _=v[g],m=_.decryptdata;if(!m.keyId)continue;const y=pn.hexDump(m.keyId);if(f===y||m.uri.replace(/-/g,"").indexOf(f)!==-1){if(E=p[y],m.pssh)break;delete p[y],m.pssh=new Uint8Array(n),m.keyId=d,E=p[f]=E.then(()=>this.generateRequestWithPreferredKeySession(_,r,n,"encrypted-event-key-match")),E.catch(b=>this.handleError(b));break}}if(!E){if(u!==l){this.log(`Ignoring "${t.type}" event with ${u} init data for selected key-system ${l}`);return}E=p[f]=this.getKeySystemSelectionPromise([u]).then(({keySystem:g,mediaKeys:_})=>{var m;this.throwIfDestroyed();const y=new af("ISO-23001-7",f,(m=id(g))!=null?m:"");return y.pssh=new Uint8Array(n),y.keyId=d,this.attemptSetMediaKeys(g,_).then(()=>{this.throwIfDestroyed();const b=this.createMediaKeySessionContext({decryptdata:y,keySystem:g,mediaKeys:_});return this.generateRequestWithPreferredKeySession(b,r,n,"encrypted-event-no-match")})}),E.catch(g=>this.handleError(g))}})}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(z.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(z.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(z.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(z.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(z.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(z.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(z.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(z.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(z.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(z.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:r}=this.config,n=t[e];if(n)return n.licenseUrl;if(e===At.WIDEVINE&&r)return r}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,r=t[e];if(r)return r.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,r=(c,l,d)=>!!c&&d.indexOf(c)===l,n=t.map(c=>c.audioCodec).filter(r),a=t.map(c=>c.videoCodec).filter(r);return n.length+a.length===0&&a.push("avc1.42e01e"),new Promise((c,l)=>{const d=u=>{const f=u.shift();this.getMediaKeysPromise(f,n,a).then(p=>c({keySystem:f,mediaKeys:p})).catch(p=>{u.length?d(u):p instanceof Pi?l(p):l(new Pi({type:Je.KEY_SYSTEM_ERROR,details:he.KEY_SYSTEM_NO_ACCESS,error:p,fatal:!0},p.message))})};d(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:r}=this.config;if(typeof r!="function"){let n=`Configured requestMediaKeySystemAccess is not a function ${r}`;return DT===null&&self.location.protocol==="http:"&&(n=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(n))}return r(e,t)}getMediaKeysPromise(e,t,r){const n=B3(e,t,r,this.config.drmSystemOptions),a=this.keySystemAccessPromises[e];let c=a==null?void 0:a.keySystemAccess;if(!c){this.log(`Requesting encrypted media "${e}" key-system access with config: ${hr(n)}`),c=this.requestMediaKeySystemAccess(e,n);const l=this.keySystemAccessPromises[e]={keySystemAccess:c};return c.catch(d=>{this.log(`Failed to obtain access to key-system "${e}": ${d}`)}),c.then(d=>{this.log(`Access for key-system "${d.keySystem}" obtained`);const u=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),l.mediaKeys=d.createMediaKeys().then(f=>(this.log(`Media-keys created for "${e}"`),l.hasMediaKeys=!0,u.then(p=>p?this.setMediaKeysServerCertificate(f,e,p):f))),l.mediaKeys.catch(f=>{this.error(`Failed to create media-keys for "${e}"}: ${f}`)}),l.mediaKeys})}return c.then(()=>a.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:r}){this.log(`Creating key-system session "${t}" keyId: ${pn.hexDump(e.keyId||[])}`);const n=r.createSession(),a={decryptdata:e,keySystem:t,mediaKeys:r,mediaKeysSession:n,keyStatus:"status-pending"};return this.mediaKeySessions.push(a),a}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const r=this.createMediaKeySessionContext(e),n=this.getKeyIdString(t),a="cenc";this.keyIdToKeySessionPromise[n]=this.generateRequestWithPreferredKeySession(r,a,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return pn.hexDump(e.keyId)}updateKeySession(e,t){var r;const n=e.mediaKeysSession;return this.log(`Updating key-session "${n.sessionId}" for keyID ${pn.hexDump(((r=e.decryptdata)==null?void 0:r.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),n.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>id(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:t,mediaKeys:r})=>this.attemptSetMediaKeys(t,r))}selectKeySystem(e){return new Promise((t,r)=>this.getKeySystemSelectionPromise(e).then(({keySystem:n})=>{const a=id(n);a?t(a):r(new Error(`Unable to find format for key-system "${n}"`))}).catch(r))}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){const t=nd(this.config),r=e.map(Rm).filter(n=>!!n&&t.indexOf(n)!==-1);return this.selectKeySystem(r)}loadKey(e){const t=e.keyInfo.decryptdata,r=this.getKeyIdString(t),n=`(keyId: ${r} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${n}`);let a=this.keyIdToKeySessionPromise[r];return a||(a=this.getKeySystemForKeyPromise(t).then(({keySystem:c,mediaKeys:l})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${n}`),this.attemptSetMediaKeys(c,l).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:c,mediaKeys:l,decryptdata:t}))))),(this.keyIdToKeySessionPromise[r]=a.then(c=>{const l="cenc",d=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(c,l,d,"playlist-key")})).catch(c=>this.handleError(c))),a}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof Pi?this.hls.trigger(z.ERROR,e.data):this.hls.trigger(z.ERROR,{type:Je.KEY_SYSTEM_ERROR,details:he.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),r=this.keyIdToKeySessionPromise[t];if(!r){const n=Rm(e.keyFormat),a=n?[n]:nd(this.config);return this.attemptKeySystemAccess(a)}return r}getKeySystemSelectionPromise(e){if(e.length||(e=nd(this.config)),e.length===0)throw new Pi({type:Je.KEY_SYSTEM_ERROR,details:he.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${hr({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaKeys===t)return Promise.resolve();const r=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const n=Promise.all(r).then(()=>{if(!this.media)throw this.mediaKeys=null,new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.mediaKeys=t,this.setMediaKeysQueue.push(n),n.then(()=>{this.log(`Media-keys set for "${e}"`),r.push(n),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(a=>r.indexOf(a)===-1)})}generateRequestWithPreferredKeySession(e,t,r,n){var a,c;const l=(a=this.config.drmSystems)==null||(c=a[e.keySystem])==null?void 0:c.generateRequest;if(l)try{const g=l.call(this.hls,t,r,e);if(!g)throw new Error("Invalid response from configured generateRequest filter");t=g.initDataType,r=g.initData?g.initData:null,e.decryptdata.pssh=r?new Uint8Array(r):null}catch(g){var d;if(this.warn(g.message),(d=this.hls)!=null&&d.config.debug)throw g}if(r===null)return this.log(`Skipping key-session request for "${n}" (no initData)`),Promise.resolve(e);const u=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${n}": ${u} (init data type: ${t} length: ${r?r.byteLength:null})`);const f=new FT,p=e._onmessage=g=>{const _=e.mediaKeysSession;if(!_){f.emit("error",new Error("invalid state"));return}const{messageType:m,message:y}=g;this.log(`"${m}" message event for session "${_.sessionId}" message size: ${y.byteLength}`),m==="license-request"||m==="license-renewal"?this.renewLicense(e,y).catch(b=>{f.eventNames().length?f.emit("error",b):this.handleError(b)}):m==="license-release"?e.keySystem===At.FAIRPLAY&&(this.updateKeySession(e,Gg("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${m}"`)},v=e._onkeystatuseschange=g=>{if(!e.mediaKeysSession){f.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const _=e.keyStatus;f.emit("keyStatus",_),_==="expired"&&(this.warn(`${e.keySystem} expired for key ${u}`),this.renewKeySession(e))};Es(e.mediaKeysSession,"message",p),Es(e.mediaKeysSession,"keystatuseschange",v);const E=new Promise((g,_)=>{f.on("error",_),f.on("keyStatus",m=>{m.startsWith("usable")?g():m==="output-restricted"?_(new Pi({type:Je.KEY_SYSTEM_ERROR,details:he.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):m==="internal-error"?_(new Pi({type:Je.KEY_SYSTEM_ERROR,details:he.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${m}"`)):m==="expired"?_(new Error("key expired while generating request")):this.warn(`unhandled key status change "${m}"`)})});return e.mediaKeysSession.generateRequest(t,r).then(()=>{var g;this.log(`Request generated for key-session "${(g=e.mediaKeysSession)==null?void 0:g.sessionId}" keyId: ${u}`)}).catch(g=>{throw new Pi({type:Je.KEY_SYSTEM_ERROR,details:he.KEY_SYSTEM_NO_SESSION,error:g,fatal:!1},`Error generating key-session request: ${g}`)}).then(()=>E).catch(g=>{throw f.removeAllListeners(),this.removeSession(e),g}).then(()=>(f.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,r)=>{if(typeof r=="string"&&typeof t=="object"){const n=r;r=t,t=n}this.log(`key status change "${t}" for keyStatuses keyId: ${pn.hexDump("buffer"in r?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r))} session keyId: ${pn.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,r=t.loader,n=new r(t),a=this.getServerCertificateUrl(e);return a?(this.log(`Fetching server certificate for "${e}"`),new Promise((c,l)=>{const d={responseType:"arraybuffer",url:a},u=t.certLoadPolicy.default,f={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(v,E,g,_)=>{c(v.data)},onError:(v,E,g,_)=>{l(new Pi({type:Je.KEY_SYSTEM_ERROR,details:he.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:g,response:Vt({url:d.url,data:void 0},v)},`"${e}" certificate request failed (${a}). Status: ${v.code} (${v.text})`))},onTimeout:(v,E,g)=>{l(new Pi({type:Je.KEY_SYSTEM_ERROR,details:he.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:g,response:{url:d.url,data:void 0}},`"${e}" certificate request timed out (${a})`))},onAbort:(v,E,g)=>{l(new Error("aborted"))}};n.load(d,f,p)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,r){return new Promise((n,a)=>{e.setServerCertificate(r).then(c=>{this.log(`setServerCertificate ${c?"success":"not supported by CDM"} (${r==null?void 0:r.byteLength}) on "${t}"`),n(e)}).catch(c=>{a(new Pi({type:Je.KEY_SYSTEM_ERROR,details:he.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:c,fatal:!0},c.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(r=>this.updateKeySession(e,new Uint8Array(r)).catch(n=>{throw new Pi({type:Je.KEY_SYSTEM_ERROR,details:he.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:n,fatal:!0},n.message)}))}unpackPlayReadyKeyMessage(e,t){const r=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!r.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const n=new DOMParser().parseFromString(r,"application/xml"),a=n.querySelectorAll("HttpHeader");if(a.length>0){let f;for(let p=0,v=a.length;p<v;p++){var c,l;f=a[p];const E=(c=f.querySelector("name"))==null?void 0:c.textContent,g=(l=f.querySelector("value"))==null?void 0:l.textContent;E&&g&&e.setRequestHeader(E,g)}}const d=n.querySelector("Challenge"),u=d==null?void 0:d.textContent;if(!u)throw new Error("Cannot find <Challenge> in key message");return Gg(atob(u))}setupLicenseXHR(e,t,r,n){const a=this.config.licenseXhrSetup;return a?Promise.resolve().then(()=>{if(!r.decryptdata)throw new Error("Key removed");return a.call(this.hls,e,t,r,n)}).catch(c=>{if(!r.decryptdata)throw c;return e.open("POST",t,!0),a.call(this.hls,e,t,r,n)}).then(c=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:c||n})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:n}))}requestLicense(e,t){const r=this.config.keyLoadPolicy.default;return new Promise((n,a)=>{const c=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${c}`);const l=new XMLHttpRequest;l.responseType="arraybuffer",l.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return a(new Error("invalid state"));if(l.readyState===4)if(l.status===200){this._requestLicenseFailureCount=0;let d=l.response;this.log(`License received ${d instanceof ArrayBuffer?d.byteLength:d}`);const u=this.config.licenseResponseCallback;if(u)try{d=u.call(this.hls,l,c,e)}catch(f){this.error(f)}n(d)}else{const d=r.errorRetry,u=d?d.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u||l.status>=400&&l.status<500)a(new Pi({type:Je.KEY_SYSTEM_ERROR,details:he.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:l,response:{url:c,data:void 0,code:l.status,text:l.statusText}},`License Request XHR failed (${c}). Status: ${l.status} (${l.statusText})`));else{const f=u-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${f} attempts left`),this.requestLicense(e,t).then(n,a)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=l,this.setupLicenseXHR(l,c,e,t).then(({xhr:d,licenseChallenge:u})=>{e.keySystem==At.PLAYREADY&&(u=this.unpackPlayReadyKeyMessage(d,u)),d.send(u)})})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const r=t.media;this.media=r,Es(r,"encrypted",this.onMediaEncrypted),Es(r,"waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media;e&&(ua(e,"encrypted",this.onMediaEncrypted),ua(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;if(this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},!this.mediaKeys&&!this.mediaKeySessions.length)return;const t=this.media,r=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,af.clearKeyUriToKeyIdMap();const n=r.length;yo.CDMCleanupPromise=Promise.all(r.map(a=>this.removeSession(a)).concat(t==null||(e=t.setMediaKeys(null))==null?void 0:e.catch(a=>{var c;this.log(`Could not clear media keys: ${a}`),(c=this.hls)==null||c.trigger(z.ERROR,{type:Je.OTHER_ERROR,details:he.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${a}`)})}))).catch(a=>{var c;this.log(`Could not close sessions and clear media keys: ${a}`),(c=this.hls)==null||c.trigger(z.ERROR,{type:Je.OTHER_ERROR,details:he.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${a}`)})}).then(()=>{n&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const r=t.reduce((n,a)=>(n.indexOf(a.keyFormat)===-1&&n.push(a.keyFormat),n),[]);this.log(`Selecting key-system from session-keys ${r.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(r)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:r}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),r&&r.readyState!==XMLHttpRequest.DONE&&r.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const n=this.mediaKeySessions.indexOf(e);n>-1&&this.mediaKeySessions.splice(n,1);const{drmSystemOptions:a}=this.config;return(U3(a)?new Promise((c,l)=>{self.setTimeout(()=>l(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(c)}):Promise.resolve()).catch(c=>{var l;this.log(`Could not remove session: ${c}`),(l=this.hls)==null||l.trigger(z.ERROR,{type:Je.OTHER_ERROR,details:he.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${c}`)})}).then(()=>t.close()).catch(c=>{var l;this.log(`Could not close session: ${c}`),(l=this.hls)==null||l.trigger(z.ERROR,{type:Je.OTHER_ERROR,details:he.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${c}`)})})}}}yo.CDMCleanupPromise=void 0;class Pi extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}class Q4{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(z.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(z.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(z.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(z.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const r=this.hls.config;if(r.capLevelOnFPSDrop){const n=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=n,n&&typeof n.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,r){const n=performance.now();if(t){if(this.lastTime){const a=n-this.lastTime,c=r-this.lastDroppedFrames,l=t-this.lastDecodedFrames,d=1e3*c/a,u=this.hls;if(u.trigger(z.FPS_DROP,{currentDropped:c,currentDecoded:l,totalDroppedFrames:r}),d>0&&c>u.config.fpsDroppedMonitoringThreshold*l){let f=u.currentLevel;u.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+f),f>0&&(u.autoLevelCapping===-1||u.autoLevelCapping>=f)&&(f=f-1,u.trigger(z.FPS_DROP_LEVEL_CAPPING,{level:f,droppedLevel:u.currentLevel}),u.autoLevelCapping=f,this.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=r,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function Z4(i,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=i,e.dispatchEvent(t)}function uC(i,e){const t=i.mode;if(t==="disabled"&&(i.mode="hidden"),i.cues&&!i.cues.getCueById(e.id))try{if(i.addCue(e),!i.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(r){Gt.debug(`[texttrack-utils]: ${r}`);try{const n=new self.TextTrackCue(e.startTime,e.endTime,e.text);n.id=e.id,i.addCue(n)}catch(n){Gt.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${n}`)}}t==="disabled"&&(i.mode=t)}function dl(i,e){const t=i.mode;if(t==="disabled"&&(i.mode="hidden"),i.cues)for(let r=i.cues.length;r--;)i.removeCue(i.cues[r]);t==="disabled"&&(i.mode=t)}function LE(i,e,t,r){const n=i.mode;if(n==="disabled"&&(i.mode="hidden"),i.cues&&i.cues.length>0){const a=eB(i.cues,e,t);for(let c=0;c<a.length;c++)i.removeCue(a[c])}n==="disabled"&&(i.mode=n)}function J4(i,e){if(e<=i[0].startTime)return 0;const t=i.length-1;if(e>i[t].endTime)return-1;let r=0,n=t,a;for(;r<=n;)if(a=Math.floor((n+r)/2),e<i[a].startTime)n=a-1;else if(e>i[a].startTime&&r<t)r=a+1;else return a;return i[r].startTime-e<e-i[n].startTime?r:n}function eB(i,e,t){const r=[],n=J4(i,e);if(n>-1)for(let a=n,c=i.length;a<c;a++){const l=i[a];if(l.startTime>=e&&l.endTime<=t)r.push(l);else if(l.startTime>t)return r}return r}function $d(i){const e=[];for(let t=0;t<i.length;t++){const r=i[t];(r.kind==="subtitles"||r.kind==="captions")&&r.label&&e.push(i[t])}return e}class tB extends tC{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const r=$d(this.media.textTracks);for(let a=0;a<r.length;a++)if(r[a].mode==="hidden")t=r[a];else if(r[a].mode==="showing"){t=r[a];break}const n=this.findTrackForTextTrack(t);this.subtitleTrack!==n&&this.setSubtitleTrack(n)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(z.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(z.MANIFEST_LOADING,this.onManifestLoading,this),e.on(z.MANIFEST_PARSED,this.onManifestParsed,this),e.on(z.LEVEL_LOADING,this.onLevelLoading,this),e.on(z.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(z.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(z.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(z.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(z.MANIFEST_LOADING,this.onManifestLoading,this),e.off(z.MANIFEST_PARSED,this.onManifestParsed,this),e.off(z.LEVEL_LOADING,this.onLevelLoading,this),e.off(z.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(z.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(z.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const r=this.media;if(!r)return;const n=!!t.transferMedia;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||r.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,!n&&$d(r.textTracks).forEach(a=>{dl(a)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:r,groupId:n,details:a}=t,c=this.tracksInGroup[r];if(!c||c.groupId!==n){this.warn(`Subtitle track with id:${r} and group:${n} not found in active group ${c==null?void 0:c.groupId}`);return}const l=c.details;c.details=t.details,this.log(`Subtitle track ${r} "${c.name}" lang:${c.lang} group:${n} loaded [${a.startSN}-${a.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,l)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const r=t.subtitleGroups||null,n=this.groupIds;let a=this.currentTrack;if(!r||(n==null?void 0:n.length)!==(r==null?void 0:r.length)||r!=null&&r.some(c=>(n==null?void 0:n.indexOf(c))===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const c=this.tracks.filter(f=>!r||r.indexOf(f.groupId)!==-1);if(c.length)this.selectDefaultTrack&&!c.some(f=>f.default)&&(this.selectDefaultTrack=!1),c.forEach((f,p)=>{f.id=p});else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=c;const l=this.hls.config.subtitlePreference;if(!a&&l){this.selectDefaultTrack=!1;const f=vn(l,c);if(f>-1)a=c[f];else{const p=vn(l,this.tracks);a=this.tracks[p]}}let d=this.findTrackId(a);d===-1&&a&&(d=this.findTrackId(null));const u={subtitleTracks:c};this.log(`Updating subtitle tracks, ${c.length} track(s) found in "${r==null?void 0:r.join(",")}" group-id`),this.hls.trigger(z.SUBTITLE_TRACKS_UPDATED,u),d!==-1&&this.trackId===-1&&this.setSubtitleTrack(d)}}findTrackId(e){const t=this.tracksInGroup,r=this.selectDefaultTrack;for(let n=0;n<t.length;n++){const a=t[n];if(!(r&&!a.default||!r&&!e)&&(!e||ha(a,e)))return n}if(e){for(let n=0;n<t.length;n++){const a=t[n];if(Dl(e.attrs,a.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return n}for(let n=0;n<t.length;n++){const a=t[n];if(Dl(e.attrs,a.attrs,["LANGUAGE"]))return n}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const n=t[r];if(qg(n,e))return r}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===Un.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const r=this.currentTrack;if(r&&ha(e,r))return r;const n=vn(e,this.tracksInGroup);if(n>-1){const a=this.tracksInGroup[n];return this.setSubtitleTrack(n),a}else{if(r)return null;{const a=vn(e,t);if(a>-1)return t[a]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const r=e.id,n=e.groupId,a=this.getUrlWithDirectives(e.url,t),c=e.details,l=c==null?void 0:c.age;this.log(`Loading subtitle ${r} "${e.name}" lang:${e.lang} group:${n}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${l&&c.live?" age "+l.toFixed(1)+(c.type&&" "+c.type||""):""} ${a}`),this.hls.trigger(z.SUBTITLE_TRACK_LOADING,{url:a,id:r,groupId:n,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=$d(e.textTracks),r=this.currentTrack;let n;if(r&&(n=t.filter(a=>qg(r,a))[0],n||this.warn(`Unable to find subtitle TextTrack with name "${r.name}" and language "${r.lang}"`)),[].slice.call(t).forEach(a=>{a.mode!=="disabled"&&a!==n&&(a.mode="disabled")}),n){const a=this.subtitleDisplay?"showing":"hidden";n.mode!==a&&(n.mode=a)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!He(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const r=this.currentTrack,n=t[e]||null;if(this.trackId=e,this.currentTrack=n,this.toggleTrackModes(),!n){this.hls.trigger(z.SUBTITLE_TRACK_SWITCH,{id:e});return}const a=!!n.details&&!n.details.live;if(e===this.trackId&&n===r&&a)return;this.log(`Switching to subtitle-track ${e}`+(n?` "${n.name}" lang:${n.lang} group:${n.groupId}`:""));const{id:c,groupId:l="",name:d,type:u,url:f}=n;this.hls.trigger(z.SUBTITLE_TRACK_SWITCH,{id:c,groupId:l,name:d,type:u,url:f});const p=this.switchParams(n.url,r==null?void 0:r.details,n.details);this.loadPlaylist(p)}}function vl(i){let e=5381,t=i.length;for(;t;)e=e*33^i.charCodeAt(--t);return(e>>>0).toString()}const bo=.025;let df=function(i){return i[i.Point=0]="Point",i[i.Range=1]="Range",i}({});function rB(i,e,t){return`${i.identifier}-${t+1}-${vl(e)}`}class iB{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;const r=this.playoutLimit;return e<=0||isNaN(r)?!1:r===0?!0:(((t=this.assetList[e])==null?void 0:t.startOffset)||0)>r}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return Om(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,r=Om(t,e);return t-r<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=He(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return Om(e,t)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<bo))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return this._duration!==null?t=this._duration:this.dateRange.duration?t=this.dateRange.duration:t=this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?df.Range:df.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return nB(this)}}function Om(i,e){return i-e.start<e.duration/2&&!(Math.abs(i-(e.start+e.duration))<bo)?e.start:e.start+e.duration}function dC(i,e,t){const r=new self.URL(i,t);return r.protocol!=="data:"&&r.searchParams.set("_HLS_primary_id",e),r}function Im(i,e){for(;(t=i.assetList[++e])!=null&&t.error;)var t;return e}function nB(i){return`["${i.identifier}" ${i.cue.pre?"<pre>":i.cue.post?"<post>":""}${i.timelineStart.toFixed(2)}-${i.resumeTime.toFixed(2)}]`}function uo(i){const e=i.timelineStart,t=i.duration||0;return`["${i.identifier}" ${e.toFixed(2)}-${(e+t).toFixed(2)}]`}class sB{constructor(e,t,r,n){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls.trigger(z.PLAYOUT_LIMIT_REACHED,{})};const a=this.hls=new e(t);this.interstitial=r,this.assetItem=n;let c=n.uri;try{c=dC(c,t.primarySessionId).href}catch{}a.loadSource(c);const l=()=>{this.hasDetails=!0};a.once(z.LEVEL_LOADED,l),a.once(z.AUDIO_TRACK_LOADED,l),a.once(z.SUBTITLE_TRACK_LOADED,l),a.on(z.MEDIA_ATTACHING,(d,{media:u})=>{this.removeMediaListeners(),this.mediaAttached=u,this.interstitial.playoutLimit&&(u.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&a.on(z.BUFFER_APPENDED,()=>{const f=this.bufferedEnd;this.reachedPlayout(f)&&(this._bufferedEosTime=f,a.trigger(z.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){var e;return((e=this.interstitial)==null?void 0:e.appendInPlace)||!1}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if((t=this.hls)!=null&&t.bufferedToEnd)return!0;if(!e||!this._bufferedEosTime)return!1;const r=this.timelineOffset,n=Lt.bufferInfo(e,r,0);return this.getAssetTime(n.end)>=this._bufferedEosTime-.02}reachedPlayout(e){const t=this.interstitial.playoutLimit;return this.startOffset+e>=t}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=Lt.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){return this.assetItem.duration||0}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const r=e-t;if(Math.abs(r)>1/9e4){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,r=this.duration;return Math.min(Math.max(0,e-t),r)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls.destroy(),this.hls=this.interstitial=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){this.hls.attachMedia(e)}detachMedia(){this.removeMediaListeners(),this.mediaAttached=null,this.hls.detachMedia()}resumeBuffering(){this.hls.resumeBuffering()}pauseBuffering(){this.hls.pauseBuffering()}transferMedia(){return this.bufferSnapShot(),this.hls.transferMedia()}resetDetails(){const e=this.hls;if(this.hasDetails){e.stopLoad();const t=r=>delete r.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,r){this.hls.on(e,t)}once(e,t,r){this.hls.once(e,t)}off(e,t,r){this.hls.off(e,t)}toString(){var e;return`HlsAssetPlayer: ${uo(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const OE=.033;class aB extends jn{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((r,n)=>e<=n.startOffset&&t>n.startOffset?(delete n.error,r+1):r,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let r=-1;e.nextEvent?r=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(r=this.findEventIndex(e.previousEvent.identifier)+1);const n=this.items;if(n)for(n[r]||(t===void 0&&(t=e.start),r=this.findItemIndexAtTime(t));r>=0&&(a=n[r])!=null&&a.event;){var a;r--}return r}findItemIndexAtTime(e,t){const r=this.items;if(r)for(let n=0;n<r.length;n++){let a=r[n];if(t&&t!=="primary"&&(a=a[t]),e===a.start||e>a.start&&e<a.end)return n}return-1}findJumpRestrictedIndex(e,t){const r=this.items;if(r)for(let n=e;n<=t&&r[n];n++){const a=r[n].event;if(a!=null&&a.restrictions.jump&&!a.appendInPlace)return n}return-1}findEventIndex(e){const t=this.items;if(t)for(let n=t.length;n--;){var r;if(((r=t[n].event)==null?void 0:r.identifier)===e)return n}return-1}findAssetIndex(e,t){const r=e.assetList,n=r.length;if(n>1)for(let a=0;a<n;a++){const c=r[a];if(!c.error){const l=c.timelineStart;if(t===l||t>l&&t<l+(c.duration||0))return a}}return 0}get assetIdAtEnd(){var e,t;const r=(e=this.items)==null||(t=e[this.length-1])==null?void 0:t.event;if(r){const n=r.assetList,a=n[n.length-1];if(a)return a.identifier}return null}parseInterstitialDateRanges(e,t){const r=e.main.details,{dateRanges:n}=r,a=this.events,c=this.parseDateRanges(n,{url:r.url},t),l=Object.keys(n),d=a?a.filter(u=>!l.includes(u.identifier)):[];c.length&&c.sort((u,f)=>{const p=u.cue.pre,v=u.cue.post,E=f.cue.pre,g=f.cue.post;if(p&&!E)return-1;if(E&&!p||v&&!g)return 1;if(g&&!v)return-1;if(!p&&!E&&!v&&!g){const _=u.startTime,m=f.startTime;if(_!==m)return _-m}return u.dateRange.tagOrder-f.dateRange.tagOrder}),this.events=c,d.forEach(u=>{this.removeEvent(u)}),this.updateSchedule(e,d)}updateSchedule(e,t=[]){const r=this.events||[];if(r.length||t.length||this.length<2){const n=this.items,a=this.parseSchedule(r,e);(t.length||(n==null?void 0:n.length)!==a.length||a.some((c,l)=>Math.abs(c.playout.start-n[l].playout.start)>.005||Math.abs(c.playout.end-n[l].playout.end)>.005))&&(this.items=a,this.onScheduleUpdate(t,n))}}parseDateRanges(e,t,r){const n=[],a=Object.keys(e);for(let c=0;c<a.length;c++){const l=a[c],d=e[l];if(d.isInterstitial){let u=this.eventMap[l];u?u.setDateRange(d):(u=new iB(d,t),this.eventMap[l]=u,r===!1&&(u.appendInPlace=r)),n.push(u)}}return n}parseSchedule(e,t){const r=[],n=t.main.details,a=n.live?1/0:n.edge;let c=0;if(e=e.filter(d=>!d.error&&!(d.cue.once&&d.hasPlayed)),e.length){this.resolveOffsets(e,t);let d=0,u=0;if(e.forEach((f,p)=>{const v=f.cue.pre,E=f.cue.post,g=e[p-1]||null,_=f.appendInPlace,m=E?a:f.startOffset,y=f.duration,b=f.timelineOccupancy===df.Range?y:0,R=f.resumptionOffset,T=(g==null?void 0:g.startTime)===m,w=m+f.cumulativeDuration;let C=_?w+y:m+R;if(v||!E&&m<=0){const L=u;u+=b,f.timelineStart=w;const D=c;c+=y,r.push({event:f,start:w,end:C,playout:{start:D,end:c},integrated:{start:L,end:u}})}else if(m<=a){if(!T){const P=m-d;if(P>OE){const k=d,M=u;u+=P;const I=c;c+=P;const F={previousEvent:e[p-1]||null,nextEvent:f,start:k,end:k+P,playout:{start:I,end:c},integrated:{start:M,end:u}};r.push(F)}else P>0&&g&&(g.cumulativeDuration+=P,r[r.length-1].end=m)}E&&(C=w),f.timelineStart=w;const L=u;u+=b;const D=c;c+=y,r.push({event:f,start:w,end:C,playout:{start:D,end:c},integrated:{start:L,end:u}})}else return;const A=f.resumeTime;E||A>a?d=a:d=A}),d<a){var l;const f=d,p=u,v=a-d;u+=v;const E=c;c+=v,r.push({previousEvent:((l=r[r.length-1])==null?void 0:l.event)||null,nextEvent:null,start:d,end:f+v,playout:{start:E,end:c},integrated:{start:p,end:u}})}this.setDurations(a,c,u)}else r.push({previousEvent:null,nextEvent:null,start:0,end:a,playout:{start:0,end:a},integrated:{start:0,end:a}}),this.setDurations(a,a,a);return r}setDurations(e,t,r){this.durations={primary:e,playout:t,integrated:r}}resolveOffsets(e,t){const r=t.main.details,n=r.live?1/0:r.edge;let a=0,c=-1;e.forEach((l,d)=>{const u=l.cue.pre,f=l.cue.post,p=u?0:f?n:l.startTime;this.updateAssetDurations(l),c===p?l.cumulativeDuration=a:(a=0,c=p),!f&&l.snapOptions.in&&(l.resumeAnchor=Co(null,r.fragments,l.startOffset+l.resumptionOffset,0,0)||void 0),l.appendInPlace&&!l.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(l,t)||(l.appendInPlace=!1)),!l.appendInPlace&&d+1<e.length&&e[d+1].startTime-e[d].resumeTime<OE&&(e[d+1].appendInPlace=!1,e[d+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${l}`));const v=He(l.resumeOffset)?l.resumeOffset:l.duration;a+=v})}primaryCanResumeInPlaceAt(e,t){const r=e.resumeTime,n=e.startTime+e.resumptionOffset;return Math.abs(r-n)>bo?(this.log(`"${e.identifier}" resumption ${r} not aligned with estimated timeline end ${n}`),!1):t?!Object.keys(t).some(a=>{const c=t[a].details,l=c.edge;if(r>=l)return this.log(`"${e.identifier}" resumption ${r} past ${a} playlist end ${l}`),!1;const d=Co(null,c.fragments,r);if(!d)return this.log(`"${e.identifier}" resumption ${r} does not align with any fragments in ${a} playlist (${c.fragStart}-${c.fragmentEnd})`),!0;const u=a==="audio"?.175:0;return Math.abs(d.start-r)<bo+u||Math.abs(d.end-r)<bo+u?!1:(this.log(`"${e.identifier}" resumption ${r} not aligned with ${a} fragment bounds (${d.start}-${d.end} sn: ${d.sn} cc: ${d.cc})`),!0)}):(this.log(`"${e.identifier}" resumption ${r} can not be aligned with media (none selected)`),!1)}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let r=0,n=!1,a=!1;e.assetList.forEach((c,l)=>{const d=t+r;c.startOffset=r,c.timelineStart=d,n||(n=c.duration===null),a||(a=!!c.error);const u=c.error?0:c.duration||0;r+=u}),n&&!a?e.duration=Math.max(r,e.duration):e.duration=r}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function ps(i){return`[${i.event?'"'+i.event.identifier+'"':"primary"}: ${i.start.toFixed(2)}-${i.end.toFixed(2)}]`}class oB{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const r=e.assetListUrl;let n;try{n=dC(r,this.hls.sessionId,e.baseUrl)}catch(v){const E=this.assignAssetListError(e,he.ASSET_LIST_LOAD_ERROR,v,r);this.hls.trigger(z.ERROR,E);return}t&&n.protocol!=="data:"&&n.searchParams.set("_HLS_start_offset",""+t);const a=this.hls.config,c=a.loader,l=new c(a),d={responseType:"json",url:n.href},u=a.interstitialAssetListLoadPolicy.default,f={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(v,E,g,_)=>{const m=v.data,y=m==null?void 0:m.ASSETS;if(!Array.isArray(y)){const b=this.assignAssetListError(e,he.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),g.url,E,_);this.hls.trigger(z.ERROR,b);return}e.assetListResponse=m,this.hls.trigger(z.ASSET_LIST_LOADED,{event:e,assetListResponse:m,networkDetails:_})},onError:(v,E,g,_)=>{const m=this.assignAssetListError(e,he.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${v.code} ${v.text} (${E.url})`),E.url,_,g);this.hls.trigger(z.ERROR,m)},onTimeout:(v,E,g)=>{const _=this.assignAssetListError(e,he.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${E.url})`),E.url,v,g);this.hls.trigger(z.ERROR,_)}};return l.load(d,f,p),this.hls.trigger(z.ASSET_LIST_LOADING,{event:e}),l}assignAssetListError(e,t,r,n,a,c){return e.error=r,{type:Je.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:n,error:r,networkDetails:c,stats:a}}}function IE(i){i==null||i.play().catch(()=>{})}class cB extends jn{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const r=this.currentTime;if(r===void 0||this.playbackDisabled)return;const n=r-this.timelinePos;if(Math.abs(n)<1/7056e5)return;const a=n<=-.01;this.timelinePos=r,this.bufferedPos=r;const c=this.playingItem;if(!c){this.checkBuffer();return}if(a&&this.schedule.resetErrorsInRange(r,r-n)&&this.updateSchedule(),this.checkBuffer(),a&&r<c.start||r>=c.end){var l;const p=this.schedule.findItemIndexAtTime(this.timelinePos);if(!this.isInterstitial(c)&&(l=this.media)!=null&&l.paused&&(this.shouldPlay=!1),!a){const v=this.findItemIndex(c);if(p>v){const E=this.schedule.findJumpRestrictedIndex(v+1,p);if(E>v){this.setSchedulePosition(E);return}}}this.setSchedulePosition(p);return}const d=this.playingAsset;if(!d){if(this.playingLastItem&&this.isInterstitial(c)){const p=c.event.assetList[0];p&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(r,p))}return}const u=d.timelineStart,f=d.duration||0;(a&&r<u||r>=u+f)&&this.setScheduleToAssetAtTime(r,d)},this.onTimeupdate=()=>{const r=this.currentTime;if(r===void 0||this.playbackDisabled)return;if(r>this.timelinePos)this.timelinePos=r,r>this.bufferedPos&&this.checkBuffer();else return;const n=this.playingItem;if(!n||this.playingLastItem)return;if(r>=n.end){this.timelinePos=n.end;const l=this.findItemIndex(n);this.setSchedulePosition(l+1)}const a=this.playingAsset;if(!a)return;const c=a.timelineStart+(a.duration||0);r>=c&&this.setScheduleToAssetAtTime(r,a)},this.onScheduleUpdate=(r,n)=>{const a=this.schedule,c=this.playingItem,l=a.events||[],d=a.items||[],u=a.durations,f=r.map(g=>g.identifier),p=!!(l.length||f.length);(p||n)&&this.log(`INTERSTITIALS_UPDATED (${l.length}): ${l}
Schedule: ${d.map(g=>ps(g))} pos: ${this.timelinePos}`),f.length&&this.log(`Removed events ${f}`),this.playerQueue.forEach(g=>{if(g.interstitial.appendInPlace){const _=g.assetItem.timelineStart,m=g.timelineOffset-_;if(m)try{g.timelineOffset=_}catch(y){Math.abs(m)>bo&&this.warn(`${y} ("${g.assetId}" ${g.timelineOffset}->${_})`)}}});let v=null;if(c){const g=this.updateItem(c,this.timelinePos);this.itemsMatch(c,g)&&(this.playingItem=g,this.waitingItem=this.endedItem=null,v=()=>this.trimInPlace(g,c))}else this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const E=this.bufferingItem;if(E){const g=this.updateItem(E,this.bufferedPos);this.itemsMatch(E,g)?(this.bufferingItem=g,v||(v=()=>this.trimInPlace(g,E))):E.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(E.event,null))}if(r.forEach(g=>{g.assetList.forEach(_=>{this.clearAssetPlayer(_.identifier,null)})}),p||n){if(this.hls.trigger(z.INTERSTITIALS_UPDATED,{events:l.slice(0),schedule:d.slice(0),durations:u,removedIds:f}),this.isInterstitial(c)&&f.includes(c.event.identifier)){this.warn(`Interstitial "${c.event.identifier}" removed while playing`),this.primaryFallback(c.event);return}v&&v(),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new oB(e),this.schedule=new aB(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e.on(z.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(z.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(z.MANIFEST_LOADING,this.onManifestLoading,this),e.on(z.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(z.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(z.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(z.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(z.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(z.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(z.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(z.BUFFER_APPENDED,this.onBufferAppended,this),e.on(z.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(z.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(z.MEDIA_ENDED,this.onMediaEnded,this),e.on(z.ERROR,this.onError,this),e.on(z.DESTROYING,this.onDestroying,this)}unregisterListeners(){const e=this.hls;e&&(e.off(z.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(z.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(z.MANIFEST_LOADING,this.onManifestLoading,this),e.off(z.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(z.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(z.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(z.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(z.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(z.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(z.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(z.BUFFER_CODECS,this.onBufferCodecs,this),e.off(z.BUFFER_APPENDED,this.onBufferAppended,this),e.off(z.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(z.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(z.MEDIA_ENDED,this.onMediaEnded,this),e.off(z.ERROR,this.onError,this),e.off(z.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.manager=null,this.hls=this.HlsPlayerClass=this.schedule=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){ua(e,"play",this.onPlay),ua(e,"pause",this.onPause),ua(e,"seeking",this.onSeeking),ua(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const r=this.media=t.media;Es(r,"seeking",this.onSeeking),Es(r,"timeupdate",this.onTimeupdate),Es(r,"play",this.onPlay),Es(r,"pause",this.onPause)}onMediaAttached(e,t){const r=this.effectivePlayingItem,n=this.detachedData;if(this.detachedData=null,r===null)this.checkStart();else if(!n){this.clearScheduleState();const a=this.findItemIndex(r);this.setSchedulePosition(a)}}clearScheduleState(){this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const r=!!t.transferMedia,n=this.media;if(this.media=null,!r&&(n&&this.removeMediaListeners(n),this.detachedData)){const a=this.getBufferingPlayer();a&&(this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,a.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.manager){if(!this.hls)return null;const e=this,t=()=>e.bufferingItem||e.waitingItem,r=p=>p&&e.getAssetPlayer(p.identifier),n=(p,v,E,g,_)=>{if(p){let m=p[v].start;const y=p.event;if(y){if(v==="playout"||y.timelineOccupancy!==df.Point){const b=r(E);(b==null?void 0:b.interstitial)===y&&(m+=b.assetItem.startOffset+b[_])}}else{const b=g==="bufferedPos"?c():e[g];m+=b-p.start}return m}return 0},a=(p,v)=>{if(p!==0&&v!=="primary"&&e.schedule.length){var E;const g=e.schedule.findItemIndexAtTime(p),_=(E=e.schedule.items)==null?void 0:E[g];if(_){const m=_[v].start-_.start;return p+m}}return p},c=()=>{const p=e.bufferedPos;return p===Number.MAX_VALUE?l("primary"):Math.max(p,0)},l=p=>{var v;return(v=e.primaryDetails)!=null&&v.live?e.primaryDetails.edge:e.schedule.durations[p]},d=(p,v)=>{var E,g;const _=e.effectivePlayingItem;if(_!=null&&(E=_.event)!=null&&E.restrictions.skip)return;e.log(`seek to ${p} "${v}"`);const m=e.effectivePlayingItem,y=e.schedule.findItemIndexAtTime(p,v),b=(g=e.schedule.items)==null?void 0:g[y],R=e.getBufferingPlayer(),T=R==null?void 0:R.interstitial,w=T==null?void 0:T.appendInPlace,C=m&&e.itemsMatch(m,b);if(m&&(w||C)){const L=r(e.playingAsset),D=(L==null?void 0:L.media)||e.primaryMedia;if(D){const P=v==="primary"?D.currentTime:n(m,v,e.playingAsset,"timelinePos","currentTime"),k=p-P,M=(w?P:D.currentTime)+k;if(M>=0&&(!L||w||M<=L.duration)){D.currentTime=M;return}}}if(b){let L=p;if(v!=="primary"){const P=b[v].start,k=p-P;L=b.start+k}const D=!e.isInterstitial(b);if((!e.isInterstitial(m)||m.event.appendInPlace)&&(D||b.event.appendInPlace)){const P=e.media||(w?R==null?void 0:R.media:null);P&&(P.currentTime=L)}else if(m){const P=e.findItemIndex(m);if(y>P){const M=e.schedule.findJumpRestrictedIndex(P+1,y);if(M>P){e.setSchedulePosition(M);return}}let k=0;if(D)e.timelinePos=L,e.checkBuffer();else{var A;const M=b==null||(A=b.event)==null?void 0:A.assetList;if(M){const I=p-(b[v]||b).start;for(let F=M.length;F--;){const $=M[F];if($.duration&&I>=$.startOffset&&I<$.startOffset+$.duration){k=F;break}}}}e.setSchedulePosition(y,k)}}},u=()=>{const p=e.effectivePlayingItem;if(e.isInterstitial(p))return p;const v=t();return e.isInterstitial(v)?v:null},f={get currentTime(){const p=u(),v=e.effectivePlayingItem;return v&&v===p?n(v,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-v.playout.start:0},set currentTime(p){const v=u(),E=e.effectivePlayingItem;E&&E===v&&d(p+E.playout.start,"playout")},get duration(){const p=u();return p?p.playout.end-p.playout.start:0},get assetPlayers(){var p;const v=(p=u())==null?void 0:p.event.assetList;return v?v.map(E=>e.getAssetPlayer(E.identifier)):[]},get playingIndex(){var p;const v=(p=u())==null?void 0:p.event;return v&&e.effectivePlayingAsset?v.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return u()}};this.manager={get events(){var p,v;return((p=e.schedule)==null||(v=p.events)==null?void 0:v.slice(0))||[]},get schedule(){var p,v;return((p=e.schedule)==null||(v=p.items)==null?void 0:v.slice(0))||[]},get interstitialPlayer(){return u()?f:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const p=t();return e.findItemIndex(p)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const p=e.effectivePlayingItem;return e.findItemIndex(p)},primary:{get bufferedEnd(){return c()},get currentTime(){const p=e.timelinePos;return p>0?p:0},set currentTime(p){d(p,"primary")},get duration(){return l("primary")},get seekableStart(){var p;return((p=e.primaryDetails)==null?void 0:p.fragmentStart)||0}},integrated:{get bufferedEnd(){return n(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return n(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(p){d(p,"integrated")},get duration(){return l("integrated")},get seekableStart(){var p;return a(((p=e.primaryDetails)==null?void 0:p.fragmentStart)||0,"integrated")}},skip:()=>{const p=e.effectivePlayingItem,v=p==null?void 0:p.event;if(v&&!v.restrictions.skip){const E=e.findItemIndex(p);if(v.appendInPlace){const g=p.playout.start+p.event.duration;d(g+.001,"playout")}else e.advanceAfterAssetEnded(v,E,1/0)}}}}return this.manager}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,r=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!t||!r?!1:this.findItemIndex(t)===r.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,t,r;if(this.mediaSelection===null)return;const n=this.waitingItem||this.playingItem;if(this.isInterstitial(n)&&!n.event.appendInPlace)return;let a=this.media;!a&&(e=this.bufferingItem)!=null&&(t=e.event)!=null&&t.appendInPlace&&(a=this.primaryMedia);const c=(r=a)==null?void 0:r.currentTime;if(!(c===void 0||!He(c)))return c}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,t){const r=this.getAssetPlayer(e);r&&this.transferMediaFromPlayer(r,t)}transferMediaFromPlayer(e,t){const r=e.interstitial.appendInPlace,n=e.media;if(r&&n===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&n){this.detachedData={media:n};return}const a=e.transferMedia();this.log(`transfer MediaSource from ${e} ${hr(a)}`),this.detachedData=a}else t&&n&&(this.shouldPlay||(this.shouldPlay=!n.paused))}transferMediaTo(e,t){var r,n;if(e.media===t)return;let a=null;const c=this.hls,l=e!==c,d=l&&e.interstitial.appendInPlace,u=(r=this.detachedData)==null?void 0:r.mediaSource;let f;if(c.media)d&&(a=c.transferMedia(),this.detachedData=a),f="Primary";else if(u){const E=this.getBufferingPlayer();E?(a=E.transferMedia(),f=`${E}`):f="detached MediaSource"}else f="detached media";if(!a){if(u)a=this.detachedData,this.log(`using detachedData: MediaSource ${hr(a)}`);else if(!this.detachedData||c.media===t){const E=this.playerQueue;E.length>1&&E.forEach(g=>{if(l&&g.interstitial.appendInPlace!==d){const _=g.interstitial;this.clearInterstitial(g.interstitial,null),_.appendInPlace=!1,_.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${_}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}}const p=a&&"mediaSource"in a&&((n=a.mediaSource)==null?void 0:n.readyState)!=="closed",v=p&&a?a:t;if(this.log(`${p?"transfering MediaSource":"attaching media"} to ${l?e:"Primary"} from ${f}`),v===a){const E=l&&e.assetId===this.schedule.assetIdAtEnd;v.overrides={duration:this.schedule.duration,endOfStream:!l||E,cueRemoval:!l}}e.attachMedia(v)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e.events;if(!t||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const r=this.timelinePos,n=this.effectivePlayingItem;if(r===-1){const a=this.hls.startPosition;if(this.timelinePos=a,t.length&&t[0].cue.pre){const c=e.findEventIndex(t[0].identifier);this.setSchedulePosition(c)}else if(a>=0||!this.primaryLive){const c=this.timelinePos=a>0?a:0,l=e.findItemIndexAtTime(c);this.setSchedulePosition(l)}}else if(n&&!this.playingItem){const a=e.findItemIndex(n);this.setSchedulePosition(a)}}advanceAfterAssetEnded(e,t,r){const n=Im(e,r);if(!e.isAssetPastPlayoutLimit(n))this.setSchedulePosition(t,n);else{const a=this.schedule.items;if(a){const c=t+1,l=a.length;if(c>=l){this.setSchedulePosition(-1);return}const d=e.resumeTime;this.timelinePos<d&&(this.timelinePos=d,this.checkBuffer()),this.setSchedulePosition(c)}}}setScheduleToAssetAtTime(e,t){const r=this.schedule,n=t.parentIdentifier,a=r.getEvent(n);if(a){const c=r.findEventIndex(n),l=r.findAssetIndex(a,e);this.advanceAfterAssetEnded(a,c,l-1)}}setSchedulePosition(e,t){const r=this.schedule.items;if(!r||this.playbackDisabled)return;this.log(`setSchedulePosition ${e}, ${t}`);const n=e>=0?r[e]:null,a=this.playingItem,c=this.playingLastItem;if(this.isInterstitial(a)){var l;const u=a.event,f=this.playingAsset,p=f==null?void 0:f.identifier,v=p?this.getAssetPlayer(p):null;if(v&&p&&(!this.eventItemsMatch(a,n)||t!==void 0&&p!==((l=u.assetList)==null?void 0:l[t].identifier))){var d;const E=u.findAssetIndex(f);this.log(`INTERSTITIAL_ASSET_ENDED ${E+1}/${u.assetList.length} ${uo(f)}`),this.endedAsset=f,this.playingAsset=null,this.hls.trigger(z.INTERSTITIAL_ASSET_ENDED,{asset:f,assetListIndex:E,event:u,schedule:r.slice(0),scheduleIndex:e,player:v}),this.retreiveMediaSource(p,n),v.media&&!((d=this.detachedData)!=null&&d.mediaSource)&&v.detachMedia()}if(!this.eventItemsMatch(a,n)&&(this.endedItem=a,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${u} ${ps(a)}`),u.hasPlayed=!0,this.hls.trigger(z.INTERSTITIAL_ENDED,{event:u,schedule:r.slice(0),scheduleIndex:e}),u.cue.once)){this.updateSchedule();const E=this.schedule.items;if(n&&E){const g=this.schedule.findItemIndex(n);this.advanceSchedule(g,E,t,a,c)}return}}this.advanceSchedule(e,r,t,a,c)}advanceSchedule(e,t,r,n,a){const c=e>=0?t[e]:null,l=this.primaryMedia,d=this.playerQueue;if(d.length&&d.forEach(u=>{const f=u.interstitial,p=this.schedule.findEventIndex(f.identifier);(p<e||p>e+1)&&this.clearInterstitial(f,c)}),this.isInterstitial(c)){this.timelinePos=Math.min(Math.max(this.timelinePos,c.start),c.end);const u=c.event;if(r===void 0){r=this.schedule.findAssetIndex(u,this.timelinePos);const E=Im(u,r-1);if(u.isAssetPastPlayoutLimit(E)){this.advanceAfterAssetEnded(u,e,r);return}r=E}const f=this.waitingItem;this.assetsBuffered(c,l)||this.setBufferingItem(c);let p=this.preloadAssets(u,r);if(this.eventItemsMatch(c,f||n)||(this.waitingItem=c,this.log(`INTERSTITIAL_STARTED ${ps(c)} ${u.appendInPlace?"append in place":""}`),this.hls.trigger(z.INTERSTITIAL_STARTED,{event:u,schedule:t.slice(0),scheduleIndex:e})),!u.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${u}`);return}if(u.assetListLoader&&(u.assetListLoader.destroy(),u.assetListLoader=void 0),!l){this.log(`Waiting for attachMedia to start Interstitial ${u}`);return}this.waitingItem=this.endedItem=null,this.playingItem=c;const v=u.assetList[r];if(!v){const E=t[e+1],g=this.media;E&&g&&!this.isInterstitial(E)&&g.currentTime<E.start&&(g.currentTime=this.timelinePos=E.start),this.advanceAfterAssetEnded(u,e,r||0);return}if(p||(p=this.getAssetPlayer(v.identifier)),p===null||p.destroyed){const E=u.assetList.length;this.warn(`asset ${r+1}/${E} player destroyed ${u}`),p=this.createAssetPlayer(u,v,r)}if(!this.eventItemsMatch(c,this.bufferingItem)&&u.appendInPlace&&this.isAssetBuffered(v))return;this.startAssetPlayer(p,r,t,e,l),this.shouldPlay&&IE(p.media)}else c!==null?(this.resumePrimary(c,e,n),this.shouldPlay&&IE(this.hls.media)):a&&this.isInterstitial(n)&&(this.endedItem=null,this.playingItem=n,n.event.appendInPlace||this.attachPrimary(this.schedule.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e,t;return(e=this.mediaSelection)==null||(t=e.main)==null?void 0:t.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,t,r){var n;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${ps(e)}`),!((n=this.detachedData)!=null&&n.mediaSource)){let c=this.timelinePos;(c<e.start||c>=e.end)&&(c=this.getPrimaryResumption(e,t),this.timelinePos=c),this.attachPrimary(c,e)}if(!r)return;const a=this.schedule.items;a&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${ps(e)}`),this.hls.trigger(z.INTERSTITIALS_PRIMARY_RESUMED,{schedule:a.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const r=e.start;if(this.primaryLive){const n=this.primaryDetails;if(t===0)return this.hls.startPosition;if(n&&(r<n.fragmentStart||r>n.edge))return this.hls.liveSyncPosition||-1}return r}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);return t!=null&&t.hls?t.hls.bufferedToEnd:Lt.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,r){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const n=this.primaryMedia;if(!n)return;const a=this.hls;a.media?this.checkBuffer():(this.transferMediaTo(a,n),r&&this.startLoadingPrimaryAt(e,r)),r||(this.timelinePos=e,this.startLoadingPrimaryAt(e,r))}startLoadingPrimaryAt(e,t){var r;const n=this.hls;!n.loadingEnabled||!n.media||Math.abs((((r=n.mainForwardBufferInfo)==null?void 0:r.start)||n.media.currentTime)-e)>.5?n.startLoad(e,t):n.bufferingEnabled||n.resumeBuffering()}onManifestLoading(){this.stopLoad(),this.schedule.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(z.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(z.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(t.level===-1)return;const r=this.hls.levels[t.level],n=Vt(Vt({},this.mediaSelection||this.altSelection),{},{main:r});this.mediaSelection=n,this.schedule.parseInterstitialDateRanges(n,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const r=this.hls.audioTracks[t.id],n=this.mediaSelection;if(!n){this.altSelection=Vt(Vt({},this.altSelection),{},{audio:r});return}const a=Vt(Vt({},n),{},{audio:r});this.mediaSelection=a}onSubtitleTrackUpdated(e,t){const r=this.hls.subtitleTracks[t.id],n=this.mediaSelection;if(!n){this.altSelection=Vt(Vt({},this.altSelection),{},{subtitles:r});return}const a=Vt(Vt({},n),{},{subtitles:r});this.mediaSelection=a}onAudioTrackSwitching(e,t){const r=eE(t);this.playerQueue.forEach(n=>n.hls.setAudioOption(t)||n.hls.setAudioOption(r))}onSubtitleTrackSwitch(e,t){const r=eE(t);this.playerQueue.forEach(n=>n.hls.setSubtitleOption(t)||t.id!==-1&&n.hls.setSubtitleOption(r))}onBufferCodecs(e,t){const r=t.tracks;r&&(this.requiredTracks=r)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const r=this.playingItem;if(r&&!this.itemsMatch(r,this.bufferingItem)&&!this.isInterstitial(r)){const n=this.timelinePos;this.bufferedPos=n,this.checkBuffer()}}onBufferedToEnd(e){const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let n=0;n<t.length;n++){const a=t[n];if(a.cue.post){var r;const c=this.schedule.findEventIndex(a.identifier),l=(r=this.schedule.items)==null?void 0:r[c];this.isInterstitial(l)&&this.eventItemsMatch(l,this.bufferingItem)&&this.bufferedToItem(l,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const r=this.findItemIndex(t);this.setSchedulePosition(r+1)}else this.shouldPlay=!1}updateItem(e,t){const r=this.schedule.items;if(e&&r){const n=this.findItemIndex(e,t);return r[n]||null}return null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((a,c)=>{e.event.isAssetPastPlayoutLimit(c)&&this.clearAssetPlayer(a.identifier,null)});const r=e.end+.25,n=Lt.bufferInfo(this.primaryMedia,r,0);(n.end>r||(n.nextStart||0)>r)&&(this.attachPrimary(r,null),this.flushFrontBuffer(r))}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var r;return!!t&&(e===t||e.event.identifier===((r=t.event)==null?void 0:r.identifier))}findItemIndex(e,t){return e?this.schedule.findItemIndex(e,t):-1}updateSchedule(){const e=this.mediaSelection;e&&this.schedule.updateSchedule(e,[])}checkBuffer(e){const t=this.schedule.items;if(!t)return;const r=Lt.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=r.len<1),this.updateBufferedPos(r.end,t,e)}updateBufferedPos(e,t,r){const n=this.schedule,a=this.bufferingItem;if(this.bufferedPos>e)return;if(t.length===1&&this.itemsMatch(t[0],a)){this.bufferedPos=e;return}const c=this.playingItem,l=this.findItemIndex(c);let d=n.findItemIndexAtTime(e);if(this.bufferedPos<e){var u,f;const p=this.findItemIndex(a),v=Math.min(p+1,t.length-1),E=t[v];if((d===-1&&a&&e>=a.end||(u=E.event)!=null&&u.appendInPlace&&e+.01>=E.start)&&(d=v),v-l>1&&(a==null||(f=a.event)==null?void 0:f.appendInPlace)===!1)return;if(this.bufferedPos=e,d>p&&d>l)this.bufferedToItem(E);else{const g=this.primaryDetails;this.primaryLive&&g&&e>g.edge-g.targetduration&&E.start<g.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(E)&&this.preloadAssets(E.event,0)}}else r&&c&&!this.itemsMatch(c,a)&&(d===l?this.bufferedToItem(c):d===l+1&&this.bufferedToItem(t[d]))}assetsBuffered(e,t){return e.event.assetList.length===0?!1:!e.event.assetList.some(r=>{const n=this.getAssetPlayer(r.identifier);return!(n!=null&&n.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,r=this.schedule;if(this.itemsMatch(e,t))this.bufferingItem!==e&&(this.bufferingItem=e);else{const{items:n,events:a}=r;if(!n||!a)return t;const c=this.isInterstitial(e),l=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const d=l?l.remaining:t?t.end-this.timelinePos:0;this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${ps(e)}`+(t?` (${d.toFixed(2)} remaining)`:"")),this.playbackDisabled||(c?e.event.assetList.forEach(u=>{const f=this.getAssetPlayer(u.identifier);f&&f.resumeBuffering()}):(this.hls.resumeBuffering(),this.playerQueue.forEach(u=>u.pauseBuffering()))),this.hls.trigger(z.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:a.slice(0),schedule:n.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}return t}bufferedToItem(e,t=0){const r=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(r!==null){this.bufferingAsset=null;const n=this.detachedData;n?n.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const t=this.findItemIndex(e),r=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(r)}bufferedToEvent(e,t){const r=e.event,n=r.assetList.length===0&&!r.assetListLoader,a=r.cue.once;if(n||!a){const c=this.preloadAssets(r,t);if(c!=null&&c.interstitial.appendInPlace){const l=r.assetList[t],d=this.primaryMedia;l&&d&&this.bufferAssetPlayer(c,d)}}}preloadAssets(e,t){const r=e.assetUrl,n=e.assetList.length,a=n===0&&!e.assetListLoader,c=e.cue.once;if(a){const d=e.timelineStart;if(e.appendInPlace){var l;const v=this.playingItem;!this.isInterstitial(v)&&(v==null||(l=v.nextEvent)==null?void 0:l.identifier)===e.identifier&&this.flushFrontBuffer(d+.25)}let u,f=0;if(!this.playingItem&&this.primaryLive&&(f=this.hls.startPosition,f===-1&&(f=this.hls.liveSyncPosition||0)),f&&!(e.cue.pre||e.cue.post)){const v=f-d;v>0&&(u=Math.round(v*1e3)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${r?1:n} ${e}${u?` live-start: ${f} start-offset: ${u}`:""}`),r)return this.createAsset(e,0,0,d,e.duration,r);const p=this.assetListLoader.loadAssetList(e,u);p&&(e.assetListLoader=p)}else if(!c&&n){for(let d=t;d<n;d++){const u=e.assetList[d],f=this.getAssetPlayerQueueIndex(u.identifier);(f===-1||this.playerQueue[f].destroyed)&&!u.error&&this.createAssetPlayer(e,u,d)}return this.getAssetPlayer(e.assetList[t].identifier)}return null}flushFrontBuffer(e){const t=this.requiredTracks;t&&(this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(r=>{this.hls.trigger(z.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:r})}))}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let r=0;r<t.length;r++)if(e===t[r].assetId)return r;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t){for(let r=0;r<e.length;r++)if(e[r].media===t)return e[r]}return null}createAsset(e,t,r,n,a,c){const l={parentIdentifier:e.identifier,identifier:rB(e,c,t),duration:a,startOffset:r,timelineStart:n,uri:c};return this.createAssetPlayer(e,l,t)}createAssetPlayer(e,t,r){const n=this.hls,a=n.userConfig;let c=a.videoPreference;const l=n.loadLevelObj||n.levels[n.currentLevel];(c||l)&&(c=Yt({},c),l.videoCodec&&(c.videoCodec=l.videoCodec),l.videoRange&&(c.allowedVideoRanges=[l.videoRange]));const d=n.audioTracks[n.audioTrack],u=n.subtitleTracks[n.subtitleTrack];let f=0;if(this.primaryLive||e.appendInPlace){const R=this.timelinePos-t.timelineStart;if(R>1){const T=t.duration;T&&R<T&&(f=R)}}const p=t.identifier,v=Vt(Vt({},a),{},{autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:n.sessionId,assetPlayerId:p,abrEwmaDefaultEstimate:n.bandwidthEstimate,interstitialsController:void 0,startPosition:f,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:c,audioPreference:d||a.audioPreference,subtitlePreference:u||a.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(v.timelineOffset=t.timelineStart));const E=v.cmcd;E!=null&&E.sessionId&&E.contentId&&(v.cmcd=Yt({},E,{contentId:vl(t.uri)})),this.getAssetPlayer(p)&&this.warn(`Duplicate date range identifier ${e} and asset ${p}`);const g=new sB(this.HlsPlayerClass,v,e,t);this.playerQueue.push(g),e.assetList[r]=t;const _=R=>{if(R.live){const C=new Error(`Interstitials MUST be VOD assets ${e}`),A={fatal:!0,type:Je.OTHER_ERROR,details:he.INTERSTITIAL_ASSET_ITEM_ERROR,error:C};this.handleAssetItemError(A,e,this.schedule.findEventIndex(e.identifier),r,C.message);return}const T=R.edge-R.fragmentStart,w=t.duration;(w===null||T>w)&&(this.log(`Interstitial asset "${p}" duration change ${w} > ${T}`),t.duration=T,this.updateSchedule())};g.on(z.LEVEL_UPDATED,(R,{details:T})=>_(T)),g.on(z.LEVEL_PTS_UPDATED,(R,{details:T})=>_(T));const m=(R,T)=>{const w=this.getAssetPlayer(p);if(w&&T.tracks){w.off(z.BUFFER_CODECS,m),w.tracks=T.tracks;const C=this.primaryMedia;this.bufferingAsset===w.assetItem&&C&&!w.media&&this.bufferAssetPlayer(w,C)}};g.on(z.BUFFER_CODECS,m);const y=()=>{var R;const T=this.getAssetPlayer(p);if(this.log(`buffered to end of asset ${T}`),!T)return;const w=this.schedule.findEventIndex(e.identifier),C=(R=this.schedule.items)==null?void 0:R[w];if(this.isInterstitial(C)){const L=e.findAssetIndex(t),D=Im(e,L);if(!e.isAssetPastPlayoutLimit(D))this.bufferedToItem(C,D);else{var A;const P=(A=this.schedule.items)==null?void 0:A[w+1];P&&this.bufferedToItem(P)}}};g.on(z.BUFFERED_TO_END,y);const b=R=>()=>{if(!this.getAssetPlayer(p))return;this.shouldPlay=!0;const T=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,T,R)};return g.once(z.MEDIA_ENDED,b(r)),g.once(z.PLAYOUT_LIMIT_REACHED,b(1/0)),g.on(z.ERROR,(R,T)=>{const w=this.getAssetPlayer(p);if(T.details===he.BUFFER_STALLED_ERROR){if(w!=null&&w.media){const C=w.currentTime,A=w.duration-C;C&&e.appendInPlace&&A/w.media.playbackRate<.5?(this.log(`Advancing buffer past end of asset ${p} ${e} at ${w.media.currentTime}`),y()):(this.warn(`Stalled at ${C} of ${C+A} in asset ${p} ${e}`),this.onTimeupdate(),this.checkBuffer(!0))}return}this.handleAssetItemError(T,e,this.schedule.findEventIndex(e.identifier),r,`Asset player error ${T.error} ${e}`)}),g.on(z.DESTROYING,()=>{if(!this.getAssetPlayer(p))return;const R=new Error(`Asset player destroyed unexpectedly ${p}`),T={fatal:!0,type:Je.OTHER_ERROR,details:he.INTERSTITIAL_ASSET_ITEM_ERROR,error:R};this.handleAssetItemError(T,e,this.schedule.findEventIndex(e.identifier),r,R.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${uo(t)}`),this.hls.trigger(z.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:r,event:e,player:g}),g}clearInterstitial(e,t){e.assetList.forEach(r=>{this.clearAssetPlayer(r.identifier,t)}),e.reset()}resetAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);if(t!==-1){this.log(`reset asset player "${e}" after error`);const r=this.playerQueue[t];this.transferMediaFromPlayer(r,null),r.resetDetails()}}clearAssetPlayer(e,t){const r=this.getAssetPlayerQueueIndex(e);if(r!==-1){this.log(`clear asset player "${e}" toSegment: ${t&&ps(t)}`);const n=this.playerQueue[r];this.transferMediaFromPlayer(n,t),this.playerQueue.splice(r,1),n.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,r,n,a){const{interstitial:c,assetItem:l,assetId:d}=e,u=c.assetList.length,f=this.playingAsset;this.endedAsset=null,this.playingAsset=l,(!f||f.identifier!==d)&&(f&&(this.clearAssetPlayer(f.identifier,r[n]),delete f.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${u} ${uo(l)}`),this.hls.trigger(z.INTERSTITIAL_ASSET_STARTED,{asset:l,assetListIndex:t,event:c,schedule:r.slice(0),scheduleIndex:n,player:e})),this.bufferAssetPlayer(e,a)}bufferAssetPlayer(e,t){var r,n;const{interstitial:a,assetItem:c}=e,l=this.schedule.findEventIndex(a.identifier),d=(r=this.schedule.items)==null?void 0:r[l];if(!d)return;this.setBufferingItem(d),this.bufferingAsset=c;const u=this.getBufferingPlayer();if(u===e)return;const f=a.appendInPlace;if(f&&(u==null?void 0:u.interstitial.appendInPlace)===!1)return;const p=(u==null?void 0:u.tracks)||((n=this.detachedData)==null?void 0:n.tracks)||this.requiredTracks;if(f&&c!==this.playingAsset){if(!e.tracks)return;if(p&&!pT(p,e.tracks)){const v=new Error(`Asset ${uo(c)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(p)}')`),E={fatal:!0,type:Je.OTHER_ERROR,details:he.INTERSTITIAL_ASSET_ITEM_ERROR,error:v},g=a.findAssetIndex(c);this.handleAssetItemError(E,a,l,g,v.message);return}}this.transferMediaTo(e,t)}handleAssetItemError(e,t,r,n,a){if(e.details===he.BUFFER_STALLED_ERROR)return;const c=t.assetList[n];this.warn(`INTERSTITIAL_ASSET_ERROR ${c&&uo(c)} ${e.error}`);const l=c==null?void 0:c.identifier,d=this.getAssetPlayerQueueIndex(l),u=this.playerQueue[d]||null,f=this.schedule.items,p=Yt({},e,{fatal:!1,errorAction:Al(!0),asset:c,assetListIndex:n,event:t,schedule:f,scheduleIndex:r,player:u});if(this.hls.trigger(z.INTERSTITIAL_ASSET_ERROR,p),!e.fatal)return;const v=this.playingAsset,E=new Error(a);if(c&&(this.clearAssetPlayer(l,null),c.error=E),!t.assetList.some(g=>!g.error))t.error=E;else if(t.appendInPlace){for(let g=n;g<t.assetList.length;g++)this.resetAssetPlayer(t.assetList[g].identifier);this.updateSchedule()}t.error?this.primaryFallback(t):v&&v.identifier===l&&this.advanceAfterAssetEnded(t,r,n)}primaryFallback(e){const t=e.timelineStart,r=this.effectivePlayingItem;if(this.updateSchedule(),r){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${this.timelinePos} playing: ${r?ps(r):"<none>"} error: ${e.error}`);let n=this.timelinePos;n===-1&&(n=this.hls.startPosition);const a=this.updateItem(r,n);this.itemsMatch(r,a)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t));const c=this.schedule.findItemIndexAtTime(n);this.setSchedulePosition(c)}else this.checkStart()}onAssetListLoaded(e,t){var r;const n=t.event,a=n.identifier,c=t.assetListResponse.ASSETS;if(!this.schedule.hasEvent(a))return;const l=n.timelineStart,d=n.duration;let u=0;c.forEach((g,_)=>{const m=parseFloat(g.DURATION);this.createAsset(n,_,u,l+u,m,g.URI),u+=m}),n.duration=u,this.log(`Loaded asset-list with duration: ${u} (was: ${d}) ${n}`);const f=this.waitingItem,p=(f==null?void 0:f.event.identifier)===a;this.updateSchedule();const v=(r=this.bufferingItem)==null?void 0:r.event;if(p){var E;const g=this.schedule.findEventIndex(a),_=(E=this.schedule.items)==null?void 0:E[g];if(_){if(!this.playingItem&&this.timelinePos>_.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==g){n.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${n}`),this.primaryFallback(n);return}this.setBufferingItem(_)}this.setSchedulePosition(g)}else if((v==null?void 0:v.identifier)===a&&v.appendInPlace){const g=n.assetList[0],_=this.getAssetPlayer(g.identifier),m=this.primaryMedia;g&&_&&m&&this.bufferAssetPlayer(_,m)}}onError(e,t){switch(t.details){case he.ASSET_LIST_PARSING_ERROR:case he.ASSET_LIST_LOAD_ERROR:case he.ASSET_LIST_LOAD_TIMEOUT:{const r=t.interstitial;r&&this.primaryFallback(r);break}case he.BUFFER_STALLED_ERROR:{this.onTimeupdate(),this.checkBuffer(!0);break}}}}const PE=500;class lB extends BT{constructor(e,t,r){super(e,t,r,"subtitle-stream-controller",ot.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(z.LEVEL_LOADED,this.onLevelLoaded,this),e.on(z.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(z.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(z.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(z.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(z.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(z.LEVEL_LOADED,this.onLevelLoaded,this),e.off(z.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(z.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(z.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(z.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(z.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=Re.IDLE,this.setInterval(PE),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:r,success:n}=t;if(vi(r)&&(this.fragPrevious=r),this.state=Re.IDLE,!n)return;const a=this.tracksBuffered[this.currentTrackId];if(!a)return;let c;const l=r.start;for(let u=0;u<a.length;u++)if(l>=a[u].start&&l<=a[u].end){c=a[u];break}const d=r.start+r.duration;c?c.end=d:(c={start:l,end:d},a.push(c)),this.fragmentTracker.fragBuffered(r),this.fragBufferedComplete(r,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:r,endOffset:n}=t;if(r===0&&n!==Number.POSITIVE_INFINITY){const a=n-1;if(a<=0)return;t.endOffsetSubtitles=Math.max(0,a),this.tracksBuffered.forEach(c=>{for(let l=0;l<c.length;){if(c[l].end<=a){c.shift();continue}else if(c[l].start<a)c[l].start=a;else break;l++}}),this.fragmentTracker.removeFragmentsInRange(r,a,ot.SUBTITLE)}}onError(e,t){const r=t.frag;(r==null?void 0:r.type)===ot.SUBTITLE&&(t.details===he.FRAG_GAP&&this.fragmentTracker.fragBuffered(r,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==Re.STOPPED&&(this.state=Re.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&rC(this.levels,t)){this.levels=t.map(r=>new tf(r));return}this.tracksBuffered=[],this.levels=t.map(r=>{const n=new tf(r);return this.tracksBuffered[n.id]=[],n}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,ot.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var r;if(this.currentTrackId=t.id,!((r=this.levels)!=null&&r.length)||this.currentTrackId===-1){this.clearInterval();return}const n=this.levels[this.currentTrackId];n!=null&&n.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,n&&this.state!==Re.STOPPED&&this.setInterval(PE)}onSubtitleTrackLoaded(e,t){var r;const{currentTrackId:n,levels:a}=this,{details:c,id:l}=t;if(!a){this.warn(`Subtitle tracks were reset while loading level ${l}`);return}const d=a[l];if(l>=a.length||!d)return;this.log(`Subtitle track ${l} loaded [${c.startSN},${c.endSN}]${c.lastPartSn?`[part-${c.lastPartSn}-${c.lastPartIndex}]`:""},duration:${c.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let u=0;if(c.live||(r=d.details)!=null&&r.live){const p=this.mainDetails;if(c.deltaUpdateFailed||!p)return;const v=p.fragments[0];if(!d.details)c.hasProgramDateTime&&p.hasProgramDateTime?(of(c,p),u=c.fragmentStart):v&&(u=v.start,Hg(c,u));else{var f;u=this.alignPlaylists(c,d.details,(f=this.levelLastLoaded)==null?void 0:f.details),u===0&&v&&(u=v.start,Hg(c,u))}}d.details=c,this.levelLastLoaded=d,l===n&&(this.hls.trigger(z.SUBTITLE_TRACK_UPDATED,{details:c,id:l,groupId:t.groupId}),this.tick(),c.live&&!this.fragCurrent&&this.media&&this.state===Re.IDLE&&(Co(null,c.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),d.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:r}=e,n=t.decryptdata,a=this.hls;if(!this.fragContextChanged(t)&&r&&r.byteLength>0&&n!=null&&n.key&&n.iv&&vo(n.method)){const c=performance.now();this.decrypter.decrypt(new Uint8Array(r),n.key.buffer,n.iv.buffer,Av(n.method)).catch(l=>{throw a.trigger(z.ERROR,{type:Je.MEDIA_ERROR,details:he.FRAG_DECRYPT_ERROR,fatal:!1,error:l,reason:l.message,frag:t}),l}).then(l=>{const d=performance.now();a.trigger(z.FRAG_DECRYPTED,{frag:t,payload:l,stats:{tstart:c,tdecrypt:d}})}).catch(l=>{this.warn(`${l.name}: ${l.message}`),this.state=Re.IDLE})}}doTick(){if(!this.media){this.state=Re.IDLE;return}if(this.state===Re.IDLE){const{currentTrackId:e,levels:t}=this,r=t==null?void 0:t[e];if(!r||!t.length||!r.details||this.waitForLive(r))return;const{config:n}=this,a=this.getLoadPosition(),c=Lt.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],a,n.maxBufferHole),{end:l,len:d}=c,u=r.details,f=this.hls.maxBufferLength+u.levelTargetDuration;if(d>f)return;const p=u.fragments,v=p.length,E=u.edge;let g=null;const _=this.fragPrevious;if(l<E){const b=n.maxFragLookUpTolerance,R=l>E-b?0:b;g=Co(_,p,Math.max(p[0].start,l),R),!g&&_&&_.start<p[0].start&&(g=p[0])}else g=p[v-1];if(g=this.filterReplacedPrimary(g,r.details),!g)return;const m=g.sn-u.startSN,y=p[m-1];if(y&&y.cc===g.cc&&this.fragmentTracker.getState(y)===Ni.NOT_LOADED&&(g=y),this.fragmentTracker.getState(g)===Ni.NOT_LOADED){const b=this.mapToInitFragWhenRequired(g);b&&this.loadFragment(b,r,l)}}}loadFragment(e,t,r){vi(e)?super.loadFragment(e,t,r):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new uB(this.tracksBuffered[this.currentTrackId]||[])}}class uB{constructor(e){this.buffered=void 0;const t=(r,n,a)=>{if(n=n>>>0,n>a-1)throw new DOMException(`Failed to execute '${r}' on 'TimeRanges': The index provided (${n}) is greater than the maximum bound (${a})`);return e[n][r]};this.buffered={get length(){return e.length},end(r){return t("end",r,e.length)},start(r){return t("start",r,e.length)}}}}const dB={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},fC=i=>String.fromCharCode(dB[i]||i),Wi=15,Nn=100,fB={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},hB={17:2,18:4,21:6,22:8,23:10,19:13,20:15},pB={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},mB={25:2,26:4,29:6,30:8,31:10,27:13,28:15},gB=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class vB{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const r=typeof t=="function"?t():t;Gt.log(`${this.time} [${e}] ${r}`)}}}const ea=function(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].toString(16));return e};class hC{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let r=0;r<t.length;r++){const n=t[r];e.hasOwnProperty(n)&&(this[n]=e[n])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class yB{constructor(){this.uchar=" ",this.penState=new hC}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class bB{constructor(e){this.chars=[],this.pos=0,this.currPenState=new hC,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<Nn;t++)this.chars.push(new yB);this.logger=e}equals(e){for(let t=0;t<Nn;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<Nn;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<Nn;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Nn&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Nn)}moveCursor(e){const t=this.pos+e;if(e>1)for(let r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=fC(e);if(this.pos>=Nn){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<Nn;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let r=0;r<Nn;r++){const n=this.chars[r].uchar;n!==" "&&(t=!1),e.push(n)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class Pm{constructor(e){this.rows=[],this.currRow=Wi-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<Wi;t++)this.rows.push(new bB(e));this.logger=e}reset(){for(let e=0;e<Wi;e++)this.rows[e].clear();this.currRow=Wi-1}equals(e){let t=!0;for(let r=0;r<Wi;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t}copy(e){for(let t=0;t<Wi;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<Wi;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+hr(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let l=0;l<Wi;l++)this.rows[l].clear();const a=this.currRow+1-this.nrRollUpRows,c=this.lastOutputScreen;if(c){const l=c.rows[a].cueStartTime,d=this.logger.time;if(l!==null&&d!==null&&l<d)for(let u=0;u<this.nrRollUpRows;u++)this.rows[t-this.nrRollUpRows+u+1].copy(c.rows[a+u])}}this.currRow=t;const r=this.rows[this.currRow];if(e.indent!==null){const a=e.indent,c=Math.max(a-1,0);r.setCursor(e.indent),e.color=r.chars[c].penState.foreground}const n={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(n)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+hr(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let r="",n=-1;for(let a=0;a<Wi;a++){const c=this.rows[a].getTextString();c&&(n=a+1,e?t.push("Row "+n+": '"+c+"'"):t.push(c.trim()))}return t.length>0&&(e?r="["+t.join(" | ")+"]":r=t.join(`
`)),r}getTextAndFormat(){return this.rows}}class kE{constructor(e,t,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new Pm(r),this.nonDisplayedMemory=new Pm(r),this.lastOutputScreen=new Pm(r),this.currRollUpRow=this.displayedMemory.rows[Wi-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[Wi-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let r=0;r<e.length;r++)this.writeScreen.insertChar(e[r]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const r=Math.floor(e/2)-16,n=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=n[r]}this.logger.log(2,"MIDROW: "+hr(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class ME{constructor(e,t,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=SB(),this.logger=void 0;const n=this.logger=new vB;this.channels=[null,new kE(e,t,n),new kE(e+1,r,n)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let r=0;r<t.length;r+=2){const n=t[r]&127,a=t[r+1]&127;let c=!1,l=null;if(n===0&&a===0)continue;this.logger.log(3,()=>"["+ea([t[r],t[r+1]])+"] -> ("+ea([n,a])+")");const d=this.cmdHistory;if(n>=16&&n<=31){if(_B(n,a,d)){ud(null,null,d),this.logger.log(3,()=>"Repeated command ("+ea([n,a])+") is dropped");continue}ud(n,a,this.cmdHistory),c=this.parseCmd(n,a),c||(c=this.parseMidrow(n,a)),c||(c=this.parsePAC(n,a)),c||(c=this.parseBackgroundAttributes(n,a))}else ud(null,null,d);if(!c&&(l=this.parseChars(n,a),l)){const u=this.currentChannel;u&&u>0?this.channels[u].insertChars(l):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!c&&!l&&this.logger.log(2,()=>"Couldn't parse cleaned data "+ea([n,a])+" orig: "+ea([t[r],t[r+1]]))}}parseCmd(e,t){const r=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,n=(e===23||e===31)&&t>=33&&t<=35;if(!(r||n))return!1;const a=e===20||e===21||e===23?1:2,c=this.channels[a];return e===20||e===21||e===28||e===29?t===32?c.ccRCL():t===33?c.ccBS():t===34?c.ccAOF():t===35?c.ccAON():t===36?c.ccDER():t===37?c.ccRU(2):t===38?c.ccRU(3):t===39?c.ccRU(4):t===40?c.ccFON():t===41?c.ccRDC():t===42?c.ccTR():t===43?c.ccRTD():t===44?c.ccEDM():t===45?c.ccCR():t===46?c.ccENM():t===47&&c.ccEOC():c.ccTO(t-32),this.currentChannel=a,!0}parseMidrow(e,t){let r=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?r=1:r=2,r!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const n=this.channels[r];return n?(n.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+ea([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let r;const n=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,a=(e===16||e===24)&&t>=64&&t<=95;if(!(n||a))return!1;const c=e<=23?1:2;t>=64&&t<=95?r=c===1?fB[e]:pB[e]:r=c===1?hB[e]:mB[e];const l=this.channels[c];return l?(l.setPAC(this.interpretPAC(r,t)),this.currentChannel=c,!0):!1}interpretPAC(e,t){let r;const n={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?r=t-96:r=t-64,n.underline=(r&1)===1,r<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(n.italics=!0,n.color="white"):n.indent=Math.floor((r-16)/2)*4,n}parseChars(e,t){let r,n=null,a=null;if(e>=25?(r=2,a=e-8):(r=1,a=e),a>=17&&a<=19){let c;a===17?c=t+80:a===18?c=t+112:c=t+144,this.logger.log(2,()=>"Special char '"+fC(c)+"' in channel "+r),n=[c]}else e>=32&&e<=127&&(n=t===0?[e]:[e,t]);return n&&this.logger.log(3,()=>"Char codes =  "+ea(n).join(",")),n}parseBackgroundAttributes(e,t){const r=(e===16||e===24)&&t>=32&&t<=47,n=(e===23||e===31)&&t>=45&&t<=47;if(!(r||n))return!1;let a;const c={};e===16||e===24?(a=Math.floor((t-32)/2),c.background=gB[a],t%2===1&&(c.background=c.background+"_semi")):t===45?c.background="transparent":(c.foreground="black",t===47&&(c.underline=!0));const l=e<=23?1:2;return this.channels[l].setBkgData(c),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}ud(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const r=this.channels[t];r&&r.cueSplitAtTime(e)}}}function ud(i,e,t){t.a=i,t.b=e}function _B(i,e,t){return t.a===i&&t.b===e}function SB(){return{a:null,b:null}}var Bv=function(){if(sf!=null&&sf.VTTCue)return self.VTTCue;const i=["","lr","rl"],e=["start","middle","end","left","right"];function t(l,d){if(typeof d!="string"||!Array.isArray(l))return!1;const u=d.toLowerCase();return~l.indexOf(u)?u:!1}function r(l){return t(i,l)}function n(l){return t(e,l)}function a(l,...d){let u=1;for(;u<arguments.length;u++){const f=arguments[u];for(const p in f)l[p]=f[p]}return l}function c(l,d,u){const f=this,p={enumerable:!0};f.hasBeenReset=!1;let v="",E=!1,g=l,_=d,m=u,y=null,b="",R=!0,T="auto",w="start",C=50,A="middle",L=50,D="middle";Object.defineProperty(f,"id",a({},p,{get:function(){return v},set:function(P){v=""+P}})),Object.defineProperty(f,"pauseOnExit",a({},p,{get:function(){return E},set:function(P){E=!!P}})),Object.defineProperty(f,"startTime",a({},p,{get:function(){return g},set:function(P){if(typeof P!="number")throw new TypeError("Start time must be set to a number.");g=P,this.hasBeenReset=!0}})),Object.defineProperty(f,"endTime",a({},p,{get:function(){return _},set:function(P){if(typeof P!="number")throw new TypeError("End time must be set to a number.");_=P,this.hasBeenReset=!0}})),Object.defineProperty(f,"text",a({},p,{get:function(){return m},set:function(P){m=""+P,this.hasBeenReset=!0}})),Object.defineProperty(f,"region",a({},p,{get:function(){return y},set:function(P){y=P,this.hasBeenReset=!0}})),Object.defineProperty(f,"vertical",a({},p,{get:function(){return b},set:function(P){const k=r(P);if(k===!1)throw new SyntaxError("An invalid or illegal string was specified.");b=k,this.hasBeenReset=!0}})),Object.defineProperty(f,"snapToLines",a({},p,{get:function(){return R},set:function(P){R=!!P,this.hasBeenReset=!0}})),Object.defineProperty(f,"line",a({},p,{get:function(){return T},set:function(P){if(typeof P!="number"&&P!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");T=P,this.hasBeenReset=!0}})),Object.defineProperty(f,"lineAlign",a({},p,{get:function(){return w},set:function(P){const k=n(P);if(!k)throw new SyntaxError("An invalid or illegal string was specified.");w=k,this.hasBeenReset=!0}})),Object.defineProperty(f,"position",a({},p,{get:function(){return C},set:function(P){if(P<0||P>100)throw new Error("Position must be between 0 and 100.");C=P,this.hasBeenReset=!0}})),Object.defineProperty(f,"positionAlign",a({},p,{get:function(){return A},set:function(P){const k=n(P);if(!k)throw new SyntaxError("An invalid or illegal string was specified.");A=k,this.hasBeenReset=!0}})),Object.defineProperty(f,"size",a({},p,{get:function(){return L},set:function(P){if(P<0||P>100)throw new Error("Size must be between 0 and 100.");L=P,this.hasBeenReset=!0}})),Object.defineProperty(f,"align",a({},p,{get:function(){return D},set:function(P){const k=n(P);if(!k)throw new SyntaxError("An invalid or illegal string was specified.");D=k,this.hasBeenReset=!0}})),f.displayState=void 0}return c.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},c}();class EB{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function pC(i){function e(r,n,a,c){return(r|0)*3600+(n|0)*60+(a|0)+parseFloat(c||0)}const t=i.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class RB{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,r){for(let n=0;n<r.length;++n)if(t===r[n]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const r=parseFloat(t);if(r>=0&&r<=100)return this.set(e,r),!0}return!1}}function mC(i,e,t,r){const n=r?i.split(r):[i];for(const a in n){if(typeof n[a]!="string")continue;const c=n[a].split(t);if(c.length!==2)continue;const l=c[0],d=c[1];e(l,d)}}const Xg=new Bv(0,0,""),dd=Xg.align==="middle"?"middle":"center";function wB(i,e,t){const r=i;function n(){const l=pC(i);if(l===null)throw new Error("Malformed timestamp: "+r);return i=i.replace(/^[^\sa-zA-Z-]+/,""),l}function a(l,d){const u=new RB;mC(l,function(v,E){let g;switch(v){case"region":for(let _=t.length-1;_>=0;_--)if(t[_].id===E){u.set(v,t[_].region);break}break;case"vertical":u.alt(v,E,["rl","lr"]);break;case"line":g=E.split(","),u.integer(v,g[0]),u.percent(v,g[0])&&u.set("snapToLines",!1),u.alt(v,g[0],["auto"]),g.length===2&&u.alt("lineAlign",g[1],["start",dd,"end"]);break;case"position":g=E.split(","),u.percent(v,g[0]),g.length===2&&u.alt("positionAlign",g[1],["start",dd,"end","line-left","line-right","auto"]);break;case"size":u.percent(v,E);break;case"align":u.alt(v,E,["start",dd,"end","left","right"]);break}},/:/,/\s/),d.region=u.get("region",null),d.vertical=u.get("vertical","");let f=u.get("line","auto");f==="auto"&&Xg.line===-1&&(f=-1),d.line=f,d.lineAlign=u.get("lineAlign","start"),d.snapToLines=u.get("snapToLines",!0),d.size=u.get("size",100),d.align=u.get("align",dd);let p=u.get("position","auto");p==="auto"&&Xg.position===50&&(p=d.align==="start"||d.align==="left"?0:d.align==="end"||d.align==="right"?100:50),d.position=p}function c(){i=i.replace(/^\s+/,"")}if(c(),e.startTime=n(),c(),i.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+r);i=i.slice(3),c(),e.endTime=n(),c(),a(i,e)}function gC(i){return i.replace(/<br(?: \/)?>/gi,`
`)}class TB{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new EB,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function r(){let a=t.buffer,c=0;for(a=gC(a);c<a.length&&a[c]!=="\r"&&a[c]!==`
`;)++c;const l=a.slice(0,c);return a[c]==="\r"&&++c,a[c]===`
`&&++c,t.buffer=a.slice(c),l}function n(a){mC(a,function(c,l){},/:/)}try{let a="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;a=r();const l=a.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!(l!=null&&l[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let c=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(c?c=!1:a=r(),t.state){case"HEADER":/:/.test(a)?n(a):a||(t.state="ID");continue;case"NOTE":a||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(a)){t.state="NOTE";break}if(!a)continue;if(t.cue=new Bv(0,0,""),t.state="CUE",a.indexOf("-->")===-1){t.cue.id=a;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{wB(a,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const l=a.indexOf("-->")!==-1;if(!a||l&&(c=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=a}continue;case"BADCUE":a||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const CB=/\r\n|\n\r|\n|\r/g,km=function(i,e,t=0){return i.slice(t,t+e.length)===e},AB=function(i){let e=parseInt(i.slice(-3));const t=parseInt(i.slice(-6,-4)),r=parseInt(i.slice(-9,-7)),n=i.length>9?parseInt(i.substring(0,i.indexOf(":"))):0;if(!He(e)||!He(t)||!He(r)||!He(n))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${i}`);return e+=1e3*t,e+=60*1e3*r,e+=60*60*1e3*n,e};function Fv(i,e,t){return vl(i.toString())+vl(e.toString())+vl(t)}const xB=function(i,e,t){let r=i[e],n=i[r.prevCC];if(!n||!n.new&&r.new){i.ccOffset=i.presentationOffset=r.start,r.new=!1;return}for(;(a=n)!=null&&a.new;){var a;i.ccOffset+=r.start-n.start,r.new=!1,r=n,n=i[r.prevCC]}i.presentationOffset=t};function DB(i,e,t,r,n,a,c){const l=new TB,d=_i(new Uint8Array(i)).trim().replace(CB,`
`).split(`
`),u=[],f=e?GN(e.baseTime,e.timescale):0;let p="00:00.000",v=0,E=0,g,_=!0;l.oncue=function(m){const y=t[r];let b=t.ccOffset;const R=(v-f)/9e4;if(y!=null&&y.new&&(E!==void 0?b=t.ccOffset=y.start:xB(t,r,R)),R){if(!e){g=new Error("Missing initPTS for VTT MPEGTS");return}b=R-t.presentationOffset}const T=m.endTime-m.startTime,w=Mi((m.startTime+b-E)*9e4,n*9e4)/9e4;m.startTime=Math.max(w,0),m.endTime=Math.max(w+T,0);const C=m.text.trim();m.text=decodeURIComponent(encodeURIComponent(C)),m.id||(m.id=Fv(m.startTime,m.endTime,C)),m.endTime>0&&u.push(m)},l.onparsingerror=function(m){g=m},l.onflush=function(){if(g){c(g);return}a(u)},d.forEach(m=>{if(_)if(km(m,"X-TIMESTAMP-MAP=")){_=!1,m.slice(16).split(",").forEach(y=>{km(y,"LOCAL:")?p=y.slice(6):km(y,"MPEGTS:")&&(v=parseInt(y.slice(7)))});try{E=AB(p)/1e3}catch(y){g=y}return}else m===""&&(_=!1);l.parse(m+`
`)}),l.flush()}const Mm="stpp.ttml.im1t",vC=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,yC=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,LB={left:"start",center:"center",right:"end",start:"start",end:"end"};function NE(i,e,t,r){const n=nt(new Uint8Array(i),["mdat"]);if(n.length===0){r(new Error("Could not parse IMSC1 mdat"));return}const a=n.map(l=>_i(l)),c=zN(e.baseTime,1,e.timescale);try{a.forEach(l=>t(OB(l,c)))}catch(l){r(l)}}function OB(i,e){const t=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("tt")[0];if(!t)throw new Error("Invalid ttml");const r={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},n=Object.keys(r).reduce((u,f)=>(u[f]=t.getAttribute(`ttp:${f}`)||r[f],u),{}),a=t.getAttribute("xml:space")!=="preserve",c=BE(Nm(t,"styling","style")),l=BE(Nm(t,"layout","region")),d=Nm(t,"body","[begin]");return[].map.call(d,u=>{const f=bC(u,a);if(!f||!u.hasAttribute("begin"))return null;const p=Fm(u.getAttribute("begin"),n),v=Fm(u.getAttribute("dur"),n);let E=Fm(u.getAttribute("end"),n);if(p===null)throw FE(u);if(E===null){if(v===null)throw FE(u);E=p+v}const g=new Bv(p-e,E-e,f);g.id=Fv(g.startTime,g.endTime,g.text);const _=l[u.getAttribute("region")],m=c[u.getAttribute("style")],y=IB(_,m,c),{textAlign:b}=y;if(b){const R=LB[b];R&&(g.lineAlign=R),g.align=b}return Yt(g,y),g}).filter(u=>u!==null)}function Nm(i,e,t){const r=i.getElementsByTagName(e)[0];return r?[].slice.call(r.querySelectorAll(t)):[]}function BE(i){return i.reduce((e,t)=>{const r=t.getAttribute("xml:id");return r&&(e[r]=t),e},{})}function bC(i,e){return[].slice.call(i.childNodes).reduce((t,r,n)=>{var a;return r.nodeName==="br"&&n?t+`
`:(a=r.childNodes)!=null&&a.length?bC(r,e):e?t+r.textContent.trim().replace(/\s+/g," "):t+r.textContent},"")}function IB(i,e,t){const r="http://www.w3.org/ns/ttml#styling";let n=null;const a=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],c=i!=null&&i.hasAttribute("style")?i.getAttribute("style"):null;return c&&t.hasOwnProperty(c)&&(n=t[c]),a.reduce((l,d)=>{const u=Bm(e,r,d)||Bm(i,r,d)||Bm(n,r,d);return u&&(l[d]=u),l},{})}function Bm(i,e,t){return i&&i.hasAttributeNS(e,t)?i.getAttributeNS(e,t):null}function FE(i){return new Error(`Could not parse ttml timestamp ${i}`)}function Fm(i,e){if(!i)return null;let t=pC(i);return t===null&&(vC.test(i)?t=PB(i,e):yC.test(i)&&(t=kB(i,e))),t}function PB(i,e){const t=vC.exec(i),r=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+r/e.frameRate}function kB(i,e){const t=yC.exec(i),r=Number(t[1]);switch(t[2]){case"h":return r*3600;case"m":return r*60;case"ms":return r*1e3;case"f":return r/e.frameRate;case"t":return r/e.tickRate}return r}class fd{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,r){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class MB{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=$E(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(z.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(z.MANIFEST_LOADING,this.onManifestLoading,this),e.on(z.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(z.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(z.FRAG_LOADING,this.onFragLoading,this),e.on(z.FRAG_LOADED,this.onFragLoaded,this),e.on(z.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(z.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(z.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(z.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(z.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(z.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(z.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(z.MANIFEST_LOADING,this.onManifestLoading,this),e.off(z.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(z.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(z.FRAG_LOADING,this.onFragLoading,this),e.off(z.FRAG_LOADED,this.onFragLoaded,this),e.off(z.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(z.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(z.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(z.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(z.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new fd(this,"textTrack1"),t=new fd(this,"textTrack2"),r=new fd(this,"textTrack3"),n=new fd(this,"textTrack4");this.cea608Parser1=new ME(1,e,t),this.cea608Parser2=new ME(3,r,n)}addCues(e,t,r,n,a){let c=!1;for(let l=a.length;l--;){const d=a[l],u=NB(d[0],d[1],t,r);if(u>=0&&(d[0]=Math.min(d[0],t),d[1]=Math.max(d[1],r),c=!0,u/(r-t)>.5))return}if(c||a.push([t,r]),this.config.renderTextTracksNatively){const l=this.captionsTracks[e];this.Cues.newCue(l,t,r,n)}else{const l=this.Cues.newCue(null,t,r,n);this.hls.trigger(z.CUES_PARSED,{type:"captions",cues:l,track:e})}}onInitPtsFound(e,{frag:t,id:r,initPTS:n,timescale:a}){const{unparsedVttFrags:c}=this;r===ot.MAIN&&(this.initPTS[t.cc]={baseTime:n,timescale:a}),c.length&&(this.unparsedVttFrags=[],c.forEach(l=>{this.onFragLoaded(z.FRAG_LOADED,l)}))}getExistingTrack(e,t){const{media:r}=this;if(r)for(let n=0;n<r.textTracks.length;n++){const a=r.textTracks[n];if(UE(a,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return a}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:r,media:n}=this,{label:a,languageCode:c}=t[e],l=this.getExistingTrack(a,c);if(l)r[e]=l,dl(r[e]),Z4(r[e],n);else{const d=this.createTextTrack("captions",a,c);d&&(d[e]=!0,r[e]=d)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const r=t.label,n={_id:e,label:r,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=n,this.hls.trigger(z.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[n]})}createTextTrack(e,t,r){const n=this.media;if(n)return n.addTextTrack(e,t,r)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const r=!!t.transferMedia;if(this.media=null,r)return;const{captionsTracks:n}=this;Object.keys(n).forEach(a=>{dl(n[a]),delete n[a]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=$E(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let r=0;r<t.length;r++)dl(t[r])}onSubtitleTracksUpdated(e,t){const r=t.subtitleTracks||[],n=r.some(a=>a.textCodec===Mm);if(this.config.enableWebVTT||n&&this.config.enableIMSC1){if(rC(this.tracks,r)){this.tracks=r;return}if(this.textTracks=[],this.tracks=r,this.config.renderTextTracksNatively){const a=this.media,c=a?$d(a.textTracks):null;if(this.tracks.forEach((l,d)=>{let u;if(c){let f=null;for(let p=0;p<c.length;p++)if(c[p]&&UE(c[p],l)){f=c[p],c[p]=null;break}f&&(u=f)}if(u)dl(u);else{const f=_C(l);u=this.createTextTrack(f,l.name,l.lang),u&&(u.mode="disabled")}u&&this.textTracks.push(u)}),c!=null&&c.length){const l=c.filter(d=>d!==null).map(d=>d.label);l.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${l.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const a=this.tracks.map(c=>({label:c.name,kind:c.type.toLowerCase(),default:c.default,subtitleTrack:c}));this.hls.trigger(z.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:a})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(r=>{const n=/(?:CC|SERVICE)([1-4])/.exec(r.instreamId);if(!n)return;const a=`textTrack${n[1]}`,c=this.captionsProperties[a];c&&(c.label=r.name,r.lang&&(c.languageCode=r.lang),c.media=r)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===ot.MAIN){var r,n;const{cea608Parser1:a,cea608Parser2:c,lastSn:l}=this,{cc:d,sn:u}=t.frag,f=(r=(n=t.part)==null?void 0:n.index)!=null?r:-1;a&&c&&(u!==l+1||u===l&&f!==this.lastPartIndex+1||d!==this.lastCc)&&(a.reset(),c.reset()),this.lastCc=d,this.lastSn=u,this.lastPartIndex=f}}onFragLoaded(e,t){const{frag:r,payload:n}=t;if(r.type===ot.SUBTITLE)if(n.byteLength){const a=r.decryptdata,c="stats"in t;if(a==null||!a.encrypted||c){const l=this.tracks[r.level],d=this.vttCCs;d[r.cc]||(d[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),l&&l.textCodec===Mm?this._parseIMSC1(r,n):this._parseVTTs(t)}}else this.hls.trigger(z.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const r=this.hls;NE(t,this.initPTS[e.cc],n=>{this._appendCues(n,e.level),r.trigger(z.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},n=>{r.logger.log(`Failed to parse IMSC1: ${n}`),r.trigger(z.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:n})})}_parseVTTs(e){var t;const{frag:r,payload:n}=e,{initPTS:a,unparsedVttFrags:c}=this,l=a.length-1;if(!a[r.cc]&&l===-1){c.push(e);return}const d=this.hls,u=(t=r.initSegment)!=null&&t.data?Fi(r.initSegment.data,new Uint8Array(n)).buffer:n;DB(u,this.initPTS[r.cc],this.vttCCs,r.cc,r.start,f=>{this._appendCues(f,r.level),d.trigger(z.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:r})},f=>{const p=f.message==="Missing initPTS for VTT MPEGTS";p?c.push(e):this._fallbackToIMSC1(r,n),d.logger.log(`Failed to parse VTT cue: ${f}`),!(p&&l>r.cc)&&d.trigger(z.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:f})})}_fallbackToIMSC1(e,t){const r=this.tracks[e.level];r.textCodec||NE(t,this.initPTS[e.cc],()=>{r.textCodec=Mm,this._parseIMSC1(e,t)},()=>{r.textCodec="wvtt"})}_appendCues(e,t){const r=this.hls;if(this.config.renderTextTracksNatively){const n=this.textTracks[t];if(!n||n.mode==="disabled")return;e.forEach(a=>uC(n,a))}else{const n=this.tracks[t];if(!n)return;const a=n.default?"default":"subtitles"+t;r.trigger(z.CUES_PARSED,{type:"subtitles",cues:e,track:a})}}onFragDecrypted(e,t){const{frag:r}=t;r.type===ot.SUBTITLE&&this.onFragLoaded(z.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:r,samples:n}=t;if(!(r.type===ot.MAIN&&this.closedCaptionsForLevel(r)==="NONE"))for(let a=0;a<n.length;a++){const c=n[a].bytes;if(c){this.cea608Parser1||this.initCea608Parsers();const l=this.extractCea608Data(c);this.cea608Parser1.addData(n[a].pts,l[0]),this.cea608Parser2.addData(n[a].pts,l[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:r,endOffsetSubtitles:n,type:a}){const{media:c}=this;if(!(!c||c.currentTime<r)){if(!a||a==="video"){const{captionsTracks:l}=this;Object.keys(l).forEach(d=>LE(l[d],t,r))}if(this.config.renderTextTracksNatively&&t===0&&n!==void 0){const{textTracks:l}=this;Object.keys(l).forEach(d=>LE(l[d],t,n))}}}extractCea608Data(e){const t=[[],[]],r=e[0]&31;let n=2;for(let a=0;a<r;a++){const c=e[n++],l=127&e[n++],d=127&e[n++];if(!(l===0&&d===0)&&(4&c)!==0){const u=3&c;(u===0||u===1)&&(t[u].push(l),t[u].push(d))}}return t}}function _C(i){return i.characteristics&&/transcribes-spoken-dialog/gi.test(i.characteristics)&&/describes-music-and-sound/gi.test(i.characteristics)?"captions":"subtitles"}function UE(i,e){return!!i&&i.kind===_C(e)&&qg(e,i)}function NB(i,e,t,r){return Math.min(e,r)-Math.max(i,t)}function $E(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const BB=/\s/,FB={newCue(i,e,t,r){const n=[];let a,c,l,d,u;const f=self.VTTCue||self.TextTrackCue;for(let v=0;v<r.rows.length;v++)if(a=r.rows[v],l=!0,d=0,u="",!a.isEmpty()){var p;for(let _=0;_<a.chars.length;_++)BB.test(a.chars[_].uchar)&&l?d++:(u+=a.chars[_].uchar,l=!1);a.cueStartTime=e,e===t&&(t+=1e-4),d>=16?d--:d++;const E=gC(u.trim()),g=Fv(e,t,E);i!=null&&(p=i.cues)!=null&&p.getCueById(g)||(c=new f(e,t,E),c.id=g,c.line=v+1,c.align="left",c.position=10+Math.min(80,Math.floor(d*8/32)*10),n.push(c))}return i&&n.length&&(n.sort((v,E)=>v.line==="auto"||E.line==="auto"?0:v.line>8&&E.line>8?E.line-v.line:v.line-E.line),n.forEach(v=>uC(i,v))),n}},UB=/^age:\s*[\d.]+\s*$/im;class $B{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new IM,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=r,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const r=this.loader=new self.XMLHttpRequest,n=this.stats;n.loading.first=0,n.loaded=0,n.aborted=!1;const a=this.xhrSetup;a?Promise.resolve().then(()=>{if(!(this.loader!==r||this.stats.aborted))return a(r,t.url)}).catch(c=>{if(!(this.loader!==r||this.stats.aborted))return r.open("GET",t.url,!0),a(r,t.url)}).then(()=>{this.loader!==r||this.stats.aborted||this.openAndSendXhr(r,t,e)}).catch(c=>{var l;(l=this.callbacks)==null||l.onError({code:r.status,text:c.message},t,r,n)}):this.openAndSendXhr(r,t,e)}openAndSendXhr(e,t,r){e.readyState||e.open("GET",t.url,!0);const n=t.headers,{maxTimeToFirstByteMs:a,maxLoadTimeMs:c}=r.loadPolicy;if(n)for(const l in n)e.setRequestHeader(l,n[l]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),r.timeout=a&&He(a)?a:c,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:r}=this;if(!e||!t)return;const n=t.readyState,a=this.config;if(!r.aborted&&n>=2&&(r.loading.first===0&&(r.loading.first=Math.max(self.performance.now(),r.loading.start),a.timeout!==a.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),a.timeout=a.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.loadPolicy.maxLoadTimeMs-(r.loading.first-r.loading.start)))),n===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const u=t.status,f=t.responseType==="text"?t.responseText:null;if(u>=200&&u<300){const g=f??t.response;if(g!=null){var c,l;r.loading.end=Math.max(self.performance.now(),r.loading.first);const _=t.responseType==="arraybuffer"?g.byteLength:g.length;r.loaded=r.total=_,r.bwEstimate=r.total*8e3/(r.loading.end-r.loading.first);const m=(c=this.callbacks)==null?void 0:c.onProgress;m&&m(r,e,g,t);const y={url:t.responseURL,data:g,code:u};(l=this.callbacks)==null||l.onSuccess(y,r,e,t);return}}const p=a.loadPolicy.errorRetry,v=r.retry,E={url:e.url,data:void 0,code:u};if(nf(p,v,!1,E))this.retry(p);else{var d;Gt.error(`${u} while loading ${e.url}`),(d=this.callbacks)==null||d.onError({code:u,text:t.statusText},e,t,r)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(nf(e,t,!0))this.retry(e);else{var r;Gt.warn(`timeout while loading ${(r=this.context)==null?void 0:r.url}`);const n=this.callbacks;n&&(this.abortInternal(),n.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:r}=this;this.retryDelay=Tv(e,r.retry),r.retry++,Gt.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${r.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&UB.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const jB={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null};Vt(Vt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:$B,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:p3,bufferController:s4,capLevelController:Mv,errorController:b3,fpsController:Q4,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:DT,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:jB},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},zB()),{},{subtitleStreamController:lB,subtitleTrackController:tB,timelineController:MB,audioStreamController:t4,audioTrackController:r4,emeController:yo,cmcdController:Y4,contentSteeringController:X4,interstitialsController:cB});function zB(){return{cueHandler:FB,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function GB(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}(()=>{const i=GB();try{i&&new i(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();var jE={},Pc={},kc={},Um={exports:{}},$m,zE;function HB(){if(zE)return $m;zE=1;var i=1e3,e=i*60,t=e*60,r=t*24,n=r*7,a=r*365.25;$m=function(f,p){p=p||{};var v=typeof f;if(v==="string"&&f.length>0)return c(f);if(v==="number"&&isFinite(f))return p.long?d(f):l(f);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(f))};function c(f){if(f=String(f),!(f.length>100)){var p=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(f);if(p){var v=parseFloat(p[1]),E=(p[2]||"ms").toLowerCase();switch(E){case"years":case"year":case"yrs":case"yr":case"y":return v*a;case"weeks":case"week":case"w":return v*n;case"days":case"day":case"d":return v*r;case"hours":case"hour":case"hrs":case"hr":case"h":return v*t;case"minutes":case"minute":case"mins":case"min":case"m":return v*e;case"seconds":case"second":case"secs":case"sec":case"s":return v*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return v;default:return}}}}function l(f){var p=Math.abs(f);return p>=r?Math.round(f/r)+"d":p>=t?Math.round(f/t)+"h":p>=e?Math.round(f/e)+"m":p>=i?Math.round(f/i)+"s":f+"ms"}function d(f){var p=Math.abs(f);return p>=r?u(f,p,r,"day"):p>=t?u(f,p,t,"hour"):p>=e?u(f,p,e,"minute"):p>=i?u(f,p,i,"second"):f+" ms"}function u(f,p,v,E){var g=p>=v*1.5;return Math.round(f/v)+" "+E+(g?"s":"")}return $m}var jm,GE;function VB(){if(GE)return jm;GE=1;function i(e){r.debug=r,r.default=r,r.coerce=u,r.disable=l,r.enable=a,r.enabled=d,r.humanize=HB(),r.destroy=f,Object.keys(e).forEach(p=>{r[p]=e[p]}),r.names=[],r.skips=[],r.formatters={};function t(p){let v=0;for(let E=0;E<p.length;E++)v=(v<<5)-v+p.charCodeAt(E),v|=0;return r.colors[Math.abs(v)%r.colors.length]}r.selectColor=t;function r(p){let v,E=null,g,_;function m(...y){if(!m.enabled)return;const b=m,R=Number(new Date),T=R-(v||R);b.diff=T,b.prev=v,b.curr=R,v=R,y[0]=r.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let w=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(C,A)=>{if(C==="%%")return"%";w++;const L=r.formatters[A];if(typeof L=="function"){const D=y[w];C=L.call(b,D),y.splice(w,1),w--}return C}),r.formatArgs.call(b,y),(b.log||r.log).apply(b,y)}return m.namespace=p,m.useColors=r.useColors(),m.color=r.selectColor(p),m.extend=n,m.destroy=r.destroy,Object.defineProperty(m,"enabled",{enumerable:!0,configurable:!1,get:()=>E!==null?E:(g!==r.namespaces&&(g=r.namespaces,_=r.enabled(p)),_),set:y=>{E=y}}),typeof r.init=="function"&&r.init(m),m}function n(p,v){const E=r(this.namespace+(typeof v>"u"?":":v)+p);return E.log=this.log,E}function a(p){r.save(p),r.namespaces=p,r.names=[],r.skips=[];const v=(typeof p=="string"?p:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const E of v)E[0]==="-"?r.skips.push(E.slice(1)):r.names.push(E)}function c(p,v){let E=0,g=0,_=-1,m=0;for(;E<p.length;)if(g<v.length&&(v[g]===p[E]||v[g]==="*"))v[g]==="*"?(_=g,m=E,g++):(E++,g++);else if(_!==-1)g=_+1,m++,E=m;else return!1;for(;g<v.length&&v[g]==="*";)g++;return g===v.length}function l(){const p=[...r.names,...r.skips.map(v=>"-"+v)].join(",");return r.enable(""),p}function d(p){for(const v of r.skips)if(c(p,v))return!1;for(const v of r.names)if(c(p,v))return!0;return!1}function u(p){return p instanceof Error?p.stack||p.message:p}function f(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}return jm=i,jm}var HE;function If(){return HE||(HE=1,function(i,e){e.formatArgs=r,e.save=n,e.load=a,e.useColors=t,e.storage=c(),e.destroy=(()=>{let d=!1;return()=>{d||(d=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function t(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let d;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(d=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(d[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(d){if(d[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+d[0]+(this.useColors?"%c ":" ")+"+"+i.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;d.splice(1,0,u,"color: inherit");let f=0,p=0;d[0].replace(/%[a-zA-Z%]/g,v=>{v!=="%%"&&(f++,v==="%c"&&(p=f))}),d.splice(p,0,u)}e.log=console.debug||console.log||(()=>{});function n(d){try{d?e.storage.setItem("debug",d):e.storage.removeItem("debug")}catch{}}function a(){let d;try{d=e.storage.getItem("debug")||e.storage.getItem("DEBUG")}catch{}return!d&&typeof process<"u"&&"env"in process&&(d=mM.DEBUG),d}function c(){try{return localStorage}catch{}}i.exports=VB()(e);const{formatters:l}=i.exports;l.j=function(d){try{return JSON.stringify(d)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}}(Um,Um.exports)),Um.exports}var VE;function KB(){if(VE)return kc;VE=1,Object.defineProperty(kc,"__esModule",{value:!0}),kc.Logger=void 0;const i=If(),e="awaitqueue";class t{constructor(n){K(this,"_debug"),K(this,"_warn"),K(this,"_error"),n?(this._debug=i(`${e}:${n}`),this._warn=i(`${e}:WARN:${n}`),this._error=i(`${e}:ERROR:${n}`)):(this._debug=i(e),this._warn=i(`${e}:WARN`),this._error=i(`${e}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}}return kc.Logger=t,kc}var ta={},KE;function SC(){if(KE)return ta;KE=1,Object.defineProperty(ta,"__esModule",{value:!0}),ta.AwaitQueueRemovedTaskError=ta.AwaitQueueStoppedError=void 0;class i extends Error{constructor(r){super(r??"queue stopped"),this.name="AwaitQueueStoppedError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,i)}}ta.AwaitQueueStoppedError=i;class e extends Error{constructor(r){super(r??"queue task removed"),this.name="AwaitQueueRemovedTaskError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,e)}}return ta.AwaitQueueRemovedTaskError=e,ta}var qE;function qB(){if(qE)return Pc;qE=1,Object.defineProperty(Pc,"__esModule",{value:!0}),Pc.AwaitQueue=void 0;const i=KB(),e=SC(),t=new i.Logger("AwaitQueue");let r=class{constructor(){K(this,"pendingTasks",new Map),K(this,"nextTaskId",0),K(this,"stopping",!1),t.debug("constructor()")}get size(){return this.pendingTasks.size}async push(n,a){if(a=a??n.name,t.debug(`push() [name:${a}]`),typeof n!="function")throw new TypeError("given task is not a function");if(a)try{Object.defineProperty(n,"name",{value:a})}catch{}return new Promise((c,l)=>{const d={id:this.nextTaskId++,task:n,name:a,enqueuedAt:Date.now(),executedAt:void 0,completed:!1,resolve:u=>{if(d.completed)return;d.completed=!0,this.pendingTasks.delete(d.id),t.debug(`resolving task [name:${d.name}]`),c(u);const[f]=this.pendingTasks.values();f&&!f.executedAt&&this.execute(f)},reject:u=>{if(!d.completed&&(d.completed=!0,this.pendingTasks.delete(d.id),t.debug(`rejecting task [name:${d.name}]: %s`,String(u)),l(u),!this.stopping)){const[f]=this.pendingTasks.values();f&&!f.executedAt&&this.execute(f)}}};this.pendingTasks.set(d.id,d),this.pendingTasks.size===1&&this.execute(d)})}stop(){t.debug("stop()"),this.stopping=!0;for(const n of this.pendingTasks.values())t.debug(`stop() | stopping task [name:${n.name}]`),n.reject(new e.AwaitQueueStoppedError);this.stopping=!1}remove(n){t.debug(`remove() [taskIdx:${n}]`);const a=Array.from(this.pendingTasks.values())[n];if(!a){t.debug(`stop() | no task with given idx [taskIdx:${n}]`);return}a.reject(new e.AwaitQueueRemovedTaskError)}dump(){const n=Date.now();let a=0;return Array.from(this.pendingTasks.values()).map(c=>({idx:a++,task:c.task,name:c.name,enqueuedTime:c.executedAt?c.executedAt-c.enqueuedAt:n-c.enqueuedAt,executionTime:c.executedAt?n-c.executedAt:0}))}async execute(n){if(t.debug(`execute() [name:${n.name}]`),n.executedAt)throw new Error("task already being executed");n.executedAt=Date.now();try{const a=await n.task();n.resolve(a)}catch(a){n.reject(a)}}};return Pc.AwaitQueue=r,Pc}var YE;function EC(){return YE||(YE=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.AwaitQueueRemovedTaskError=i.AwaitQueueStoppedError=i.AwaitQueue=void 0;var e=qB();Object.defineProperty(i,"AwaitQueue",{enumerable:!0,get:function(){return e.AwaitQueue}});var t=SC();Object.defineProperty(i,"AwaitQueueStoppedError",{enumerable:!0,get:function(){return t.AwaitQueueStoppedError}}),Object.defineProperty(i,"AwaitQueueRemovedTaskError",{enumerable:!0,get:function(){return t.AwaitQueueRemovedTaskError}})}(jE)),jE}EC();var WE={},so={},ra={},jd={exports:{}},YB=jd.exports,XE;function WB(){return XE||(XE=1,function(i,e){(function(t,r){var n="2.0.3",a=500,c="user-agent",l="",d="?",u="function",f="undefined",p="object",v="string",E="browser",g="cpu",_="device",m="engine",y="os",b="result",R="name",T="type",w="vendor",C="version",A="architecture",L="major",D="model",P="console",k="mobile",M="tablet",I="smarttv",F="wearable",$="xr",N="embedded",U="inapp",V="brands",J="formFactors",j="fullVersionList",q="platform",Z="platformVersion",X="bitness",Y="sec-ch-ua",re=Y+"-full-version-list",oe=Y+"-arch",ve=Y+"-"+X,be=Y+"-form-factors",Oe=Y+"-"+k,Pe=Y+"-"+D,Se=Y+"-"+q,Te=Se+"-version",ge=[V,j,k,D,q,Z,A,J,X],Ue="Amazon",je="Apple",Ie="ASUS",De="BlackBerry",ze="Google",ut="Huawei",Ft="Lenovo",rt="Honor",et="LG",$e="Microsoft",Ge="Motorola",ft="Nvidia",Wt="OnePlus",_t="OPPO",Ze="Samsung",Et="Sharp",le="Sony",pe="Xiaomi",_e="Zebra",Ce="Chrome",Ee="Chromium",ke="Chromecast",Qe="Edge",Tt="Firefox",pr="Opera",Si="Facebook",Is="Sogou",Ei="Mobile ",ni=" Browser",Ps="Windows",zn=typeof t!==f,Zt=zn&&t.navigator?t.navigator:r,Lr=Zt&&Zt.userAgentData?Zt.userAgentData:r,Sn=function(ye,xe){var Ae={},mt=xe;if(!ar(xe)){mt={};for(var Me in xe)for(var Rt in xe[Me])mt[Rt]=xe[Me][Rt].concat(mt[Rt]?mt[Rt]:[])}for(var Fe in ye)Ae[Fe]=mt[Fe]&&mt[Fe].length%2===0?mt[Fe].concat(ye[Fe]):ye[Fe];return Ae},$i=function(ye){for(var xe={},Ae=0;Ae<ye.length;Ae++)xe[ye[Ae].toUpperCase()]=ye[Ae];return xe},Ri=function(ye,xe){if(typeof ye===p&&ye.length>0){for(var Ae in ye)if(yt(ye[Ae])==yt(xe))return!0;return!1}return Ut(ye)?yt(xe).indexOf(yt(ye))!==-1:!1},ar=function(ye,xe){for(var Ae in ye)return/^(browser|cpu|device|engine|os)$/.test(Ae)||(xe?ar(ye[Ae]):!1)},Ut=function(ye){return typeof ye===v},or=function(ye){if(!ye)return r;for(var xe=[],Ae=Ot(/\\?\"/g,ye).split(","),mt=0;mt<Ae.length;mt++)if(Ae[mt].indexOf(";")>-1){var Me=Jt(Ae[mt]).split(";v=");xe[mt]={brand:Me[0],version:Me[1]}}else xe[mt]=Jt(Ae[mt]);return xe},yt=function(ye){return Ut(ye)?ye.toLowerCase():ye},nn=function(ye){return Ut(ye)?Ot(/[^\d\.]/g,ye).split(".")[0]:r},si=function(ye){for(var xe in ye){var Ae=ye[xe];typeof Ae==p&&Ae.length==2?this[Ae[0]]=Ae[1]:this[Ae]=r}return this},Ot=function(ye,xe){return Ut(xe)?xe.replace(ye,l):xe},$t=function(ye){return Ot(/\\?\"/g,ye)},Jt=function(ye,xe){if(Ut(ye))return ye=Ot(/^\s\s*/,ye),typeof xe===f?ye:ye.substring(0,a)},_r=function(ye,xe){if(!(!ye||!xe))for(var Ae=0,mt,Me,Rt,Fe,gt,it;Ae<xe.length&&!gt;){var Ht=xe[Ae],Gi=xe[Ae+1];for(mt=Me=0;mt<Ht.length&&!gt&&Ht[mt];)if(gt=Ht[mt++].exec(ye),gt)for(Rt=0;Rt<Gi.length;Rt++)it=gt[++Me],Fe=Gi[Rt],typeof Fe===p&&Fe.length>0?Fe.length===2?typeof Fe[1]==u?this[Fe[0]]=Fe[1].call(this,it):this[Fe[0]]=Fe[1]:Fe.length===3?typeof Fe[1]===u&&!(Fe[1].exec&&Fe[1].test)?this[Fe[0]]=it?Fe[1].call(this,it,Fe[2]):r:this[Fe[0]]=it?it.replace(Fe[1],Fe[2]):r:Fe.length===4&&(this[Fe[0]]=it?Fe[3].call(this,it.replace(Fe[1],Fe[2])):r):this[Fe]=it||r;Ae+=2}},cr=function(ye,xe){for(var Ae in xe)if(typeof xe[Ae]===p&&xe[Ae].length>0){for(var mt=0;mt<xe[Ae].length;mt++)if(Ri(xe[Ae][mt],ye))return Ae===d?r:Ae}else if(Ri(xe[Ae],ye))return Ae===d?r:Ae;return xe.hasOwnProperty("*")?xe["*"]:ye},ji={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},zi={embedded:"Automotive",mobile:"Mobile",tablet:["Tablet","EInk"],smarttv:"TV",wearable:"Watch",xr:["VR","XR"],"?":["Desktop","Unknown"],"*":r},ai={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[C,[R,Ei+"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[C,[R,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[R,C],[/opios[\/ ]+([\w\.]+)/i],[C,[R,pr+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[C,[R,pr+" GX"]],[/\bopr\/([\w\.]+)/i],[C,[R,pr]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[C,[R,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[C,[R,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon|otter|dooble|(?:lg |qute)browser)\/([-\w\.]+)/i,/(heytap|ovi|115|surf)browser\/([\d\.]+)/i,/(ecosia|weibo)(?:__| \w+@)([\d\.]+)/i],[R,C],[/quark(?:pc)?\/([-\w\.]+)/i],[C,[R,"Quark"]],[/\bddg\/([\w\.]+)/i],[C,[R,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[C,[R,"UCBrowser"]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[C,[R,"WeChat"]],[/konqueror\/([\w\.]+)/i],[C,[R,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[C,[R,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[C,[R,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[C,[R,"Smart "+Ft+ni]],[/(avast|avg)\/([\w\.]+)/i],[[R,/(.+)/,"$1 Secure"+ni],C],[/\bfocus\/([\w\.]+)/i],[C,[R,Tt+" Focus"]],[/\bopt\/([\w\.]+)/i],[C,[R,pr+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[C,[R,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[C,[R,"Dolphin"]],[/coast\/([\w\.]+)/i],[C,[R,pr+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[C,[R,"MIUI"+ni]],[/fxios\/([\w\.-]+)/i],[C,[R,Ei+Tt]],[/\bqihoobrowser\/?([\w\.]*)/i],[C,[R,"360"]],[/\b(qq)\/([\w\.]+)/i],[[R,/(.+)/,"$1Browser"],C],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[R,/(.+)/,"$1"+ni],C],[/samsungbrowser\/([\w\.]+)/i],[C,[R,Ze+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[C,[R,Is+" Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[R,Is+" Mobile"],C],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[R,C],[/(lbbrowser|rekonq)/i],[R],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[C,R],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[R,Si],C,[T,U]],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/(daum)apps[\/ ]([\w\.]+)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(instagram|snapchat)[\/ ]([-\w\.]+)/i],[R,C,[T,U]],[/\bgsa\/([\w\.]+) .*safari\//i],[C,[R,"GSA"],[T,U]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[C,[R,"TikTok"],[T,U]],[/\[(linkedin)app\]/i],[R,[T,U]],[/(chromium)[\/ ]([-\w\.]+)/i],[R,C],[/headlesschrome(?:\/([\w\.]+)| )/i],[C,[R,Ce+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[R,Ce+" WebView"],C],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[C,[R,"Android"+ni]],[/chrome\/([\w\.]+) mobile/i],[C,[R,Ei+"Chrome"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[R,C],[/version\/([\w\.\,]+) .*mobile(?:\/\w+ | ?)safari/i],[C,[R,Ei+"Safari"]],[/iphone .*mobile(?:\/\w+ | ?)safari/i],[[R,Ei+"Safari"]],[/version\/([\w\.\,]+) .*(safari)/i],[C,R],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[R,[C,"1"]],[/(webkit|khtml)\/([\w\.]+)/i],[R,C],[/(?:mobile|tablet);.*(firefox)\/([\w\.-]+)/i],[[R,Ei+Tt],C],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[R,"Netscape"],C],[/(wolvic|librewolf)\/([\w\.]+)/i],[R,C],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[C,[R,Tt+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(amaya|dillo|doris|icab|ladybird|lynx|mosaic|netsurf|obigo|polaris|w3m|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/\b(links) \(([\w\.]+)/i],[R,[C,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[R,[C,/[^\d\.]+./,l]]],cpu:[[/\b((amd|x|x86[-_]?|wow|win)64)\b/i],[[A,"amd64"]],[/(ia32(?=;))/i,/\b((i[346]|x)86)(pc)?\b/i],[[A,"ia32"]],[/\b(aarch64|arm(v?[89]e?l?|_?64))\b/i],[[A,"arm64"]],[/\b(arm(v[67])?ht?n?[fl]p?)\b/i],[[A,"armhf"]],[/( (ce|mobile); ppc;|\/[\w\.]+arm\b)/i],[[A,"arm"]],[/((ppc|powerpc)(64)?)( mac|;|\))/i],[[A,/ower/,l,yt]],[/ sun4\w[;\)]/i],[[A,"sparc"]],[/\b(avr32|ia64(?=;)|68k(?=\))|\barm(?=v([1-7]|[5-7]1)l?|;|eabi)|(irix|mips|sparc)(64)?\b|pa-risc)/i],[[A,yt]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[D,[w,Ze],[T,M]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[D,[w,Ze],[T,k]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[D,[w,je],[T,k]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[D,[w,je],[T,M]],[/(macintosh);/i],[D,[w,je]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[D,[w,Et],[T,k]],[/\b((?:brt|eln|hey2?|gdi|jdn)-a?[lnw]09|(?:ag[rm]3?|jdn2|kob2)-a?[lw]0[09]hn)(?: bui|\)|;)/i],[D,[w,rt],[T,M]],[/honor([-\w ]+)[;\)]/i],[D,[w,rt],[T,k]],[/\b((?:ag[rs][2356]?k?|bah[234]?|bg[2o]|bt[kv]|cmr|cpn|db[ry]2?|jdn2|got|kob2?k?|mon|pce|scm|sht?|[tw]gr|vrd)-[ad]?[lw][0125][09]b?|605hw|bg2-u03|(?:gem|fdr|m2|ple|t1)-[7a]0[1-4][lu]|t1-a2[13][lw]|mediapad[\w\. ]*(?= bui|\)))\b(?!.+d\/s)/i],[D,[w,ut],[T,M]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[D,[w,ut],[T,k]],[/oid[^\)]+; (2[\dbc]{4}(182|283|rp\w{2})[cgl]|m2105k81a?c)(?: bui|\))/i,/\b((?:red)?mi[-_ ]?pad[\w- ]*)(?: bui|\))/i],[[D,/_/g," "],[w,pe],[T,M]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i,/ ([\w ]+) miui\/v?\d/i],[[D,/_/g," "],[w,pe],[T,k]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[D,[w,_t],[T,k]],[/\b(opd2(\d{3}a?))(?: bui|\))/i],[D,[w,cr,{OnePlus:["304","403","203"],"*":_t}],[T,M]],[/(vivo (5r?|6|8l?|go|one|s|x[il]?[2-4]?)[\w\+ ]*)(?: bui|\))/i],[D,[w,"BLU"],[T,k]],[/; vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[D,[w,"Vivo"],[T,k]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[D,[w,"Realme"],[T,k]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto(?! 360)[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[D,[w,Ge],[T,k]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[D,[w,Ge],[T,M]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[D,[w,et],[T,M]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+(?!.*(?:browser|netcast|android tv|watch))(\w+)/i,/\blg-?([\d\w]+) bui/i],[D,[w,et],[T,k]],[/(ideatab[-\w ]+|602lv|d-42a|a101lv|a2109a|a3500-hv|s[56]000|pb-6505[my]|tb-?x?\d{3,4}(?:f[cu]|xu|[av])|yt\d?-[jx]?\d+[lfmx])( bui|;|\)|\/)/i,/lenovo ?(b[68]0[08]0-?[hf]?|tab(?:[\w- ]+?)|tb[\w-]{6,7})( bui|;|\)|\/)/i],[D,[w,Ft],[T,M]],[/(nokia) (t[12][01])/i],[w,D,[T,M]],[/(?:maemo|nokia).*(n900|lumia \d+|rm-\d+)/i,/nokia[-_ ]?(([-\w\. ]*))/i],[[D,/_/g," "],[T,k],[w,"Nokia"]],[/(pixel (c|tablet))\b/i],[D,[w,ze],[T,M]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[D,[w,ze],[T,k]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[D,[w,le],[T,k]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[D,"Xperia Tablet"],[w,le],[T,M]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[D,[w,Wt],[T,k]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[D,[w,Ue],[T,M]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[D,/(.+)/g,"Fire Phone $1"],[w,Ue],[T,k]],[/(playbook);[-\w\),; ]+(rim)/i],[D,w,[T,M]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[D,[w,De],[T,k]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[D,[w,Ie],[T,M]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[D,[w,Ie],[T,k]],[/(nexus 9)/i],[D,[w,"HTC"],[T,M]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[w,[D,/_/g," "],[T,k]],[/tcl (xess p17aa)/i,/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])(_\w(\w|\w\w))?(\)| bui)/i],[D,[w,"TCL"],[T,M]],[/droid [\w\.]+; (418(?:7d|8v)|5087z|5102l|61(?:02[dh]|25[adfh]|27[ai]|56[dh]|59k|65[ah])|a509dl|t(?:43(?:0w|1[adepqu])|50(?:6d|7[adju])|6(?:09dl|10k|12b|71[efho]|76[hjk])|7(?:66[ahju]|67[hw]|7[045][bh]|71[hk]|73o|76[ho]|79w|81[hks]?|82h|90[bhsy]|99b)|810[hs]))(_\w(\w|\w\w))?(\)| bui)/i],[D,[w,"TCL"],[T,k]],[/(itel) ((\w+))/i],[[w,yt],D,[T,cr,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[D,[w,"Acer"],[T,M]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[D,[w,"Meizu"],[T,k]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[D,[w,"Ulefone"],[T,k]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[D,[w,"Energizer"],[T,k]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[D,[w,"Cat"],[T,k]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[D,[w,"Smartfren"],[T,k]],[/droid.+; (a(?:015|06[35]|142p?))/i],[D,[w,"Nothing"],[T,k]],[/; (x67 5g|tikeasy \w+|ac[1789]\d\w+)( b|\))/i,/archos ?(5|gamepad2?|([\w ]*[t1789]|hello) ?\d+[\w ]*)( b|\))/i],[D,[w,"Archos"],[T,M]],[/archos ([\w ]+)( b|\))/i,/; (ac[3-6]\d\w{2,8})( b|\))/i],[D,[w,"Archos"],[T,k]],[/(imo) (tab \w+)/i,/(infinix) (x1101b?)/i],[w,D,[T,M]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus(?! zenw)|dell|jolla|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (blu|hmd|imo|tcl)[_ ]([\w\+ ]+?)(?: bui|\)|; r)/i,/(hp) ([\w ]+\w)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w ]+?)(?: bui|\)|\/)/i,/(oppo) ?([\w ]+) bui/i],[w,D,[T,k]],[/(kobo)\s(ereader|touch)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i],[w,D,[T,M]],[/(surface duo)/i],[D,[w,$e],[T,M]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[D,[w,"Fairphone"],[T,k]],[/((?:tegranote|shield t(?!.+d tv))[\w- ]*?)(?: b|\))/i],[D,[w,ft],[T,M]],[/(sprint) (\w+)/i],[w,D,[T,k]],[/(kin\.[onetw]{3})/i],[[D,/\./g," "],[w,$e],[T,k]],[/droid.+; ([c6]+|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[D,[w,_e],[T,M]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[D,[w,_e],[T,k]],[/smart-tv.+(samsung)/i],[w,[T,I]],[/hbbtv.+maple;(\d+)/i],[[D,/^/,"SmartTV"],[w,Ze],[T,I]],[/tcast.+(lg)e?. ([-\w]+)/i],[w,D,[T,I]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[w,et],[T,I]],[/(apple) ?tv/i],[w,[D,je+" TV"],[T,I]],[/crkey.*devicetype\/chromecast/i],[[D,ke+" Third Generation"],[w,ze],[T,I]],[/crkey.*devicetype\/([^/]*)/i],[[D,/^/,"Chromecast "],[w,ze],[T,I]],[/fuchsia.*crkey/i],[[D,ke+" Nest Hub"],[w,ze],[T,I]],[/crkey/i],[[D,ke],[w,ze],[T,I]],[/(portaltv)/i],[D,[w,Si],[T,I]],[/droid.+aft(\w+)( bui|\))/i],[D,[w,Ue],[T,I]],[/(shield \w+ tv)/i],[D,[w,ft],[T,I]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[D,[w,Et],[T,I]],[/(bravia[\w ]+)( bui|\))/i],[D,[w,le],[T,I]],[/(mi(tv|box)-?\w+) bui/i],[D,[w,pe],[T,I]],[/Hbbtv.*(technisat) (.*);/i],[w,D,[T,I]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[w,Jt],[D,Jt],[T,I]],[/droid.+; ([\w- ]+) (?:android tv|smart[- ]?tv)/i],[D,[T,I]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[T,I]],[/(ouya)/i,/(nintendo) (\w+)/i],[w,D,[T,P]],[/droid.+; (shield)( bui|\))/i],[D,[w,ft],[T,P]],[/(playstation \w+)/i],[D,[w,le],[T,P]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[D,[w,$e],[T,P]],[/\b(sm-[lr]\d\d[0156][fnuw]?s?|gear live)\b/i],[D,[w,Ze],[T,F]],[/((pebble))app/i,/(asus|google|lg|oppo) ((pixel |zen)?watch[\w ]*)( bui|\))/i],[w,D,[T,F]],[/(ow(?:19|20)?we?[1-3]{1,3})/i],[D,[w,_t],[T,F]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[D,[w,je],[T,F]],[/(opwwe\d{3})/i],[D,[w,Wt],[T,F]],[/(moto 360)/i],[D,[w,Ge],[T,F]],[/(smartwatch 3)/i],[D,[w,le],[T,F]],[/(g watch r)/i],[D,[w,et],[T,F]],[/droid.+; (wt63?0{2,3})\)/i],[D,[w,_e],[T,F]],[/droid.+; (glass) \d/i],[D,[w,ze],[T,$]],[/(pico) (4|neo3(?: link|pro)?)/i],[w,D,[T,$]],[/(quest( \d| pro)?s?).+vr/i],[D,[w,Si],[T,$]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[w,[T,N]],[/(aeobc)\b/i],[D,[w,Ue],[T,N]],[/(homepod).+mac os/i],[D,[w,je],[T,N]],[/windows iot/i],[[T,N]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+?(mobile|vr|\d) safari/i],[D,[T,cr,{mobile:"Mobile",xr:"VR","*":M}]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[T,M]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[T,k]],[/droid .+?; ([\w\. -]+)( bui|\))/i],[D,[w,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[C,[R,Qe+"HTML"]],[/(arkweb)\/([\w\.]+)/i],[R,C],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[C,[R,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[R,C],[/ladybird\//i],[[R,"LibWeb"]],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[C,R]],os:[[/microsoft (windows) (vista|xp)/i],[R,C],[/(windows (?:phone(?: os)?|mobile|iot))[\/ ]?([\d\.\w ]*)/i],[R,[C,cr,ji]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[C,cr,ji],[R,Ps]],[/[adehimnop]{4,7}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[C,/_/g,"."],[R,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[R,"macOS"],[C,/_/g,"."]],[/android ([\d\.]+).*crkey/i],[C,[R,ke+" Android"]],[/fuchsia.*crkey\/([\d\.]+)/i],[C,[R,ke+" Fuchsia"]],[/crkey\/([\d\.]+).*devicetype\/smartspeaker/i],[C,[R,ke+" SmartSpeaker"]],[/linux.*crkey\/([\d\.]+)/i],[C,[R,ke+" Linux"]],[/crkey\/([\d\.]+)/i],[C,[R,ke]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[C,R],[/(ubuntu) ([\w\.]+) like android/i],[[R,/(.+)/,"$1 Touch"],C],[/(android|bada|blackberry|kaios|maemo|meego|openharmony|qnx|rim tablet os|sailfish|series40|symbian|tizen|webos)\w*[-\/\.; ]?([\d\.]*)/i],[R,C],[/\(bb(10);/i],[C,[R,De]],[/(?:symbian ?os|symbos|s60(?=;)|series ?60)[-\/ ]?([\w\.]*)/i],[C,[R,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[C,[R,Tt+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[C,[R,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[C,[R,"watchOS"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[R,"Chrome OS"],C],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) (\w+)/i,/(xbox); +xbox ([^\);]+)/i,/(pico) .+os([\w\.]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux)(?: arm\w*| x86\w*| ?)([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[R,C],[/(sunos) ?([\w\.\d]*)/i],[[R,"Solaris"],C],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[R,C]]},jt=function(){var ye={init:{},isIgnore:{},isIgnoreRgx:{},toString:{}};return si.call(ye.init,[[E,[R,C,L,T]],[g,[A]],[_,[T,D,w]],[m,[R,C]],[y,[R,C]]]),si.call(ye.isIgnore,[[E,[C,L]],[m,[C]],[y,[C]]]),si.call(ye.isIgnoreRgx,[[E,/ ?browser$/i],[y,/ ?os$/i]]),si.call(ye.toString,[[E,[R,C]],[g,[A]],[_,[w,D]],[m,[R,C]],[y,[R,C]]]),ye}(),va=function(ye,xe){var Ae=jt.init[xe],mt=jt.isIgnore[xe]||0,Me=jt.isIgnoreRgx[xe]||0,Rt=jt.toString[xe]||0;function Fe(){si.call(this,Ae)}return Fe.prototype.getItem=function(){return ye},Fe.prototype.withClientHints=function(){return Lr?Lr.getHighEntropyValues(ge).then(function(gt){return ye.setCH(new ks(gt,!1)).parseCH().get()}):ye.parseCH().get()},Fe.prototype.withFeatureCheck=function(){return ye.detectFeature().get()},xe!=b&&(Fe.prototype.is=function(gt){var it=!1;for(var Ht in this)if(this.hasOwnProperty(Ht)&&!Ri(mt,Ht)&&yt(Me?Ot(Me,this[Ht]):this[Ht])==yt(Me?Ot(Me,gt):gt)){if(it=!0,gt!=f)break}else if(gt==f&&it){it=!it;break}return it},Fe.prototype.toString=function(){var gt=l;for(var it in Rt)typeof this[Rt[it]]!==f&&(gt+=(gt?" ":l)+this[Rt[it]]);return gt||f}),Lr||(Fe.prototype.then=function(gt){var it=this,Ht=function(){for(var Hi in it)it.hasOwnProperty(Hi)&&(this[Hi]=it[Hi])};Ht.prototype={is:Fe.prototype.is,toString:Fe.prototype.toString};var Gi=new Ht;return gt(Gi),Gi}),new Fe};function ks(ye,xe){if(ye=ye||{},si.call(this,ge),xe)si.call(this,[[V,or(ye[Y])],[j,or(ye[re])],[k,/\?1/.test(ye[Oe])],[D,$t(ye[Pe])],[q,$t(ye[Se])],[Z,$t(ye[Te])],[A,$t(ye[oe])],[J,or(ye[be])],[X,$t(ye[ve])]]);else for(var Ae in ye)this.hasOwnProperty(Ae)&&typeof ye[Ae]!==f&&(this[Ae]=ye[Ae])}function lr(ye,xe,Ae,mt){return this.get=function(Me){return Me?this.data.hasOwnProperty(Me)?this.data[Me]:r:this.data},this.set=function(Me,Rt){return this.data[Me]=Rt,this},this.setCH=function(Me){return this.uaCH=Me,this},this.detectFeature=function(){if(Zt&&Zt.userAgent==this.ua)switch(this.itemType){case E:Zt.brave&&typeof Zt.brave.isBrave==u&&this.set(R,"Brave");break;case _:!this.get(T)&&Lr&&Lr[k]&&this.set(T,k),this.get(D)=="Macintosh"&&Zt&&typeof Zt.standalone!==f&&Zt.maxTouchPoints&&Zt.maxTouchPoints>2&&this.set(D,"iPad").set(T,M);break;case y:!this.get(R)&&Lr&&Lr[q]&&this.set(R,Lr[q]);break;case b:var Me=this.data,Rt=function(Fe){return Me[Fe].getItem().detectFeature().get()};this.set(E,Rt(E)).set(g,Rt(g)).set(_,Rt(_)).set(m,Rt(m)).set(y,Rt(y))}return this},this.parseUA=function(){return this.itemType!=b&&_r.call(this.data,this.ua,this.rgxMap),this.itemType==E&&this.set(L,nn(this.get(C))),this},this.parseCH=function(){var Me=this.uaCH,Rt=this.rgxMap;switch(this.itemType){case E:case m:var Fe=Me[j]||Me[V],gt;if(Fe)for(var it in Fe){var Ht=Fe[it].brand||Fe[it],Gi=Fe[it].version;this.itemType==E&&!/not.a.brand/i.test(Ht)&&(!gt||/chrom/i.test(gt)&&Ht!=Ee)&&(Ht=cr(Ht,{Chrome:"Google Chrome",Edge:"Microsoft Edge","Chrome WebView":"Android WebView","Chrome Headless":"HeadlessChrome","Huawei Browser":"HuaweiBrowser","MIUI Browser":"Miui Browser","Opera Mobi":"OperaMobile",Yandex:"YaBrowser"}),this.set(R,Ht).set(C,Gi).set(L,nn(Gi)),gt=Ht),this.itemType==m&&Ht==Ee&&this.set(C,Gi)}break;case g:var Hi=Me[A];Hi&&(Hi&&Me[X]=="64"&&(Hi+="64"),_r.call(this.data,Hi+";",Rt));break;case _:if(Me[k]&&this.set(T,k),Me[D]&&(this.set(D,Me[D]),!this.get(T)||!this.get(w))){var Er={};_r.call(Er,"droid 9; "+Me[D]+")",Rt),!this.get(T)&&Er.type&&this.set(T,Er.type),!this.get(w)&&Er.vendor&&this.set(w,Er.vendor)}if(Me[J]){var Ns;if(typeof Me[J]!="string")for(var Fl=0;!Ns&&Fl<Me[J].length;)Ns=cr(Me[J][Fl++],zi);else Ns=cr(Me[J],zi);this.set(T,Ns)}break;case y:var Hn=Me[q];if(Hn){var ya=Me[Z];Hn==Ps&&(ya=parseInt(nn(ya),10)>=13?"11":"10"),this.set(R,Hn).set(C,ya)}this.get(R)==Ps&&Me[D]=="Xbox"&&this.set(R,"Xbox").set(C,r);break;case b:var ba=this.data,Bs=function(qr){return ba[qr].getItem().setCH(Me).parseCH().get()};this.set(E,Bs(E)).set(g,Bs(g)).set(_,Bs(_)).set(m,Bs(m)).set(y,Bs(y))}return this},si.call(this,[["itemType",ye],["ua",xe],["uaCH",mt],["rgxMap",Ae],["data",va(this,ye)]]),this}function Sr(ye,xe,Ae){if(typeof ye===p?(ar(ye,!0)?(typeof xe===p&&(Ae=xe),xe=ye):(Ae=ye,xe=r),ye=r):typeof ye===v&&!ar(xe,!0)&&(Ae=xe,xe=r),Ae&&typeof Ae.append===u){var mt={};Ae.forEach(function(it,Ht){mt[Ht]=it}),Ae=mt}if(!(this instanceof Sr))return new Sr(ye,xe,Ae).getResult();var Me=typeof ye===v?ye:Ae&&Ae[c]?Ae[c]:Zt&&Zt.userAgent?Zt.userAgent:l,Rt=new ks(Ae,!0),Fe=xe?Sn(ai,xe):ai,gt=function(it){return it==b?function(){return new lr(it,Me,Fe,Rt).set("ua",Me).set(E,this.getBrowser()).set(g,this.getCPU()).set(_,this.getDevice()).set(m,this.getEngine()).set(y,this.getOS()).get()}:function(){return new lr(it,Me,Fe[it],Rt).parseUA().get()}};return si.call(this,[["getBrowser",gt(E)],["getCPU",gt(g)],["getDevice",gt(_)],["getEngine",gt(m)],["getOS",gt(y)],["getResult",gt(b)],["getUA",function(){return Me}],["setUA",function(it){return Ut(it)&&(Me=it.length>a?Jt(it,a):it),this}]]).setUA(Me),this}Sr.VERSION=n,Sr.BROWSER=$i([R,C,L,T]),Sr.CPU=$i([A]),Sr.DEVICE=$i([D,w,T,P,k,I,M,F,N]),Sr.ENGINE=Sr.OS=$i([R,C]),i.exports&&(e=i.exports=Sr),e.UAParser=Sr;var Gn=zn&&(t.jQuery||t.Zepto);if(Gn&&!Gn.ua){var Ms=new Sr;Gn.ua=Ms.getResult(),Gn.ua.get=function(){return Ms.getUA()},Gn.ua.set=function(ye){Ms.setUA(ye);var xe=Ms.getResult();for(var Ae in xe)Gn.ua[Ae]=xe[Ae]}}})(typeof window=="object"?window:YB)}(jd,jd.exports)),jd.exports}var Mc={},QE;function sr(){if(QE)return Mc;QE=1,Object.defineProperty(Mc,"__esModule",{value:!0}),Mc.Logger=void 0;const i=If(),e="mediasoup-client";class t{constructor(n){K(this,"_debug"),K(this,"_warn"),K(this,"_error"),n?(this._debug=(0,i.default)(`${e}:${n}`),this._warn=(0,i.default)(`${e}:WARN:${n}`),this._error=(0,i.default)(`${e}:ERROR:${n}`)):(this._debug=(0,i.default)(e),this._warn=(0,i.default)(`${e}:WARN`),this._error=(0,i.default)(`${e}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}}return Mc.Logger=t,Mc}var Nc={},hd={exports:{}},ZE;function XB(){if(ZE)return hd.exports;ZE=1;var i=typeof Reflect=="object"?Reflect:null,e=i&&typeof i.apply=="function"?i.apply:function(T,w,C){return Function.prototype.apply.call(T,w,C)},t;i&&typeof i.ownKeys=="function"?t=i.ownKeys:Object.getOwnPropertySymbols?t=function(T){return Object.getOwnPropertyNames(T).concat(Object.getOwnPropertySymbols(T))}:t=function(T){return Object.getOwnPropertyNames(T)};function r(T){console&&console.warn&&console.warn(T)}var n=Number.isNaN||function(T){return T!==T};function a(){a.init.call(this)}hd.exports=a,hd.exports.once=y,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var c=10;function l(T){if(typeof T!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof T)}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(T){if(typeof T!="number"||T<0||n(T))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+T+".");c=T}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(T){if(typeof T!="number"||T<0||n(T))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+T+".");return this._maxListeners=T,this};function d(T){return T._maxListeners===void 0?a.defaultMaxListeners:T._maxListeners}a.prototype.getMaxListeners=function(){return d(this)},a.prototype.emit=function(T){for(var w=[],C=1;C<arguments.length;C++)w.push(arguments[C]);var A=T==="error",L=this._events;if(L!==void 0)A=A&&L.error===void 0;else if(!A)return!1;if(A){var D;if(w.length>0&&(D=w[0]),D instanceof Error)throw D;var P=new Error("Unhandled error."+(D?" ("+D.message+")":""));throw P.context=D,P}var k=L[T];if(k===void 0)return!1;if(typeof k=="function")e(k,this,w);else for(var M=k.length,I=g(k,M),C=0;C<M;++C)e(I[C],this,w);return!0};function u(T,w,C,A){var L,D,P;if(l(C),D=T._events,D===void 0?(D=T._events=Object.create(null),T._eventsCount=0):(D.newListener!==void 0&&(T.emit("newListener",w,C.listener?C.listener:C),D=T._events),P=D[w]),P===void 0)P=D[w]=C,++T._eventsCount;else if(typeof P=="function"?P=D[w]=A?[C,P]:[P,C]:A?P.unshift(C):P.push(C),L=d(T),L>0&&P.length>L&&!P.warned){P.warned=!0;var k=new Error("Possible EventEmitter memory leak detected. "+P.length+" "+String(w)+" listeners added. Use emitter.setMaxListeners() to increase limit");k.name="MaxListenersExceededWarning",k.emitter=T,k.type=w,k.count=P.length,r(k)}return T}a.prototype.addListener=function(T,w){return u(this,T,w,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(T,w){return u(this,T,w,!0)};function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(T,w,C){var A={fired:!1,wrapFn:void 0,target:T,type:w,listener:C},L=f.bind(A);return L.listener=C,A.wrapFn=L,L}a.prototype.once=function(T,w){return l(w),this.on(T,p(this,T,w)),this},a.prototype.prependOnceListener=function(T,w){return l(w),this.prependListener(T,p(this,T,w)),this},a.prototype.removeListener=function(T,w){var C,A,L,D,P;if(l(w),A=this._events,A===void 0)return this;if(C=A[T],C===void 0)return this;if(C===w||C.listener===w)--this._eventsCount===0?this._events=Object.create(null):(delete A[T],A.removeListener&&this.emit("removeListener",T,C.listener||w));else if(typeof C!="function"){for(L=-1,D=C.length-1;D>=0;D--)if(C[D]===w||C[D].listener===w){P=C[D].listener,L=D;break}if(L<0)return this;L===0?C.shift():_(C,L),C.length===1&&(A[T]=C[0]),A.removeListener!==void 0&&this.emit("removeListener",T,P||w)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(T){var w,C,A;if(C=this._events,C===void 0)return this;if(C.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):C[T]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete C[T]),this;if(arguments.length===0){var L=Object.keys(C),D;for(A=0;A<L.length;++A)D=L[A],D!=="removeListener"&&this.removeAllListeners(D);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(w=C[T],typeof w=="function")this.removeListener(T,w);else if(w!==void 0)for(A=w.length-1;A>=0;A--)this.removeListener(T,w[A]);return this};function v(T,w,C){var A=T._events;if(A===void 0)return[];var L=A[w];return L===void 0?[]:typeof L=="function"?C?[L.listener||L]:[L]:C?m(L):g(L,L.length)}a.prototype.listeners=function(T){return v(this,T,!0)},a.prototype.rawListeners=function(T){return v(this,T,!1)},a.listenerCount=function(T,w){return typeof T.listenerCount=="function"?T.listenerCount(w):E.call(T,w)},a.prototype.listenerCount=E;function E(T){var w=this._events;if(w!==void 0){var C=w[T];if(typeof C=="function")return 1;if(C!==void 0)return C.length}return 0}a.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function g(T,w){for(var C=new Array(w),A=0;A<w;++A)C[A]=T[A];return C}function _(T,w){for(;w+1<T.length;w++)T[w]=T[w+1];T.pop()}function m(T){for(var w=new Array(T.length),C=0;C<w.length;++C)w[C]=T[C].listener||T[C];return w}function y(T,w){return new Promise(function(C,A){function L(P){T.removeListener(w,D),A(P)}function D(){typeof T.removeListener=="function"&&T.removeListener("error",L),C([].slice.call(arguments))}R(T,w,D,{once:!0}),w!=="error"&&b(T,L,{once:!0})})}function b(T,w,C){typeof T.on=="function"&&R(T,"error",w,C)}function R(T,w,C,A){if(typeof T.on=="function")A.once?T.once(w,C):T.on(w,C);else if(typeof T.addEventListener=="function")T.addEventListener(w,function L(D){A.once&&T.removeEventListener(w,L),C(D)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof T)}return hd.exports}var JE;function Ds(){if(JE)return Nc;JE=1,Object.defineProperty(Nc,"__esModule",{value:!0}),Nc.EnhancedEventEmitter=void 0;const i=XB(),e=sr(),t=new e.Logger("EnhancedEventEmitter");class r extends i.EventEmitter{constructor(){super(),this.setMaxListeners(1/0)}emit(a,...c){return super.emit(a,...c)}safeEmit(a,...c){try{return super.emit(a,...c)}catch(l){t.error("safeEmit() | event listener threw an error [eventName:%s]:%o",a,l);try{super.emit("listenererror",a,l)}catch{}return!!super.listenerCount(a)}}on(a,c){return super.on(a,c),this}off(a,c){return super.off(a,c),this}addListener(a,c){return super.on(a,c),this}prependListener(a,c){return super.prependListener(a,c),this}once(a,c){return super.once(a,c),this}prependOnceListener(a,c){return super.prependOnceListener(a,c),this}removeListener(a,c){return super.off(a,c),this}removeAllListeners(a){return super.removeAllListeners(a),this}listenerCount(a){return super.listenerCount(a)}listeners(a){return super.listeners(a)}rawListeners(a){return super.rawListeners(a)}}return Nc.EnhancedEventEmitter=r,Nc}var ia={},e1;function Gr(){if(e1)return ia;e1=1,Object.defineProperty(ia,"__esModule",{value:!0}),ia.InvalidStateError=ia.UnsupportedError=void 0;class i extends Error{constructor(r){super(r),this.name="UnsupportedError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,i):this.stack=new Error(r).stack}}ia.UnsupportedError=i;class e extends Error{constructor(r){super(r),this.name="InvalidStateError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,e):this.stack=new Error(r).stack}}return ia.InvalidStateError=e,ia}var ao={},t1;function br(){if(t1)return ao;t1=1,Object.defineProperty(ao,"__esModule",{value:!0}),ao.clone=i,ao.generateRandomNumber=e,ao.deepFreeze=t;function i(r){if(r!==void 0)return Number.isNaN(r)?NaN:typeof structuredClone=="function"?structuredClone(r):JSON.parse(JSON.stringify(r))}function e(){return Math.round(Math.random()*1e7)}function t(r){const n=Reflect.ownKeys(r);for(const a of n){const c=r[a];(c&&typeof c=="object"||typeof c=="function")&&t(c)}return Object.freeze(r)}return ao}var Kr={},xr={},na={},r1;function QB(){if(r1)return na;r1=1;var i=na&&na.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(na,"__esModule",{value:!0}),na.Logger=void 0;const e=i(If()),t="h264-profile-level-id";let r=class{constructor(n){n?(this._debug=(0,e.default)(`${t}:${n}`),this._warn=(0,e.default)(`${t}:WARN:${n}`),this._error=(0,e.default)(`${t}:ERROR:${n}`)):(this._debug=(0,e.default)(t),this._warn=(0,e.default)(`${t}:WARN`),this._error=(0,e.default)(`${t}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}};return na.Logger=r,na}var i1;function ZB(){if(i1)return xr;i1=1,Object.defineProperty(xr,"__esModule",{value:!0}),xr.ProfileLevelId=xr.Level=xr.Profile=void 0,xr.parseProfileLevelId=f,xr.profileLevelIdToString=p,xr.profileToString=v,xr.levelToString=E,xr.parseSdpProfileLevelId=g,xr.isSameProfile=_,xr.isSameProfileAndLevel=m,xr.generateProfileLevelIdStringForAnswer=y,xr.supportedLevel=b;const i=QB(),e=new i.Logger;var t;(function(A){A[A.ConstrainedBaseline=1]="ConstrainedBaseline",A[A.Baseline=2]="Baseline",A[A.Main=3]="Main",A[A.ConstrainedHigh=4]="ConstrainedHigh",A[A.High=5]="High",A[A.PredictiveHigh444=6]="PredictiveHigh444"})(t||(xr.Profile=t={}));var r;(function(A){A[A.L1_b=0]="L1_b",A[A.L1=10]="L1",A[A.L1_1=11]="L1_1",A[A.L1_2=12]="L1_2",A[A.L1_3=13]="L1_3",A[A.L2=20]="L2",A[A.L2_1=21]="L2_1",A[A.L2_2=22]="L2_2",A[A.L3=30]="L3",A[A.L3_1=31]="L3_1",A[A.L3_2=32]="L3_2",A[A.L4=40]="L4",A[A.L4_1=41]="L4_1",A[A.L4_2=42]="L4_2",A[A.L5=50]="L5",A[A.L5_1=51]="L5_1",A[A.L5_2=52]="L5_2"})(r||(xr.Level=r={}));class n{constructor(L,D){this.profile=L,this.level=D}}xr.ProfileLevelId=n;const a=new n(t.ConstrainedBaseline,r.L3_1);class c{constructor(L){this.mask=~R("x",L),this.masked_value=R("1",L)}isMatch(L){return this.masked_value===(L&this.mask)}}class l{constructor(L,D,P){this.profile_idc=L,this.profile_iop=D,this.profile=P}}const d=[new l(66,new c("x1xx0000"),t.ConstrainedBaseline),new l(77,new c("1xxx0000"),t.ConstrainedBaseline),new l(88,new c("11xx0000"),t.ConstrainedBaseline),new l(66,new c("x0xx0000"),t.Baseline),new l(88,new c("10xx0000"),t.Baseline),new l(77,new c("0x0x0000"),t.Main),new l(100,new c("00000000"),t.High),new l(100,new c("00001100"),t.ConstrainedHigh),new l(244,new c("00000000"),t.PredictiveHigh444)],u=[{max_macroblocks_per_second:1485,max_macroblock_frame_size:99,level:r.L1},{max_macroblocks_per_second:1485,max_macroblock_frame_size:99,level:r.L1_b},{max_macroblocks_per_second:3e3,max_macroblock_frame_size:396,level:r.L1_1},{max_macroblocks_per_second:6e3,max_macroblock_frame_size:396,level:r.L1_2},{max_macroblocks_per_second:11880,max_macroblock_frame_size:396,level:r.L1_3},{max_macroblocks_per_second:11880,max_macroblock_frame_size:396,level:r.L2},{max_macroblocks_per_second:19800,max_macroblock_frame_size:792,level:r.L2_1},{max_macroblocks_per_second:20250,max_macroblock_frame_size:1620,level:r.L2_2},{max_macroblocks_per_second:40500,max_macroblock_frame_size:1620,level:r.L3},{max_macroblocks_per_second:108e3,max_macroblock_frame_size:3600,level:r.L3_1},{max_macroblocks_per_second:216e3,max_macroblock_frame_size:5120,level:r.L3_2},{max_macroblocks_per_second:245760,max_macroblock_frame_size:8192,level:r.L4},{max_macroblocks_per_second:245760,max_macroblock_frame_size:8192,level:r.L4_1},{max_macroblocks_per_second:522240,max_macroblock_frame_size:8704,level:r.L4_2},{max_macroblocks_per_second:589824,max_macroblock_frame_size:22080,level:r.L5},{max_macroblocks_per_second:983040,max_macroblock_frame_size:36864,level:r.L5_1},{max_macroblocks_per_second:2073600,max_macroblock_frame_size:36864,level:r.L5_2}];function f(A){if(typeof A!="string"||A.length!==6)return;const L=parseInt(A,16);if(L===0)return;const D=L&255,P=L>>8&255,k=L>>16&255;let M;switch(D){case r.L1_1:{M=(P&16)!==0?r.L1_b:r.L1_1;break}case r.L1:case r.L1_2:case r.L1_3:case r.L2:case r.L2_1:case r.L2_2:case r.L3:case r.L3_1:case r.L3_2:case r.L4:case r.L4_1:case r.L4_2:case r.L5:case r.L5_1:case r.L5_2:{M=D;break}default:{e.warn(`parseProfileLevelId() | unrecognized level_idc [str:${A}, level_idc:${D}]`);return}}for(const I of d)if(k===I.profile_idc&&I.profile_iop.isMatch(P))return e.debug(`parseProfileLevelId() | result [str:${A}, profile:${I.profile}, level:${M}]`),new n(I.profile,M);e.warn(`parseProfileLevelId() | unrecognized profile_idc/profile_iop combination [str:${A}, profile_idc:${k}, profile_iop:${P}]`)}function p(A){if(A.level==r.L1_b)switch(A.profile){case t.ConstrainedBaseline:return"42f00b";case t.Baseline:return"42100b";case t.Main:return"4d100b";default:{e.warn(`profileLevelIdToString() | Level 1_b not is allowed for profile ${A.profile}`);return}}let L;switch(A.profile){case t.ConstrainedBaseline:{L="42e0";break}case t.Baseline:{L="4200";break}case t.Main:{L="4d00";break}case t.ConstrainedHigh:{L="640c";break}case t.High:{L="6400";break}case t.PredictiveHigh444:{L="f400";break}default:{e.warn(`profileLevelIdToString() | unrecognized profile ${A.profile}`);return}}let D=A.level.toString(16);return D.length===1&&(D=`0${D}`),`${L}${D}`}function v(A){switch(A){case t.ConstrainedBaseline:return"ConstrainedBaseline";case t.Baseline:return"Baseline";case t.Main:return"Main";case t.ConstrainedHigh:return"ConstrainedHigh";case t.High:return"High";case t.PredictiveHigh444:return"PredictiveHigh444";default:{e.warn(`profileToString() | unrecognized profile ${A}`);return}}}function E(A){switch(A){case r.L1_b:return"1b";case r.L1:return"1";case r.L1_1:return"1.1";case r.L1_2:return"1.2";case r.L1_3:return"1.3";case r.L2:return"2";case r.L2_1:return"2.1";case r.L2_2:return"2.2";case r.L3:return"3";case r.L3_1:return"3.1";case r.L3_2:return"3.2";case r.L4:return"4";case r.L4_1:return"4.1";case r.L4_2:return"4.2";case r.L5:return"5";case r.L5_1:return"5.1";case r.L5_2:return"5.2";default:{e.warn(`levelToString() | unrecognized level ${A}`);return}}}function g(A={}){const L=A["profile-level-id"];return L?f(L):a}function _(A={},L={}){const D=g(A),P=g(L);return!!(D&&P&&D.profile===P.profile)}function m(A={},L={}){const D=g(A),P=g(L);return!!(D&&P&&D.profile===P.profile&&D.level==P.level)}function y(A={},L={}){if(!A["profile-level-id"]&&!L["profile-level-id"]){e.warn("generateProfileLevelIdStringForAnswer() | profile-level-id missing in local and remote params");return}const D=g(A),P=g(L);if(!D)throw new TypeError("invalid local_profile_level_id");if(!P)throw new TypeError("invalid remote_profile_level_id");if(D.profile!==P.profile)throw new TypeError("H264 Profile mismatch");const k=C(A)&&C(L),M=D.level,I=P.level,F=w(M,I),$=k?M:F;return e.debug(`generateProfileLevelIdStringForAnswer() | result [profile:${D.profile}, level:${$}]`),p(new n(D.profile,$))}function b(A,L){for(let D=u.length-1;D>=0;--D){const P=u[D];if(P.max_macroblock_frame_size*256<=A&&P.max_macroblocks_per_second<=L*P.max_macroblock_frame_size)return e.debug(`supportedLevel() | result [max_frame_pixel_count:${A}, max_fps:${L}, level:${P.level}]`),P.level}e.warn(`supportedLevel() | no level supported [max_frame_pixel_count:${A}, max_fps:${L}]`)}function R(A,L){return+(L[0]===A)<<7|+(L[1]===A)<<6|+(L[2]===A)<<5|+(L[3]===A)<<4|+(L[4]===A)<<3|+(L[5]===A)<<2|+(L[6]===A)<<1|+(L[7]===A)<<0}function T(A,L){return A===r.L1_b?L!==r.L1&&L!==r.L1_b:L===r.L1_b?A!==r.L1:A<L}function w(A,L){return T(A,L)?A:L}function C(A={}){const L=A["level-asymmetry-allowed"];return L===!0||L===1||L==="1"}return xr}var n1;function Hr(){if(n1)return Kr;n1=1,Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.validateRtpCapabilities=a,Kr.validateRtpParameters=c,Kr.validateSctpStreamParameters=l,Kr.validateSctpCapabilities=d,Kr.getExtendedRtpCapabilities=u,Kr.getRecvRtpCapabilities=f,Kr.getSendingRtpParameters=p,Kr.getSendingRemoteRtpParameters=v,Kr.reduceCodecs=E,Kr.generateProbatorRtpParameters=g,Kr.canSend=_,Kr.canReceive=m;const i=ZB(),e=br(),t="probator",r=1234,n=127;function a(I){if(typeof I!="object")throw new TypeError("caps is not an object");if(I.codecs&&!Array.isArray(I.codecs))throw new TypeError("caps.codecs is not an array");I.codecs||(I.codecs=[]);for(const F of I.codecs)y(F);if(I.headerExtensions&&!Array.isArray(I.headerExtensions))throw new TypeError("caps.headerExtensions is not an array");I.headerExtensions||(I.headerExtensions=[]);for(const F of I.headerExtensions)R(F)}function c(I){if(typeof I!="object")throw new TypeError("params is not an object");if(I.mid&&typeof I.mid!="string")throw new TypeError("params.mid is not a string");if(!Array.isArray(I.codecs))throw new TypeError("missing params.codecs");for(const F of I.codecs)T(F);if(I.headerExtensions&&!Array.isArray(I.headerExtensions))throw new TypeError("params.headerExtensions is not an array");I.headerExtensions||(I.headerExtensions=[]);for(const F of I.headerExtensions)w(F);if(I.encodings&&!Array.isArray(I.encodings))throw new TypeError("params.encodings is not an array");I.encodings||(I.encodings=[]);for(const F of I.encodings)C(F);if(I.rtcp&&typeof I.rtcp!="object")throw new TypeError("params.rtcp is not an object");I.rtcp||(I.rtcp={}),A(I.rtcp)}function l(I){if(typeof I!="object")throw new TypeError("params is not an object");if(typeof I.streamId!="number")throw new TypeError("missing params.streamId");let F=!1;if(typeof I.ordered=="boolean"?F=!0:I.ordered=!0,I.maxPacketLifeTime&&typeof I.maxPacketLifeTime!="number")throw new TypeError("invalid params.maxPacketLifeTime");if(I.maxRetransmits&&typeof I.maxRetransmits!="number")throw new TypeError("invalid params.maxRetransmits");if(I.maxPacketLifeTime&&I.maxRetransmits)throw new TypeError("cannot provide both maxPacketLifeTime and maxRetransmits");if(F&&I.ordered&&(I.maxPacketLifeTime||I.maxRetransmits))throw new TypeError("cannot be ordered with maxPacketLifeTime or maxRetransmits");if(!F&&(I.maxPacketLifeTime||I.maxRetransmits)&&(I.ordered=!1),I.label&&typeof I.label!="string")throw new TypeError("invalid params.label");if(I.protocol&&typeof I.protocol!="string")throw new TypeError("invalid params.protocol")}function d(I){if(typeof I!="object")throw new TypeError("caps is not an object");if(!I.numStreams||typeof I.numStreams!="object")throw new TypeError("missing caps.numStreams");L(I.numStreams)}function u(I,F,$){const N={codecs:[],headerExtensions:[]};if($)for(const U of I.codecs??[]){if(D(U))continue;const V=(F.codecs??[]).find(j=>P(j,U,{strict:!0,modify:!0}));if(!V)continue;const J={mimeType:U.mimeType,kind:U.kind,clockRate:U.clockRate,channels:U.channels,localPayloadType:U.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:V.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:U.parameters,remoteParameters:V.parameters,rtcpFeedback:M(U,V)};N.codecs.push(J)}else for(const U of F.codecs??[]){if(D(U))continue;const V=(I.codecs??[]).find(j=>P(j,U,{strict:!0,modify:!0}));if(!V)continue;const J={mimeType:V.mimeType,kind:V.kind,clockRate:V.clockRate,channels:V.channels,localPayloadType:V.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:U.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:V.parameters,remoteParameters:U.parameters,rtcpFeedback:M(V,U)};N.codecs.push(J)}for(const U of N.codecs){const V=I.codecs.find(j=>D(j)&&j.parameters.apt===U.localPayloadType),J=F.codecs.find(j=>D(j)&&j.parameters.apt===U.remotePayloadType);V&&J&&(U.localRtxPayloadType=V.preferredPayloadType,U.remoteRtxPayloadType=J.preferredPayloadType)}for(const U of F.headerExtensions){const V=I.headerExtensions.find(j=>k(j,U));if(!V)continue;const J={kind:U.kind,uri:U.uri,sendId:V.preferredId,recvId:U.preferredId,encrypt:V.preferredEncrypt,direction:"sendrecv"};switch(U.direction){case"sendrecv":{J.direction="sendrecv";break}case"recvonly":{J.direction="sendonly";break}case"sendonly":{J.direction="recvonly";break}case"inactive":{J.direction="inactive";break}}N.headerExtensions.push(J)}return N}function f(I){const F={codecs:[],headerExtensions:[]};for(const $ of I.codecs){const N={mimeType:$.mimeType,kind:$.kind,preferredPayloadType:$.remotePayloadType,clockRate:$.clockRate,channels:$.channels,parameters:$.localParameters,rtcpFeedback:$.rtcpFeedback};if(F.codecs.push(N),!$.remoteRtxPayloadType)continue;const U={mimeType:`${$.kind}/rtx`,kind:$.kind,preferredPayloadType:$.remoteRtxPayloadType,clockRate:$.clockRate,parameters:{apt:$.remotePayloadType},rtcpFeedback:[]};F.codecs.push(U)}for(const $ of I.headerExtensions){if($.direction!=="sendrecv"&&$.direction!=="recvonly")continue;const N={kind:$.kind,uri:$.uri,preferredId:$.recvId,preferredEncrypt:$.encrypt,direction:$.direction};F.headerExtensions.push(N)}return F}function p(I,F){const $={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const N of F.codecs){if(N.kind!==I)continue;const U={mimeType:N.mimeType,payloadType:N.localPayloadType,clockRate:N.clockRate,channels:N.channels,parameters:N.localParameters,rtcpFeedback:N.rtcpFeedback};if($.codecs.push(U),N.localRtxPayloadType){const V={mimeType:`${N.kind}/rtx`,payloadType:N.localRtxPayloadType,clockRate:N.clockRate,parameters:{apt:N.localPayloadType},rtcpFeedback:[]};$.codecs.push(V)}}for(const N of F.headerExtensions){if(N.kind&&N.kind!==I||N.direction!=="sendrecv"&&N.direction!=="sendonly")continue;const U={uri:N.uri,id:N.sendId,encrypt:N.encrypt,parameters:{}};$.headerExtensions.push(U)}return $}function v(I,F){const $={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const N of F.codecs){if(N.kind!==I)continue;const U={mimeType:N.mimeType,payloadType:N.localPayloadType,clockRate:N.clockRate,channels:N.channels,parameters:N.remoteParameters,rtcpFeedback:N.rtcpFeedback};if($.codecs.push(U),N.localRtxPayloadType){const V={mimeType:`${N.kind}/rtx`,payloadType:N.localRtxPayloadType,clockRate:N.clockRate,parameters:{apt:N.localPayloadType},rtcpFeedback:[]};$.codecs.push(V)}}for(const N of F.headerExtensions){if(N.kind&&N.kind!==I||N.direction!=="sendrecv"&&N.direction!=="sendonly")continue;const U={uri:N.uri,id:N.sendId,encrypt:N.encrypt,parameters:{}};$.headerExtensions.push(U)}if($.headerExtensions.some(N=>N.uri==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"))for(const N of $.codecs)N.rtcpFeedback=(N.rtcpFeedback??[]).filter(U=>U.type!=="goog-remb");else if($.headerExtensions.some(N=>N.uri==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"))for(const N of $.codecs)N.rtcpFeedback=(N.rtcpFeedback??[]).filter(U=>U.type!=="transport-cc");else for(const N of $.codecs)N.rtcpFeedback=(N.rtcpFeedback??[]).filter(U=>U.type!=="transport-cc"&&U.type!=="goog-remb");return $}function E(I,F){const $=[];if(!F)$.push(I[0]),D(I[1])&&$.push(I[1]);else{for(let N=0;N<I.length;++N)if(P(I[N],F,{strict:!0})){$.push(I[N]),D(I[N+1])&&$.push(I[N+1]);break}if($.length===0)throw new TypeError("no matching codec found")}return $}function g(I){I=e.clone(I),c(I);const F={mid:t,codecs:[],headerExtensions:[],encodings:[{ssrc:r}],rtcp:{cname:"probator"}};return F.codecs.push(I.codecs[0]),F.codecs[0].payloadType=n,F.headerExtensions=I.headerExtensions,F}function _(I,F){return F.codecs.some($=>$.kind===I)}function m(I,F){if(c(I),I.codecs.length===0)return!1;const $=I.codecs[0];return F.codecs.some(N=>N.remotePayloadType===$.payloadType)}function y(I){const F=new RegExp("^(audio|video)/(.+)","i");if(typeof I!="object")throw new TypeError("codec is not an object");if(!I.mimeType||typeof I.mimeType!="string")throw new TypeError("missing codec.mimeType");const $=F.exec(I.mimeType);if(!$)throw new TypeError("invalid codec.mimeType");if(I.kind=$[1].toLowerCase(),I.preferredPayloadType&&typeof I.preferredPayloadType!="number")throw new TypeError("invalid codec.preferredPayloadType");if(typeof I.clockRate!="number")throw new TypeError("missing codec.clockRate");I.kind==="audio"?typeof I.channels!="number"&&(I.channels=1):delete I.channels,(!I.parameters||typeof I.parameters!="object")&&(I.parameters={});for(const N of Object.keys(I.parameters)){let U=I.parameters[N];if(U===void 0&&(I.parameters[N]="",U=""),typeof U!="string"&&typeof U!="number")throw new TypeError(`invalid codec parameter [key:${N}s, value:${U}]`);if(N==="apt"&&typeof U!="number")throw new TypeError("invalid codec apt parameter")}(!I.rtcpFeedback||!Array.isArray(I.rtcpFeedback))&&(I.rtcpFeedback=[]);for(const N of I.rtcpFeedback)b(N)}function b(I){if(typeof I!="object")throw new TypeError("fb is not an object");if(!I.type||typeof I.type!="string")throw new TypeError("missing fb.type");(!I.parameter||typeof I.parameter!="string")&&(I.parameter="")}function R(I){if(typeof I!="object")throw new TypeError("ext is not an object");if(I.kind!=="audio"&&I.kind!=="video")throw new TypeError("invalid ext.kind");if(!I.uri||typeof I.uri!="string")throw new TypeError("missing ext.uri");if(typeof I.preferredId!="number")throw new TypeError("missing ext.preferredId");if(I.preferredEncrypt&&typeof I.preferredEncrypt!="boolean")throw new TypeError("invalid ext.preferredEncrypt");if(I.preferredEncrypt||(I.preferredEncrypt=!1),I.direction&&typeof I.direction!="string")throw new TypeError("invalid ext.direction");I.direction||(I.direction="sendrecv")}function T(I){const F=new RegExp("^(audio|video)/(.+)","i");if(typeof I!="object")throw new TypeError("codec is not an object");if(!I.mimeType||typeof I.mimeType!="string")throw new TypeError("missing codec.mimeType");const $=F.exec(I.mimeType);if(!$)throw new TypeError("invalid codec.mimeType");if(typeof I.payloadType!="number")throw new TypeError("missing codec.payloadType");if(typeof I.clockRate!="number")throw new TypeError("missing codec.clockRate");$[1].toLowerCase()==="audio"?typeof I.channels!="number"&&(I.channels=1):delete I.channels,(!I.parameters||typeof I.parameters!="object")&&(I.parameters={});for(const N of Object.keys(I.parameters)){let U=I.parameters[N];if(U===void 0&&(I.parameters[N]="",U=""),typeof U!="string"&&typeof U!="number")throw new TypeError(`invalid codec parameter [key:${N}s, value:${U}]`);if(N==="apt"&&typeof U!="number")throw new TypeError("invalid codec apt parameter")}(!I.rtcpFeedback||!Array.isArray(I.rtcpFeedback))&&(I.rtcpFeedback=[]);for(const N of I.rtcpFeedback)b(N)}function w(I){if(typeof I!="object")throw new TypeError("ext is not an object");if(!I.uri||typeof I.uri!="string")throw new TypeError("missing ext.uri");if(typeof I.id!="number")throw new TypeError("missing ext.id");if(I.encrypt&&typeof I.encrypt!="boolean")throw new TypeError("invalid ext.encrypt");I.encrypt||(I.encrypt=!1),(!I.parameters||typeof I.parameters!="object")&&(I.parameters={});for(const F of Object.keys(I.parameters)){let $=I.parameters[F];if($===void 0&&(I.parameters[F]="",$=""),typeof $!="string"&&typeof $!="number")throw new TypeError("invalid header extension parameter")}}function C(I){if(typeof I!="object")throw new TypeError("encoding is not an object");if(I.ssrc&&typeof I.ssrc!="number")throw new TypeError("invalid encoding.ssrc");if(I.rid&&typeof I.rid!="string")throw new TypeError("invalid encoding.rid");if(I.rtx&&typeof I.rtx!="object")throw new TypeError("invalid encoding.rtx");if(I.rtx&&typeof I.rtx.ssrc!="number")throw new TypeError("missing encoding.rtx.ssrc");if((!I.dtx||typeof I.dtx!="boolean")&&(I.dtx=!1),I.scalabilityMode&&typeof I.scalabilityMode!="string")throw new TypeError("invalid encoding.scalabilityMode")}function A(I){if(typeof I!="object")throw new TypeError("rtcp is not an object");if(I.cname&&typeof I.cname!="string")throw new TypeError("invalid rtcp.cname");(!I.reducedSize||typeof I.reducedSize!="boolean")&&(I.reducedSize=!0)}function L(I){if(typeof I!="object")throw new TypeError("numStreams is not an object");if(typeof I.OS!="number")throw new TypeError("missing numStreams.OS");if(typeof I.MIS!="number")throw new TypeError("missing numStreams.MIS")}function D(I){return I?/.+\/rtx$/i.test(I.mimeType):!1}function P(I,F,{strict:$=!1,modify:N=!1}={}){const U=I.mimeType.toLowerCase(),V=F.mimeType.toLowerCase();if(U!==V||I.clockRate!==F.clockRate||I.channels!==F.channels)return!1;switch(U){case"video/h264":{if($){const J=I.parameters["packetization-mode"]??0,j=F.parameters["packetization-mode"]??0;if(J!==j||!i.isSameProfile(I.parameters,F.parameters))return!1;let q;try{q=i.generateProfileLevelIdStringForAnswer(I.parameters,F.parameters)}catch{return!1}N&&(q?(I.parameters["profile-level-id"]=q,F.parameters["profile-level-id"]=q):(delete I.parameters["profile-level-id"],delete F.parameters["profile-level-id"]))}break}case"video/vp9":{if($){const J=I.parameters["profile-id"]??0,j=F.parameters["profile-id"]??0;if(J!==j)return!1}break}}return!0}function k(I,F){return!(I.kind&&F.kind&&I.kind!==F.kind||I.uri!==F.uri)}function M(I,F){const $=[];for(const N of I.rtcpFeedback??[]){const U=(F.rtcpFeedback??[]).find(V=>V.type===N.type&&(V.parameter===N.parameter||!V.parameter&&!N.parameter));U&&$.push(U)}return $}return Kr}var Bc={},Fc={},s1;function RC(){if(s1)return Fc;s1=1,Object.defineProperty(Fc,"__esModule",{value:!0}),Fc.Producer=void 0;const i=sr(),e=Ds(),t=Gr(),r=new i.Logger("Producer");let n=class extends e.EnhancedEventEmitter{constructor({id:a,localId:c,rtpSender:l,track:d,rtpParameters:u,stopTracks:f,disableTrackOnPause:p,zeroRtpOnPause:v,appData:E}){super(),K(this,"_id"),K(this,"_localId"),K(this,"_closed",!1),K(this,"_rtpSender"),K(this,"_track"),K(this,"_kind"),K(this,"_rtpParameters"),K(this,"_paused"),K(this,"_maxSpatialLayer"),K(this,"_stopTracks"),K(this,"_disableTrackOnPause"),K(this,"_zeroRtpOnPause"),K(this,"_appData"),K(this,"_observer",new e.EnhancedEventEmitter),r.debug("constructor()"),this._id=a,this._localId=c,this._rtpSender=l,this._track=d,this._kind=d.kind,this._rtpParameters=u,this._paused=p?!d.enabled:!1,this._maxSpatialLayer=void 0,this._stopTracks=f,this._disableTrackOnPause=p,this._zeroRtpOnPause=v,this._appData=E??{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get closed(){return this._closed}get kind(){return this._kind}get rtpSender(){return this._rtpSender}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get maxSpatialLayer(){return this._maxSpatialLayer}get appData(){return this._appData}set appData(a){this._appData=a}get observer(){return this._observer}close(){this._closed||(r.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(r.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}async getStats(){if(this._closed)throw new t.InvalidStateError("closed");return new Promise((a,c)=>{this.safeEmit("@getstats",a,c)})}pause(){if(r.debug("pause()"),this._closed){r.error("pause() | Producer closed");return}this._paused=!0,this._track&&this._disableTrackOnPause&&(this._track.enabled=!1),this._zeroRtpOnPause&&new Promise((a,c)=>{this.safeEmit("@pause",a,c)}).catch(()=>{}),this._observer.safeEmit("pause")}resume(){if(r.debug("resume()"),this._closed){r.error("resume() | Producer closed");return}this._paused=!1,this._track&&this._disableTrackOnPause&&(this._track.enabled=!0),this._zeroRtpOnPause&&new Promise((a,c)=>{this.safeEmit("@resume",a,c)}).catch(()=>{}),this._observer.safeEmit("resume")}async replaceTrack({track:a}){if(r.debug("replaceTrack() [track:%o]",a),this._closed){if(a&&this._stopTracks)try{a.stop()}catch{}throw new t.InvalidStateError("closed")}else if(a&&a.readyState==="ended")throw new t.InvalidStateError("track ended");if(a===this._track){r.debug("replaceTrack() | same track, ignored");return}await new Promise((c,l)=>{this.safeEmit("@replacetrack",a,c,l)}),this.destroyTrack(),this._track=a,this._track&&this._disableTrackOnPause&&(this._paused?this._paused&&(this._track.enabled=!1):this._track.enabled=!0),this.handleTrack()}async setMaxSpatialLayer(a){if(this._closed)throw new t.InvalidStateError("closed");if(this._kind!=="video")throw new t.UnsupportedError("not a video Producer");if(typeof a!="number")throw new TypeError("invalid spatialLayer");a!==this._maxSpatialLayer&&(await new Promise((c,l)=>{this.safeEmit("@setmaxspatiallayer",a,c,l)}).catch(()=>{}),this._maxSpatialLayer=a)}async setRtpEncodingParameters(a){if(this._closed)throw new t.InvalidStateError("closed");if(typeof a!="object")throw new TypeError("invalid params");await new Promise((c,l)=>{this.safeEmit("@setrtpencodingparameters",a,c,l)})}onTrackEnded(){r.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track&&this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){if(this._track)try{this._track.removeEventListener("ended",this.onTrackEnded),this._stopTracks&&this._track.stop()}catch{}}};return Fc.Producer=n,Fc}var Uc={},a1;function wC(){if(a1)return Uc;a1=1,Object.defineProperty(Uc,"__esModule",{value:!0}),Uc.Consumer=void 0;const i=sr(),e=Ds(),t=Gr(),r=new i.Logger("Consumer");let n=class extends e.EnhancedEventEmitter{constructor({id:a,localId:c,producerId:l,rtpReceiver:d,track:u,rtpParameters:f,appData:p}){super(),K(this,"_id"),K(this,"_localId"),K(this,"_producerId"),K(this,"_closed",!1),K(this,"_rtpReceiver"),K(this,"_track"),K(this,"_rtpParameters"),K(this,"_paused"),K(this,"_appData"),K(this,"_observer",new e.EnhancedEventEmitter),r.debug("constructor()"),this._id=a,this._localId=c,this._producerId=l,this._rtpReceiver=d,this._track=u,this._rtpParameters=f,this._paused=!u.enabled,this._appData=p??{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get producerId(){return this._producerId}get closed(){return this._closed}get kind(){return this._track.kind}get rtpReceiver(){return this._rtpReceiver}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get appData(){return this._appData}set appData(a){this._appData=a}get observer(){return this._observer}close(){this._closed||(r.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(r.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}async getStats(){if(this._closed)throw new t.InvalidStateError("closed");return new Promise((a,c)=>{this.safeEmit("@getstats",a,c)})}pause(){if(r.debug("pause()"),this._closed){r.error("pause() | Consumer closed");return}if(this._paused){r.debug("pause() | Consumer is already paused");return}this._paused=!0,this._track.enabled=!1,this.emit("@pause"),this._observer.safeEmit("pause")}resume(){if(r.debug("resume()"),this._closed){r.error("resume() | Consumer closed");return}if(!this._paused){r.debug("resume() | Consumer is already resumed");return}this._paused=!1,this._track.enabled=!0,this.emit("@resume"),this._observer.safeEmit("resume")}onTrackEnded(){r.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){try{this._track.removeEventListener("ended",this.onTrackEnded),this._track.stop()}catch{}}};return Uc.Consumer=n,Uc}var $c={},o1;function TC(){if(o1)return $c;o1=1,Object.defineProperty($c,"__esModule",{value:!0}),$c.DataProducer=void 0;const i=sr(),e=Ds(),t=Gr(),r=new i.Logger("DataProducer");let n=class extends e.EnhancedEventEmitter{constructor({id:a,dataChannel:c,sctpStreamParameters:l,appData:d}){super(),K(this,"_id"),K(this,"_dataChannel"),K(this,"_closed",!1),K(this,"_sctpStreamParameters"),K(this,"_appData"),K(this,"_observer",new e.EnhancedEventEmitter),r.debug("constructor()"),this._id=a,this._dataChannel=c,this._sctpStreamParameters=l,this._appData=d??{},this.handleDataChannel()}get id(){return this._id}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get bufferedAmount(){return this._dataChannel.bufferedAmount}get bufferedAmountLowThreshold(){return this._dataChannel.bufferedAmountLowThreshold}set bufferedAmountLowThreshold(a){this._dataChannel.bufferedAmountLowThreshold=a}get appData(){return this._appData}set appData(a){this._appData=a}get observer(){return this._observer}close(){this._closed||(r.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(r.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}send(a){if(r.debug("send()"),this._closed)throw new t.InvalidStateError("closed");this._dataChannel.send(a)}handleDataChannel(){this._dataChannel.addEventListener("open",()=>{this._closed||(r.debug('DataChannel "open" event'),this.safeEmit("open"))}),this._dataChannel.addEventListener("error",a=>{if(this._closed)return;let{error:c}=a;c||(c=new Error("unknown DataChannel error")),c.errorDetail==="sctp-failure"?r.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",c.sctpCauseCode,c.message):r.error('DataChannel "error" event: %o',c),this.safeEmit("error",c)}),this._dataChannel.addEventListener("close",()=>{this._closed||(r.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",()=>{this._closed||r.warn('DataChannel "message" event in a DataProducer, message discarded')}),this._dataChannel.addEventListener("bufferedamountlow",()=>{this._closed||this.safeEmit("bufferedamountlow")})}};return $c.DataProducer=n,$c}var jc={},c1;function CC(){if(c1)return jc;c1=1,Object.defineProperty(jc,"__esModule",{value:!0}),jc.DataConsumer=void 0;const i=sr(),e=Ds(),t=new i.Logger("DataConsumer");let r=class extends e.EnhancedEventEmitter{constructor({id:n,dataProducerId:a,dataChannel:c,sctpStreamParameters:l,appData:d}){super(),K(this,"_id"),K(this,"_dataProducerId"),K(this,"_dataChannel"),K(this,"_closed",!1),K(this,"_sctpStreamParameters"),K(this,"_appData"),K(this,"_observer",new e.EnhancedEventEmitter),t.debug("constructor()"),this._id=n,this._dataProducerId=a,this._dataChannel=c,this._sctpStreamParameters=l,this._appData=d??{},this.handleDataChannel()}get id(){return this._id}get dataProducerId(){return this._dataProducerId}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get binaryType(){return this._dataChannel.binaryType}set binaryType(n){this._dataChannel.binaryType=n}get appData(){return this._appData}set appData(n){this._appData=n}get observer(){return this._observer}close(){this._closed||(t.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(t.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}handleDataChannel(){this._dataChannel.addEventListener("open",()=>{this._closed||(t.debug('DataChannel "open" event'),this.safeEmit("open"))}),this._dataChannel.addEventListener("error",n=>{if(this._closed)return;let{error:a}=n;a||(a=new Error("unknown DataChannel error")),a.errorDetail==="sctp-failure"?t.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",a.sctpCauseCode,a.message):t.error('DataChannel "error" event: %o',a),this.safeEmit("error",a)}),this._dataChannel.addEventListener("close",()=>{this._closed||(t.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",n=>{this._closed||this.safeEmit("message",n.data)})}};return jc.DataConsumer=r,jc}var l1;function AC(){if(l1)return Bc;l1=1,Object.defineProperty(Bc,"__esModule",{value:!0}),Bc.Transport=void 0;const i=EC(),e=sr(),t=Ds(),r=Gr(),n=br(),a=Hr(),c=RC(),l=wC(),d=TC(),u=CC(),f=new e.Logger("Transport");class p{constructor(g){K(this,"consumerOptions"),K(this,"promise"),K(this,"resolve"),K(this,"reject"),this.consumerOptions=g,this.promise=new Promise((_,m)=>{this.resolve=_,this.reject=m})}}let v=class extends t.EnhancedEventEmitter{constructor({direction:E,id:g,iceParameters:_,iceCandidates:m,dtlsParameters:y,sctpParameters:b,iceServers:R,iceTransportPolicy:T,additionalSettings:w,proprietaryConstraints:C,appData:A,handlerFactory:L,extendedRtpCapabilities:D,canProduceByKind:P}){super(),K(this,"_id"),K(this,"_closed",!1),K(this,"_direction"),K(this,"_extendedRtpCapabilities"),K(this,"_canProduceByKind"),K(this,"_maxSctpMessageSize"),K(this,"_handler"),K(this,"_iceGatheringState","new"),K(this,"_connectionState","new"),K(this,"_appData"),K(this,"_producers",new Map),K(this,"_consumers",new Map),K(this,"_dataProducers",new Map),K(this,"_dataConsumers",new Map),K(this,"_probatorConsumerCreated",!1),K(this,"_awaitQueue",new i.AwaitQueue),K(this,"_pendingConsumerTasks",[]),K(this,"_consumerCreationInProgress",!1),K(this,"_pendingPauseConsumers",new Map),K(this,"_consumerPauseInProgress",!1),K(this,"_pendingResumeConsumers",new Map),K(this,"_consumerResumeInProgress",!1),K(this,"_pendingCloseConsumers",new Map),K(this,"_consumerCloseInProgress",!1),K(this,"_observer",new t.EnhancedEventEmitter),f.debug("constructor() [id:%s, direction:%s]",g,E),this._id=g,this._direction=E,this._extendedRtpCapabilities=D,this._canProduceByKind=P,this._maxSctpMessageSize=b?b.maxMessageSize:null;const k=n.clone(w)??{};delete k.iceServers,delete k.iceTransportPolicy,delete k.bundlePolicy,delete k.rtcpMuxPolicy,delete k.sdpSemantics,this._handler=L(),this._handler.run({direction:E,iceParameters:_,iceCandidates:m,dtlsParameters:y,sctpParameters:b,iceServers:R,iceTransportPolicy:T,additionalSettings:k,proprietaryConstraints:C,extendedRtpCapabilities:D}),this._appData=A??{},this.handleHandler()}get id(){return this._id}get closed(){return this._closed}get direction(){return this._direction}get handler(){return this._handler}get iceGatheringState(){return this._iceGatheringState}get connectionState(){return this._connectionState}get appData(){return this._appData}set appData(E){this._appData=E}get observer(){return this._observer}close(){if(!this._closed){f.debug("close()"),this._closed=!0,this._awaitQueue.stop(),this._handler.close(),this._connectionState="closed";for(const E of this._producers.values())E.transportClosed();this._producers.clear();for(const E of this._consumers.values())E.transportClosed();this._consumers.clear();for(const E of this._dataProducers.values())E.transportClosed();this._dataProducers.clear();for(const E of this._dataConsumers.values())E.transportClosed();this._dataConsumers.clear(),this._observer.safeEmit("close")}}async getStats(){if(this._closed)throw new r.InvalidStateError("closed");return this._handler.getTransportStats()}async restartIce({iceParameters:E}){if(f.debug("restartIce()"),this._closed)throw new r.InvalidStateError("closed");if(!E)throw new TypeError("missing iceParameters");return this._awaitQueue.push(async()=>await this._handler.restartIce(E),"transport.restartIce()")}async updateIceServers({iceServers:E}={}){if(f.debug("updateIceServers()"),this._closed)throw new r.InvalidStateError("closed");if(!Array.isArray(E))throw new TypeError("missing iceServers");return this._awaitQueue.push(async()=>this._handler.updateIceServers(E),"transport.updateIceServers()")}async produce({track:E,encodings:g,codecOptions:_,codec:m,stopTracks:y=!0,disableTrackOnPause:b=!0,zeroRtpOnPause:R=!1,onRtpSender:T,appData:w={}}={}){if(f.debug("produce() [track:%o]",E),this._closed)throw new r.InvalidStateError("closed");if(E){if(this._direction!=="send")throw new r.UnsupportedError("not a sending Transport");if(this._canProduceByKind[E.kind]){if(E.readyState==="ended")throw new r.InvalidStateError("track ended");if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(this.listenerCount("produce")===0)throw new TypeError('no "produce" listener set into this transport');if(w&&typeof w!="object")throw new TypeError("if given, appData must be an object")}else throw new r.UnsupportedError(`cannot produce ${E.kind}`)}else throw new TypeError("missing track");return this._awaitQueue.push(async()=>{let C;if(g&&!Array.isArray(g))throw TypeError("encodings must be an array");g&&g.length===0?C=void 0:g&&(C=g.map(P=>{const k={active:!0};return P.active===!1&&(k.active=!1),typeof P.dtx=="boolean"&&(k.dtx=P.dtx),typeof P.scalabilityMode=="string"&&(k.scalabilityMode=P.scalabilityMode),typeof P.scaleResolutionDownBy=="number"&&(k.scaleResolutionDownBy=P.scaleResolutionDownBy),typeof P.maxBitrate=="number"&&(k.maxBitrate=P.maxBitrate),typeof P.maxFramerate=="number"&&(k.maxFramerate=P.maxFramerate),typeof P.adaptivePtime=="boolean"&&(k.adaptivePtime=P.adaptivePtime),typeof P.priority=="string"&&(k.priority=P.priority),typeof P.networkPriority=="string"&&(k.networkPriority=P.networkPriority),k}));const{localId:A,rtpParameters:L,rtpSender:D}=await this._handler.send({track:E,encodings:C,codecOptions:_,codec:m,onRtpSender:T});try{a.validateRtpParameters(L);const{id:P}=await new Promise((M,I)=>{this.safeEmit("produce",{kind:E.kind,rtpParameters:L,appData:w},M,I)}),k=new c.Producer({id:P,localId:A,rtpSender:D,track:E,rtpParameters:L,stopTracks:y,disableTrackOnPause:b,zeroRtpOnPause:R,appData:w});return this._producers.set(k.id,k),this.handleProducer(k),this._observer.safeEmit("newproducer",k),k}catch(P){throw this._handler.stopSending(A).catch(()=>{}),P}},"transport.produce()").catch(C=>{if(y)try{E.stop()}catch{}throw C})}async consume({id:E,producerId:g,kind:_,rtpParameters:m,streamId:y,onRtpReceiver:b,appData:R={}}){if(f.debug("consume()"),this._closed)throw new r.InvalidStateError("closed");if(this._direction!=="recv")throw new r.UnsupportedError("not a receiving Transport");if(typeof E!="string")throw new TypeError("missing id");if(typeof g!="string")throw new TypeError("missing producerId");if(_!=="audio"&&_!=="video")throw new TypeError(`invalid kind '${_}'`);if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(R&&typeof R!="object")throw new TypeError("if given, appData must be an object");const T=n.clone(m);if(!a.canReceive(T,this._extendedRtpCapabilities))throw new r.UnsupportedError("cannot consume this Producer");const w=new p({id:E,producerId:g,kind:_,rtpParameters:T,streamId:y,onRtpReceiver:b,appData:R});return this._pendingConsumerTasks.push(w),queueMicrotask(()=>{this._closed||this._consumerCreationInProgress===!1&&this.createPendingConsumers()}),w.promise}async produceData({ordered:E=!0,maxPacketLifeTime:g,maxRetransmits:_,label:m="",protocol:y="",appData:b={}}={}){if(f.debug("produceData()"),this._closed)throw new r.InvalidStateError("closed");if(this._direction!=="send")throw new r.UnsupportedError("not a sending Transport");if(this._maxSctpMessageSize){if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(this.listenerCount("producedata")===0)throw new TypeError('no "producedata" listener set into this transport');if(b&&typeof b!="object")throw new TypeError("if given, appData must be an object")}else throw new r.UnsupportedError("SCTP not enabled by remote Transport");return(g||_)&&(E=!1),this._awaitQueue.push(async()=>{const{dataChannel:R,sctpStreamParameters:T}=await this._handler.sendDataChannel({ordered:E,maxPacketLifeTime:g,maxRetransmits:_,label:m,protocol:y});a.validateSctpStreamParameters(T);const{id:w}=await new Promise((A,L)=>{this.safeEmit("producedata",{sctpStreamParameters:T,label:m,protocol:y,appData:b},A,L)}),C=new d.DataProducer({id:w,dataChannel:R,sctpStreamParameters:T,appData:b});return this._dataProducers.set(C.id,C),this.handleDataProducer(C),this._observer.safeEmit("newdataproducer",C),C},"transport.produceData()")}async consumeData({id:E,dataProducerId:g,sctpStreamParameters:_,label:m="",protocol:y="",appData:b={}}){if(f.debug("consumeData()"),this._closed)throw new r.InvalidStateError("closed");if(this._direction!=="recv")throw new r.UnsupportedError("not a receiving Transport");if(this._maxSctpMessageSize){if(typeof E!="string")throw new TypeError("missing id");if(typeof g!="string")throw new TypeError("missing dataProducerId");if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(b&&typeof b!="object")throw new TypeError("if given, appData must be an object")}else throw new r.UnsupportedError("SCTP not enabled by remote Transport");const R=n.clone(_);return a.validateSctpStreamParameters(R),this._awaitQueue.push(async()=>{const{dataChannel:T}=await this._handler.receiveDataChannel({sctpStreamParameters:R,label:m,protocol:y}),w=new u.DataConsumer({id:E,dataProducerId:g,dataChannel:T,sctpStreamParameters:R,appData:b});return this._dataConsumers.set(w.id,w),this.handleDataConsumer(w),this._observer.safeEmit("newdataconsumer",w),w},"transport.consumeData()")}createPendingConsumers(){this._consumerCreationInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingConsumerTasks.length===0){f.debug("createPendingConsumers() | there is no Consumer to be created");return}const E=[...this._pendingConsumerTasks];this._pendingConsumerTasks=[];let g;const _=[];for(const m of E){const{id:y,kind:b,rtpParameters:R,streamId:T,onRtpReceiver:w}=m.consumerOptions;_.push({trackId:y,kind:b,rtpParameters:R,streamId:T,onRtpReceiver:w})}try{const m=await this._handler.receive(_);for(let y=0;y<m.length;++y){const b=E[y],R=m[y],{id:T,producerId:w,kind:C,rtpParameters:A,appData:L}=b.consumerOptions,{localId:D,rtpReceiver:P,track:k}=R,M=new l.Consumer({id:T,localId:D,producerId:w,rtpReceiver:P,track:k,rtpParameters:A,appData:L});this._consumers.set(M.id,M),this.handleConsumer(M),!this._probatorConsumerCreated&&!g&&C==="video"&&(g=M),this._observer.safeEmit("newconsumer",M),b.resolve(M)}}catch(m){for(const y of E)y.reject(m)}if(g)try{const m=a.generateProbatorRtpParameters(g.rtpParameters);await this._handler.receive([{trackId:"probator",kind:"video",rtpParameters:m}]),f.debug("createPendingConsumers() | Consumer for RTP probation created"),this._probatorConsumerCreated=!0}catch(m){f.error("createPendingConsumers() | failed to create Consumer for RTP probation:%o",m)}},"transport.createPendingConsumers()").then(()=>{this._consumerCreationInProgress=!1,this._pendingConsumerTasks.length>0&&this.createPendingConsumers()}).catch(()=>{})}pausePendingConsumers(){this._consumerPauseInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingPauseConsumers.size===0){f.debug("pausePendingConsumers() | there is no Consumer to be paused");return}const E=Array.from(this._pendingPauseConsumers.values());this._pendingPauseConsumers.clear();try{const g=E.map(_=>_.localId);await this._handler.pauseReceiving(g)}catch(g){f.error("pausePendingConsumers() | failed to pause Consumers:",g)}},"transport.pausePendingConsumers").then(()=>{this._consumerPauseInProgress=!1,this._pendingPauseConsumers.size>0&&this.pausePendingConsumers()}).catch(()=>{})}resumePendingConsumers(){this._consumerResumeInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingResumeConsumers.size===0){f.debug("resumePendingConsumers() | there is no Consumer to be resumed");return}const E=Array.from(this._pendingResumeConsumers.values());this._pendingResumeConsumers.clear();try{const g=E.map(_=>_.localId);await this._handler.resumeReceiving(g)}catch(g){f.error("resumePendingConsumers() | failed to resume Consumers:",g)}},"transport.resumePendingConsumers").then(()=>{this._consumerResumeInProgress=!1,this._pendingResumeConsumers.size>0&&this.resumePendingConsumers()}).catch(()=>{})}closePendingConsumers(){this._consumerCloseInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingCloseConsumers.size===0){f.debug("closePendingConsumers() | there is no Consumer to be closed");return}const E=Array.from(this._pendingCloseConsumers.values());this._pendingCloseConsumers.clear();try{await this._handler.stopReceiving(E.map(g=>g.localId))}catch(g){f.error("closePendingConsumers() | failed to close Consumers:",g)}},"transport.closePendingConsumers").then(()=>{this._consumerCloseInProgress=!1,this._pendingCloseConsumers.size>0&&this.closePendingConsumers()}).catch(()=>{})}handleHandler(){const E=this._handler;E.on("@connect",({dtlsParameters:g},_,m)=>{if(this._closed){m(new r.InvalidStateError("closed"));return}this.safeEmit("connect",{dtlsParameters:g},_,m)}),E.on("@icegatheringstatechange",g=>{g!==this._iceGatheringState&&(f.debug("ICE gathering state changed to %s",g),this._iceGatheringState=g,this._closed||this.safeEmit("icegatheringstatechange",g))}),E.on("@icecandidateerror",g=>{f.warn(`ICE candidate error [url:${g.url}, localAddress:${g.address}, localPort:${g.port}]: ${g.errorCode} "${g.errorText}"`),this.safeEmit("icecandidateerror",g)}),E.on("@connectionstatechange",g=>{g!==this._connectionState&&(f.debug("connection state changed to %s",g),this._connectionState=g,this._closed||this.safeEmit("connectionstatechange",g))})}handleProducer(E){E.on("@close",()=>{this._producers.delete(E.id),!this._closed&&this._awaitQueue.push(async()=>await this._handler.stopSending(E.localId),"producer @close event").catch(g=>f.warn("producer.close() failed:%o",g))}),E.on("@pause",(g,_)=>{this._awaitQueue.push(async()=>await this._handler.pauseSending(E.localId),"producer @pause event").then(g).catch(_)}),E.on("@resume",(g,_)=>{this._awaitQueue.push(async()=>await this._handler.resumeSending(E.localId),"producer @resume event").then(g).catch(_)}),E.on("@replacetrack",(g,_,m)=>{this._awaitQueue.push(async()=>await this._handler.replaceTrack(E.localId,g),"producer @replacetrack event").then(_).catch(m)}),E.on("@setmaxspatiallayer",(g,_,m)=>{this._awaitQueue.push(async()=>await this._handler.setMaxSpatialLayer(E.localId,g),"producer @setmaxspatiallayer event").then(_).catch(m)}),E.on("@setrtpencodingparameters",(g,_,m)=>{this._awaitQueue.push(async()=>await this._handler.setRtpEncodingParameters(E.localId,g),"producer @setrtpencodingparameters event").then(_).catch(m)}),E.on("@getstats",(g,_)=>{if(this._closed)return _(new r.InvalidStateError("closed"));this._handler.getSenderStats(E.localId).then(g).catch(_)})}handleConsumer(E){E.on("@close",()=>{this._consumers.delete(E.id),this._pendingPauseConsumers.delete(E.id),this._pendingResumeConsumers.delete(E.id),!this._closed&&(this._pendingCloseConsumers.set(E.id,E),this._consumerCloseInProgress===!1&&this.closePendingConsumers())}),E.on("@pause",()=>{this._pendingResumeConsumers.has(E.id)&&this._pendingResumeConsumers.delete(E.id),this._pendingPauseConsumers.set(E.id,E),queueMicrotask(()=>{this._closed||this._consumerPauseInProgress===!1&&this.pausePendingConsumers()})}),E.on("@resume",()=>{this._pendingPauseConsumers.has(E.id)&&this._pendingPauseConsumers.delete(E.id),this._pendingResumeConsumers.set(E.id,E),queueMicrotask(()=>{this._closed||this._consumerResumeInProgress===!1&&this.resumePendingConsumers()})}),E.on("@getstats",(g,_)=>{if(this._closed)return _(new r.InvalidStateError("closed"));this._handler.getReceiverStats(E.localId).then(g).catch(_)})}handleDataProducer(E){E.on("@close",()=>{this._dataProducers.delete(E.id)})}handleDataConsumer(E){E.on("@close",()=>{this._dataConsumers.delete(E.id)})}};return Bc.Transport=v,Bc}var zc={},Yi={},u1={},zm={exports:{}},d1;function Uv(){if(d1)return zm.exports;d1=1;var i=zm.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=e.raddr!=null?" raddr %s rport %d":"%v%v",t+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(t+=" generation %d"),t+=e["network-id"]!=null?" network-id %d":"%v",t+=e["network-cost"]!=null?" network-cost %d":"%v",t}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return e.attribute!=null&&(t+=" %s",e.value!=null&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=e.id!=null?"id=%s %s":"%v%s",t+=e.mediaClockValue!=null?"=%s":"",t+=e.rateNumerator!=null?" rate=%s":"",t+=e.rateDenominator!=null?"/%s":"",t}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(i).forEach(function(e){var t=i[e];t.forEach(function(r){r.reg||(r.reg=/(.*)/),r.format||(r.format="%s")})}),zm.exports}var f1;function JB(){return f1||(f1=1,function(i){var e=function(l){return String(Number(l))===l?Number(l):l},t=function(l,d,u,f){if(f&&!u)d[f]=e(l[1]);else for(var p=0;p<u.length;p+=1)l[p+1]!=null&&(d[u[p]]=e(l[p+1]))},r=function(l,d,u){var f=l.name&&l.names;l.push&&!d[l.push]?d[l.push]=[]:f&&!d[l.name]&&(d[l.name]={});var p=l.push?{}:f?d[l.name]:d;t(u.match(l.reg),p,l.names,l.name),l.push&&d[l.push].push(p)},n=Uv(),a=RegExp.prototype.test.bind(/^([a-z])=(.*)/);i.parse=function(l){var d={},u=[],f=d;return l.split(/(\r\n|\r|\n)/).filter(a).forEach(function(p){var v=p[0],E=p.slice(2);v==="m"&&(u.push({rtp:[],fmtp:[]}),f=u[u.length-1]);for(var g=0;g<(n[v]||[]).length;g+=1){var _=n[v][g];if(_.reg.test(E))return r(_,f,E)}}),d.media=u,d};var c=function(l,d){var u=d.split(/=(.+)/,2);return u.length===2?l[u[0]]=e(u[1]):u.length===1&&d.length>1&&(l[u[0]]=void 0),l};i.parseParams=function(l){return l.split(/;\s?/).reduce(c,{})},i.parseFmtpConfig=i.parseParams,i.parsePayloads=function(l){return l.toString().split(" ").map(Number)},i.parseRemoteCandidates=function(l){for(var d=[],u=l.split(" ").map(e),f=0;f<u.length;f+=3)d.push({component:u[f],ip:u[f+1],port:u[f+2]});return d},i.parseImageAttributes=function(l){return l.split(" ").map(function(d){return d.substring(1,d.length-1).split(",").reduce(c,{})})},i.parseSimulcastStreamList=function(l){return l.split(";").map(function(d){return d.split(",").map(function(u){var f,p=!1;return u[0]!=="~"?f=e(u):(f=e(u.substring(1,u.length)),p=!0),{scid:f,paused:p}})})}}(u1)),u1}var Gm,h1;function e5(){if(h1)return Gm;h1=1;var i=Uv(),e=/%[sdv%]/g,t=function(c){var l=1,d=arguments,u=d.length;return c.replace(e,function(f){if(l>=u)return f;var p=d[l];switch(l+=1,f){case"%%":return"%";case"%s":return String(p);case"%d":return Number(p);case"%v":return""}})},r=function(c,l,d){var u=l.format instanceof Function?l.format(l.push?d:d[l.name]):l.format,f=[c+"="+u];if(l.names)for(var p=0;p<l.names.length;p+=1){var v=l.names[p];l.name?f.push(d[l.name][v]):f.push(d[l.names[p]])}else f.push(d[l.name]);return t.apply(null,f)},n=["v","o","s","i","u","e","p","c","b","t","r","z","a"],a=["i","c","b","a"];return Gm=function(c,l){l=l||{},c.version==null&&(c.version=0),c.name==null&&(c.name=" "),c.media.forEach(function(p){p.payloads==null&&(p.payloads="")});var d=l.outerOrder||n,u=l.innerOrder||a,f=[];return d.forEach(function(p){i[p].forEach(function(v){v.name in c&&c[v.name]!=null?f.push(r(p,v,c)):v.push in c&&c[v.push]!=null&&c[v.push].forEach(function(E){f.push(r(p,v,E))})})}),c.media.forEach(function(p){f.push(r("m",i.m[0],p)),u.forEach(function(v){i[v].forEach(function(E){E.name in p&&p[E.name]!=null?f.push(r(v,E,p)):E.push in p&&p[E.push]!=null&&p[E.push].forEach(function(g){f.push(r(v,E,g))})})})}),f.join(`\r
`)+`\r
`},Gm}var p1;function ri(){if(p1)return Yi;p1=1;var i=JB(),e=e5(),t=Uv();return Yi.grammar=t,Yi.write=e,Yi.parse=i.parse,Yi.parseParams=i.parseParams,Yi.parseFmtpConfig=i.parseFmtpConfig,Yi.parsePayloads=i.parsePayloads,Yi.parseRemoteCandidates=i.parseRemoteCandidates,Yi.parseImageAttributes=i.parseImageAttributes,Yi.parseSimulcastStreamList=i.parseSimulcastStreamList,Yi}var sa={},m1;function tn(){if(m1)return sa;m1=1,Object.defineProperty(sa,"__esModule",{value:!0}),sa.extractRtpCapabilities=e,sa.extractDtlsParameters=t,sa.getCname=r,sa.applyCodecParameters=n;const i=ri();function e({sdpObject:a}){const c=new Map,l=[];let d=!1,u=!1;for(const f of a.media){const p=f.type;switch(p){case"audio":{if(d)continue;d=!0;break}case"video":{if(u)continue;u=!0;break}default:continue}for(const v of f.rtp){const E={kind:p,mimeType:`${p}/${v.codec}`,preferredPayloadType:v.payload,clockRate:v.rate,channels:v.encoding,parameters:{},rtcpFeedback:[]};c.set(E.preferredPayloadType,E)}for(const v of f.fmtp??[]){const E=i.parseParams(v.config),g=c.get(v.payload);g&&(E!=null&&E.hasOwnProperty("profile-level-id")&&(E["profile-level-id"]=String(E["profile-level-id"])),g.parameters=E)}for(const v of f.rtcpFb??[]){const E={type:v.type,parameter:v.subtype};if(E.parameter||delete E.parameter,v.payload!=="*"){const g=c.get(v.payload);if(!g)continue;g.rtcpFeedback.push(E)}else for(const g of c.values())g.kind===p&&!/.+\/rtx$/i.test(g.mimeType)&&g.rtcpFeedback.push(E)}for(const v of f.ext??[]){if(v["encrypt-uri"])continue;const E={kind:p,uri:v.uri,preferredId:v.value};l.push(E)}}return{codecs:Array.from(c.values()),headerExtensions:l}}function t({sdpObject:a}){let c=a.setup,l=a.fingerprint;if(!c||!l){const u=(a.media??[]).find(f=>f.port!==0);u&&(c??(c=u.setup),l??(l=u.fingerprint))}if(c){if(!l)throw new Error("no a=fingerprint found at SDP session or media level")}else throw new Error("no a=setup found at SDP session or media level");let d;switch(c){case"active":{d="client";break}case"passive":{d="server";break}case"actpass":{d="auto";break}}return{role:d,fingerprints:[{algorithm:l.type,value:l.hash}]}}function r({offerMediaObject:a}){const c=(a.ssrcs??[]).find(l=>l.attribute==="cname");return c?c.value:""}function n({offerRtpParameters:a,answerMediaObject:c}){for(const l of a.codecs){const d=l.mimeType.toLowerCase();if(d!=="audio/opus"||!(c.rtp??[]).find(p=>p.payload===l.payloadType))continue;c.fmtp=c.fmtp??[];let u=c.fmtp.find(p=>p.payload===l.payloadType);u||(u={payload:l.payloadType,config:""},c.fmtp.push(u));const f=i.parseParams(u.config);switch(d){case"audio/opus":{const p=l.parameters["sprop-stereo"];p!==void 0&&(f.stereo=Number(p)?1:0);break}}u.config="";for(const p of Object.keys(f))u.config&&(u.config+=";"),u.config+=`${p}=${f[p]}`}}return sa}var Gc={},g1;function ga(){if(g1)return Gc;g1=1,Object.defineProperty(Gc,"__esModule",{value:!0}),Gc.getRtpEncodings=i,Gc.addLegacySimulcast=e;function i({offerMediaObject:t}){const r=new Set;for(const c of t.ssrcs??[]){const l=c.id;r.add(l)}if(r.size===0)throw new Error("no a=ssrc lines found");const n=new Map;for(const c of t.ssrcGroups??[]){if(c.semantics!=="FID")continue;let[l,d]=c.ssrcs.split(/\s+/);l=Number(l),d=Number(d),r.has(l)&&(r.delete(l),r.delete(d),n.set(l,d))}for(const c of r)n.set(c,null);const a=[];for(const[c,l]of n){const d={ssrc:c};l&&(d.rtx={ssrc:l}),a.push(d)}return a}function e({offerMediaObject:t,numStreams:r}){if(r<=1)throw new TypeError("numStreams must be greater than 1");const n=(t.ssrcs??[]).find(E=>E.attribute==="msid");if(!n)throw new Error("a=ssrc line with msid information not found");const[a,c]=n.value.split(" "),l=Number(n.id);let d;(t.ssrcGroups??[]).some(E=>{if(E.semantics!=="FID")return!1;const g=E.ssrcs.split(/\s+/);return Number(g[0])===l?(d=Number(g[1]),!0):!1});const u=t.ssrcs.find(E=>E.attribute==="cname");if(!u)throw new Error("a=ssrc line with cname information not found");const f=u.value,p=[],v=[];for(let E=0;E<r;++E)p.push(l+E),d&&v.push(d+E);t.ssrcGroups=[],t.ssrcs=[],t.ssrcGroups.push({semantics:"SIM",ssrcs:p.join(" ")});for(const E of p)t.ssrcs.push({id:E,attribute:"cname",value:f}),t.ssrcs.push({id:E,attribute:"msid",value:`${a} ${c}`});for(let E=0;E<v.length;++E){const g=p[E],_=v[E];t.ssrcs.push({id:_,attribute:"cname",value:f}),t.ssrcs.push({id:_,attribute:"msid",value:`${a} ${c}`}),t.ssrcGroups.push({semantics:"FID",ssrcs:`${g} ${_}`})}}return Gc}var pd={},v1;function Pf(){if(v1)return pd;v1=1,Object.defineProperty(pd,"__esModule",{value:!0}),pd.addNackSupportForOpus=i;function i(e){var t;for(const r of e.codecs??[])(r.mimeType.toLowerCase()==="audio/opus"||r.mimeType.toLowerCase()==="audio/multiopus")&&!((t=r.rtcpFeedback)!=null&&t.some(n=>n.type==="nack"&&!n.parameter))&&(r.rtcpFeedback||(r.rtcpFeedback=[]),r.rtcpFeedback.push({type:"nack"}))}return pd}var Hc={},y1;function ii(){if(y1)return Hc;y1=1,Object.defineProperty(Hc,"__esModule",{value:!0}),Hc.HandlerInterface=void 0;const i=Ds();let e=class extends i.EnhancedEventEmitter{constructor(){super()}};return Hc.HandlerInterface=e,Hc}var Vc={},Bn={},b1;function t5(){if(b1)return Bn;b1=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.OfferMediaSection=Bn.AnswerMediaSection=Bn.MediaSection=void 0;const i=ri(),e=br();let t=class{constructor({iceParameters:c,iceCandidates:l,dtlsParameters:d,planB:u=!1}){if(K(this,"_mediaObject"),K(this,"_planB"),this._mediaObject={},this._planB=u,c&&this.setIceParameters(c),l){this._mediaObject.candidates=[];for(const f of l){const p={};p.component=1,p.foundation=f.foundation,p.ip=f.address??f.ip,p.port=f.port,p.priority=f.priority,p.transport=f.protocol,p.type=f.type,f.tcpType&&(p.tcptype=f.tcpType),this._mediaObject.candidates.push(p)}this._mediaObject.endOfCandidates="end-of-candidates",this._mediaObject.iceOptions="renomination"}d&&this.setDtlsRole(d.role)}get mid(){return String(this._mediaObject.mid)}get closed(){return this._mediaObject.port===0}getObject(){return this._mediaObject}setIceParameters(c){this._mediaObject.iceUfrag=c.usernameFragment,this._mediaObject.icePwd=c.password}pause(){this._mediaObject.direction="inactive"}disable(){this.pause(),delete this._mediaObject.ext,delete this._mediaObject.ssrcs,delete this._mediaObject.ssrcGroups,delete this._mediaObject.simulcast,delete this._mediaObject.simulcast_03,delete this._mediaObject.rids,delete this._mediaObject.extmapAllowMixed}close(){this.disable(),this._mediaObject.port=0}};Bn.MediaSection=t;class r extends t{constructor({iceParameters:l,iceCandidates:d,dtlsParameters:u,sctpParameters:f,plainRtpParameters:p,planB:v=!1,offerMediaObject:E,offerRtpParameters:g,answerRtpParameters:_,codecOptions:m}){switch(super({iceParameters:l,iceCandidates:d,dtlsParameters:u,planB:v}),this._mediaObject.mid=String(E.mid),this._mediaObject.type=E.type,this._mediaObject.protocol=E.protocol,p?(this._mediaObject.connection={ip:p.ip,version:p.ipVersion},this._mediaObject.port=p.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},this._mediaObject.port=7),E.type){case"audio":case"video":{this._mediaObject.direction="recvonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[];for(const y of _.codecs){const b={payload:y.payloadType,codec:a(y),rate:y.clockRate};y.channels>1&&(b.encoding=y.channels),this._mediaObject.rtp.push(b);const R=e.clone(y.parameters)??{};let T=e.clone(y.rtcpFeedback)??[];if(m){const{opusStereo:C,opusFec:A,opusDtx:L,opusMaxPlaybackRate:D,opusMaxAverageBitrate:P,opusPtime:k,opusNack:M,videoGoogleStartBitrate:I,videoGoogleMaxBitrate:F,videoGoogleMinBitrate:$}=m,N=g.codecs.find(U=>U.payloadType===y.payloadType);switch(y.mimeType.toLowerCase()){case"audio/opus":case"audio/multiopus":{C!==void 0&&(N.parameters["sprop-stereo"]=C?1:0,R.stereo=C?1:0),A!==void 0&&(N.parameters.useinbandfec=A?1:0,R.useinbandfec=A?1:0),L!==void 0&&(N.parameters.usedtx=L?1:0,R.usedtx=L?1:0),D!==void 0&&(R.maxplaybackrate=D),P!==void 0&&(R.maxaveragebitrate=P),k!==void 0&&(N.parameters.ptime=k,R.ptime=k),M||(N.rtcpFeedback=N.rtcpFeedback.filter(U=>U.type!=="nack"||U.parameter),T=T.filter(U=>U.type!=="nack"||U.parameter));break}case"video/vp8":case"video/vp9":case"video/h264":case"video/h265":{I!==void 0&&(R["x-google-start-bitrate"]=I),F!==void 0&&(R["x-google-max-bitrate"]=F),$!==void 0&&(R["x-google-min-bitrate"]=$);break}}}const w={payload:y.payloadType,config:""};for(const C of Object.keys(R))w.config&&(w.config+=";"),w.config+=`${C}=${R[C]}`;w.config&&this._mediaObject.fmtp.push(w);for(const C of T)this._mediaObject.rtcpFb.push({payload:y.payloadType,type:C.type,subtype:C.parameter})}this._mediaObject.payloads=_.codecs.map(y=>y.payloadType).join(" "),this._mediaObject.ext=[];for(const y of _.headerExtensions)(E.ext??[]).some(b=>b.uri===y.uri)&&this._mediaObject.ext.push({uri:y.uri,value:y.id});if(E.extmapAllowMixed==="extmap-allow-mixed"&&(this._mediaObject.extmapAllowMixed="extmap-allow-mixed"),E.simulcast){this._mediaObject.simulcast={dir1:"recv",list1:E.simulcast.list1},this._mediaObject.rids=[];for(const y of E.rids??[])y.direction==="send"&&this._mediaObject.rids.push({id:y.id,direction:"recv"})}else if(E.simulcast_03){this._mediaObject.simulcast_03={value:E.simulcast_03.value.replace(/send/g,"recv")},this._mediaObject.rids=[];for(const y of E.rids??[])y.direction==="send"&&this._mediaObject.rids.push({id:y.id,direction:"recv"})}this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize",this._planB&&this._mediaObject.type==="video"&&(this._mediaObject.xGoogleFlag="conference");break}case"application":{typeof E.sctpPort=="number"?(this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=f.port,this._mediaObject.maxMessageSize=f.maxMessageSize):E.sctpmap&&(this._mediaObject.payloads=f.port,this._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:f.port,maxMessageSize:f.maxMessageSize});break}}}setDtlsRole(l){switch(l){case"client":{this._mediaObject.setup="active";break}case"server":{this._mediaObject.setup="passive";break}case"auto":{this._mediaObject.setup="actpass";break}}}resume(){this._mediaObject.direction="recvonly"}muxSimulcastStreams(l){var d,u;if(!((d=this._mediaObject.simulcast)!=null&&d.list1))return;const f={};for(const E of l)E.rid&&(f[E.rid]=E);const p=this._mediaObject.simulcast.list1,v=i.parseSimulcastStreamList(p);for(const E of v)for(const g of E)g.paused=!((u=f[g.scid])!=null&&u.active);this._mediaObject.simulcast.list1=v.map(E=>E.map(g=>`${g.paused?"~":""}${g.scid}`).join(",")).join(";")}}Bn.AnswerMediaSection=r;class n extends t{constructor({iceParameters:l,iceCandidates:d,dtlsParameters:u,sctpParameters:f,plainRtpParameters:p,planB:v=!1,mid:E,kind:g,offerRtpParameters:_,streamId:m,trackId:y,oldDataChannelSpec:b=!1}){var R;switch(super({iceParameters:l,iceCandidates:d,dtlsParameters:u,planB:v}),this._mediaObject.mid=String(E),this._mediaObject.type=g,p?(this._mediaObject.connection={ip:p.ip,version:p.ipVersion},this._mediaObject.protocol="RTP/AVP",this._mediaObject.port=p.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},f?this._mediaObject.protocol="UDP/DTLS/SCTP":this._mediaObject.protocol="UDP/TLS/RTP/SAVPF",this._mediaObject.port=7),this._mediaObject.extmapAllowMixed="extmap-allow-mixed",g){case"audio":case"video":{this._mediaObject.direction="sendonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[],this._planB||(this._mediaObject.msid=`${m??"-"} ${y}`);for(const A of _.codecs){const L={payload:A.payloadType,codec:a(A),rate:A.clockRate};A.channels>1&&(L.encoding=A.channels),this._mediaObject.rtp.push(L);const D={payload:A.payloadType,config:""};for(const P of Object.keys(A.parameters))D.config&&(D.config+=";"),D.config+=`${P}=${A.parameters[P]}`;D.config&&this._mediaObject.fmtp.push(D);for(const P of A.rtcpFeedback)this._mediaObject.rtcpFb.push({payload:A.payloadType,type:P.type,subtype:P.parameter})}this._mediaObject.payloads=_.codecs.map(A=>A.payloadType).join(" "),this._mediaObject.ext=[];for(const A of _.headerExtensions)this._mediaObject.ext.push({uri:A.uri,value:A.id});this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize";const T=_.encodings[0],w=T.ssrc,C=(R=T.rtx)==null?void 0:R.ssrc;this._mediaObject.ssrcs=[],this._mediaObject.ssrcGroups=[],_.rtcp.cname&&this._mediaObject.ssrcs.push({id:w,attribute:"cname",value:_.rtcp.cname}),this._planB&&this._mediaObject.ssrcs.push({id:w,attribute:"msid",value:`${m??"-"} ${y}`}),C&&(_.rtcp.cname&&this._mediaObject.ssrcs.push({id:C,attribute:"cname",value:_.rtcp.cname}),this._planB&&this._mediaObject.ssrcs.push({id:C,attribute:"msid",value:`${m??"-"} ${y}`}),this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:`${w} ${C}`}));break}case"application":{b?(this._mediaObject.payloads=f.port,this._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:f.port,maxMessageSize:f.maxMessageSize}):(this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=f.port,this._mediaObject.maxMessageSize=f.maxMessageSize);break}}}setDtlsRole(l){this._mediaObject.setup="actpass"}resume(){this._mediaObject.direction="sendonly"}planBReceive({offerRtpParameters:l,streamId:d,trackId:u}){var f;const p=l.encodings[0],v=p.ssrc,E=(f=p.rtx)==null?void 0:f.ssrc,g=this._mediaObject.payloads.split(" ");for(const _ of l.codecs){if(g.includes(String(_.payloadType)))continue;const m={payload:_.payloadType,codec:a(_),rate:_.clockRate};_.channels>1&&(m.encoding=_.channels),this._mediaObject.rtp.push(m);const y={payload:_.payloadType,config:""};for(const b of Object.keys(_.parameters))y.config&&(y.config+=";"),y.config+=`${b}=${_.parameters[b]}`;y.config&&this._mediaObject.fmtp.push(y);for(const b of _.rtcpFeedback)this._mediaObject.rtcpFb.push({payload:_.payloadType,type:b.type,subtype:b.parameter})}this._mediaObject.payloads+=` ${l.codecs.filter(_=>!this._mediaObject.payloads.includes(_.payloadType)).map(_=>_.payloadType).join(" ")}`,this._mediaObject.payloads=this._mediaObject.payloads.trim(),l.rtcp.cname&&this._mediaObject.ssrcs.push({id:v,attribute:"cname",value:l.rtcp.cname}),this._mediaObject.ssrcs.push({id:v,attribute:"msid",value:`${d??"-"} ${u}`}),E&&(l.rtcp.cname&&this._mediaObject.ssrcs.push({id:E,attribute:"cname",value:l.rtcp.cname}),this._mediaObject.ssrcs.push({id:E,attribute:"msid",value:`${d??"-"} ${u}`}),this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:`${v} ${E}`}))}planBStopReceiving({offerRtpParameters:l}){var d;const u=l.encodings[0],f=u.ssrc,p=(d=u.rtx)==null?void 0:d.ssrc;this._mediaObject.ssrcs=this._mediaObject.ssrcs.filter(v=>v.id!==f&&v.id!==p),p&&(this._mediaObject.ssrcGroups=this._mediaObject.ssrcGroups.filter(v=>v.ssrcs!==`${f} ${p}`))}}Bn.OfferMediaSection=n;function a(c){const l=new RegExp("^(audio|video)/(.+)","i").exec(c.mimeType);if(!l)throw new TypeError("invalid codec.mimeType");return l[2]}return Bn}var _1;function rn(){if(_1)return Vc;_1=1,Object.defineProperty(Vc,"__esModule",{value:!0}),Vc.RemoteSdp=void 0;const i=ri(),e=sr(),t=t5(),r=new e.Logger("RemoteSdp");let n=class{constructor({iceParameters:a,iceCandidates:c,dtlsParameters:l,sctpParameters:d,plainRtpParameters:u,planB:f=!1}){if(K(this,"_iceParameters"),K(this,"_iceCandidates"),K(this,"_dtlsParameters"),K(this,"_sctpParameters"),K(this,"_plainRtpParameters"),K(this,"_planB"),K(this,"_mediaSections",[]),K(this,"_midToIndex",new Map),K(this,"_firstMid"),K(this,"_sdpObject"),this._iceParameters=a,this._iceCandidates=c,this._dtlsParameters=l,this._sctpParameters=d,this._plainRtpParameters=u,this._planB=f,this._sdpObject={version:0,origin:{address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:1e4,sessionVersion:0,username:"mediasoup-client"},name:"-",timing:{start:0,stop:0},media:[]},a!=null&&a.iceLite&&(this._sdpObject.icelite="ice-lite"),l){this._sdpObject.msidSemantic={semantic:"WMS",token:"*"};const p=this._dtlsParameters.fingerprints.length;this._sdpObject.fingerprint={type:l.fingerprints[p-1].algorithm,hash:l.fingerprints[p-1].value},this._sdpObject.groups=[{type:"BUNDLE",mids:""}]}u&&(this._sdpObject.origin.address=u.ip,this._sdpObject.origin.ipVer=u.ipVersion)}updateIceParameters(a){r.debug("updateIceParameters() [iceParameters:%o]",a),this._iceParameters=a,this._sdpObject.icelite=a.iceLite?"ice-lite":void 0;for(const c of this._mediaSections)c.setIceParameters(a)}updateDtlsRole(a){r.debug("updateDtlsRole() [role:%s]",a),this._dtlsParameters.role=a;for(const c of this._mediaSections)c.setDtlsRole(a)}setSessionExtmapAllowMixed(){r.debug("setSessionExtmapAllowMixed()"),this._sdpObject.extmapAllowMixed="extmap-allow-mixed"}getNextMediaSectionIdx(){for(let a=0;a<this._mediaSections.length;++a){const c=this._mediaSections[a];if(c.closed)return{idx:a,reuseMid:c.mid}}return{idx:this._mediaSections.length}}send({offerMediaObject:a,reuseMid:c,offerRtpParameters:l,answerRtpParameters:d,codecOptions:u}){const f=new t.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,offerMediaObject:a,offerRtpParameters:l,answerRtpParameters:d,codecOptions:u});c?this._replaceMediaSection(f,c):this._midToIndex.has(f.mid)?this._replaceMediaSection(f):this._addMediaSection(f)}receive({mid:a,kind:c,offerRtpParameters:l,streamId:d,trackId:u}){const f=this._midToIndex.get(a);let p;if(f!==void 0&&(p=this._mediaSections[f]),this.setSessionExtmapAllowMixed(),p)p.planBReceive({offerRtpParameters:l,streamId:d,trackId:u}),this._replaceMediaSection(p);else{p=new t.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,mid:a,kind:c,offerRtpParameters:l,streamId:d,trackId:u});const v=this._mediaSections.find(E=>E.closed);v?this._replaceMediaSection(p,v.mid):this._addMediaSection(p)}}pauseMediaSection(a){this._findMediaSection(a).pause()}resumeSendingMediaSection(a){this._findMediaSection(a).resume()}resumeReceivingMediaSection(a){this._findMediaSection(a).resume()}disableMediaSection(a){this._findMediaSection(a).disable()}closeMediaSection(a){const c=this._findMediaSection(a);return a===this._firstMid?(r.debug("closeMediaSection() | cannot close first media section, disabling it instead [mid:%s]",a),this.disableMediaSection(a),!1):(c.close(),this._regenerateBundleMids(),!0)}muxMediaSectionSimulcast(a,c){const l=this._findMediaSection(a);l.muxSimulcastStreams(c),this._replaceMediaSection(l)}planBStopReceiving({mid:a,offerRtpParameters:c}){const l=this._findMediaSection(a);l.planBStopReceiving({offerRtpParameters:c}),this._replaceMediaSection(l)}sendSctpAssociation({offerMediaObject:a}){const c=new t.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,offerMediaObject:a});this._addMediaSection(c)}receiveSctpAssociation({oldDataChannelSpec:a=!1}={}){const c=new t.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,mid:"datachannel",kind:"application",oldDataChannelSpec:a});this._addMediaSection(c)}getSdp(){return this._sdpObject.origin.sessionVersion++,i.write(this._sdpObject)}_addMediaSection(a){this._firstMid||(this._firstMid=a.mid),this._mediaSections.push(a),this._midToIndex.set(a.mid,this._mediaSections.length-1),this._sdpObject.media.push(a.getObject()),this._regenerateBundleMids()}_replaceMediaSection(a,c){if(typeof c=="string"){const l=this._midToIndex.get(c);if(l===void 0)throw new Error(`no media section found for reuseMid '${c}'`);const d=this._mediaSections[l];this._mediaSections[l]=a,this._midToIndex.delete(d.mid),this._midToIndex.set(a.mid,l),this._sdpObject.media[l]=a.getObject(),this._regenerateBundleMids()}else{const l=this._midToIndex.get(a.mid);if(l===void 0)throw new Error(`no media section found with mid '${a.mid}'`);this._mediaSections[l]=a,this._sdpObject.media[l]=a.getObject()}}_findMediaSection(a){const c=this._midToIndex.get(a);if(c===void 0)throw new Error(`no media section found with mid '${a}'`);return this._mediaSections[c]}_regenerateBundleMids(){this._dtlsParameters&&(this._sdpObject.groups[0].mids=this._mediaSections.filter(a=>!a.closed).map(a=>a.mid).join(" "))}};return Vc.RemoteSdp=n,Vc}var md={},S1;function Ls(){if(S1)return md;S1=1,Object.defineProperty(md,"__esModule",{value:!0}),md.parse=e;const i=new RegExp("^[LS]([1-9]\\d{0,1})T([1-9]\\d{0,1})");function e(t){const r=i.exec(t??"");return r?{spatialLayers:Number(r[1]),temporalLayers:Number(r[2])}:{spatialLayers:1,temporalLayers:1}}return md}var E1;function r5(){if(E1)return zc;E1=1,Object.defineProperty(zc,"__esModule",{value:!0}),zc.Chrome111=void 0;const i=ri(),e=sr(),t=br(),r=Hr(),n=tn(),a=ga(),c=Pf(),l=Gr(),d=ii(),u=rn(),f=Ls(),p=new e.Logger("Chrome111"),v="Chrome111",E={OS:1024,MIS:1024};let g=class xC extends d.HandlerInterface{constructor(){super(),K(this,"_closed",!1),K(this,"_direction"),K(this,"_remoteSdp"),K(this,"_sendingRtpParametersByKind"),K(this,"_sendingRemoteRtpParametersByKind"),K(this,"_forcedLocalDtlsRole"),K(this,"_pc"),K(this,"_mapMidTransceiver",new Map),K(this,"_sendStream",new MediaStream),K(this,"_hasDataChannelMediaSection",!1),K(this,"_nextSendSctpStreamId",0),K(this,"_transportReady",!1)}static createFactory(){return()=>new xC}get name(){return v}close(){if(p.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){p.debug("getNativeRtpCapabilities()");const m=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{m.addTransceiver("audio"),m.addTransceiver("video");const y=await m.createOffer();try{m.close()}catch{}const b=i.parse(y.sdp),R=n.extractRtpCapabilities({sdpObject:b});return c.addNackSupportForOpus(R),R}catch(y){try{m.close()}catch{}throw y}}async getNativeSctpCapabilities(){return p.debug("getNativeSctpCapabilities()"),{numStreams:E}}run({direction:m,iceParameters:y,iceCandidates:b,dtlsParameters:R,sctpParameters:T,iceServers:w,iceTransportPolicy:C,additionalSettings:A,proprietaryConstraints:L,extendedRtpCapabilities:D}){this.assertNotClosed(),p.debug("run()"),this._direction=m,this._remoteSdp=new u.RemoteSdp({iceParameters:y,iceCandidates:b,dtlsParameters:R,sctpParameters:T}),this._sendingRtpParametersByKind={audio:r.getSendingRtpParameters("audio",D),video:r.getSendingRtpParameters("video",D)},this._sendingRemoteRtpParametersByKind={audio:r.getSendingRemoteRtpParameters("audio",D),video:r.getSendingRemoteRtpParameters("video",D)},R.role&&R.role!=="auto"&&(this._forcedLocalDtlsRole=R.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:w??[],iceTransportPolicy:C??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...A},L),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",P=>{this.emit("@icecandidateerror",P)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):(p.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}))}async updateIceServers(m){this.assertNotClosed(),p.debug("updateIceServers()");const y=this._pc.getConfiguration();y.iceServers=m,this._pc.setConfiguration(y)}async restartIce(m){if(this.assertNotClosed(),p.debug("restartIce()"),this._remoteSdp.updateIceParameters(m),!!this._transportReady)if(this._direction==="send"){const y=await this._pc.createOffer({iceRestart:!0});p.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",y),await this._pc.setLocalDescription(y);const b={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",b),await this._pc.setRemoteDescription(b)}else{const y={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",y),await this._pc.setRemoteDescription(y);const b=await this._pc.createAnswer();p.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",b),await this._pc.setLocalDescription(b)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:m,encodings:y,codecOptions:b,codec:R,onRtpSender:T}){if(this.assertNotClosed(),this.assertSendDirection(),p.debug("send() [kind:%s, track.id:%s]",m.kind,m.id),y&&y.length>1){let F=1;for(const $ of y){const N=$.scalabilityMode?(0,f.parse)($.scalabilityMode).temporalLayers:3;N>F&&(F=N)}y.forEach(($,N)=>{$.rid=`r${N}`,$.scalabilityMode=`L1T${F}`})}const w=t.clone(this._sendingRtpParametersByKind[m.kind]);w.codecs=r.reduceCodecs(w.codecs,R);const C=t.clone(this._sendingRemoteRtpParametersByKind[m.kind]);C.codecs=r.reduceCodecs(C.codecs,R);const A=this._remoteSdp.getNextMediaSectionIdx(),L=this._pc.addTransceiver(m,{direction:"sendonly",streams:[this._sendStream],sendEncodings:y});T&&T(L.sender);const D=await this._pc.createOffer();let P=i.parse(D.sdp);P.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed(),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:P}),p.debug("send() | calling pc.setLocalDescription() [offer:%o]",D),await this._pc.setLocalDescription(D);const k=L.mid;w.mid=k,P=i.parse(this._pc.localDescription.sdp);const M=P.media[A.idx];if(w.rtcp.cname=n.getCname({offerMediaObject:M}),!y)w.encodings=a.getRtpEncodings({offerMediaObject:M});else if(y.length===1){const F=a.getRtpEncodings({offerMediaObject:M});Object.assign(F[0],y[0]),w.encodings=F}else w.encodings=y;this._remoteSdp.send({offerMediaObject:M,reuseMid:A.reuseMid,offerRtpParameters:w,answerRtpParameters:C,codecOptions:b});const I={type:"answer",sdp:this._remoteSdp.getSdp()};return p.debug("send() | calling pc.setRemoteDescription() [answer:%o]",I),await this._pc.setRemoteDescription(I),this._mapMidTransceiver.set(k,L),{localId:k,rtpParameters:w,rtpSender:L.sender}}async stopSending(m){if(this.assertSendDirection(),p.debug("stopSending() [localId:%s]",m),this._closed)return;const y=this._mapMidTransceiver.get(m);if(!y)throw new Error("associated RTCRtpTransceiver not found");if(y.sender.replaceTrack(null),this._pc.removeTrack(y.sender),this._remoteSdp.closeMediaSection(y.mid))try{y.stop()}catch{}const b=await this._pc.createOffer();p.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",b),await this._pc.setLocalDescription(b);const R={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",R),await this._pc.setRemoteDescription(R),this._mapMidTransceiver.delete(m)}async pauseSending(m){this.assertNotClosed(),this.assertSendDirection(),p.debug("pauseSending() [localId:%s]",m);const y=this._mapMidTransceiver.get(m);if(!y)throw new Error("associated RTCRtpTransceiver not found");y.direction="inactive",this._remoteSdp.pauseMediaSection(m);const b=await this._pc.createOffer();p.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",b),await this._pc.setLocalDescription(b);const R={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",R),await this._pc.setRemoteDescription(R)}async resumeSending(m){this.assertNotClosed(),this.assertSendDirection(),p.debug("resumeSending() [localId:%s]",m);const y=this._mapMidTransceiver.get(m);if(this._remoteSdp.resumeSendingMediaSection(m),!y)throw new Error("associated RTCRtpTransceiver not found");y.direction="sendonly";const b=await this._pc.createOffer();p.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",b),await this._pc.setLocalDescription(b);const R={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",R),await this._pc.setRemoteDescription(R)}async replaceTrack(m,y){this.assertNotClosed(),this.assertSendDirection(),y?p.debug("replaceTrack() [localId:%s, track.id:%s]",m,y.id):p.debug("replaceTrack() [localId:%s, no track]",m);const b=this._mapMidTransceiver.get(m);if(!b)throw new Error("associated RTCRtpTransceiver not found");await b.sender.replaceTrack(y)}async setMaxSpatialLayer(m,y){this.assertNotClosed(),this.assertSendDirection(),p.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",m,y);const b=this._mapMidTransceiver.get(m);if(!b)throw new Error("associated RTCRtpTransceiver not found");const R=b.sender.getParameters();R.encodings.forEach((C,A)=>{A<=y?C.active=!0:C.active=!1}),await b.sender.setParameters(R),this._remoteSdp.muxMediaSectionSimulcast(m,R.encodings);const T=await this._pc.createOffer();p.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",T),await this._pc.setLocalDescription(T);const w={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",w),await this._pc.setRemoteDescription(w)}async setRtpEncodingParameters(m,y){this.assertNotClosed(),this.assertSendDirection(),p.debug("setRtpEncodingParameters() [localId:%s, params:%o]",m,y);const b=this._mapMidTransceiver.get(m);if(!b)throw new Error("associated RTCRtpTransceiver not found");const R=b.sender.getParameters();R.encodings.forEach((C,A)=>{R.encodings[A]={...C,...y}}),await b.sender.setParameters(R),this._remoteSdp.muxMediaSectionSimulcast(m,R.encodings);const T=await this._pc.createOffer();p.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",T),await this._pc.setLocalDescription(T);const w={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",w),await this._pc.setRemoteDescription(w)}async getSenderStats(m){this.assertNotClosed(),this.assertSendDirection();const y=this._mapMidTransceiver.get(m);if(!y)throw new Error("associated RTCRtpTransceiver not found");return y.sender.getStats()}async sendDataChannel({ordered:m,maxPacketLifeTime:y,maxRetransmits:b,label:R,protocol:T}){this.assertNotClosed(),this.assertSendDirection();const w={negotiated:!0,id:this._nextSendSctpStreamId,ordered:m,maxPacketLifeTime:y,maxRetransmits:b,protocol:T};p.debug("sendDataChannel() [options:%o]",w);const C=this._pc.createDataChannel(R,w);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%E.MIS,!this._hasDataChannelMediaSection){const L=await this._pc.createOffer(),D=i.parse(L.sdp),P=D.media.find(M=>M.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:D}),p.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",L),await this._pc.setLocalDescription(L),this._remoteSdp.sendSctpAssociation({offerMediaObject:P});const k={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",k),await this._pc.setRemoteDescription(k),this._hasDataChannelMediaSection=!0}const A={streamId:w.id,ordered:w.ordered,maxPacketLifeTime:w.maxPacketLifeTime,maxRetransmits:w.maxRetransmits};return{dataChannel:C,sctpStreamParameters:A}}async receive(m){this.assertNotClosed(),this.assertRecvDirection();const y=[],b=new Map;for(const C of m){const{trackId:A,kind:L,rtpParameters:D,streamId:P}=C;p.debug("receive() [trackId:%s, kind:%s]",A,L);const k=D.mid??String(this._mapMidTransceiver.size);b.set(A,k),this._remoteSdp.receive({mid:k,kind:L,offerRtpParameters:D,streamId:P??D.rtcp.cname,trackId:A})}const R={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",R),await this._pc.setRemoteDescription(R);for(const C of m){const{trackId:A,onRtpReceiver:L}=C;if(L){const D=b.get(A),P=this._pc.getTransceivers().find(k=>k.mid===D);if(!P)throw new Error("transceiver not found");L(P.receiver)}}let T=await this._pc.createAnswer();const w=i.parse(T.sdp);for(const C of m){const{trackId:A,rtpParameters:L}=C,D=b.get(A),P=w.media.find(k=>String(k.mid)===D);n.applyCodecParameters({offerRtpParameters:L,answerMediaObject:P})}T={type:"answer",sdp:i.write(w)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:w}),p.debug("receive() | calling pc.setLocalDescription() [answer:%o]",T),await this._pc.setLocalDescription(T);for(const C of m){const{trackId:A}=C,L=b.get(A),D=this._pc.getTransceivers().find(P=>P.mid===L);if(D)this._mapMidTransceiver.set(L,D),y.push({localId:L,track:D.receiver.track,rtpReceiver:D.receiver});else throw new Error("new RTCRtpTransceiver not found")}return y}async stopReceiving(m){if(this.assertRecvDirection(),this._closed)return;for(const R of m){p.debug("stopReceiving() [localId:%s]",R);const T=this._mapMidTransceiver.get(R);if(!T)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(T.mid)}const y={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",y),await this._pc.setRemoteDescription(y);const b=await this._pc.createAnswer();p.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",b),await this._pc.setLocalDescription(b);for(const R of m)this._mapMidTransceiver.delete(R)}async pauseReceiving(m){this.assertNotClosed(),this.assertRecvDirection();for(const R of m){p.debug("pauseReceiving() [localId:%s]",R);const T=this._mapMidTransceiver.get(R);if(!T)throw new Error("associated RTCRtpTransceiver not found");T.direction="inactive",this._remoteSdp.pauseMediaSection(R)}const y={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",y),await this._pc.setRemoteDescription(y);const b=await this._pc.createAnswer();p.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",b),await this._pc.setLocalDescription(b)}async resumeReceiving(m){this.assertNotClosed(),this.assertRecvDirection();for(const R of m){p.debug("resumeReceiving() [localId:%s]",R);const T=this._mapMidTransceiver.get(R);if(!T)throw new Error("associated RTCRtpTransceiver not found");T.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(R)}const y={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",y),await this._pc.setRemoteDescription(y);const b=await this._pc.createAnswer();p.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",b),await this._pc.setLocalDescription(b)}async getReceiverStats(m){this.assertNotClosed(),this.assertRecvDirection();const y=this._mapMidTransceiver.get(m);if(!y)throw new Error("associated RTCRtpTransceiver not found");return y.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:m,label:y,protocol:b}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:R,ordered:T,maxPacketLifeTime:w,maxRetransmits:C}=m,A={negotiated:!0,id:R,ordered:T,maxPacketLifeTime:w,maxRetransmits:C,protocol:b};p.debug("receiveDataChannel() [options:%o]",A);const L=this._pc.createDataChannel(y,A);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const D={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",D),await this._pc.setRemoteDescription(D);const P=await this._pc.createAnswer();if(!this._transportReady){const k=i.parse(P.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:k})}p.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",P),await this._pc.setLocalDescription(P),this._hasDataChannelMediaSection=!0}return{dataChannel:L}}async setupTransport({localDtlsRole:m,localSdpObject:y}){y||(y=i.parse(this._pc.localDescription.sdp));const b=n.extractDtlsParameters({sdpObject:y});b.role=m,this._remoteSdp.updateDtlsRole(m==="client"?"server":"client"),await new Promise((R,T)=>{this.safeEmit("@connect",{dtlsParameters:b},R,T)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new l.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};return zc.Chrome111=g,zc}var Kc={},R1;function i5(){if(R1)return Kc;R1=1,Object.defineProperty(Kc,"__esModule",{value:!0}),Kc.Chrome74=void 0;const i=ri(),e=sr(),t=br(),r=Hr(),n=tn(),a=ga(),c=Pf(),l=Gr(),d=ii(),u=rn(),f=Ls(),p=new e.Logger("Chrome74"),v="Chrome74",E={OS:1024,MIS:1024};let g=class DC extends d.HandlerInterface{constructor(){super(),K(this,"_closed",!1),K(this,"_direction"),K(this,"_remoteSdp"),K(this,"_sendingRtpParametersByKind"),K(this,"_sendingRemoteRtpParametersByKind"),K(this,"_forcedLocalDtlsRole"),K(this,"_pc"),K(this,"_mapMidTransceiver",new Map),K(this,"_sendStream",new MediaStream),K(this,"_hasDataChannelMediaSection",!1),K(this,"_nextSendSctpStreamId",0),K(this,"_transportReady",!1)}static createFactory(){return()=>new DC}get name(){return v}close(){if(p.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){p.debug("getNativeRtpCapabilities()");const m=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{m.addTransceiver("audio"),m.addTransceiver("video");const y=await m.createOffer();try{m.close()}catch{}const b=i.parse(y.sdp),R=n.extractRtpCapabilities({sdpObject:b});return c.addNackSupportForOpus(R),R}catch(y){try{m.close()}catch{}throw y}}async getNativeSctpCapabilities(){return p.debug("getNativeSctpCapabilities()"),{numStreams:E}}run({direction:m,iceParameters:y,iceCandidates:b,dtlsParameters:R,sctpParameters:T,iceServers:w,iceTransportPolicy:C,additionalSettings:A,proprietaryConstraints:L,extendedRtpCapabilities:D}){p.debug("run()"),this._direction=m,this._remoteSdp=new u.RemoteSdp({iceParameters:y,iceCandidates:b,dtlsParameters:R,sctpParameters:T}),this._sendingRtpParametersByKind={audio:r.getSendingRtpParameters("audio",D),video:r.getSendingRtpParameters("video",D)},this._sendingRemoteRtpParametersByKind={audio:r.getSendingRemoteRtpParameters("audio",D),video:r.getSendingRemoteRtpParameters("video",D)},R.role&&R.role!=="auto"&&(this._forcedLocalDtlsRole=R.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:w??[],iceTransportPolicy:C??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...A},L),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",P=>{this.emit("@icecandidateerror",P)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):(p.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}))}async updateIceServers(m){this.assertNotClosed(),p.debug("updateIceServers()");const y=this._pc.getConfiguration();y.iceServers=m,this._pc.setConfiguration(y)}async restartIce(m){if(this.assertNotClosed(),p.debug("restartIce()"),this._remoteSdp.updateIceParameters(m),!!this._transportReady)if(this._direction==="send"){const y=await this._pc.createOffer({iceRestart:!0});p.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",y),await this._pc.setLocalDescription(y);const b={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",b),await this._pc.setRemoteDescription(b)}else{const y={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",y),await this._pc.setRemoteDescription(y);const b=await this._pc.createAnswer();p.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",b),await this._pc.setLocalDescription(b)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:m,encodings:y,codecOptions:b,codec:R}){this.assertNotClosed(),this.assertSendDirection(),p.debug("send() [kind:%s, track.id:%s]",m.kind,m.id),y&&y.length>1&&y.forEach(($,N)=>{$.rid=`r${N}`});const T=t.clone(this._sendingRtpParametersByKind[m.kind]);T.codecs=r.reduceCodecs(T.codecs,R);const w=t.clone(this._sendingRemoteRtpParametersByKind[m.kind]);w.codecs=r.reduceCodecs(w.codecs,R);const C=this._remoteSdp.getNextMediaSectionIdx(),A=this._pc.addTransceiver(m,{direction:"sendonly",streams:[this._sendStream],sendEncodings:y});let L=await this._pc.createOffer(),D=i.parse(L.sdp);D.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let P;this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:D});let k=!1;const M=(0,f.parse)((y??[{}])[0].scalabilityMode);y&&y.length===1&&M.spatialLayers>1&&T.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(p.debug("send() | enabling legacy simulcast for VP9 SVC"),k=!0,D=i.parse(L.sdp),P=D.media[C.idx],a.addLegacySimulcast({offerMediaObject:P,numStreams:M.spatialLayers}),L={type:"offer",sdp:i.write(D)}),p.debug("send() | calling pc.setLocalDescription() [offer:%o]",L),await this._pc.setLocalDescription(L);const I=A.mid;if(T.mid=I,D=i.parse(this._pc.localDescription.sdp),P=D.media[C.idx],T.rtcp.cname=n.getCname({offerMediaObject:P}),!y)T.encodings=a.getRtpEncodings({offerMediaObject:P});else if(y.length===1){let $=a.getRtpEncodings({offerMediaObject:P});Object.assign($[0],y[0]),k&&($=[$[0]]),T.encodings=$}else T.encodings=y;if(T.encodings.length>1&&(T.codecs[0].mimeType.toLowerCase()==="video/vp8"||T.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const $ of T.encodings)$.scalabilityMode?$.scalabilityMode=`L1T${M.temporalLayers}`:$.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:P,reuseMid:C.reuseMid,offerRtpParameters:T,answerRtpParameters:w,codecOptions:b});const F={type:"answer",sdp:this._remoteSdp.getSdp()};return p.debug("send() | calling pc.setRemoteDescription() [answer:%o]",F),await this._pc.setRemoteDescription(F),this._mapMidTransceiver.set(I,A),{localId:I,rtpParameters:T,rtpSender:A.sender}}async stopSending(m){if(this.assertSendDirection(),p.debug("stopSending() [localId:%s]",m),this._closed)return;const y=this._mapMidTransceiver.get(m);if(!y)throw new Error("associated RTCRtpTransceiver not found");if(y.sender.replaceTrack(null),this._pc.removeTrack(y.sender),this._remoteSdp.closeMediaSection(y.mid))try{y.stop()}catch{}const b=await this._pc.createOffer();p.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",b),await this._pc.setLocalDescription(b);const R={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",R),await this._pc.setRemoteDescription(R),this._mapMidTransceiver.delete(m)}async pauseSending(m){this.assertNotClosed(),this.assertSendDirection(),p.debug("pauseSending() [localId:%s]",m);const y=this._mapMidTransceiver.get(m);if(!y)throw new Error("associated RTCRtpTransceiver not found");y.direction="inactive",this._remoteSdp.pauseMediaSection(m);const b=await this._pc.createOffer();p.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",b),await this._pc.setLocalDescription(b);const R={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",R),await this._pc.setRemoteDescription(R)}async resumeSending(m){this.assertNotClosed(),this.assertSendDirection(),p.debug("resumeSending() [localId:%s]",m);const y=this._mapMidTransceiver.get(m);if(this._remoteSdp.resumeSendingMediaSection(m),!y)throw new Error("associated RTCRtpTransceiver not found");y.direction="sendonly";const b=await this._pc.createOffer();p.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",b),await this._pc.setLocalDescription(b);const R={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",R),await this._pc.setRemoteDescription(R)}async replaceTrack(m,y){this.assertNotClosed(),this.assertSendDirection(),y?p.debug("replaceTrack() [localId:%s, track.id:%s]",m,y.id):p.debug("replaceTrack() [localId:%s, no track]",m);const b=this._mapMidTransceiver.get(m);if(!b)throw new Error("associated RTCRtpTransceiver not found");await b.sender.replaceTrack(y)}async setMaxSpatialLayer(m,y){this.assertNotClosed(),this.assertSendDirection(),p.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",m,y);const b=this._mapMidTransceiver.get(m);if(!b)throw new Error("associated RTCRtpTransceiver not found");const R=b.sender.getParameters();R.encodings.forEach((C,A)=>{A<=y?C.active=!0:C.active=!1}),await b.sender.setParameters(R),this._remoteSdp.muxMediaSectionSimulcast(m,R.encodings);const T=await this._pc.createOffer();p.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",T),await this._pc.setLocalDescription(T);const w={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",w),await this._pc.setRemoteDescription(w)}async setRtpEncodingParameters(m,y){this.assertNotClosed(),this.assertSendDirection(),p.debug("setRtpEncodingParameters() [localId:%s, params:%o]",m,y);const b=this._mapMidTransceiver.get(m);if(!b)throw new Error("associated RTCRtpTransceiver not found");const R=b.sender.getParameters();R.encodings.forEach((C,A)=>{R.encodings[A]={...C,...y}}),await b.sender.setParameters(R),this._remoteSdp.muxMediaSectionSimulcast(m,R.encodings);const T=await this._pc.createOffer();p.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",T),await this._pc.setLocalDescription(T);const w={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",w),await this._pc.setRemoteDescription(w)}async getSenderStats(m){this.assertNotClosed(),this.assertSendDirection();const y=this._mapMidTransceiver.get(m);if(!y)throw new Error("associated RTCRtpTransceiver not found");return y.sender.getStats()}async sendDataChannel({ordered:m,maxPacketLifeTime:y,maxRetransmits:b,label:R,protocol:T}){this.assertNotClosed(),this.assertSendDirection();const w={negotiated:!0,id:this._nextSendSctpStreamId,ordered:m,maxPacketLifeTime:y,maxRetransmits:b,protocol:T};p.debug("sendDataChannel() [options:%o]",w);const C=this._pc.createDataChannel(R,w);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%E.MIS,!this._hasDataChannelMediaSection){const L=await this._pc.createOffer(),D=i.parse(L.sdp),P=D.media.find(M=>M.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:D}),p.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",L),await this._pc.setLocalDescription(L),this._remoteSdp.sendSctpAssociation({offerMediaObject:P});const k={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",k),await this._pc.setRemoteDescription(k),this._hasDataChannelMediaSection=!0}const A={streamId:w.id,ordered:w.ordered,maxPacketLifeTime:w.maxPacketLifeTime,maxRetransmits:w.maxRetransmits};return{dataChannel:C,sctpStreamParameters:A}}async receive(m){this.assertNotClosed(),this.assertRecvDirection();const y=[],b=new Map;for(const C of m){const{trackId:A,kind:L,rtpParameters:D,streamId:P}=C;p.debug("receive() [trackId:%s, kind:%s]",A,L);const k=D.mid??String(this._mapMidTransceiver.size);b.set(A,k),this._remoteSdp.receive({mid:k,kind:L,offerRtpParameters:D,streamId:P??D.rtcp.cname,trackId:A})}const R={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",R),await this._pc.setRemoteDescription(R);let T=await this._pc.createAnswer();const w=i.parse(T.sdp);for(const C of m){const{trackId:A,rtpParameters:L}=C,D=b.get(A),P=w.media.find(k=>String(k.mid)===D);n.applyCodecParameters({offerRtpParameters:L,answerMediaObject:P})}T={type:"answer",sdp:i.write(w)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:w}),p.debug("receive() | calling pc.setLocalDescription() [answer:%o]",T),await this._pc.setLocalDescription(T);for(const C of m){const{trackId:A}=C,L=b.get(A),D=this._pc.getTransceivers().find(P=>P.mid===L);if(D)this._mapMidTransceiver.set(L,D),y.push({localId:L,track:D.receiver.track,rtpReceiver:D.receiver});else throw new Error("new RTCRtpTransceiver not found")}return y}async stopReceiving(m){if(this.assertRecvDirection(),this._closed)return;for(const R of m){p.debug("stopReceiving() [localId:%s]",R);const T=this._mapMidTransceiver.get(R);if(!T)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(T.mid)}const y={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",y),await this._pc.setRemoteDescription(y);const b=await this._pc.createAnswer();p.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",b),await this._pc.setLocalDescription(b);for(const R of m)this._mapMidTransceiver.delete(R)}async pauseReceiving(m){this.assertNotClosed(),this.assertRecvDirection();for(const R of m){p.debug("pauseReceiving() [localId:%s]",R);const T=this._mapMidTransceiver.get(R);if(!T)throw new Error("associated RTCRtpTransceiver not found");T.direction="inactive",this._remoteSdp.pauseMediaSection(R)}const y={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",y),await this._pc.setRemoteDescription(y);const b=await this._pc.createAnswer();p.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",b),await this._pc.setLocalDescription(b)}async resumeReceiving(m){this.assertNotClosed(),this.assertRecvDirection();for(const R of m){p.debug("resumeReceiving() [localId:%s]",R);const T=this._mapMidTransceiver.get(R);if(!T)throw new Error("associated RTCRtpTransceiver not found");T.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(R)}const y={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",y),await this._pc.setRemoteDescription(y);const b=await this._pc.createAnswer();p.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",b),await this._pc.setLocalDescription(b)}async getReceiverStats(m){this.assertNotClosed(),this.assertRecvDirection();const y=this._mapMidTransceiver.get(m);if(!y)throw new Error("associated RTCRtpTransceiver not found");return y.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:m,label:y,protocol:b}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:R,ordered:T,maxPacketLifeTime:w,maxRetransmits:C}=m,A={negotiated:!0,id:R,ordered:T,maxPacketLifeTime:w,maxRetransmits:C,protocol:b};p.debug("receiveDataChannel() [options:%o]",A);const L=this._pc.createDataChannel(y,A);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const D={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",D),await this._pc.setRemoteDescription(D);const P=await this._pc.createAnswer();if(!this._transportReady){const k=i.parse(P.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:k})}p.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",P),await this._pc.setLocalDescription(P),this._hasDataChannelMediaSection=!0}return{dataChannel:L}}async setupTransport({localDtlsRole:m,localSdpObject:y}){y||(y=i.parse(this._pc.localDescription.sdp));const b=n.extractDtlsParameters({sdpObject:y});b.role=m,this._remoteSdp.updateDtlsRole(m==="client"?"server":"client"),await new Promise((R,T)=>{this.safeEmit("@connect",{dtlsParameters:b},R,T)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new l.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};return Kc.Chrome74=g,Kc}var qc={},w1;function n5(){if(w1)return qc;w1=1,Object.defineProperty(qc,"__esModule",{value:!0}),qc.Chrome70=void 0;const i=ri(),e=sr(),t=br(),r=Hr(),n=tn(),a=ga(),c=ii(),l=rn(),d=Ls(),u=new e.Logger("Chrome70"),f="Chrome70",p={OS:1024,MIS:1024};let v=class LC extends c.HandlerInterface{constructor(){super(),K(this,"_direction"),K(this,"_remoteSdp"),K(this,"_sendingRtpParametersByKind"),K(this,"_sendingRemoteRtpParametersByKind"),K(this,"_forcedLocalDtlsRole"),K(this,"_pc"),K(this,"_mapMidTransceiver",new Map),K(this,"_sendStream",new MediaStream),K(this,"_hasDataChannelMediaSection",!1),K(this,"_nextSendSctpStreamId",0),K(this,"_transportReady",!1)}static createFactory(){return()=>new LC}get name(){return f}close(){if(u.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){u.debug("getNativeRtpCapabilities()");const g=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{g.addTransceiver("audio"),g.addTransceiver("video");const _=await g.createOffer();try{g.close()}catch{}const m=i.parse(_.sdp);return n.extractRtpCapabilities({sdpObject:m})}catch(_){try{g.close()}catch{}throw _}}async getNativeSctpCapabilities(){return u.debug("getNativeSctpCapabilities()"),{numStreams:p}}run({direction:g,iceParameters:_,iceCandidates:m,dtlsParameters:y,sctpParameters:b,iceServers:R,iceTransportPolicy:T,additionalSettings:w,proprietaryConstraints:C,extendedRtpCapabilities:A}){u.debug("run()"),this._direction=g,this._remoteSdp=new l.RemoteSdp({iceParameters:_,iceCandidates:m,dtlsParameters:y,sctpParameters:b}),this._sendingRtpParametersByKind={audio:r.getSendingRtpParameters("audio",A),video:r.getSendingRtpParameters("video",A)},this._sendingRemoteRtpParametersByKind={audio:r.getSendingRemoteRtpParameters("audio",A),video:r.getSendingRemoteRtpParameters("video",A)},y.role&&y.role!=="auto"&&(this._forcedLocalDtlsRole=y.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:R??[],iceTransportPolicy:T??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...w},C),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",L=>{this.emit("@icecandidateerror",L)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(u.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(g){u.debug("updateIceServers()");const _=this._pc.getConfiguration();_.iceServers=g,this._pc.setConfiguration(_)}async restartIce(g){if(u.debug("restartIce()"),this._remoteSdp.updateIceParameters(g),!!this._transportReady)if(this._direction==="send"){const _=await this._pc.createOffer({iceRestart:!0});u.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",_),await this._pc.setLocalDescription(_);const m={type:"answer",sdp:this._remoteSdp.getSdp()};u.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",m),await this._pc.setRemoteDescription(m)}else{const _={type:"offer",sdp:this._remoteSdp.getSdp()};u.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",_),await this._pc.setRemoteDescription(_);const m=await this._pc.createAnswer();u.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",m),await this._pc.setLocalDescription(m)}}async getTransportStats(){return this._pc.getStats()}async send({track:g,encodings:_,codecOptions:m,codec:y}){this.assertSendDirection(),u.debug("send() [kind:%s, track.id:%s]",g.kind,g.id);const b=t.clone(this._sendingRtpParametersByKind[g.kind]);b.codecs=r.reduceCodecs(b.codecs,y);const R=t.clone(this._sendingRemoteRtpParametersByKind[g.kind]);R.codecs=r.reduceCodecs(R.codecs,y);const T=this._remoteSdp.getNextMediaSectionIdx(),w=this._pc.addTransceiver(g,{direction:"sendonly",streams:[this._sendStream]});let C=await this._pc.createOffer(),A=i.parse(C.sdp);A.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let L;this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:A}),_&&_.length>1&&(u.debug("send() | enabling legacy simulcast"),A=i.parse(C.sdp),L=A.media[T.idx],a.addLegacySimulcast({offerMediaObject:L,numStreams:_.length}),C={type:"offer",sdp:i.write(A)});let D=!1;const P=(0,d.parse)((_??[{}])[0].scalabilityMode);if(_&&_.length===1&&P.spatialLayers>1&&b.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(u.debug("send() | enabling legacy simulcast for VP9 SVC"),D=!0,A=i.parse(C.sdp),L=A.media[T.idx],a.addLegacySimulcast({offerMediaObject:L,numStreams:P.spatialLayers}),C={type:"offer",sdp:i.write(A)}),u.debug("send() | calling pc.setLocalDescription() [offer:%o]",C),await this._pc.setLocalDescription(C),_){u.debug("send() | applying given encodings");const I=w.sender.getParameters();for(let F=0;F<(I.encodings??[]).length;++F){const $=I.encodings[F],N=_[F];if(!N)break;I.encodings[F]=Object.assign($,N)}await w.sender.setParameters(I)}const k=w.mid;if(b.mid=k,A=i.parse(this._pc.localDescription.sdp),L=A.media[T.idx],b.rtcp.cname=n.getCname({offerMediaObject:L}),b.encodings=a.getRtpEncodings({offerMediaObject:L}),_)for(let I=0;I<b.encodings.length;++I)_[I]&&Object.assign(b.encodings[I],_[I]);if(D&&(b.encodings=[b.encodings[0]]),b.encodings.length>1&&(b.codecs[0].mimeType.toLowerCase()==="video/vp8"||b.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const I of b.encodings)I.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:L,reuseMid:T.reuseMid,offerRtpParameters:b,answerRtpParameters:R,codecOptions:m});const M={type:"answer",sdp:this._remoteSdp.getSdp()};return u.debug("send() | calling pc.setRemoteDescription() [answer:%o]",M),await this._pc.setRemoteDescription(M),this._mapMidTransceiver.set(k,w),{localId:k,rtpParameters:b,rtpSender:w.sender}}async stopSending(g){this.assertSendDirection(),u.debug("stopSending() [localId:%s]",g);const _=this._mapMidTransceiver.get(g);if(!_)throw new Error("associated RTCRtpTransceiver not found");if(_.sender.replaceTrack(null),this._pc.removeTrack(_.sender),this._remoteSdp.closeMediaSection(_.mid))try{_.stop()}catch{}const m=await this._pc.createOffer();u.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",m),await this._pc.setLocalDescription(m);const y={type:"answer",sdp:this._remoteSdp.getSdp()};u.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",y),await this._pc.setRemoteDescription(y),this._mapMidTransceiver.delete(g)}async pauseSending(g){}async resumeSending(g){}async replaceTrack(g,_){this.assertSendDirection(),_?u.debug("replaceTrack() [localId:%s, track.id:%s]",g,_.id):u.debug("replaceTrack() [localId:%s, no track]",g);const m=this._mapMidTransceiver.get(g);if(!m)throw new Error("associated RTCRtpTransceiver not found");await m.sender.replaceTrack(_)}async setMaxSpatialLayer(g,_){this.assertSendDirection(),u.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",g,_);const m=this._mapMidTransceiver.get(g);if(!m)throw new Error("associated RTCRtpTransceiver not found");const y=m.sender.getParameters();y.encodings.forEach((T,w)=>{w<=_?T.active=!0:T.active=!1}),await m.sender.setParameters(y),this._remoteSdp.muxMediaSectionSimulcast(g,y.encodings);const b=await this._pc.createOffer();u.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",b),await this._pc.setLocalDescription(b);const R={type:"answer",sdp:this._remoteSdp.getSdp()};u.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",R),await this._pc.setRemoteDescription(R)}async setRtpEncodingParameters(g,_){this.assertSendDirection(),u.debug("setRtpEncodingParameters() [localId:%s, params:%o]",g,_);const m=this._mapMidTransceiver.get(g);if(!m)throw new Error("associated RTCRtpTransceiver not found");const y=m.sender.getParameters();y.encodings.forEach((T,w)=>{y.encodings[w]={...T,..._}}),await m.sender.setParameters(y),this._remoteSdp.muxMediaSectionSimulcast(g,y.encodings);const b=await this._pc.createOffer();u.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",b),await this._pc.setLocalDescription(b);const R={type:"answer",sdp:this._remoteSdp.getSdp()};u.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",R),await this._pc.setRemoteDescription(R)}async getSenderStats(g){this.assertSendDirection();const _=this._mapMidTransceiver.get(g);if(!_)throw new Error("associated RTCRtpTransceiver not found");return _.sender.getStats()}async sendDataChannel({ordered:g,maxPacketLifeTime:_,maxRetransmits:m,label:y,protocol:b}){this.assertSendDirection();const R={negotiated:!0,id:this._nextSendSctpStreamId,ordered:g,maxPacketLifeTime:_,maxRetransmitTime:_,maxRetransmits:m,protocol:b};u.debug("sendDataChannel() [options:%o]",R);const T=this._pc.createDataChannel(y,R);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%p.MIS,!this._hasDataChannelMediaSection){const C=await this._pc.createOffer(),A=i.parse(C.sdp),L=A.media.find(P=>P.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:A}),u.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",C),await this._pc.setLocalDescription(C),this._remoteSdp.sendSctpAssociation({offerMediaObject:L});const D={type:"answer",sdp:this._remoteSdp.getSdp()};u.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",D),await this._pc.setRemoteDescription(D),this._hasDataChannelMediaSection=!0}const w={streamId:R.id,ordered:R.ordered,maxPacketLifeTime:R.maxPacketLifeTime,maxRetransmits:R.maxRetransmits};return{dataChannel:T,sctpStreamParameters:w}}async receive(g){this.assertRecvDirection();const _=[],m=new Map;for(const T of g){const{trackId:w,kind:C,rtpParameters:A,streamId:L}=T;u.debug("receive() [trackId:%s, kind:%s]",w,C);const D=A.mid??String(this._mapMidTransceiver.size);m.set(w,D),this._remoteSdp.receive({mid:D,kind:C,offerRtpParameters:A,streamId:L??A.rtcp.cname,trackId:w})}const y={type:"offer",sdp:this._remoteSdp.getSdp()};u.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",y),await this._pc.setRemoteDescription(y);let b=await this._pc.createAnswer();const R=i.parse(b.sdp);for(const T of g){const{trackId:w,rtpParameters:C}=T,A=m.get(w),L=R.media.find(D=>String(D.mid)===A);n.applyCodecParameters({offerRtpParameters:C,answerMediaObject:L})}b={type:"answer",sdp:i.write(R)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:R}),u.debug("receive() | calling pc.setLocalDescription() [answer:%o]",b),await this._pc.setLocalDescription(b);for(const T of g){const{trackId:w}=T,C=m.get(w),A=this._pc.getTransceivers().find(L=>L.mid===C);if(!A)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(C,A),_.push({localId:C,track:A.receiver.track,rtpReceiver:A.receiver})}return _}async stopReceiving(g){this.assertRecvDirection();for(const y of g){u.debug("stopReceiving() [localId:%s]",y);const b=this._mapMidTransceiver.get(y);if(!b)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(b.mid)}const _={type:"offer",sdp:this._remoteSdp.getSdp()};u.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",_),await this._pc.setRemoteDescription(_);const m=await this._pc.createAnswer();u.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",m),await this._pc.setLocalDescription(m);for(const y of g)this._mapMidTransceiver.delete(y)}async pauseReceiving(g){}async resumeReceiving(g){}async getReceiverStats(g){this.assertRecvDirection();const _=this._mapMidTransceiver.get(g);if(!_)throw new Error("associated RTCRtpTransceiver not found");return _.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:g,label:_,protocol:m}){this.assertRecvDirection();const{streamId:y,ordered:b,maxPacketLifeTime:R,maxRetransmits:T}=g,w={negotiated:!0,id:y,ordered:b,maxPacketLifeTime:R,maxRetransmitTime:R,maxRetransmits:T,protocol:m};u.debug("receiveDataChannel() [options:%o]",w);const C=this._pc.createDataChannel(_,w);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const A={type:"offer",sdp:this._remoteSdp.getSdp()};u.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",A),await this._pc.setRemoteDescription(A);const L=await this._pc.createAnswer();if(!this._transportReady){const D=i.parse(L.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:D})}u.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",L),await this._pc.setLocalDescription(L),this._hasDataChannelMediaSection=!0}return{dataChannel:C}}async setupTransport({localDtlsRole:g,localSdpObject:_}){_||(_=i.parse(this._pc.localDescription.sdp));const m=n.extractDtlsParameters({sdpObject:_});m.role=g,this._remoteSdp.updateDtlsRole(g==="client"?"server":"client"),await new Promise((y,b)=>{this.safeEmit("@connect",{dtlsParameters:m},y,b)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};return qc.Chrome70=v,qc}var Yc={},Wc={},T1;function kf(){if(T1)return Wc;T1=1,Object.defineProperty(Wc,"__esModule",{value:!0}),Wc.getRtpEncodings=i,Wc.addLegacySimulcast=e;function i({offerMediaObject:t,track:r}){const n=new Set;for(const l of t.ssrcs??[])if(l.attribute==="msid"&&l.value.split(" ")[1]===r.id){const d=l.id;n.add(d)}if(n.size===0)throw new Error(`a=ssrc line with msid information not found [track.id:${r.id}]`);const a=new Map;for(const l of t.ssrcGroups??[]){if(l.semantics!=="FID")continue;let[d,u]=l.ssrcs.split(/\s+/);d=Number(d),u=Number(u),n.has(d)&&(n.delete(d),n.delete(u),a.set(d,u))}for(const l of n)a.set(l,null);const c=[];for(const[l,d]of a){const u={ssrc:l};d&&(u.rtx={ssrc:d}),c.push(u)}return c}function e({offerMediaObject:t,track:r,numStreams:n}){if(n<=1)throw new TypeError("numStreams must be greater than 1");let a,c,l;if(!(t.ssrcs??[]).find(v=>v.attribute!=="msid"?!1:v.value.split(" ")[1]===r.id?(a=v.id,l=v.value.split(" ")[0],!0):!1))throw new Error(`a=ssrc line with msid information not found [track.id:${r.id}]`);(t.ssrcGroups??[]).some(v=>{if(v.semantics!=="FID")return!1;const E=v.ssrcs.split(/\s+/);return Number(E[0])===a?(c=Number(E[1]),!0):!1});const d=t.ssrcs.find(v=>v.attribute==="cname"&&v.id===a);if(!d)throw new Error(`a=ssrc line with cname information not found [track.id:${r.id}]`);const u=d.value,f=[],p=[];for(let v=0;v<n;++v)f.push(a+v),c&&p.push(c+v);t.ssrcGroups=t.ssrcGroups??[],t.ssrcs=t.ssrcs??[],t.ssrcGroups.push({semantics:"SIM",ssrcs:f.join(" ")});for(const v of f)t.ssrcs.push({id:v,attribute:"cname",value:u}),t.ssrcs.push({id:v,attribute:"msid",value:`${l} ${r.id}`});for(let v=0;v<p.length;++v){const E=f[v],g=p[v];t.ssrcs.push({id:g,attribute:"cname",value:u}),t.ssrcs.push({id:g,attribute:"msid",value:`${l} ${r.id}`}),t.ssrcGroups.push({semantics:"FID",ssrcs:`${E} ${g}`})}}return Wc}var C1;function s5(){if(C1)return Yc;C1=1,Object.defineProperty(Yc,"__esModule",{value:!0}),Yc.Chrome67=void 0;const i=ri(),e=sr(),t=br(),r=Hr(),n=tn(),a=kf(),c=ii(),l=rn(),d=new e.Logger("Chrome67"),u="Chrome67",f={OS:1024,MIS:1024};let p=class OC extends c.HandlerInterface{constructor(){super(),K(this,"_direction"),K(this,"_remoteSdp"),K(this,"_sendingRtpParametersByKind"),K(this,"_sendingRemoteRtpParametersByKind"),K(this,"_forcedLocalDtlsRole"),K(this,"_pc"),K(this,"_sendStream",new MediaStream),K(this,"_mapSendLocalIdRtpSender",new Map),K(this,"_nextSendLocalId",0),K(this,"_mapRecvLocalIdInfo",new Map),K(this,"_hasDataChannelMediaSection",!1),K(this,"_nextSendSctpStreamId",0),K(this,"_transportReady",!1)}static createFactory(){return()=>new OC}get name(){return u}close(){if(d.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){d.debug("getNativeRtpCapabilities()");const E=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const g=await E.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{E.close()}catch{}const _=i.parse(g.sdp);return n.extractRtpCapabilities({sdpObject:_})}catch(g){try{E.close()}catch{}throw g}}async getNativeSctpCapabilities(){return d.debug("getNativeSctpCapabilities()"),{numStreams:f}}run({direction:E,iceParameters:g,iceCandidates:_,dtlsParameters:m,sctpParameters:y,iceServers:b,iceTransportPolicy:R,additionalSettings:T,proprietaryConstraints:w,extendedRtpCapabilities:C}){d.debug("run()"),this._direction=E,this._remoteSdp=new l.RemoteSdp({iceParameters:g,iceCandidates:_,dtlsParameters:m,sctpParameters:y,planB:!0}),this._sendingRtpParametersByKind={audio:r.getSendingRtpParameters("audio",C),video:r.getSendingRtpParameters("video",C)},this._sendingRemoteRtpParametersByKind={audio:r.getSendingRemoteRtpParameters("audio",C),video:r.getSendingRemoteRtpParameters("video",C)},m.role&&m.role!=="auto"&&(this._forcedLocalDtlsRole=m.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:b??[],iceTransportPolicy:R??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...T},w),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",A=>{this.emit("@icecandidateerror",A)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(d.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(E){d.debug("updateIceServers()");const g=this._pc.getConfiguration();g.iceServers=E,this._pc.setConfiguration(g)}async restartIce(E){if(d.debug("restartIce()"),this._remoteSdp.updateIceParameters(E),!!this._transportReady)if(this._direction==="send"){const g=await this._pc.createOffer({iceRestart:!0});d.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",g),await this._pc.setLocalDescription(g);const _={type:"answer",sdp:this._remoteSdp.getSdp()};d.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",_),await this._pc.setRemoteDescription(_)}else{const g={type:"offer",sdp:this._remoteSdp.getSdp()};d.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",g),await this._pc.setRemoteDescription(g);const _=await this._pc.createAnswer();d.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",_),await this._pc.setLocalDescription(_)}}async getTransportStats(){return this._pc.getStats()}async send({track:E,encodings:g,codecOptions:_,codec:m}){this.assertSendDirection(),d.debug("send() [kind:%s, track.id:%s]",E.kind,E.id),m&&d.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(E),this._pc.addTrack(E,this._sendStream);let y=await this._pc.createOffer(),b=i.parse(y.sdp);b.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let R;const T=t.clone(this._sendingRtpParametersByKind[E.kind]);T.codecs=r.reduceCodecs(T.codecs);const w=t.clone(this._sendingRemoteRtpParametersByKind[E.kind]);if(w.codecs=r.reduceCodecs(w.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:b}),E.kind==="video"&&g&&g.length>1&&(d.debug("send() | enabling simulcast"),b=i.parse(y.sdp),R=b.media.find(D=>D.type==="video"),a.addLegacySimulcast({offerMediaObject:R,track:E,numStreams:g.length}),y={type:"offer",sdp:i.write(b)}),d.debug("send() | calling pc.setLocalDescription() [offer:%o]",y),await this._pc.setLocalDescription(y),b=i.parse(this._pc.localDescription.sdp),R=b.media.find(D=>D.type===E.kind),T.rtcp.cname=n.getCname({offerMediaObject:R}),T.encodings=a.getRtpEncodings({offerMediaObject:R,track:E}),g)for(let D=0;D<T.encodings.length;++D)g[D]&&Object.assign(T.encodings[D],g[D]);if(T.encodings.length>1&&T.codecs[0].mimeType.toLowerCase()==="video/vp8")for(const D of T.encodings)D.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:R,offerRtpParameters:T,answerRtpParameters:w,codecOptions:_});const C={type:"answer",sdp:this._remoteSdp.getSdp()};d.debug("send() | calling pc.setRemoteDescription() [answer:%o]",C),await this._pc.setRemoteDescription(C);const A=String(this._nextSendLocalId);this._nextSendLocalId++;const L=this._pc.getSenders().find(D=>D.track===E);return this._mapSendLocalIdRtpSender.set(A,L),{localId:A,rtpParameters:T,rtpSender:L}}async stopSending(E){this.assertSendDirection(),d.debug("stopSending() [localId:%s]",E);const g=this._mapSendLocalIdRtpSender.get(E);if(!g)throw new Error("associated RTCRtpSender not found");this._pc.removeTrack(g),g.track&&this._sendStream.removeTrack(g.track),this._mapSendLocalIdRtpSender.delete(E);const _=await this._pc.createOffer();d.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",_);try{await this._pc.setLocalDescription(_)}catch(y){if(this._sendStream.getTracks().length===0){d.warn("stopSending() | ignoring expected error due no sending tracks: %s",y.toString());return}throw y}if(this._pc.signalingState==="stable")return;const m={type:"answer",sdp:this._remoteSdp.getSdp()};d.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",m),await this._pc.setRemoteDescription(m)}async pauseSending(E){}async resumeSending(E){}async replaceTrack(E,g){this.assertSendDirection(),g?d.debug("replaceTrack() [localId:%s, track.id:%s]",E,g.id):d.debug("replaceTrack() [localId:%s, no track]",E);const _=this._mapSendLocalIdRtpSender.get(E);if(!_)throw new Error("associated RTCRtpSender not found");const m=_.track;await _.replaceTrack(g),m&&this._sendStream.removeTrack(m),g&&this._sendStream.addTrack(g)}async setMaxSpatialLayer(E,g){this.assertSendDirection(),d.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",E,g);const _=this._mapSendLocalIdRtpSender.get(E);if(!_)throw new Error("associated RTCRtpSender not found");const m=_.getParameters();m.encodings.forEach((y,b)=>{b<=g?y.active=!0:y.active=!1}),await _.setParameters(m)}async setRtpEncodingParameters(E,g){this.assertSendDirection(),d.debug("setRtpEncodingParameters() [localId:%s, params:%o]",E,g);const _=this._mapSendLocalIdRtpSender.get(E);if(!_)throw new Error("associated RTCRtpSender not found");const m=_.getParameters();m.encodings.forEach((y,b)=>{m.encodings[b]={...y,...g}}),await _.setParameters(m)}async getSenderStats(E){this.assertSendDirection();const g=this._mapSendLocalIdRtpSender.get(E);if(!g)throw new Error("associated RTCRtpSender not found");return g.getStats()}async sendDataChannel({ordered:E,maxPacketLifeTime:g,maxRetransmits:_,label:m,protocol:y}){this.assertSendDirection();const b={negotiated:!0,id:this._nextSendSctpStreamId,ordered:E,maxPacketLifeTime:g,maxRetransmitTime:g,maxRetransmits:_,protocol:y};d.debug("sendDataChannel() [options:%o]",b);const R=this._pc.createDataChannel(m,b);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%f.MIS,!this._hasDataChannelMediaSection){const w=await this._pc.createOffer(),C=i.parse(w.sdp),A=C.media.find(D=>D.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:C}),d.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",w),await this._pc.setLocalDescription(w),this._remoteSdp.sendSctpAssociation({offerMediaObject:A});const L={type:"answer",sdp:this._remoteSdp.getSdp()};d.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",L),await this._pc.setRemoteDescription(L),this._hasDataChannelMediaSection=!0}const T={streamId:b.id,ordered:b.ordered,maxPacketLifeTime:b.maxPacketLifeTime,maxRetransmits:b.maxRetransmits};return{dataChannel:R,sctpStreamParameters:T}}async receive(E){this.assertRecvDirection();const g=[];for(const b of E){const{trackId:R,kind:T,rtpParameters:w,streamId:C}=b;d.debug("receive() [trackId:%s, kind:%s]",R,T);const A=T;this._remoteSdp.receive({mid:A,kind:T,offerRtpParameters:w,streamId:C??w.rtcp.cname,trackId:R})}const _={type:"offer",sdp:this._remoteSdp.getSdp()};d.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",_),await this._pc.setRemoteDescription(_);let m=await this._pc.createAnswer();const y=i.parse(m.sdp);for(const b of E){const{kind:R,rtpParameters:T}=b,w=R,C=y.media.find(A=>String(A.mid)===w);n.applyCodecParameters({offerRtpParameters:T,answerMediaObject:C})}m={type:"answer",sdp:i.write(y)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:y}),d.debug("receive() | calling pc.setLocalDescription() [answer:%o]",m),await this._pc.setLocalDescription(m);for(const b of E){const{kind:R,trackId:T,rtpParameters:w}=b,C=T,A=R,L=this._pc.getReceivers().find(D=>D.track&&D.track.id===C);if(!L)throw new Error("new RTCRtpReceiver not");this._mapRecvLocalIdInfo.set(C,{mid:A,rtpParameters:w,rtpReceiver:L}),g.push({localId:C,track:L.track,rtpReceiver:L})}return g}async stopReceiving(E){this.assertRecvDirection();for(const m of E){d.debug("stopReceiving() [localId:%s]",m);const{mid:y,rtpParameters:b}=this._mapRecvLocalIdInfo.get(m)??{};this._mapRecvLocalIdInfo.delete(m),this._remoteSdp.planBStopReceiving({mid:y,offerRtpParameters:b})}const g={type:"offer",sdp:this._remoteSdp.getSdp()};d.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",g),await this._pc.setRemoteDescription(g);const _=await this._pc.createAnswer();d.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",_),await this._pc.setLocalDescription(_)}async pauseReceiving(E){}async resumeReceiving(E){}async getReceiverStats(E){this.assertRecvDirection();const{rtpReceiver:g}=this._mapRecvLocalIdInfo.get(E)??{};if(!g)throw new Error("associated RTCRtpReceiver not found");return g.getStats()}async receiveDataChannel({sctpStreamParameters:E,label:g,protocol:_}){this.assertRecvDirection();const{streamId:m,ordered:y,maxPacketLifeTime:b,maxRetransmits:R}=E,T={negotiated:!0,id:m,ordered:y,maxPacketLifeTime:b,maxRetransmitTime:b,maxRetransmits:R,protocol:_};d.debug("receiveDataChannel() [options:%o]",T);const w=this._pc.createDataChannel(g,T);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const C={type:"offer",sdp:this._remoteSdp.getSdp()};d.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",C),await this._pc.setRemoteDescription(C);const A=await this._pc.createAnswer();if(!this._transportReady){const L=i.parse(A.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:L})}d.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",A),await this._pc.setLocalDescription(A),this._hasDataChannelMediaSection=!0}return{dataChannel:w}}async setupTransport({localDtlsRole:E,localSdpObject:g}){g||(g=i.parse(this._pc.localDescription.sdp));const _=n.extractDtlsParameters({sdpObject:g});_.role=E,this._remoteSdp.updateDtlsRole(E==="client"?"server":"client"),await new Promise((m,y)=>{this.safeEmit("@connect",{dtlsParameters:_},m,y)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};return Yc.Chrome67=p,Yc}var Xc={},A1;function a5(){if(A1)return Xc;A1=1,Object.defineProperty(Xc,"__esModule",{value:!0}),Xc.Chrome55=void 0;const i=ri(),e=sr(),t=Gr(),r=br(),n=Hr(),a=tn(),c=kf(),l=ii(),d=rn(),u=new e.Logger("Chrome55"),f="Chrome55",p={OS:1024,MIS:1024};let v=class IC extends l.HandlerInterface{constructor(){super(),K(this,"_direction"),K(this,"_remoteSdp"),K(this,"_sendingRtpParametersByKind"),K(this,"_sendingRemoteRtpParametersByKind"),K(this,"_forcedLocalDtlsRole"),K(this,"_pc"),K(this,"_sendStream",new MediaStream),K(this,"_mapSendLocalIdTrack",new Map),K(this,"_nextSendLocalId",0),K(this,"_mapRecvLocalIdInfo",new Map),K(this,"_hasDataChannelMediaSection",!1),K(this,"_nextSendSctpStreamId",0),K(this,"_transportReady",!1)}static createFactory(){return()=>new IC}get name(){return f}close(){if(u.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){u.debug("getNativeRtpCapabilities()");const g=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const _=await g.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{g.close()}catch{}const m=i.parse(_.sdp);return a.extractRtpCapabilities({sdpObject:m})}catch(_){try{g.close()}catch{}throw _}}async getNativeSctpCapabilities(){return u.debug("getNativeSctpCapabilities()"),{numStreams:p}}run({direction:g,iceParameters:_,iceCandidates:m,dtlsParameters:y,sctpParameters:b,iceServers:R,iceTransportPolicy:T,additionalSettings:w,proprietaryConstraints:C,extendedRtpCapabilities:A}){u.debug("run()"),this._direction=g,this._remoteSdp=new d.RemoteSdp({iceParameters:_,iceCandidates:m,dtlsParameters:y,sctpParameters:b,planB:!0}),this._sendingRtpParametersByKind={audio:n.getSendingRtpParameters("audio",A),video:n.getSendingRtpParameters("video",A)},this._sendingRemoteRtpParametersByKind={audio:n.getSendingRemoteRtpParameters("audio",A),video:n.getSendingRemoteRtpParameters("video",A)},y.role&&y.role!=="auto"&&(this._forcedLocalDtlsRole=y.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:R??[],iceTransportPolicy:T??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...w},C),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",L=>{this.emit("@icecandidateerror",L)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(u.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(g){u.debug("updateIceServers()");const _=this._pc.getConfiguration();_.iceServers=g,this._pc.setConfiguration(_)}async restartIce(g){if(u.debug("restartIce()"),this._remoteSdp.updateIceParameters(g),!!this._transportReady)if(this._direction==="send"){const _=await this._pc.createOffer({iceRestart:!0});u.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",_),await this._pc.setLocalDescription(_);const m={type:"answer",sdp:this._remoteSdp.getSdp()};u.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",m),await this._pc.setRemoteDescription(m)}else{const _={type:"offer",sdp:this._remoteSdp.getSdp()};u.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",_),await this._pc.setRemoteDescription(_);const m=await this._pc.createAnswer();u.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",m),await this._pc.setLocalDescription(m)}}async getTransportStats(){return this._pc.getStats()}async send({track:g,encodings:_,codecOptions:m,codec:y}){this.assertSendDirection(),u.debug("send() [kind:%s, track.id:%s]",g.kind,g.id),y&&u.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(g),this._pc.addStream(this._sendStream);let b=await this._pc.createOffer(),R=i.parse(b.sdp);R.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let T;const w=r.clone(this._sendingRtpParametersByKind[g.kind]);w.codecs=n.reduceCodecs(w.codecs);const C=r.clone(this._sendingRemoteRtpParametersByKind[g.kind]);if(C.codecs=n.reduceCodecs(C.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:R}),g.kind==="video"&&_&&_.length>1&&(u.debug("send() | enabling simulcast"),R=i.parse(b.sdp),T=R.media.find(D=>D.type==="video"),c.addLegacySimulcast({offerMediaObject:T,track:g,numStreams:_.length}),b={type:"offer",sdp:i.write(R)}),u.debug("send() | calling pc.setLocalDescription() [offer:%o]",b),await this._pc.setLocalDescription(b),R=i.parse(this._pc.localDescription.sdp),T=R.media.find(D=>D.type===g.kind),w.rtcp.cname=a.getCname({offerMediaObject:T}),w.encodings=c.getRtpEncodings({offerMediaObject:T,track:g}),_)for(let D=0;D<w.encodings.length;++D)_[D]&&Object.assign(w.encodings[D],_[D]);if(w.encodings.length>1&&w.codecs[0].mimeType.toLowerCase()==="video/vp8")for(const D of w.encodings)D.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:T,offerRtpParameters:w,answerRtpParameters:C,codecOptions:m});const A={type:"answer",sdp:this._remoteSdp.getSdp()};u.debug("send() | calling pc.setRemoteDescription() [answer:%o]",A),await this._pc.setRemoteDescription(A);const L=String(this._nextSendLocalId);return this._nextSendLocalId++,this._mapSendLocalIdTrack.set(L,g),{localId:L,rtpParameters:w}}async stopSending(g){this.assertSendDirection(),u.debug("stopSending() [localId:%s]",g);const _=this._mapSendLocalIdTrack.get(g);if(!_)throw new Error("track not found");this._mapSendLocalIdTrack.delete(g),this._sendStream.removeTrack(_),this._pc.addStream(this._sendStream);const m=await this._pc.createOffer();u.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",m);try{await this._pc.setLocalDescription(m)}catch(b){if(this._sendStream.getTracks().length===0){u.warn("stopSending() | ignoring expected error due no sending tracks: %s",b.toString());return}throw b}if(this._pc.signalingState==="stable")return;const y={type:"answer",sdp:this._remoteSdp.getSdp()};u.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",y),await this._pc.setRemoteDescription(y)}async pauseSending(g){}async resumeSending(g){}async replaceTrack(g,_){throw new t.UnsupportedError("not implemented")}async setMaxSpatialLayer(g,_){throw new t.UnsupportedError(" not implemented")}async setRtpEncodingParameters(g,_){throw new t.UnsupportedError("not supported")}async getSenderStats(g){throw new t.UnsupportedError("not implemented")}async sendDataChannel({ordered:g,maxPacketLifeTime:_,maxRetransmits:m,label:y,protocol:b}){this.assertSendDirection();const R={negotiated:!0,id:this._nextSendSctpStreamId,ordered:g,maxPacketLifeTime:_,maxRetransmitTime:_,maxRetransmits:m,protocol:b};u.debug("sendDataChannel() [options:%o]",R);const T=this._pc.createDataChannel(y,R);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%p.MIS,!this._hasDataChannelMediaSection){const C=await this._pc.createOffer(),A=i.parse(C.sdp),L=A.media.find(P=>P.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:A}),u.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",C),await this._pc.setLocalDescription(C),this._remoteSdp.sendSctpAssociation({offerMediaObject:L});const D={type:"answer",sdp:this._remoteSdp.getSdp()};u.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",D),await this._pc.setRemoteDescription(D),this._hasDataChannelMediaSection=!0}const w={streamId:R.id,ordered:R.ordered,maxPacketLifeTime:R.maxPacketLifeTime,maxRetransmits:R.maxRetransmits};return{dataChannel:T,sctpStreamParameters:w}}async receive(g){this.assertRecvDirection();const _=[];for(const R of g){const{trackId:T,kind:w,rtpParameters:C,streamId:A}=R;u.debug("receive() [trackId:%s, kind:%s]",T,w);const L=w;this._remoteSdp.receive({mid:L,kind:w,offerRtpParameters:C,streamId:A??C.rtcp.cname,trackId:T})}const m={type:"offer",sdp:this._remoteSdp.getSdp()};u.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",m),await this._pc.setRemoteDescription(m);let y=await this._pc.createAnswer();const b=i.parse(y.sdp);for(const R of g){const{kind:T,rtpParameters:w}=R,C=T,A=b.media.find(L=>String(L.mid)===C);a.applyCodecParameters({offerRtpParameters:w,answerMediaObject:A})}y={type:"answer",sdp:i.write(b)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:b}),u.debug("receive() | calling pc.setLocalDescription() [answer:%o]",y),await this._pc.setLocalDescription(y);for(const R of g){const{kind:T,trackId:w,rtpParameters:C}=R,A=T,L=w,D=R.streamId??C.rtcp.cname,P=this._pc.getRemoteStreams().find(k=>k.id===D).getTrackById(L);if(!P)throw new Error("remote track not found");this._mapRecvLocalIdInfo.set(L,{mid:A,rtpParameters:C}),_.push({localId:L,track:P})}return _}async stopReceiving(g){this.assertRecvDirection();for(const y of g){u.debug("stopReceiving() [localId:%s]",y);const{mid:b,rtpParameters:R}=this._mapRecvLocalIdInfo.get(y)??{};this._mapRecvLocalIdInfo.delete(y),this._remoteSdp.planBStopReceiving({mid:b,offerRtpParameters:R})}const _={type:"offer",sdp:this._remoteSdp.getSdp()};u.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",_),await this._pc.setRemoteDescription(_);const m=await this._pc.createAnswer();u.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",m),await this._pc.setLocalDescription(m)}async pauseReceiving(g){}async resumeReceiving(g){}async getReceiverStats(g){throw new t.UnsupportedError("not implemented")}async receiveDataChannel({sctpStreamParameters:g,label:_,protocol:m}){this.assertRecvDirection();const{streamId:y,ordered:b,maxPacketLifeTime:R,maxRetransmits:T}=g,w={negotiated:!0,id:y,ordered:b,maxPacketLifeTime:R,maxRetransmitTime:R,maxRetransmits:T,protocol:m};u.debug("receiveDataChannel() [options:%o]",w);const C=this._pc.createDataChannel(_,w);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const A={type:"offer",sdp:this._remoteSdp.getSdp()};u.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",A),await this._pc.setRemoteDescription(A);const L=await this._pc.createAnswer();if(!this._transportReady){const D=i.parse(L.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:D})}u.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",L),await this._pc.setLocalDescription(L),this._hasDataChannelMediaSection=!0}return{dataChannel:C}}async setupTransport({localDtlsRole:g,localSdpObject:_}){_||(_=i.parse(this._pc.localDescription.sdp));const m=a.extractDtlsParameters({sdpObject:_});m.role=g,this._remoteSdp.updateDtlsRole(g==="client"?"server":"client"),await new Promise((y,b)=>{this.safeEmit("@connect",{dtlsParameters:m},y,b)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};return Xc.Chrome55=v,Xc}var Qc={},x1;function o5(){if(x1)return Qc;x1=1,Object.defineProperty(Qc,"__esModule",{value:!0}),Qc.Firefox120=void 0;const i=ri(),e=sr(),t=Gr(),r=br(),n=Hr(),a=tn(),c=ga(),l=ii(),d=rn(),u=Ls(),f=new e.Logger("Firefox120"),p="Firefox120",v={OS:16,MIS:2048};let E=class PC extends l.HandlerInterface{constructor(){super(),K(this,"_closed",!1),K(this,"_direction"),K(this,"_remoteSdp"),K(this,"_sendingRtpParametersByKind"),K(this,"_sendingRemoteRtpParametersByKind"),K(this,"_pc"),K(this,"_mapMidTransceiver",new Map),K(this,"_sendStream",new MediaStream),K(this,"_hasDataChannelMediaSection",!1),K(this,"_nextSendSctpStreamId",0),K(this,"_transportReady",!1)}static createFactory(){return()=>new PC}get name(){return p}close(){if(f.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){f.debug("getNativeRtpCapabilities()");const _=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),m=document.createElement("canvas");m.getContext("2d");const y=m.captureStream().getVideoTracks()[0];try{_.addTransceiver("audio",{direction:"sendrecv"}),_.addTransceiver(y,{direction:"sendrecv",sendEncodings:[{rid:"r0",maxBitrate:1e5},{rid:"r1",maxBitrate:5e5}]});const b=await _.createOffer();try{m.remove()}catch{}try{y.stop()}catch{}try{_.close()}catch{}const R=i.parse(b.sdp);return a.extractRtpCapabilities({sdpObject:R})}catch(b){try{m.remove()}catch{}try{y.stop()}catch{}try{_.close()}catch{}throw b}}async getNativeSctpCapabilities(){return f.debug("getNativeSctpCapabilities()"),{numStreams:v}}run({direction:_,iceParameters:m,iceCandidates:y,dtlsParameters:b,sctpParameters:R,iceServers:T,iceTransportPolicy:w,additionalSettings:C,proprietaryConstraints:A,extendedRtpCapabilities:L}){this.assertNotClosed(),f.debug("run()"),this._direction=_,this._remoteSdp=new d.RemoteSdp({iceParameters:m,iceCandidates:y,dtlsParameters:b,sctpParameters:R}),this._sendingRtpParametersByKind={audio:n.getSendingRtpParameters("audio",L),video:n.getSendingRtpParameters("video",L)},this._sendingRemoteRtpParametersByKind={audio:n.getSendingRemoteRtpParameters("audio",L),video:n.getSendingRemoteRtpParameters("video",L)},this._pc=new RTCPeerConnection({iceServers:T??[],iceTransportPolicy:w??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...C},A),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",D=>{this.emit("@icecandidateerror",D)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(f.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(_){throw this.assertNotClosed(),new t.UnsupportedError("not supported")}async restartIce(_){if(this.assertNotClosed(),f.debug("restartIce()"),this._remoteSdp.updateIceParameters(_),!!this._transportReady)if(this._direction==="send"){const m=await this._pc.createOffer({iceRestart:!0});f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",m),await this._pc.setLocalDescription(m);const y={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",y),await this._pc.setRemoteDescription(y)}else{const m={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",m),await this._pc.setRemoteDescription(m);const y=await this._pc.createAnswer();f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",y),await this._pc.setLocalDescription(y)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:_,encodings:m,codecOptions:y,codec:b,onRtpSender:R}){this.assertNotClosed(),this.assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",_.kind,_.id),m&&m.length>1&&m.forEach((I,F)=>{I.rid=`r${F}`});const T=r.clone(this._sendingRtpParametersByKind[_.kind]);T.codecs=n.reduceCodecs(T.codecs,b);const w=r.clone(this._sendingRemoteRtpParametersByKind[_.kind]);w.codecs=n.reduceCodecs(w.codecs,b);const C=this._pc.addTransceiver(_,{direction:"sendonly",streams:[this._sendStream],sendEncodings:m});R&&R(C.sender);const A=await this._pc.createOffer();let L=i.parse(A.sdp);L.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed(),this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:L});const D=(0,u.parse)((m??[{}])[0].scalabilityMode);f.debug("send() | calling pc.setLocalDescription() [offer:%o]",A),await this._pc.setLocalDescription(A);const P=C.mid;T.mid=P,L=i.parse(this._pc.localDescription.sdp);const k=L.media[L.media.length-1];if(T.rtcp.cname=a.getCname({offerMediaObject:k}),!m)T.encodings=c.getRtpEncodings({offerMediaObject:k});else if(m.length===1){const I=c.getRtpEncodings({offerMediaObject:k});Object.assign(I[0],m[0]),T.encodings=I}else T.encodings=m;if(T.encodings.length>1&&(T.codecs[0].mimeType.toLowerCase()==="video/vp8"||T.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const I of T.encodings)I.scalabilityMode?I.scalabilityMode=`L1T${D.temporalLayers}`:I.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:k,offerRtpParameters:T,answerRtpParameters:w,codecOptions:y});const M={type:"answer",sdp:this._remoteSdp.getSdp()};return f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",M),await this._pc.setRemoteDescription(M),this._mapMidTransceiver.set(P,C),{localId:P,rtpParameters:T,rtpSender:C.sender}}async stopSending(_){if(this.assertSendDirection(),f.debug("stopSending() [localId:%s]",_),this._closed)return;const m=this._mapMidTransceiver.get(_);if(!m)throw new Error("associated transceiver not found");m.sender.replaceTrack(null),this._pc.removeTrack(m.sender),this._remoteSdp.disableMediaSection(m.mid);const y=await this._pc.createOffer();f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",y),await this._pc.setLocalDescription(y);const b={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",b),await this._pc.setRemoteDescription(b),this._mapMidTransceiver.delete(_)}async pauseSending(_){this.assertNotClosed(),this.assertSendDirection(),f.debug("pauseSending() [localId:%s]",_);const m=this._mapMidTransceiver.get(_);if(!m)throw new Error("associated RTCRtpTransceiver not found");m.direction="inactive",this._remoteSdp.pauseMediaSection(_);const y=await this._pc.createOffer();f.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",y),await this._pc.setLocalDescription(y);const b={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",b),await this._pc.setRemoteDescription(b)}async resumeSending(_){this.assertNotClosed(),this.assertSendDirection(),f.debug("resumeSending() [localId:%s]",_);const m=this._mapMidTransceiver.get(_);if(!m)throw new Error("associated RTCRtpTransceiver not found");m.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(_);const y=await this._pc.createOffer();f.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",y),await this._pc.setLocalDescription(y);const b={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",b),await this._pc.setRemoteDescription(b)}async replaceTrack(_,m){this.assertNotClosed(),this.assertSendDirection(),m?f.debug("replaceTrack() [localId:%s, track.id:%s]",_,m.id):f.debug("replaceTrack() [localId:%s, no track]",_);const y=this._mapMidTransceiver.get(_);if(!y)throw new Error("associated RTCRtpTransceiver not found");await y.sender.replaceTrack(m)}async setMaxSpatialLayer(_,m){this.assertNotClosed(),this.assertSendDirection(),f.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",_,m);const y=this._mapMidTransceiver.get(_);if(!y)throw new Error("associated transceiver not found");const b=y.sender.getParameters();b.encodings.forEach((w,C)=>{C<=m?w.active=!0:w.active=!1}),await y.sender.setParameters(b),this._remoteSdp.muxMediaSectionSimulcast(_,b.encodings);const R=await this._pc.createOffer();f.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",R),await this._pc.setLocalDescription(R);const T={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",T),await this._pc.setRemoteDescription(T)}async setRtpEncodingParameters(_,m){this.assertNotClosed(),this.assertSendDirection(),f.debug("setRtpEncodingParameters() [localId:%s, params:%o]",_,m);const y=this._mapMidTransceiver.get(_);if(!y)throw new Error("associated RTCRtpTransceiver not found");const b=y.sender.getParameters();b.encodings.forEach((w,C)=>{b.encodings[C]={...w,...m}}),await y.sender.setParameters(b),this._remoteSdp.muxMediaSectionSimulcast(_,b.encodings);const R=await this._pc.createOffer();f.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",R),await this._pc.setLocalDescription(R);const T={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",T),await this._pc.setRemoteDescription(T)}async getSenderStats(_){this.assertNotClosed(),this.assertSendDirection();const m=this._mapMidTransceiver.get(_);if(!m)throw new Error("associated RTCRtpTransceiver not found");return m.sender.getStats()}async sendDataChannel({ordered:_,maxPacketLifeTime:m,maxRetransmits:y,label:b,protocol:R}){this.assertNotClosed(),this.assertSendDirection();const T={negotiated:!0,id:this._nextSendSctpStreamId,ordered:_,maxPacketLifeTime:m,maxRetransmits:y,protocol:R};f.debug("sendDataChannel() [options:%o]",T);const w=this._pc.createDataChannel(b,T);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%v.MIS,!this._hasDataChannelMediaSection){const A=await this._pc.createOffer(),L=i.parse(A.sdp),D=L.media.find(k=>k.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:L}),f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",A),await this._pc.setLocalDescription(A),this._remoteSdp.sendSctpAssociation({offerMediaObject:D});const P={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",P),await this._pc.setRemoteDescription(P),this._hasDataChannelMediaSection=!0}const C={streamId:T.id,ordered:T.ordered,maxPacketLifeTime:T.maxPacketLifeTime,maxRetransmits:T.maxRetransmits};return{dataChannel:w,sctpStreamParameters:C}}async receive(_){this.assertNotClosed(),this.assertRecvDirection();const m=[],y=new Map;for(const w of _){const{trackId:C,kind:A,rtpParameters:L,streamId:D}=w;f.debug("receive() [trackId:%s, kind:%s]",C,A);const P=L.mid??String(this._mapMidTransceiver.size);y.set(C,P),this._remoteSdp.receive({mid:P,kind:A,offerRtpParameters:L,streamId:D??L.rtcp.cname,trackId:C})}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",b),await this._pc.setRemoteDescription(b);for(const w of _){const{trackId:C,onRtpReceiver:A}=w;if(A){const L=y.get(C),D=this._pc.getTransceivers().find(P=>P.mid===L);if(!D)throw new Error("transceiver not found");A(D.receiver)}}let R=await this._pc.createAnswer();const T=i.parse(R.sdp);for(const w of _){const{trackId:C,rtpParameters:A}=w,L=y.get(C),D=T.media.find(P=>String(P.mid)===L);a.applyCodecParameters({offerRtpParameters:A,answerMediaObject:D}),R={type:"answer",sdp:i.write(T)}}this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:T}),f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",R),await this._pc.setLocalDescription(R);for(const w of _){const{trackId:C}=w,A=y.get(C),L=this._pc.getTransceivers().find(D=>D.mid===A);if(!L)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(A,L),m.push({localId:A,track:L.receiver.track,rtpReceiver:L.receiver})}return m}async stopReceiving(_){if(this.assertRecvDirection(),this._closed)return;for(const b of _){f.debug("stopReceiving() [localId:%s]",b);const R=this._mapMidTransceiver.get(b);if(!R)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(R.mid)}const m={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",m),await this._pc.setRemoteDescription(m);const y=await this._pc.createAnswer();f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",y),await this._pc.setLocalDescription(y);for(const b of _)this._mapMidTransceiver.delete(b)}async pauseReceiving(_){this.assertNotClosed(),this.assertRecvDirection();for(const b of _){f.debug("pauseReceiving() [localId:%s]",b);const R=this._mapMidTransceiver.get(b);if(!R)throw new Error("associated RTCRtpTransceiver not found");R.direction="inactive",this._remoteSdp.pauseMediaSection(b)}const m={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",m),await this._pc.setRemoteDescription(m);const y=await this._pc.createAnswer();f.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",y),await this._pc.setLocalDescription(y)}async resumeReceiving(_){this.assertNotClosed(),this.assertRecvDirection();for(const b of _){f.debug("resumeReceiving() [localId:%s]",b);const R=this._mapMidTransceiver.get(b);if(!R)throw new Error("associated RTCRtpTransceiver not found");R.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(b)}const m={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",m),await this._pc.setRemoteDescription(m);const y=await this._pc.createAnswer();f.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",y),await this._pc.setLocalDescription(y)}async getReceiverStats(_){this.assertRecvDirection();const m=this._mapMidTransceiver.get(_);if(!m)throw new Error("associated RTCRtpTransceiver not found");return m.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:_,label:m,protocol:y}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:b,ordered:R,maxPacketLifeTime:T,maxRetransmits:w}=_,C={negotiated:!0,id:b,ordered:R,maxPacketLifeTime:T,maxRetransmits:w,protocol:y};f.debug("receiveDataChannel() [options:%o]",C);const A=this._pc.createDataChannel(m,C);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const L={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",L),await this._pc.setRemoteDescription(L);const D=await this._pc.createAnswer();if(!this._transportReady){const P=i.parse(D.sdp);await this.setupTransport({localDtlsRole:"client",localSdpObject:P})}f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",D),await this._pc.setLocalDescription(D),this._hasDataChannelMediaSection=!0}return{dataChannel:A}}async setupTransport({localDtlsRole:_,localSdpObject:m}){m||(m=i.parse(this._pc.localDescription.sdp));const y=a.extractDtlsParameters({sdpObject:m});y.role=_,this._remoteSdp.updateDtlsRole(_==="client"?"server":"client"),await new Promise((b,R)=>{this.safeEmit("@connect",{dtlsParameters:y},b,R)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new t.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};return Qc.Firefox120=E,Qc}var Zc={},D1;function c5(){if(D1)return Zc;D1=1,Object.defineProperty(Zc,"__esModule",{value:!0}),Zc.Firefox60=void 0;const i=ri(),e=sr(),t=Gr(),r=br(),n=Hr(),a=tn(),c=ga(),l=ii(),d=rn(),u=Ls(),f=new e.Logger("Firefox60"),p="Firefox60",v={OS:16,MIS:2048};let E=class kC extends l.HandlerInterface{constructor(){super(),K(this,"_closed",!1),K(this,"_direction"),K(this,"_remoteSdp"),K(this,"_sendingRtpParametersByKind"),K(this,"_sendingRemoteRtpParametersByKind"),K(this,"_pc"),K(this,"_mapMidTransceiver",new Map),K(this,"_sendStream",new MediaStream),K(this,"_hasDataChannelMediaSection",!1),K(this,"_nextSendSctpStreamId",0),K(this,"_transportReady",!1)}static createFactory(){return()=>new kC}get name(){return p}close(){if(f.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){f.debug("getNativeRtpCapabilities()");const _=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),m=document.createElement("canvas");m.getContext("2d");const y=m.captureStream().getVideoTracks()[0];try{_.addTransceiver("audio",{direction:"sendrecv"});const b=_.addTransceiver(y,{direction:"sendrecv"}),R=b.sender.getParameters(),T=[{rid:"r0",maxBitrate:1e5},{rid:"r1",maxBitrate:5e5}];R.encodings=T,await b.sender.setParameters(R);const w=await _.createOffer();try{m.remove()}catch{}try{y.stop()}catch{}try{_.close()}catch{}const C=i.parse(w.sdp);return a.extractRtpCapabilities({sdpObject:C})}catch(b){try{m.remove()}catch{}try{y.stop()}catch{}try{_.close()}catch{}throw b}}async getNativeSctpCapabilities(){return f.debug("getNativeSctpCapabilities()"),{numStreams:v}}run({direction:_,iceParameters:m,iceCandidates:y,dtlsParameters:b,sctpParameters:R,iceServers:T,iceTransportPolicy:w,additionalSettings:C,proprietaryConstraints:A,extendedRtpCapabilities:L}){this.assertNotClosed(),f.debug("run()"),this._direction=_,this._remoteSdp=new d.RemoteSdp({iceParameters:m,iceCandidates:y,dtlsParameters:b,sctpParameters:R}),this._sendingRtpParametersByKind={audio:n.getSendingRtpParameters("audio",L),video:n.getSendingRtpParameters("video",L)},this._sendingRemoteRtpParametersByKind={audio:n.getSendingRemoteRtpParameters("audio",L),video:n.getSendingRemoteRtpParameters("video",L)},this._pc=new RTCPeerConnection({iceServers:T??[],iceTransportPolicy:w??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...C},A),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",D=>{this.emit("@icecandidateerror",D)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(f.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(_){throw this.assertNotClosed(),new t.UnsupportedError("not supported")}async restartIce(_){if(this.assertNotClosed(),f.debug("restartIce()"),this._remoteSdp.updateIceParameters(_),!!this._transportReady)if(this._direction==="send"){const m=await this._pc.createOffer({iceRestart:!0});f.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",m),await this._pc.setLocalDescription(m);const y={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",y),await this._pc.setRemoteDescription(y)}else{const m={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",m),await this._pc.setRemoteDescription(m);const y=await this._pc.createAnswer();f.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",y),await this._pc.setLocalDescription(y)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:_,encodings:m,codecOptions:y,codec:b}){this.assertNotClosed(),this.assertSendDirection(),f.debug("send() [kind:%s, track.id:%s]",_.kind,_.id),m&&(m=r.clone(m),m.forEach((M,I)=>{M.rid=`r${I}`}),m.reverse());const R=r.clone(this._sendingRtpParametersByKind[_.kind]);R.codecs=n.reduceCodecs(R.codecs,b);const T=r.clone(this._sendingRemoteRtpParametersByKind[_.kind]);T.codecs=n.reduceCodecs(T.codecs,b);const w=this._pc.addTransceiver(_,{direction:"sendonly",streams:[this._sendStream]});if(m){const M=w.sender.getParameters();M.encodings=m,await w.sender.setParameters(M)}const C=await this._pc.createOffer();let A=i.parse(C.sdp);A.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed(),this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:A});const L=(0,u.parse)((m??[{}])[0].scalabilityMode);f.debug("send() | calling pc.setLocalDescription() [offer:%o]",C),await this._pc.setLocalDescription(C);const D=w.mid;R.mid=D,A=i.parse(this._pc.localDescription.sdp);const P=A.media[A.media.length-1];if(R.rtcp.cname=a.getCname({offerMediaObject:P}),!m)R.encodings=c.getRtpEncodings({offerMediaObject:P});else if(m.length===1){const M=c.getRtpEncodings({offerMediaObject:P});Object.assign(M[0],m[0]),R.encodings=M}else R.encodings=m.reverse();if(R.encodings.length>1&&(R.codecs[0].mimeType.toLowerCase()==="video/vp8"||R.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const M of R.encodings)M.scalabilityMode?M.scalabilityMode=`L1T${L.temporalLayers}`:M.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:P,offerRtpParameters:R,answerRtpParameters:T,codecOptions:y});const k={type:"answer",sdp:this._remoteSdp.getSdp()};return f.debug("send() | calling pc.setRemoteDescription() [answer:%o]",k),await this._pc.setRemoteDescription(k),this._mapMidTransceiver.set(D,w),{localId:D,rtpParameters:R,rtpSender:w.sender}}async stopSending(_){if(this.assertSendDirection(),f.debug("stopSending() [localId:%s]",_),this._closed)return;const m=this._mapMidTransceiver.get(_);if(!m)throw new Error("associated transceiver not found");m.sender.replaceTrack(null),this._pc.removeTrack(m.sender),this._remoteSdp.disableMediaSection(m.mid);const y=await this._pc.createOffer();f.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",y),await this._pc.setLocalDescription(y);const b={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",b),await this._pc.setRemoteDescription(b),this._mapMidTransceiver.delete(_)}async pauseSending(_){this.assertNotClosed(),this.assertSendDirection(),f.debug("pauseSending() [localId:%s]",_);const m=this._mapMidTransceiver.get(_);if(!m)throw new Error("associated RTCRtpTransceiver not found");m.direction="inactive",this._remoteSdp.pauseMediaSection(_);const y=await this._pc.createOffer();f.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",y),await this._pc.setLocalDescription(y);const b={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",b),await this._pc.setRemoteDescription(b)}async resumeSending(_){this.assertNotClosed(),this.assertSendDirection(),f.debug("resumeSending() [localId:%s]",_);const m=this._mapMidTransceiver.get(_);if(!m)throw new Error("associated RTCRtpTransceiver not found");m.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(_);const y=await this._pc.createOffer();f.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",y),await this._pc.setLocalDescription(y);const b={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",b),await this._pc.setRemoteDescription(b)}async replaceTrack(_,m){this.assertNotClosed(),this.assertSendDirection(),m?f.debug("replaceTrack() [localId:%s, track.id:%s]",_,m.id):f.debug("replaceTrack() [localId:%s, no track]",_);const y=this._mapMidTransceiver.get(_);if(!y)throw new Error("associated RTCRtpTransceiver not found");await y.sender.replaceTrack(m)}async setMaxSpatialLayer(_,m){this.assertNotClosed(),this.assertSendDirection(),f.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",_,m);const y=this._mapMidTransceiver.get(_);if(!y)throw new Error("associated transceiver not found");const b=y.sender.getParameters();m=b.encodings.length-1-m,b.encodings.forEach((w,C)=>{C>=m?w.active=!0:w.active=!1}),await y.sender.setParameters(b),this._remoteSdp.muxMediaSectionSimulcast(_,b.encodings);const R=await this._pc.createOffer();f.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",R),await this._pc.setLocalDescription(R);const T={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",T),await this._pc.setRemoteDescription(T)}async setRtpEncodingParameters(_,m){this.assertNotClosed(),this.assertSendDirection(),f.debug("setRtpEncodingParameters() [localId:%s, params:%o]",_,m);const y=this._mapMidTransceiver.get(_);if(!y)throw new Error("associated RTCRtpTransceiver not found");const b=y.sender.getParameters();b.encodings.forEach((w,C)=>{b.encodings[C]={...w,...m}}),await y.sender.setParameters(b),this._remoteSdp.muxMediaSectionSimulcast(_,b.encodings);const R=await this._pc.createOffer();f.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",R),await this._pc.setLocalDescription(R);const T={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",T),await this._pc.setRemoteDescription(T)}async getSenderStats(_){this.assertNotClosed(),this.assertSendDirection();const m=this._mapMidTransceiver.get(_);if(!m)throw new Error("associated RTCRtpTransceiver not found");return m.sender.getStats()}async sendDataChannel({ordered:_,maxPacketLifeTime:m,maxRetransmits:y,label:b,protocol:R}){this.assertNotClosed(),this.assertSendDirection();const T={negotiated:!0,id:this._nextSendSctpStreamId,ordered:_,maxPacketLifeTime:m,maxRetransmits:y,protocol:R};f.debug("sendDataChannel() [options:%o]",T);const w=this._pc.createDataChannel(b,T);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%v.MIS,!this._hasDataChannelMediaSection){const A=await this._pc.createOffer(),L=i.parse(A.sdp),D=L.media.find(k=>k.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:L}),f.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",A),await this._pc.setLocalDescription(A),this._remoteSdp.sendSctpAssociation({offerMediaObject:D});const P={type:"answer",sdp:this._remoteSdp.getSdp()};f.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",P),await this._pc.setRemoteDescription(P),this._hasDataChannelMediaSection=!0}const C={streamId:T.id,ordered:T.ordered,maxPacketLifeTime:T.maxPacketLifeTime,maxRetransmits:T.maxRetransmits};return{dataChannel:w,sctpStreamParameters:C}}async receive(_){this.assertNotClosed(),this.assertRecvDirection();const m=[],y=new Map;for(const w of _){const{trackId:C,kind:A,rtpParameters:L,streamId:D}=w;f.debug("receive() [trackId:%s, kind:%s]",C,A);const P=L.mid??String(this._mapMidTransceiver.size);y.set(C,P),this._remoteSdp.receive({mid:P,kind:A,offerRtpParameters:L,streamId:D??L.rtcp.cname,trackId:C})}const b={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",b),await this._pc.setRemoteDescription(b);let R=await this._pc.createAnswer();const T=i.parse(R.sdp);for(const w of _){const{trackId:C,rtpParameters:A}=w,L=y.get(C),D=T.media.find(P=>String(P.mid)===L);a.applyCodecParameters({offerRtpParameters:A,answerMediaObject:D}),R={type:"answer",sdp:i.write(T)}}this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:T}),f.debug("receive() | calling pc.setLocalDescription() [answer:%o]",R),await this._pc.setLocalDescription(R);for(const w of _){const{trackId:C}=w,A=y.get(C),L=this._pc.getTransceivers().find(D=>D.mid===A);if(!L)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(A,L),m.push({localId:A,track:L.receiver.track,rtpReceiver:L.receiver})}return m}async stopReceiving(_){if(this.assertRecvDirection(),this._closed)return;for(const b of _){f.debug("stopReceiving() [localId:%s]",b);const R=this._mapMidTransceiver.get(b);if(!R)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(R.mid)}const m={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",m),await this._pc.setRemoteDescription(m);const y=await this._pc.createAnswer();f.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",y),await this._pc.setLocalDescription(y);for(const b of _)this._mapMidTransceiver.delete(b)}async pauseReceiving(_){this.assertNotClosed(),this.assertRecvDirection();for(const b of _){f.debug("pauseReceiving() [localId:%s]",b);const R=this._mapMidTransceiver.get(b);if(!R)throw new Error("associated RTCRtpTransceiver not found");R.direction="inactive",this._remoteSdp.pauseMediaSection(b)}const m={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",m),await this._pc.setRemoteDescription(m);const y=await this._pc.createAnswer();f.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",y),await this._pc.setLocalDescription(y)}async resumeReceiving(_){this.assertNotClosed(),this.assertRecvDirection();for(const b of _){f.debug("resumeReceiving() [localId:%s]",b);const R=this._mapMidTransceiver.get(b);if(!R)throw new Error("associated RTCRtpTransceiver not found");R.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(b)}const m={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",m),await this._pc.setRemoteDescription(m);const y=await this._pc.createAnswer();f.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",y),await this._pc.setLocalDescription(y)}async getReceiverStats(_){this.assertRecvDirection();const m=this._mapMidTransceiver.get(_);if(!m)throw new Error("associated RTCRtpTransceiver not found");return m.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:_,label:m,protocol:y}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:b,ordered:R,maxPacketLifeTime:T,maxRetransmits:w}=_,C={negotiated:!0,id:b,ordered:R,maxPacketLifeTime:T,maxRetransmits:w,protocol:y};f.debug("receiveDataChannel() [options:%o]",C);const A=this._pc.createDataChannel(m,C);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const L={type:"offer",sdp:this._remoteSdp.getSdp()};f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",L),await this._pc.setRemoteDescription(L);const D=await this._pc.createAnswer();if(!this._transportReady){const P=i.parse(D.sdp);await this.setupTransport({localDtlsRole:"client",localSdpObject:P})}f.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",D),await this._pc.setLocalDescription(D),this._hasDataChannelMediaSection=!0}return{dataChannel:A}}async setupTransport({localDtlsRole:_,localSdpObject:m}){m||(m=i.parse(this._pc.localDescription.sdp));const y=a.extractDtlsParameters({sdpObject:m});y.role=_,this._remoteSdp.updateDtlsRole(_==="client"?"server":"client"),await new Promise((b,R)=>{this.safeEmit("@connect",{dtlsParameters:y},b,R)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new t.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};return Zc.Firefox60=E,Zc}var Jc={},L1;function l5(){if(L1)return Jc;L1=1,Object.defineProperty(Jc,"__esModule",{value:!0}),Jc.Safari12=void 0;const i=ri(),e=sr(),t=br(),r=Hr(),n=tn(),a=ga(),c=Pf(),l=Gr(),d=ii(),u=rn(),f=Ls(),p=new e.Logger("Safari12"),v="Safari12",E={OS:1024,MIS:1024};let g=class MC extends d.HandlerInterface{constructor(){super(),K(this,"_closed",!1),K(this,"_direction"),K(this,"_remoteSdp"),K(this,"_sendingRtpParametersByKind"),K(this,"_sendingRemoteRtpParametersByKind"),K(this,"_forcedLocalDtlsRole"),K(this,"_pc"),K(this,"_mapMidTransceiver",new Map),K(this,"_sendStream",new MediaStream),K(this,"_hasDataChannelMediaSection",!1),K(this,"_nextSendSctpStreamId",0),K(this,"_transportReady",!1)}static createFactory(){return()=>new MC}get name(){return v}close(){if(p.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){p.debug("getNativeRtpCapabilities()");const m=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{m.addTransceiver("audio"),m.addTransceiver("video");const y=await m.createOffer();try{m.close()}catch{}const b=i.parse(y.sdp),R=n.extractRtpCapabilities({sdpObject:b});return c.addNackSupportForOpus(R),R}catch(y){try{m.close()}catch{}throw y}}async getNativeSctpCapabilities(){return p.debug("getNativeSctpCapabilities()"),{numStreams:E}}run({direction:m,iceParameters:y,iceCandidates:b,dtlsParameters:R,sctpParameters:T,iceServers:w,iceTransportPolicy:C,additionalSettings:A,proprietaryConstraints:L,extendedRtpCapabilities:D}){this.assertNotClosed(),p.debug("run()"),this._direction=m,this._remoteSdp=new u.RemoteSdp({iceParameters:y,iceCandidates:b,dtlsParameters:R,sctpParameters:T}),this._sendingRtpParametersByKind={audio:r.getSendingRtpParameters("audio",D),video:r.getSendingRtpParameters("video",D)},this._sendingRemoteRtpParametersByKind={audio:r.getSendingRemoteRtpParameters("audio",D),video:r.getSendingRemoteRtpParameters("video",D)},R.role&&R.role!=="auto"&&(this._forcedLocalDtlsRole=R.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:w??[],iceTransportPolicy:C??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...A},L),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",P=>{this.emit("@icecandidateerror",P)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(p.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(m){this.assertNotClosed(),p.debug("updateIceServers()");const y=this._pc.getConfiguration();y.iceServers=m,this._pc.setConfiguration(y)}async restartIce(m){if(this.assertNotClosed(),p.debug("restartIce()"),this._remoteSdp.updateIceParameters(m),!!this._transportReady)if(this._direction==="send"){const y=await this._pc.createOffer({iceRestart:!0});p.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",y),await this._pc.setLocalDescription(y);const b={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",b),await this._pc.setRemoteDescription(b)}else{const y={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",y),await this._pc.setRemoteDescription(y);const b=await this._pc.createAnswer();p.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",b),await this._pc.setLocalDescription(b)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:m,encodings:y,codecOptions:b,codec:R,onRtpSender:T}){this.assertNotClosed(),this.assertSendDirection(),p.debug("send() [kind:%s, track.id:%s]",m.kind,m.id);const w=t.clone(this._sendingRtpParametersByKind[m.kind]);w.codecs=r.reduceCodecs(w.codecs,R);const C=t.clone(this._sendingRemoteRtpParametersByKind[m.kind]);C.codecs=r.reduceCodecs(C.codecs,R);const A=this._remoteSdp.getNextMediaSectionIdx(),L=this._pc.addTransceiver(m,{direction:"sendonly",streams:[this._sendStream]});T&&T(L.sender);let D=await this._pc.createOffer(),P=i.parse(D.sdp);P.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let k;this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:P});const M=(0,f.parse)((y??[{}])[0].scalabilityMode);y&&y.length>1&&(p.debug("send() | enabling legacy simulcast"),P=i.parse(D.sdp),k=P.media[A.idx],a.addLegacySimulcast({offerMediaObject:k,numStreams:y.length}),D={type:"offer",sdp:i.write(P)}),p.debug("send() | calling pc.setLocalDescription() [offer:%o]",D),await this._pc.setLocalDescription(D);const I=L.mid;if(w.mid=I,P=i.parse(this._pc.localDescription.sdp),k=P.media[A.idx],w.rtcp.cname=n.getCname({offerMediaObject:k}),w.encodings=a.getRtpEncodings({offerMediaObject:k}),y)for(let $=0;$<w.encodings.length;++$)y[$]&&Object.assign(w.encodings[$],y[$]);if(w.encodings.length>1&&(w.codecs[0].mimeType.toLowerCase()==="video/vp8"||w.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const $ of w.encodings)$.scalabilityMode?$.scalabilityMode=`L1T${M.temporalLayers}`:$.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:k,reuseMid:A.reuseMid,offerRtpParameters:w,answerRtpParameters:C,codecOptions:b});const F={type:"answer",sdp:this._remoteSdp.getSdp()};return p.debug("send() | calling pc.setRemoteDescription() [answer:%o]",F),await this._pc.setRemoteDescription(F),this._mapMidTransceiver.set(I,L),{localId:I,rtpParameters:w,rtpSender:L.sender}}async stopSending(m){if(this.assertSendDirection(),this._closed)return;p.debug("stopSending() [localId:%s]",m);const y=this._mapMidTransceiver.get(m);if(!y)throw new Error("associated RTCRtpTransceiver not found");if(y.sender.replaceTrack(null),this._pc.removeTrack(y.sender),this._remoteSdp.closeMediaSection(y.mid))try{y.stop()}catch{}const b=await this._pc.createOffer();p.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",b),await this._pc.setLocalDescription(b);const R={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",R),await this._pc.setRemoteDescription(R),this._mapMidTransceiver.delete(m)}async pauseSending(m){this.assertNotClosed(),this.assertSendDirection(),p.debug("pauseSending() [localId:%s]",m);const y=this._mapMidTransceiver.get(m);if(!y)throw new Error("associated RTCRtpTransceiver not found");y.direction="inactive",this._remoteSdp.pauseMediaSection(m);const b=await this._pc.createOffer();p.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",b),await this._pc.setLocalDescription(b);const R={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",R),await this._pc.setRemoteDescription(R)}async resumeSending(m){this.assertNotClosed(),this.assertSendDirection(),p.debug("resumeSending() [localId:%s]",m);const y=this._mapMidTransceiver.get(m);if(!y)throw new Error("associated RTCRtpTransceiver not found");y.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(m);const b=await this._pc.createOffer();p.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",b),await this._pc.setLocalDescription(b);const R={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",R),await this._pc.setRemoteDescription(R)}async replaceTrack(m,y){this.assertNotClosed(),this.assertSendDirection(),y?p.debug("replaceTrack() [localId:%s, track.id:%s]",m,y.id):p.debug("replaceTrack() [localId:%s, no track]",m);const b=this._mapMidTransceiver.get(m);if(!b)throw new Error("associated RTCRtpTransceiver not found");await b.sender.replaceTrack(y)}async setMaxSpatialLayer(m,y){this.assertNotClosed(),this.assertSendDirection(),p.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",m,y);const b=this._mapMidTransceiver.get(m);if(!b)throw new Error("associated RTCRtpTransceiver not found");const R=b.sender.getParameters();R.encodings.forEach((C,A)=>{A<=y?C.active=!0:C.active=!1}),await b.sender.setParameters(R),this._remoteSdp.muxMediaSectionSimulcast(m,R.encodings);const T=await this._pc.createOffer();p.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",T),await this._pc.setLocalDescription(T);const w={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",w),await this._pc.setRemoteDescription(w)}async setRtpEncodingParameters(m,y){this.assertNotClosed(),this.assertSendDirection(),p.debug("setRtpEncodingParameters() [localId:%s, params:%o]",m,y);const b=this._mapMidTransceiver.get(m);if(!b)throw new Error("associated RTCRtpTransceiver not found");const R=b.sender.getParameters();R.encodings.forEach((C,A)=>{R.encodings[A]={...C,...y}}),await b.sender.setParameters(R),this._remoteSdp.muxMediaSectionSimulcast(m,R.encodings);const T=await this._pc.createOffer();p.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",T),await this._pc.setLocalDescription(T);const w={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",w),await this._pc.setRemoteDescription(w)}async getSenderStats(m){this.assertNotClosed(),this.assertSendDirection();const y=this._mapMidTransceiver.get(m);if(!y)throw new Error("associated RTCRtpTransceiver not found");return y.sender.getStats()}async sendDataChannel({ordered:m,maxPacketLifeTime:y,maxRetransmits:b,label:R,protocol:T}){this.assertNotClosed(),this.assertSendDirection();const w={negotiated:!0,id:this._nextSendSctpStreamId,ordered:m,maxPacketLifeTime:y,maxRetransmits:b,protocol:T};p.debug("sendDataChannel() [options:%o]",w);const C=this._pc.createDataChannel(R,w);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%E.MIS,!this._hasDataChannelMediaSection){const L=await this._pc.createOffer(),D=i.parse(L.sdp),P=D.media.find(M=>M.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:D}),p.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",L),await this._pc.setLocalDescription(L),this._remoteSdp.sendSctpAssociation({offerMediaObject:P});const k={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",k),await this._pc.setRemoteDescription(k),this._hasDataChannelMediaSection=!0}const A={streamId:w.id,ordered:w.ordered,maxPacketLifeTime:w.maxPacketLifeTime,maxRetransmits:w.maxRetransmits};return{dataChannel:C,sctpStreamParameters:A}}async receive(m){this.assertNotClosed(),this.assertRecvDirection();const y=[],b=new Map;for(const C of m){const{trackId:A,kind:L,rtpParameters:D,streamId:P}=C;p.debug("receive() [trackId:%s, kind:%s]",A,L);const k=D.mid??String(this._mapMidTransceiver.size);b.set(A,k),this._remoteSdp.receive({mid:k,kind:L,offerRtpParameters:D,streamId:P??D.rtcp.cname,trackId:A})}const R={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",R),await this._pc.setRemoteDescription(R);for(const C of m){const{trackId:A,onRtpReceiver:L}=C;if(L){const D=b.get(A),P=this._pc.getTransceivers().find(k=>k.mid===D);if(!P)throw new Error("transceiver not found");L(P.receiver)}}let T=await this._pc.createAnswer();const w=i.parse(T.sdp);for(const C of m){const{trackId:A,rtpParameters:L}=C,D=b.get(A),P=w.media.find(k=>String(k.mid)===D);n.applyCodecParameters({offerRtpParameters:L,answerMediaObject:P})}T={type:"answer",sdp:i.write(w)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:w}),p.debug("receive() | calling pc.setLocalDescription() [answer:%o]",T),await this._pc.setLocalDescription(T);for(const C of m){const{trackId:A}=C,L=b.get(A),D=this._pc.getTransceivers().find(P=>P.mid===L);if(!D)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(L,D),y.push({localId:L,track:D.receiver.track,rtpReceiver:D.receiver})}return y}async stopReceiving(m){if(this.assertRecvDirection(),this._closed)return;for(const R of m){p.debug("stopReceiving() [localId:%s]",R);const T=this._mapMidTransceiver.get(R);if(!T)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(T.mid)}const y={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",y),await this._pc.setRemoteDescription(y);const b=await this._pc.createAnswer();p.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",b),await this._pc.setLocalDescription(b);for(const R of m)this._mapMidTransceiver.delete(R)}async pauseReceiving(m){this.assertNotClosed(),this.assertRecvDirection();for(const R of m){p.debug("pauseReceiving() [localId:%s]",R);const T=this._mapMidTransceiver.get(R);if(!T)throw new Error("associated RTCRtpTransceiver not found");T.direction="inactive",this._remoteSdp.pauseMediaSection(R)}const y={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",y),await this._pc.setRemoteDescription(y);const b=await this._pc.createAnswer();p.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",b),await this._pc.setLocalDescription(b)}async resumeReceiving(m){this.assertNotClosed(),this.assertRecvDirection();for(const R of m){p.debug("resumeReceiving() [localId:%s]",R);const T=this._mapMidTransceiver.get(R);if(!T)throw new Error("associated RTCRtpTransceiver not found");T.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(R)}const y={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",y),await this._pc.setRemoteDescription(y);const b=await this._pc.createAnswer();p.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",b),await this._pc.setLocalDescription(b)}async getReceiverStats(m){this.assertNotClosed(),this.assertRecvDirection();const y=this._mapMidTransceiver.get(m);if(!y)throw new Error("associated RTCRtpTransceiver not found");return y.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:m,label:y,protocol:b}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:R,ordered:T,maxPacketLifeTime:w,maxRetransmits:C}=m,A={negotiated:!0,id:R,ordered:T,maxPacketLifeTime:w,maxRetransmits:C,protocol:b};p.debug("receiveDataChannel() [options:%o]",A);const L=this._pc.createDataChannel(y,A);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const D={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",D),await this._pc.setRemoteDescription(D);const P=await this._pc.createAnswer();if(!this._transportReady){const k=i.parse(P.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:k})}p.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",P),await this._pc.setLocalDescription(P),this._hasDataChannelMediaSection=!0}return{dataChannel:L}}async setupTransport({localDtlsRole:m,localSdpObject:y}){y||(y=i.parse(this._pc.localDescription.sdp));const b=n.extractDtlsParameters({sdpObject:y});b.role=m,this._remoteSdp.updateDtlsRole(m==="client"?"server":"client"),await new Promise((R,T)=>{this.safeEmit("@connect",{dtlsParameters:b},R,T)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new l.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};return Jc.Safari12=g,Jc}var el={},O1;function u5(){if(O1)return el;O1=1,Object.defineProperty(el,"__esModule",{value:!0}),el.Safari11=void 0;const i=ri(),e=sr(),t=br(),r=Hr(),n=tn(),a=kf(),c=ii(),l=rn(),d=new e.Logger("Safari11"),u="Safari11",f={OS:1024,MIS:1024};let p=class NC extends c.HandlerInterface{constructor(){super(),K(this,"_direction"),K(this,"_remoteSdp"),K(this,"_sendingRtpParametersByKind"),K(this,"_sendingRemoteRtpParametersByKind"),K(this,"_forcedLocalDtlsRole"),K(this,"_pc"),K(this,"_sendStream",new MediaStream),K(this,"_mapSendLocalIdRtpSender",new Map),K(this,"_nextSendLocalId",0),K(this,"_mapRecvLocalIdInfo",new Map),K(this,"_hasDataChannelMediaSection",!1),K(this,"_nextSendSctpStreamId",0),K(this,"_transportReady",!1)}static createFactory(){return()=>new NC}get name(){return u}close(){if(d.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){d.debug("getNativeRtpCapabilities()");const E=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const g=await E.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{E.close()}catch{}const _=i.parse(g.sdp);return n.extractRtpCapabilities({sdpObject:_})}catch(g){try{E.close()}catch{}throw g}}async getNativeSctpCapabilities(){return d.debug("getNativeSctpCapabilities()"),{numStreams:f}}run({direction:E,iceParameters:g,iceCandidates:_,dtlsParameters:m,sctpParameters:y,iceServers:b,iceTransportPolicy:R,additionalSettings:T,proprietaryConstraints:w,extendedRtpCapabilities:C}){d.debug("run()"),this._direction=E,this._remoteSdp=new l.RemoteSdp({iceParameters:g,iceCandidates:_,dtlsParameters:m,sctpParameters:y,planB:!0}),this._sendingRtpParametersByKind={audio:r.getSendingRtpParameters("audio",C),video:r.getSendingRtpParameters("video",C)},this._sendingRemoteRtpParametersByKind={audio:r.getSendingRemoteRtpParameters("audio",C),video:r.getSendingRemoteRtpParameters("video",C)},m.role&&m.role!=="auto"&&(this._forcedLocalDtlsRole=m.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:b??[],iceTransportPolicy:R??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...T},w),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",A=>{this.emit("@icecandidateerror",A)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(d.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(E){d.debug("updateIceServers()");const g=this._pc.getConfiguration();g.iceServers=E,this._pc.setConfiguration(g)}async restartIce(E){if(d.debug("restartIce()"),this._remoteSdp.updateIceParameters(E),!!this._transportReady)if(this._direction==="send"){const g=await this._pc.createOffer({iceRestart:!0});d.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",g),await this._pc.setLocalDescription(g);const _={type:"answer",sdp:this._remoteSdp.getSdp()};d.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",_),await this._pc.setRemoteDescription(_)}else{const g={type:"offer",sdp:this._remoteSdp.getSdp()};d.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",g),await this._pc.setRemoteDescription(g);const _=await this._pc.createAnswer();d.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",_),await this._pc.setLocalDescription(_)}}async getTransportStats(){return this._pc.getStats()}async send({track:E,encodings:g,codecOptions:_,codec:m}){this.assertSendDirection(),d.debug("send() [kind:%s, track.id:%s]",E.kind,E.id),m&&d.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(E),this._pc.addTrack(E,this._sendStream);let y=await this._pc.createOffer(),b=i.parse(y.sdp);b.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let R;const T=t.clone(this._sendingRtpParametersByKind[E.kind]);T.codecs=r.reduceCodecs(T.codecs);const w=t.clone(this._sendingRemoteRtpParametersByKind[E.kind]);if(w.codecs=r.reduceCodecs(w.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:b}),E.kind==="video"&&g&&g.length>1&&(d.debug("send() | enabling simulcast"),b=i.parse(y.sdp),R=b.media.find(D=>D.type==="video"),a.addLegacySimulcast({offerMediaObject:R,track:E,numStreams:g.length}),y={type:"offer",sdp:i.write(b)}),d.debug("send() | calling pc.setLocalDescription() [offer:%o]",y),await this._pc.setLocalDescription(y),b=i.parse(this._pc.localDescription.sdp),R=b.media.find(D=>D.type===E.kind),T.rtcp.cname=n.getCname({offerMediaObject:R}),T.encodings=a.getRtpEncodings({offerMediaObject:R,track:E}),g)for(let D=0;D<T.encodings.length;++D)g[D]&&Object.assign(T.encodings[D],g[D]);if(T.encodings.length>1&&T.codecs[0].mimeType.toLowerCase()==="video/vp8")for(const D of T.encodings)D.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:R,offerRtpParameters:T,answerRtpParameters:w,codecOptions:_});const C={type:"answer",sdp:this._remoteSdp.getSdp()};d.debug("send() | calling pc.setRemoteDescription() [answer:%o]",C),await this._pc.setRemoteDescription(C);const A=String(this._nextSendLocalId);this._nextSendLocalId++;const L=this._pc.getSenders().find(D=>D.track===E);return this._mapSendLocalIdRtpSender.set(A,L),{localId:A,rtpParameters:T,rtpSender:L}}async stopSending(E){this.assertSendDirection();const g=this._mapSendLocalIdRtpSender.get(E);if(!g)throw new Error("associated RTCRtpSender not found");g.track&&this._sendStream.removeTrack(g.track),this._mapSendLocalIdRtpSender.delete(E);const _=await this._pc.createOffer();d.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",_);try{await this._pc.setLocalDescription(_)}catch(y){if(this._sendStream.getTracks().length===0){d.warn("stopSending() | ignoring expected error due no sending tracks: %s",y.toString());return}throw y}if(this._pc.signalingState==="stable")return;const m={type:"answer",sdp:this._remoteSdp.getSdp()};d.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",m),await this._pc.setRemoteDescription(m)}async pauseSending(E){}async resumeSending(E){}async replaceTrack(E,g){this.assertSendDirection(),g?d.debug("replaceTrack() [localId:%s, track.id:%s]",E,g.id):d.debug("replaceTrack() [localId:%s, no track]",E);const _=this._mapSendLocalIdRtpSender.get(E);if(!_)throw new Error("associated RTCRtpSender not found");const m=_.track;await _.replaceTrack(g),m&&this._sendStream.removeTrack(m),g&&this._sendStream.addTrack(g)}async setMaxSpatialLayer(E,g){this.assertSendDirection(),d.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",E,g);const _=this._mapSendLocalIdRtpSender.get(E);if(!_)throw new Error("associated RTCRtpSender not found");const m=_.getParameters();m.encodings.forEach((y,b)=>{b<=g?y.active=!0:y.active=!1}),await _.setParameters(m)}async setRtpEncodingParameters(E,g){this.assertSendDirection(),d.debug("setRtpEncodingParameters() [localId:%s, params:%o]",E,g);const _=this._mapSendLocalIdRtpSender.get(E);if(!_)throw new Error("associated RTCRtpSender not found");const m=_.getParameters();m.encodings.forEach((y,b)=>{m.encodings[b]={...y,...g}}),await _.setParameters(m)}async getSenderStats(E){this.assertSendDirection();const g=this._mapSendLocalIdRtpSender.get(E);if(!g)throw new Error("associated RTCRtpSender not found");return g.getStats()}async sendDataChannel({ordered:E,maxPacketLifeTime:g,maxRetransmits:_,label:m,protocol:y}){this.assertSendDirection();const b={negotiated:!0,id:this._nextSendSctpStreamId,ordered:E,maxPacketLifeTime:g,maxRetransmits:_,protocol:y};d.debug("sendDataChannel() [options:%o]",b);const R=this._pc.createDataChannel(m,b);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%f.MIS,!this._hasDataChannelMediaSection){const w=await this._pc.createOffer(),C=i.parse(w.sdp),A=C.media.find(D=>D.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:C}),d.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",w),await this._pc.setLocalDescription(w),this._remoteSdp.sendSctpAssociation({offerMediaObject:A});const L={type:"answer",sdp:this._remoteSdp.getSdp()};d.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",L),await this._pc.setRemoteDescription(L),this._hasDataChannelMediaSection=!0}const T={streamId:b.id,ordered:b.ordered,maxPacketLifeTime:b.maxPacketLifeTime,maxRetransmits:b.maxRetransmits};return{dataChannel:R,sctpStreamParameters:T}}async receive(E){this.assertRecvDirection();const g=[];for(const b of E){const{trackId:R,kind:T,rtpParameters:w,streamId:C}=b;d.debug("receive() [trackId:%s, kind:%s]",R,T);const A=T;this._remoteSdp.receive({mid:A,kind:T,offerRtpParameters:w,streamId:C??w.rtcp.cname,trackId:R})}const _={type:"offer",sdp:this._remoteSdp.getSdp()};d.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",_),await this._pc.setRemoteDescription(_);let m=await this._pc.createAnswer();const y=i.parse(m.sdp);for(const b of E){const{kind:R,rtpParameters:T}=b,w=R,C=y.media.find(A=>String(A.mid)===w);n.applyCodecParameters({offerRtpParameters:T,answerMediaObject:C})}m={type:"answer",sdp:i.write(y)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:y}),d.debug("receive() | calling pc.setLocalDescription() [answer:%o]",m),await this._pc.setLocalDescription(m);for(const b of E){const{kind:R,trackId:T,rtpParameters:w}=b,C=R,A=T,L=this._pc.getReceivers().find(D=>D.track&&D.track.id===A);if(!L)throw new Error("new RTCRtpReceiver not");this._mapRecvLocalIdInfo.set(A,{mid:C,rtpParameters:w,rtpReceiver:L}),g.push({localId:A,track:L.track,rtpReceiver:L})}return g}async stopReceiving(E){this.assertRecvDirection();for(const m of E){d.debug("stopReceiving() [localId:%s]",m);const{mid:y,rtpParameters:b}=this._mapRecvLocalIdInfo.get(m)??{};this._mapRecvLocalIdInfo.delete(m),this._remoteSdp.planBStopReceiving({mid:y,offerRtpParameters:b})}const g={type:"offer",sdp:this._remoteSdp.getSdp()};d.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",g),await this._pc.setRemoteDescription(g);const _=await this._pc.createAnswer();d.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",_),await this._pc.setLocalDescription(_)}async getReceiverStats(E){this.assertRecvDirection();const{rtpReceiver:g}=this._mapRecvLocalIdInfo.get(E)??{};if(!g)throw new Error("associated RTCRtpReceiver not found");return g.getStats()}async pauseReceiving(E){}async resumeReceiving(E){}async receiveDataChannel({sctpStreamParameters:E,label:g,protocol:_}){this.assertRecvDirection();const{streamId:m,ordered:y,maxPacketLifeTime:b,maxRetransmits:R}=E,T={negotiated:!0,id:m,ordered:y,maxPacketLifeTime:b,maxRetransmits:R,protocol:_};d.debug("receiveDataChannel() [options:%o]",T);const w=this._pc.createDataChannel(g,T);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const C={type:"offer",sdp:this._remoteSdp.getSdp()};d.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",C),await this._pc.setRemoteDescription(C);const A=await this._pc.createAnswer();if(!this._transportReady){const L=i.parse(A.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:L})}d.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",A),await this._pc.setLocalDescription(A),this._hasDataChannelMediaSection=!0}return{dataChannel:w}}async setupTransport({localDtlsRole:E,localSdpObject:g}){g||(g=i.parse(this._pc.localDescription.sdp));const _=n.extractDtlsParameters({sdpObject:g});_.role=E,this._remoteSdp.updateDtlsRole(E==="client"?"server":"client"),await new Promise((m,y)=>{this.safeEmit("@connect",{dtlsParameters:_},m,y)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};return el.Safari11=p,el}var tl={},rl={},I1;function d5(){if(I1)return rl;I1=1,Object.defineProperty(rl,"__esModule",{value:!0}),rl.getCapabilities=e,rl.mangleRtpParameters=t;const i=br();function e(){const r=RTCRtpReceiver.getCapabilities(),n=i.clone(r);for(const a of n.codecs??[]){if(a.channels=a.numChannels,delete a.numChannels,a.mimeType=a.mimeType??`${a.kind}/${a.name}`,a.parameters){const c=a.parameters;c.apt&&(c.apt=Number(c.apt)),c["packetization-mode"]&&(c["packetization-mode"]=Number(c["packetization-mode"]))}for(const c of a.rtcpFeedback??[])c.parameter||(c.parameter="")}return n}function t(r){const n=i.clone(r);n.mid&&(n.muxId=n.mid,delete n.mid);for(const a of n.codecs)a.channels&&(a.numChannels=a.channels,delete a.channels),a.mimeType&&!a.name&&(a.name=a.mimeType.split("/")[1]),delete a.mimeType;return n}return rl}var P1;function f5(){if(P1)return tl;P1=1,Object.defineProperty(tl,"__esModule",{value:!0}),tl.Edge11=void 0;const i=sr(),e=Gr(),t=br(),r=Hr(),n=d5(),a=ii(),c=new i.Logger("Edge11"),l="Edge11";let d=class BC extends a.HandlerInterface{constructor(){super(),K(this,"_sendingRtpParametersByKind"),K(this,"_remoteIceParameters"),K(this,"_remoteIceCandidates"),K(this,"_remoteDtlsParameters"),K(this,"_iceGatherer"),K(this,"_iceTransport"),K(this,"_dtlsTransport"),K(this,"_rtpSenders",new Map),K(this,"_rtpReceivers",new Map),K(this,"_nextSendLocalId",0),K(this,"_cname"),K(this,"_transportReady",!1)}static createFactory(){return()=>new BC}get name(){return l}close(){c.debug("close()");try{this._iceGatherer.close()}catch{}try{this._iceTransport.stop()}catch{}try{this._dtlsTransport.stop()}catch{}for(const f of this._rtpSenders.values())try{f.stop()}catch{}for(const f of this._rtpReceivers.values())try{f.stop()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){return c.debug("getNativeRtpCapabilities()"),n.getCapabilities()}async getNativeSctpCapabilities(){return c.debug("getNativeSctpCapabilities()"),{numStreams:{OS:0,MIS:0}}}run({direction:f,iceParameters:p,iceCandidates:v,dtlsParameters:E,sctpParameters:g,iceServers:_,iceTransportPolicy:m,additionalSettings:y,proprietaryConstraints:b,extendedRtpCapabilities:R}){c.debug("run()"),this._sendingRtpParametersByKind={audio:r.getSendingRtpParameters("audio",R),video:r.getSendingRtpParameters("video",R)},this._remoteIceParameters=p,this._remoteIceCandidates=v,this._remoteDtlsParameters=E,this._cname=`CNAME-${t.generateRandomNumber()}`,this.setIceGatherer({iceServers:_,iceTransportPolicy:m}),this.setIceTransport(),this.setDtlsTransport()}async updateIceServers(f){throw new e.UnsupportedError("not supported")}async restartIce(f){if(c.debug("restartIce()"),this._remoteIceParameters=f,!!this._transportReady){c.debug("restartIce() | calling iceTransport.start()"),this._iceTransport.start(this._iceGatherer,f,"controlling");for(const p of this._remoteIceCandidates)this._iceTransport.addRemoteCandidate(p);this._iceTransport.addRemoteCandidate({})}}async getTransportStats(){return this._iceTransport.getStats()}async send({track:f,encodings:p,codecOptions:v,codec:E}){c.debug("send() [kind:%s, track.id:%s]",f.kind,f.id),this._transportReady||await this.setupTransport({localDtlsRole:"server"}),c.debug("send() | calling new RTCRtpSender()");const g=new RTCRtpSender(f,this._dtlsTransport),_=t.clone(this._sendingRtpParametersByKind[f.kind]);_.codecs=r.reduceCodecs(_.codecs,E);const m=_.codecs.some(R=>/.+\/rtx$/i.test(R.mimeType));p||(p=[{}]);for(const R of p)R.ssrc=t.generateRandomNumber(),m&&(R.rtx={ssrc:t.generateRandomNumber()});_.encodings=p,_.rtcp={cname:this._cname,reducedSize:!0,mux:!0};const y=n.mangleRtpParameters(_);c.debug("send() | calling rtpSender.send() [params:%o]",y),await g.send(y);const b=String(this._nextSendLocalId);return this._nextSendLocalId++,this._rtpSenders.set(b,g),{localId:b,rtpParameters:_,rtpSender:g}}async stopSending(f){c.debug("stopSending() [localId:%s]",f);const p=this._rtpSenders.get(f);if(!p)throw new Error("RTCRtpSender not found");this._rtpSenders.delete(f);try{c.debug("stopSending() | calling rtpSender.stop()"),p.stop()}catch(v){throw c.warn("stopSending() | rtpSender.stop() failed:%o",v),v}}async pauseSending(f){}async resumeSending(f){}async replaceTrack(f,p){p?c.debug("replaceTrack() [localId:%s, track.id:%s]",f,p.id):c.debug("replaceTrack() [localId:%s, no track]",f);const v=this._rtpSenders.get(f);if(!v)throw new Error("RTCRtpSender not found");v.setTrack(p)}async setMaxSpatialLayer(f,p){c.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",f,p);const v=this._rtpSenders.get(f);if(!v)throw new Error("RTCRtpSender not found");const E=v.getParameters();E.encodings.forEach((g,_)=>{_<=p?g.active=!0:g.active=!1}),await v.setParameters(E)}async setRtpEncodingParameters(f,p){c.debug("setRtpEncodingParameters() [localId:%s, params:%o]",f,p);const v=this._rtpSenders.get(f);if(!v)throw new Error("RTCRtpSender not found");const E=v.getParameters();E.encodings.forEach((g,_)=>{E.encodings[_]={...g,...p}}),await v.setParameters(E)}async getSenderStats(f){const p=this._rtpSenders.get(f);if(!p)throw new Error("RTCRtpSender not found");return p.getStats()}async sendDataChannel(f){throw new e.UnsupportedError("not implemented")}async receive(f){const p=[];for(const v of f){const{trackId:E,kind:g}=v;c.debug("receive() [trackId:%s, kind:%s]",E,g)}this._transportReady||await this.setupTransport({localDtlsRole:"server"});for(const v of f){const{trackId:E,kind:g,rtpParameters:_}=v;c.debug("receive() | calling new RTCRtpReceiver()");const m=new RTCRtpReceiver(this._dtlsTransport,g);m.addEventListener("error",R=>{c.error('rtpReceiver "error" event [event:%o]',R)});const y=n.mangleRtpParameters(_);c.debug("receive() | calling rtpReceiver.receive() [params:%o]",y),await m.receive(y);const b=E;this._rtpReceivers.set(b,m),p.push({localId:b,track:m.track,rtpReceiver:m})}return p}async stopReceiving(f){for(const p of f){c.debug("stopReceiving() [localId:%s]",p);const v=this._rtpReceivers.get(p);if(!v)throw new Error("RTCRtpReceiver not found");this._rtpReceivers.delete(p);try{c.debug("stopReceiving() | calling rtpReceiver.stop()"),v.stop()}catch(E){c.warn("stopReceiving() | rtpReceiver.stop() failed:%o",E)}}}async pauseReceiving(f){}async resumeReceiving(f){}async getReceiverStats(f){const p=this._rtpReceivers.get(f);if(!p)throw new Error("RTCRtpReceiver not found");return p.getStats()}async receiveDataChannel(f){throw new e.UnsupportedError("not implemented")}setIceGatherer({iceServers:f,iceTransportPolicy:p}){const v=new RTCIceGatherer({iceServers:f??[],gatherPolicy:p??"all"});v.addEventListener("error",E=>{c.error('iceGatherer "error" event [event:%o]',E)});try{v.gather()}catch(E){c.debug("setIceGatherer() | iceGatherer.gather() failed: %s",E.toString())}this._iceGatherer=v}setIceTransport(){const f=new RTCIceTransport(this._iceGatherer);f.addEventListener("statechange",()=>{switch(f.state){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),f.addEventListener("icestatechange",()=>{switch(f.state){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),f.addEventListener("candidatepairchange",p=>{c.debug('iceTransport "candidatepairchange" event [pair:%o]',p.pair)}),this._iceTransport=f}setDtlsTransport(){const f=new RTCDtlsTransport(this._iceTransport);f.addEventListener("statechange",()=>{c.debug('dtlsTransport "statechange" event [state:%s]',f.state)}),f.addEventListener("dtlsstatechange",()=>{c.debug('dtlsTransport "dtlsstatechange" event [state:%s]',f.state),f.state==="closed"&&this.emit("@connectionstatechange","closed")}),f.addEventListener("error",p=>{c.error('dtlsTransport "error" event [event:%o]',p)}),this._dtlsTransport=f}async setupTransport({localDtlsRole:f}){c.debug("setupTransport()");const p=this._dtlsTransport.getLocalParameters();p.role=f,await new Promise((v,E)=>{this.safeEmit("@connect",{dtlsParameters:p},v,E)}),this._iceTransport.start(this._iceGatherer,this._remoteIceParameters,"controlling");for(const v of this._remoteIceCandidates)this._iceTransport.addRemoteCandidate(v);this._iceTransport.addRemoteCandidate({}),this._remoteDtlsParameters.fingerprints=this._remoteDtlsParameters.fingerprints.filter(v=>v.algorithm==="sha-256"||v.algorithm==="sha-384"||v.algorithm==="sha-512"),this._dtlsTransport.start(this._remoteDtlsParameters),this._transportReady=!0}};return tl.Edge11=d,tl}var il={},k1;function h5(){if(k1)return il;k1=1,Object.defineProperty(il,"__esModule",{value:!0}),il.ReactNativeUnifiedPlan=void 0;const i=ri(),e=sr(),t=br(),r=Hr(),n=tn(),a=ga(),c=Pf(),l=Gr(),d=ii(),u=rn(),f=Ls(),p=new e.Logger("ReactNativeUnifiedPlan"),v="ReactNativeUnifiedPlan",E={OS:1024,MIS:1024};let g=class FC extends d.HandlerInterface{constructor(){super(),K(this,"_closed",!1),K(this,"_direction"),K(this,"_remoteSdp"),K(this,"_sendingRtpParametersByKind"),K(this,"_sendingRemoteRtpParametersByKind"),K(this,"_forcedLocalDtlsRole"),K(this,"_pc"),K(this,"_mapMidTransceiver",new Map),K(this,"_sendStream",new MediaStream),K(this,"_hasDataChannelMediaSection",!1),K(this,"_nextSendSctpStreamId",0),K(this,"_transportReady",!1)}static createFactory(){return()=>new FC}get name(){return v}close(){if(p.debug("close()"),!this._closed){if(this._closed=!0,this._sendStream.release(!1),this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){p.debug("getNativeRtpCapabilities()");const m=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{m.addTransceiver("audio"),m.addTransceiver("video");const y=await m.createOffer();try{m.close()}catch{}const b=i.parse(y.sdp),R=n.extractRtpCapabilities({sdpObject:b});return c.addNackSupportForOpus(R),R}catch(y){try{m.close()}catch{}throw y}}async getNativeSctpCapabilities(){return p.debug("getNativeSctpCapabilities()"),{numStreams:E}}run({direction:m,iceParameters:y,iceCandidates:b,dtlsParameters:R,sctpParameters:T,iceServers:w,iceTransportPolicy:C,additionalSettings:A,proprietaryConstraints:L,extendedRtpCapabilities:D}){this.assertNotClosed(),p.debug("run()"),this._direction=m,this._remoteSdp=new u.RemoteSdp({iceParameters:y,iceCandidates:b,dtlsParameters:R,sctpParameters:T}),this._sendingRtpParametersByKind={audio:r.getSendingRtpParameters("audio",D),video:r.getSendingRtpParameters("video",D)},this._sendingRemoteRtpParametersByKind={audio:r.getSendingRemoteRtpParameters("audio",D),video:r.getSendingRemoteRtpParameters("video",D)},R.role&&R.role!=="auto"&&(this._forcedLocalDtlsRole=R.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:w??[],iceTransportPolicy:C??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...A},L),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",P=>{this.emit("@icecandidateerror",P)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(p.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(m){this.assertNotClosed(),p.debug("updateIceServers()");const y=this._pc.getConfiguration();y.iceServers=m,this._pc.setConfiguration(y)}async restartIce(m){if(this.assertNotClosed(),p.debug("restartIce()"),this._remoteSdp.updateIceParameters(m),!!this._transportReady)if(this._direction==="send"){const y=await this._pc.createOffer({iceRestart:!0});p.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",y),await this._pc.setLocalDescription(y);const b={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",b),await this._pc.setRemoteDescription(b)}else{const y={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",y),await this._pc.setRemoteDescription(y);const b=await this._pc.createAnswer();p.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",b),await this._pc.setLocalDescription(b)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:m,encodings:y,codecOptions:b,codec:R,onRtpSender:T}){this.assertNotClosed(),this.assertSendDirection(),p.debug("send() [kind:%s, track.id:%s]",m.kind,m.id),y&&y.length>1&&y.forEach((N,U)=>{N.rid=`r${U}`});const w=t.clone(this._sendingRtpParametersByKind[m.kind]);w.codecs=r.reduceCodecs(w.codecs,R);const C=t.clone(this._sendingRemoteRtpParametersByKind[m.kind]);C.codecs=r.reduceCodecs(C.codecs,R);const A=this._remoteSdp.getNextMediaSectionIdx(),L=this._pc.addTransceiver(m,{direction:"sendonly",streams:[this._sendStream],sendEncodings:y});T&&T(L.sender);let D=await this._pc.createOffer(),P=i.parse(D.sdp);P.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let k;this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:P});let M=!1;const I=(0,f.parse)((y??[{}])[0].scalabilityMode);y&&y.length===1&&I.spatialLayers>1&&w.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(p.debug("send() | enabling legacy simulcast for VP9 SVC"),M=!0,P=i.parse(D.sdp),k=P.media[A.idx],a.addLegacySimulcast({offerMediaObject:k,numStreams:I.spatialLayers}),D={type:"offer",sdp:i.write(P)}),p.debug("send() | calling pc.setLocalDescription() [offer:%o]",D),await this._pc.setLocalDescription(D);let F=L.mid??void 0;if(F||p.warn("send() | missing transceiver.mid (bug in react-native-webrtc, using a workaround"),w.mid=F,P=i.parse(this._pc.localDescription.sdp),k=P.media[A.idx],w.rtcp.cname=n.getCname({offerMediaObject:k}),!y)w.encodings=a.getRtpEncodings({offerMediaObject:k});else if(y.length===1){let N=a.getRtpEncodings({offerMediaObject:k});Object.assign(N[0],y[0]),M&&(N=[N[0]]),w.encodings=N}else w.encodings=y;if(w.encodings.length>1&&(w.codecs[0].mimeType.toLowerCase()==="video/vp8"||w.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const N of w.encodings)N.scalabilityMode?N.scalabilityMode=`L1T${I.temporalLayers}`:N.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:k,reuseMid:A.reuseMid,offerRtpParameters:w,answerRtpParameters:C,codecOptions:b});const $={type:"answer",sdp:this._remoteSdp.getSdp()};return p.debug("send() | calling pc.setRemoteDescription() [answer:%o]",$),await this._pc.setRemoteDescription($),F||(F=L.mid,w.mid=F),this._mapMidTransceiver.set(F,L),{localId:F,rtpParameters:w,rtpSender:L.sender}}async stopSending(m){if(this.assertSendDirection(),this._closed)return;p.debug("stopSending() [localId:%s]",m);const y=this._mapMidTransceiver.get(m);if(!y)throw new Error("associated RTCRtpTransceiver not found");if(y.sender.replaceTrack(null),this._pc.removeTrack(y.sender),this._remoteSdp.closeMediaSection(y.mid))try{y.stop()}catch{}const b=await this._pc.createOffer();p.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",b),await this._pc.setLocalDescription(b);const R={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",R),await this._pc.setRemoteDescription(R),this._mapMidTransceiver.delete(m)}async pauseSending(m){this.assertNotClosed(),this.assertSendDirection(),p.debug("pauseSending() [localId:%s]",m);const y=this._mapMidTransceiver.get(m);if(!y)throw new Error("associated RTCRtpTransceiver not found");y.direction="inactive",this._remoteSdp.pauseMediaSection(m);const b=await this._pc.createOffer();p.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",b),await this._pc.setLocalDescription(b);const R={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",R),await this._pc.setRemoteDescription(R)}async resumeSending(m){this.assertNotClosed(),this.assertSendDirection(),p.debug("resumeSending() [localId:%s]",m);const y=this._mapMidTransceiver.get(m);if(this._remoteSdp.resumeSendingMediaSection(m),!y)throw new Error("associated RTCRtpTransceiver not found");y.direction="sendonly";const b=await this._pc.createOffer();p.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",b),await this._pc.setLocalDescription(b);const R={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",R),await this._pc.setRemoteDescription(R)}async replaceTrack(m,y){this.assertNotClosed(),this.assertSendDirection(),y?p.debug("replaceTrack() [localId:%s, track.id:%s]",m,y.id):p.debug("replaceTrack() [localId:%s, no track]",m);const b=this._mapMidTransceiver.get(m);if(!b)throw new Error("associated RTCRtpTransceiver not found");await b.sender.replaceTrack(y)}async setMaxSpatialLayer(m,y){this.assertNotClosed(),this.assertSendDirection(),p.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",m,y);const b=this._mapMidTransceiver.get(m);if(!b)throw new Error("associated RTCRtpTransceiver not found");const R=b.sender.getParameters();R.encodings.forEach((C,A)=>{A<=y?C.active=!0:C.active=!1}),await b.sender.setParameters(R),this._remoteSdp.muxMediaSectionSimulcast(m,R.encodings);const T=await this._pc.createOffer();p.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",T),await this._pc.setLocalDescription(T);const w={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",w),await this._pc.setRemoteDescription(w)}async setRtpEncodingParameters(m,y){this.assertNotClosed(),this.assertSendDirection(),p.debug("setRtpEncodingParameters() [localId:%s, params:%o]",m,y);const b=this._mapMidTransceiver.get(m);if(!b)throw new Error("associated RTCRtpTransceiver not found");const R=b.sender.getParameters();R.encodings.forEach((C,A)=>{R.encodings[A]={...C,...y}}),await b.sender.setParameters(R),this._remoteSdp.muxMediaSectionSimulcast(m,R.encodings);const T=await this._pc.createOffer();p.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",T),await this._pc.setLocalDescription(T);const w={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",w),await this._pc.setRemoteDescription(w)}async getSenderStats(m){this.assertNotClosed(),this.assertSendDirection();const y=this._mapMidTransceiver.get(m);if(!y)throw new Error("associated RTCRtpTransceiver not found");return y.sender.getStats()}async sendDataChannel({ordered:m,maxPacketLifeTime:y,maxRetransmits:b,label:R,protocol:T}){this.assertNotClosed(),this.assertSendDirection();const w={negotiated:!0,id:this._nextSendSctpStreamId,ordered:m,maxPacketLifeTime:y,maxRetransmits:b,protocol:T};p.debug("sendDataChannel() [options:%o]",w);const C=this._pc.createDataChannel(R,w);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%E.MIS,!this._hasDataChannelMediaSection){const L=await this._pc.createOffer(),D=i.parse(L.sdp),P=D.media.find(M=>M.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:D}),p.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",L),await this._pc.setLocalDescription(L),this._remoteSdp.sendSctpAssociation({offerMediaObject:P});const k={type:"answer",sdp:this._remoteSdp.getSdp()};p.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",k),await this._pc.setRemoteDescription(k),this._hasDataChannelMediaSection=!0}const A={streamId:w.id,ordered:w.ordered,maxPacketLifeTime:w.maxPacketLifeTime,maxRetransmits:w.maxRetransmits};return{dataChannel:C,sctpStreamParameters:A}}async receive(m){this.assertNotClosed(),this.assertRecvDirection();const y=[],b=new Map;for(const C of m){const{trackId:A,kind:L,rtpParameters:D,streamId:P}=C;p.debug("receive() [trackId:%s, kind:%s]",A,L);const k=D.mid??String(this._mapMidTransceiver.size);b.set(A,k),this._remoteSdp.receive({mid:k,kind:L,offerRtpParameters:D,streamId:P??D.rtcp.cname,trackId:A})}const R={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",R),await this._pc.setRemoteDescription(R);for(const C of m){const{trackId:A,onRtpReceiver:L}=C;if(L){const D=b.get(A),P=this._pc.getTransceivers().find(k=>k.mid===D);if(!P)throw new Error("transceiver not found");L(P.receiver)}}let T=await this._pc.createAnswer();const w=i.parse(T.sdp);for(const C of m){const{trackId:A,rtpParameters:L}=C,D=b.get(A),P=w.media.find(k=>String(k.mid)===D);n.applyCodecParameters({offerRtpParameters:L,answerMediaObject:P})}T={type:"answer",sdp:i.write(w)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:w}),p.debug("receive() | calling pc.setLocalDescription() [answer:%o]",T),await this._pc.setLocalDescription(T);for(const C of m){const{trackId:A}=C,L=b.get(A),D=this._pc.getTransceivers().find(P=>P.mid===L);if(D)this._mapMidTransceiver.set(L,D),y.push({localId:L,track:D.receiver.track,rtpReceiver:D.receiver});else throw new Error("new RTCRtpTransceiver not found")}return y}async stopReceiving(m){if(this.assertRecvDirection(),this._closed)return;for(const R of m){p.debug("stopReceiving() [localId:%s]",R);const T=this._mapMidTransceiver.get(R);if(!T)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(T.mid)}const y={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",y),await this._pc.setRemoteDescription(y);const b=await this._pc.createAnswer();p.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",b),await this._pc.setLocalDescription(b);for(const R of m)this._mapMidTransceiver.delete(R)}async pauseReceiving(m){this.assertNotClosed(),this.assertRecvDirection();for(const R of m){p.debug("pauseReceiving() [localId:%s]",R);const T=this._mapMidTransceiver.get(R);if(!T)throw new Error("associated RTCRtpTransceiver not found");T.direction="inactive",this._remoteSdp.pauseMediaSection(R)}const y={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",y),await this._pc.setRemoteDescription(y);const b=await this._pc.createAnswer();p.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",b),await this._pc.setLocalDescription(b)}async resumeReceiving(m){this.assertNotClosed(),this.assertRecvDirection();for(const R of m){p.debug("resumeReceiving() [localId:%s]",R);const T=this._mapMidTransceiver.get(R);if(!T)throw new Error("associated RTCRtpTransceiver not found");T.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(R)}const y={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",y),await this._pc.setRemoteDescription(y);const b=await this._pc.createAnswer();p.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",b),await this._pc.setLocalDescription(b)}async getReceiverStats(m){this.assertNotClosed(),this.assertRecvDirection();const y=this._mapMidTransceiver.get(m);if(!y)throw new Error("associated RTCRtpTransceiver not found");return y.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:m,label:y,protocol:b}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:R,ordered:T,maxPacketLifeTime:w,maxRetransmits:C}=m,A={negotiated:!0,id:R,ordered:T,maxPacketLifeTime:w,maxRetransmits:C,protocol:b};p.debug("receiveDataChannel() [options:%o]",A);const L=this._pc.createDataChannel(y,A);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const D={type:"offer",sdp:this._remoteSdp.getSdp()};p.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",D),await this._pc.setRemoteDescription(D);const P=await this._pc.createAnswer();if(!this._transportReady){const k=i.parse(P.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:k})}p.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",P),await this._pc.setLocalDescription(P),this._hasDataChannelMediaSection=!0}return{dataChannel:L}}async setupTransport({localDtlsRole:m,localSdpObject:y}){y||(y=i.parse(this._pc.localDescription.sdp));const b=n.extractDtlsParameters({sdpObject:y});b.role=m,this._remoteSdp.updateDtlsRole(m==="client"?"server":"client"),await new Promise((R,T)=>{this.safeEmit("@connect",{dtlsParameters:b},R,T)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new l.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};return il.ReactNativeUnifiedPlan=g,il}var nl={},M1;function p5(){if(M1)return nl;M1=1,Object.defineProperty(nl,"__esModule",{value:!0}),nl.ReactNative=void 0;const i=ri(),e=sr(),t=Gr(),r=br(),n=Hr(),a=tn(),c=kf(),l=ii(),d=rn(),u=new e.Logger("ReactNative"),f="ReactNative",p={OS:1024,MIS:1024};let v=class UC extends l.HandlerInterface{constructor(){super(),K(this,"_direction"),K(this,"_remoteSdp"),K(this,"_sendingRtpParametersByKind"),K(this,"_sendingRemoteRtpParametersByKind"),K(this,"_forcedLocalDtlsRole"),K(this,"_pc"),K(this,"_sendStream",new MediaStream),K(this,"_mapSendLocalIdTrack",new Map),K(this,"_nextSendLocalId",0),K(this,"_mapRecvLocalIdInfo",new Map),K(this,"_hasDataChannelMediaSection",!1),K(this,"_nextSendSctpStreamId",0),K(this,"_transportReady",!1)}static createFactory(){return()=>new UC}get name(){return f}close(){if(u.debug("close()"),this._sendStream.release(!1),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){u.debug("getNativeRtpCapabilities()");const g=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const _=await g.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{g.close()}catch{}const m=i.parse(_.sdp);return a.extractRtpCapabilities({sdpObject:m})}catch(_){try{g.close()}catch{}throw _}}async getNativeSctpCapabilities(){return u.debug("getNativeSctpCapabilities()"),{numStreams:p}}run({direction:g,iceParameters:_,iceCandidates:m,dtlsParameters:y,sctpParameters:b,iceServers:R,iceTransportPolicy:T,additionalSettings:w,proprietaryConstraints:C,extendedRtpCapabilities:A}){u.debug("run()"),this._direction=g,this._remoteSdp=new d.RemoteSdp({iceParameters:_,iceCandidates:m,dtlsParameters:y,sctpParameters:b,planB:!0}),this._sendingRtpParametersByKind={audio:n.getSendingRtpParameters("audio",A),video:n.getSendingRtpParameters("video",A)},this._sendingRemoteRtpParametersByKind={audio:n.getSendingRemoteRtpParameters("audio",A),video:n.getSendingRemoteRtpParameters("video",A)},y.role&&y.role!=="auto"&&(this._forcedLocalDtlsRole=y.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:R??[],iceTransportPolicy:T??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...w},C),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",L=>{this.emit("@icecandidateerror",L)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(u.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(g){u.debug("updateIceServers()");const _=this._pc.getConfiguration();_.iceServers=g,this._pc.setConfiguration(_)}async restartIce(g){if(u.debug("restartIce()"),this._remoteSdp.updateIceParameters(g),!!this._transportReady)if(this._direction==="send"){const _=await this._pc.createOffer({iceRestart:!0});u.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",_),await this._pc.setLocalDescription(_);const m={type:"answer",sdp:this._remoteSdp.getSdp()};u.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",m),await this._pc.setRemoteDescription(m)}else{const _={type:"offer",sdp:this._remoteSdp.getSdp()};u.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",_),await this._pc.setRemoteDescription(_);const m=await this._pc.createAnswer();u.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",m),await this._pc.setLocalDescription(m)}}async getTransportStats(){return this._pc.getStats()}async send({track:g,encodings:_,codecOptions:m,codec:y}){this.assertSendDirection(),u.debug("send() [kind:%s, track.id:%s]",g.kind,g.id),y&&u.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(g),this._pc.addStream(this._sendStream);let b=await this._pc.createOffer(),R=i.parse(b.sdp);R.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let T;const w=r.clone(this._sendingRtpParametersByKind[g.kind]);w.codecs=n.reduceCodecs(w.codecs);const C=r.clone(this._sendingRemoteRtpParametersByKind[g.kind]);if(C.codecs=n.reduceCodecs(C.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:R}),g.kind==="video"&&_&&_.length>1&&(u.debug("send() | enabling simulcast"),R=i.parse(b.sdp),T=R.media.find(D=>D.type==="video"),c.addLegacySimulcast({offerMediaObject:T,track:g,numStreams:_.length}),b={type:"offer",sdp:i.write(R)}),u.debug("send() | calling pc.setLocalDescription() [offer:%o]",b),await this._pc.setLocalDescription(b),R=i.parse(this._pc.localDescription.sdp),T=R.media.find(D=>D.type===g.kind),w.rtcp.cname=a.getCname({offerMediaObject:T}),w.encodings=c.getRtpEncodings({offerMediaObject:T,track:g}),_)for(let D=0;D<w.encodings.length;++D)_[D]&&Object.assign(w.encodings[D],_[D]);if(w.encodings.length>1&&(w.codecs[0].mimeType.toLowerCase()==="video/vp8"||w.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const D of w.encodings)D.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:T,offerRtpParameters:w,answerRtpParameters:C,codecOptions:m});const A={type:"answer",sdp:this._remoteSdp.getSdp()};u.debug("send() | calling pc.setRemoteDescription() [answer:%o]",A),await this._pc.setRemoteDescription(A);const L=String(this._nextSendLocalId);return this._nextSendLocalId++,this._mapSendLocalIdTrack.set(L,g),{localId:L,rtpParameters:w}}async stopSending(g){this.assertSendDirection(),u.debug("stopSending() [localId:%s]",g);const _=this._mapSendLocalIdTrack.get(g);if(!_)throw new Error("track not found");this._mapSendLocalIdTrack.delete(g),this._sendStream.removeTrack(_),this._pc.addStream(this._sendStream);const m=await this._pc.createOffer();u.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",m);try{await this._pc.setLocalDescription(m)}catch(b){if(this._sendStream.getTracks().length===0){u.warn("stopSending() | ignoring expected error due no sending tracks: %s",b.toString());return}throw b}if(this._pc.signalingState==="stable")return;const y={type:"answer",sdp:this._remoteSdp.getSdp()};u.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",y),await this._pc.setRemoteDescription(y)}async pauseSending(g){}async resumeSending(g){}async replaceTrack(g,_){throw new t.UnsupportedError("not implemented")}async setMaxSpatialLayer(g,_){throw new t.UnsupportedError("not implemented")}async setRtpEncodingParameters(g,_){throw new t.UnsupportedError("not implemented")}async getSenderStats(g){throw new t.UnsupportedError("not implemented")}async sendDataChannel({ordered:g,maxPacketLifeTime:_,maxRetransmits:m,label:y,protocol:b}){this.assertSendDirection();const R={negotiated:!0,id:this._nextSendSctpStreamId,ordered:g,maxPacketLifeTime:_,maxRetransmitTime:_,maxRetransmits:m,protocol:b};u.debug("sendDataChannel() [options:%o]",R);const T=this._pc.createDataChannel(y,R);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%p.MIS,!this._hasDataChannelMediaSection){const C=await this._pc.createOffer(),A=i.parse(C.sdp),L=A.media.find(P=>P.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:A}),u.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",C),await this._pc.setLocalDescription(C),this._remoteSdp.sendSctpAssociation({offerMediaObject:L});const D={type:"answer",sdp:this._remoteSdp.getSdp()};u.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",D),await this._pc.setRemoteDescription(D),this._hasDataChannelMediaSection=!0}const w={streamId:R.id,ordered:R.ordered,maxPacketLifeTime:R.maxPacketLifeTime,maxRetransmits:R.maxRetransmits};return{dataChannel:T,sctpStreamParameters:w}}async receive(g){this.assertRecvDirection();const _=[],m=new Map;for(const T of g){const{trackId:w,kind:C,rtpParameters:A}=T;u.debug("receive() [trackId:%s, kind:%s]",w,C);const L=C;let D=T.streamId??A.rtcp.cname;u.debug("receive() | forcing a random remote streamId to avoid well known bug in react-native-webrtc"),D+=`-hack-${r.generateRandomNumber()}`,m.set(w,D),this._remoteSdp.receive({mid:L,kind:C,offerRtpParameters:A,streamId:D,trackId:w})}const y={type:"offer",sdp:this._remoteSdp.getSdp()};u.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",y),await this._pc.setRemoteDescription(y);let b=await this._pc.createAnswer();const R=i.parse(b.sdp);for(const T of g){const{kind:w,rtpParameters:C}=T,A=w,L=R.media.find(D=>String(D.mid)===A);a.applyCodecParameters({offerRtpParameters:C,answerMediaObject:L})}b={type:"answer",sdp:i.write(R)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:R}),u.debug("receive() | calling pc.setLocalDescription() [answer:%o]",b),await this._pc.setLocalDescription(b);for(const T of g){const{kind:w,trackId:C,rtpParameters:A}=T,L=C,D=w,P=m.get(C),k=this._pc.getRemoteStreams().find(M=>M.id===P).getTrackById(L);if(!k)throw new Error("remote track not found");this._mapRecvLocalIdInfo.set(L,{mid:D,rtpParameters:A}),_.push({localId:L,track:k})}return _}async stopReceiving(g){this.assertRecvDirection();for(const y of g){u.debug("stopReceiving() [localId:%s]",y);const{mid:b,rtpParameters:R}=this._mapRecvLocalIdInfo.get(y)??{};this._mapRecvLocalIdInfo.delete(y),this._remoteSdp.planBStopReceiving({mid:b,offerRtpParameters:R})}const _={type:"offer",sdp:this._remoteSdp.getSdp()};u.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",_),await this._pc.setRemoteDescription(_);const m=await this._pc.createAnswer();u.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",m),await this._pc.setLocalDescription(m)}async pauseReceiving(g){}async resumeReceiving(g){}async getReceiverStats(g){throw new t.UnsupportedError("not implemented")}async receiveDataChannel({sctpStreamParameters:g,label:_,protocol:m}){this.assertRecvDirection();const{streamId:y,ordered:b,maxPacketLifeTime:R,maxRetransmits:T}=g,w={negotiated:!0,id:y,ordered:b,maxPacketLifeTime:R,maxRetransmitTime:R,maxRetransmits:T,protocol:m};u.debug("receiveDataChannel() [options:%o]",w);const C=this._pc.createDataChannel(_,w);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const A={type:"offer",sdp:this._remoteSdp.getSdp()};u.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",A),await this._pc.setRemoteDescription(A);const L=await this._pc.createAnswer();if(!this._transportReady){const D=i.parse(L.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:D})}u.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",L),await this._pc.setLocalDescription(L),this._hasDataChannelMediaSection=!0}return{dataChannel:C}}async setupTransport({localDtlsRole:g,localSdpObject:_}){_||(_=i.parse(this._pc.localDescription.sdp));const m=a.extractDtlsParameters({sdpObject:_});m.role=g,this._remoteSdp.updateDtlsRole(g==="client"?"server":"client"),await new Promise((y,b)=>{this.safeEmit("@connect",{dtlsParameters:m},y,b)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}};return nl.ReactNative=v,nl}var N1;function jC(){if(N1)return ra;N1=1,Object.defineProperty(ra,"__esModule",{value:!0}),ra.Device=void 0,ra.detectDeviceAsync=T,ra.detectDevice=w;const i=WB(),e=sr(),t=Ds(),r=Gr(),n=br(),a=Hr(),c=AC(),l=r5(),d=i5(),u=n5(),f=s5(),p=a5(),v=o5(),E=c5(),g=l5(),_=u5(),m=f5(),y=h5(),b=p5(),R=new e.Logger("Device");async function T(L){R.debug("detectDeviceAsync() [userAgent:%s]",L),!L&&typeof navigator=="object"&&(L=navigator.userAgent);const D=await(0,i.UAParser)(L).withFeatureCheck();return A(D)}function w(L){R.debug("detectDevice() [userAgent:%s]",L),!L&&typeof navigator=="object"&&(L=navigator.userAgent);const D=(0,i.UAParser)(L);return A(D)}let C=class $C{constructor({handlerName:D,handlerFactory:P}={}){if(K(this,"_handlerFactory"),K(this,"_handlerName"),K(this,"_loaded",!1),K(this,"_extendedRtpCapabilities"),K(this,"_recvRtpCapabilities"),K(this,"_canProduceByKind"),K(this,"_sctpCapabilities"),K(this,"_observer",new t.EnhancedEventEmitter),R.debug("constructor()"),D&&P)throw new TypeError("just one of handlerName or handlerInterface can be given");if(P)this._handlerFactory=P;else{if(D)R.debug("constructor() | handler given: %s",D);else if(D=w(),D)R.debug("constructor() | detected handler: %s",D);else throw new r.UnsupportedError("device not supported");switch(D){case"Chrome111":{this._handlerFactory=l.Chrome111.createFactory();break}case"Chrome74":{this._handlerFactory=d.Chrome74.createFactory();break}case"Chrome70":{this._handlerFactory=u.Chrome70.createFactory();break}case"Chrome67":{this._handlerFactory=f.Chrome67.createFactory();break}case"Chrome55":{this._handlerFactory=p.Chrome55.createFactory();break}case"Firefox120":{this._handlerFactory=v.Firefox120.createFactory();break}case"Firefox60":{this._handlerFactory=E.Firefox60.createFactory();break}case"Safari12":{this._handlerFactory=g.Safari12.createFactory();break}case"Safari11":{this._handlerFactory=_.Safari11.createFactory();break}case"Edge11":{this._handlerFactory=m.Edge11.createFactory();break}case"ReactNativeUnifiedPlan":{this._handlerFactory=y.ReactNativeUnifiedPlan.createFactory();break}case"ReactNative":{this._handlerFactory=b.ReactNative.createFactory();break}default:throw new TypeError(`unknown handlerName "${D}"`)}}const k=this._handlerFactory();this._handlerName=k.name,k.close(),this._extendedRtpCapabilities=void 0,this._recvRtpCapabilities=void 0,this._canProduceByKind={audio:!1,video:!1},this._sctpCapabilities=void 0}static async factory({handlerName:D,handlerFactory:P}={}){if(R.debug("factory()"),D&&P)throw new TypeError("just one of handlerName or handlerInterface can be given");if(!D&&!P&&(D=await T(),!D))throw new r.UnsupportedError("device not supported");return new $C({handlerName:D,handlerFactory:P})}get handlerName(){return this._handlerName}get loaded(){return this._loaded}get rtpCapabilities(){if(!this._loaded)throw new r.InvalidStateError("not loaded");return this._recvRtpCapabilities}get sctpCapabilities(){if(!this._loaded)throw new r.InvalidStateError("not loaded");return this._sctpCapabilities}get observer(){return this._observer}async load({routerRtpCapabilities:D,preferLocalCodecsOrder:P=!1}){R.debug("load() [routerRtpCapabilities:%o]",D);let k;try{if(this._loaded)throw new r.InvalidStateError("already loaded");const M=n.clone(D);a.validateRtpCapabilities(M),k=this._handlerFactory();const I=await k.getNativeRtpCapabilities();R.debug("load() | got native RTP capabilities:%o",I);const F=n.clone(I);a.validateRtpCapabilities(F),this._extendedRtpCapabilities=a.getExtendedRtpCapabilities(F,M,P),R.debug("load() | got extended RTP capabilities:%o",this._extendedRtpCapabilities),this._canProduceByKind.audio=a.canSend("audio",this._extendedRtpCapabilities),this._canProduceByKind.video=a.canSend("video",this._extendedRtpCapabilities),this._recvRtpCapabilities=a.getRecvRtpCapabilities(this._extendedRtpCapabilities),a.validateRtpCapabilities(this._recvRtpCapabilities),R.debug("load() | got receiving RTP capabilities:%o",this._recvRtpCapabilities),this._sctpCapabilities=await k.getNativeSctpCapabilities(),R.debug("load() | got native SCTP capabilities:%o",this._sctpCapabilities),a.validateSctpCapabilities(this._sctpCapabilities),R.debug("load() succeeded"),this._loaded=!0,k.close()}catch(M){throw k&&k.close(),M}}canProduce(D){if(this._loaded){if(D!=="audio"&&D!=="video")throw new TypeError(`invalid kind "${D}"`)}else throw new r.InvalidStateError("not loaded");return this._canProduceByKind[D]}createSendTransport({id:D,iceParameters:P,iceCandidates:k,dtlsParameters:M,sctpParameters:I,iceServers:F,iceTransportPolicy:$,additionalSettings:N,proprietaryConstraints:U,appData:V}){return R.debug("createSendTransport()"),this.createTransport({direction:"send",id:D,iceParameters:P,iceCandidates:k,dtlsParameters:M,sctpParameters:I,iceServers:F,iceTransportPolicy:$,additionalSettings:N,proprietaryConstraints:U,appData:V})}createRecvTransport({id:D,iceParameters:P,iceCandidates:k,dtlsParameters:M,sctpParameters:I,iceServers:F,iceTransportPolicy:$,additionalSettings:N,proprietaryConstraints:U,appData:V}){return R.debug("createRecvTransport()"),this.createTransport({direction:"recv",id:D,iceParameters:P,iceCandidates:k,dtlsParameters:M,sctpParameters:I,iceServers:F,iceTransportPolicy:$,additionalSettings:N,proprietaryConstraints:U,appData:V})}createTransport({direction:D,id:P,iceParameters:k,iceCandidates:M,dtlsParameters:I,sctpParameters:F,iceServers:$,iceTransportPolicy:N,additionalSettings:U,proprietaryConstraints:V,appData:J}){if(this._loaded){if(typeof P!="string")throw new TypeError("missing id");if(typeof k!="object")throw new TypeError("missing iceParameters");if(Array.isArray(M)){if(typeof I!="object")throw new TypeError("missing dtlsParameters");if(F&&typeof F!="object")throw new TypeError("wrong sctpParameters");if(J&&typeof J!="object")throw new TypeError("if given, appData must be an object")}else throw new TypeError("missing iceCandidates")}else throw new r.InvalidStateError("not loaded");const j=new c.Transport({direction:D,id:P,iceParameters:k,iceCandidates:M,dtlsParameters:I,sctpParameters:F,iceServers:$,iceTransportPolicy:N,additionalSettings:U,proprietaryConstraints:V,appData:J,handlerFactory:this._handlerFactory,extendedRtpCapabilities:this._extendedRtpCapabilities,canProduceByKind:this._canProduceByKind});return this._observer.safeEmit("newtransport",j),j}};ra.Device=C;function A(L){var D,P,k,M;if(typeof navigator=="object"&&navigator.product==="ReactNative"){if(R.debug("detectDeviceImpl() | React-Native detected"),typeof RTCPeerConnection>"u"){R.warn("detectDeviceImpl() | unsupported react-native-webrtc without RTCPeerConnection, forgot to call registerGlobals()?");return}return typeof RTCRtpTransceiver<"u"?(R.debug("detectDeviceImpl() | ReactNative UnifiedPlan handler chosen"),"ReactNativeUnifiedPlan"):(R.debug("detectDeviceImpl() | ReactNative PlanB handler chosen"),"ReactNative")}else{R.debug("detectDeviceImpl() | browser detected [userAgent:%s, parsed:%o]",L.ua,L);const I=L.browser,F=(D=I.name)==null?void 0:D.toLowerCase(),$=parseInt(I.major??"0"),N=(P=L.engine.name)==null?void 0:P.toLowerCase(),U=L.os,V=(k=U.name)==null?void 0:k.toLowerCase(),J=parseFloat(U.version??"0"),j=(M=L.device.model)==null?void 0:M.toLowerCase(),q=V==="ios"||j==="ipad",Z=F&&["chrome","chromium","mobile chrome","chrome webview","chrome headless"].includes(F),X=F&&["firefox","mobile firefox","mobile focus"].includes(F),Y=F&&["safari","mobile safari"].includes(F),re=F&&["edge"].includes(F);if((Z||re)&&!q&&$>=111)return"Chrome111";if(Z&&!q&&$>=74||re&&!q&&$>=88)return"Chrome74";if(Z&&!q&&$>=70)return"Chrome70";if(Z&&!q&&$>=67)return"Chrome67";if(Z&&!q&&$>=55)return"Chrome55";if(X&&!q&&$>=120)return"Firefox120";if(X&&!q&&$>=60)return"Firefox60";if(X&&q&&J>=14.3||Y&&$>=12&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(Y&&$>=11)return"Safari11";if(re&&!q&&$>=11&&$<=18)return"Edge11";if(N==="webkit"&&q&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(N==="blink"){const oe=L.ua.match(/(?:(?:Chrome|Chromium))[ /](\w+)/i);if(oe){const ve=Number(oe[1]);return ve>=111?"Chrome111":ve>=74?"Chrome74":ve>=70?"Chrome70":ve>=67?"Chrome67":"Chrome55"}else return"Chrome111"}else{R.warn("detectDeviceImpl() | browser not supported [name:%s, version:%s]",F,$);return}}}return ra}var B1={},F1;function m5(){return F1||(F1=1,Object.defineProperty(B1,"__esModule",{value:!0})),B1}var U1={},$1;function g5(){return $1||($1=1,Object.defineProperty(U1,"__esModule",{value:!0})),U1}var j1;function v5(){return j1||(j1=1,function(i){var e=so&&so.__createBinding||(Object.create?function(r,n,a,c){c===void 0&&(c=a);var l=Object.getOwnPropertyDescriptor(n,a);(!l||("get"in l?!n.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(r,c,l)}:function(r,n,a,c){c===void 0&&(c=a),r[c]=n[a]}),t=so&&so.__exportStar||function(r,n){for(var a in r)a!=="default"&&!Object.prototype.hasOwnProperty.call(n,a)&&e(n,r,a)};Object.defineProperty(i,"__esModule",{value:!0}),t(jC(),i),t(AC(),i),t(RC(),i),t(wC(),i),t(TC(),i),t(CC(),i),t(m5(),i),t(g5(),i),t(ii(),i),t(Gr(),i)}(so)),so}var sl={},al={},z1={},Hm={},G1;function y5(){return G1||(G1=1,Object.defineProperty(Hm,"__esModule",{value:!0}),Hm.default="ffffffff-ffff-ffff-ffff-ffffffffffff"),Hm}var Vm={},H1;function b5(){return H1||(H1=1,Object.defineProperty(Vm,"__esModule",{value:!0}),Vm.default="00000000-0000-0000-0000-000000000000"),Vm}var gd={},vd={},Km={},V1;function _5(){return V1||(V1=1,Object.defineProperty(Km,"__esModule",{value:!0}),Km.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i),Km}var K1;function Mf(){if(K1)return vd;K1=1,Object.defineProperty(vd,"__esModule",{value:!0});const i=_5();function e(t){return typeof t=="string"&&i.default.test(t)}return vd.default=e,vd}var q1;function Nf(){if(q1)return gd;q1=1,Object.defineProperty(gd,"__esModule",{value:!0});const i=Mf();function e(t){if(!(0,i.default)(t))throw TypeError("Invalid UUID");let r;return Uint8Array.of((r=parseInt(t.slice(0,8),16))>>>24,r>>>16&255,r>>>8&255,r&255,(r=parseInt(t.slice(9,13),16))>>>8,r&255,(r=parseInt(t.slice(14,18),16))>>>8,r&255,(r=parseInt(t.slice(19,23),16))>>>8,r&255,(r=parseInt(t.slice(24,36),16))/1099511627776&255,r/4294967296&255,r>>>24&255,r>>>16&255,r>>>8&255,r&255)}return gd.default=e,gd}var oo={},Y1;function Os(){if(Y1)return oo;Y1=1,Object.defineProperty(oo,"__esModule",{value:!0}),oo.unsafeStringify=void 0;const i=Mf(),e=[];for(let n=0;n<256;++n)e.push((n+256).toString(16).slice(1));function t(n,a=0){return(e[n[a+0]]+e[n[a+1]]+e[n[a+2]]+e[n[a+3]]+"-"+e[n[a+4]]+e[n[a+5]]+"-"+e[n[a+6]]+e[n[a+7]]+"-"+e[n[a+8]]+e[n[a+9]]+"-"+e[n[a+10]]+e[n[a+11]]+e[n[a+12]]+e[n[a+13]]+e[n[a+14]]+e[n[a+15]]).toLowerCase()}oo.unsafeStringify=t;function r(n,a=0){const c=t(n,a);if(!(0,i.default)(c))throw TypeError("Stringified UUID is invalid");return c}return oo.default=r,oo}var co={},yd={},W1;function $v(){if(W1)return yd;W1=1,Object.defineProperty(yd,"__esModule",{value:!0});let i;const e=new Uint8Array(16);function t(){if(!i){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");i=crypto.getRandomValues.bind(crypto)}return i(e)}return yd.default=t,yd}var X1;function zC(){if(X1)return co;X1=1,Object.defineProperty(co,"__esModule",{value:!0}),co.updateV1State=void 0;const i=$v(),e=Os(),t={};function r(c,l,d){var u;let f;const p=(c==null?void 0:c._v6)??!1;if(c){const v=Object.keys(c);v.length===1&&v[0]==="_v6"&&(c=void 0)}if(c)f=a(c.random??((u=c.rng)==null?void 0:u.call(c))??(0,i.default)(),c.msecs,c.nsecs,c.clockseq,c.node,l,d);else{const v=Date.now(),E=(0,i.default)();n(t,v,E),f=a(E,t.msecs,t.nsecs,p?void 0:t.clockseq,p?void 0:t.node,l,d)}return l??(0,e.unsafeStringify)(f)}function n(c,l,d){return c.msecs??(c.msecs=-1/0),c.nsecs??(c.nsecs=0),l===c.msecs?(c.nsecs++,c.nsecs>=1e4&&(c.node=void 0,c.nsecs=0)):l>c.msecs?c.nsecs=0:l<c.msecs&&(c.node=void 0),c.node||(c.node=d.slice(10,16),c.node[0]|=1,c.clockseq=(d[8]<<8|d[9])&16383),c.msecs=l,c}co.updateV1State=n;function a(c,l,d,u,f,p,v=0){if(c.length<16)throw new Error("Random bytes length must be >= 16");if(!p)p=new Uint8Array(16),v=0;else if(v<0||v+16>p.length)throw new RangeError(`UUID byte range ${v}:${v+15} is out of buffer bounds`);l??(l=Date.now()),d??(d=0),u??(u=(c[8]<<8|c[9])&16383),f??(f=c.slice(10,16)),l+=122192928e5;const E=((l&268435455)*1e4+d)%4294967296;p[v++]=E>>>24&255,p[v++]=E>>>16&255,p[v++]=E>>>8&255,p[v++]=E&255;const g=l/4294967296*1e4&268435455;p[v++]=g>>>8&255,p[v++]=g&255,p[v++]=g>>>24&15|16,p[v++]=g>>>16&255,p[v++]=u>>>8|128,p[v++]=u&255;for(let _=0;_<6;++_)p[v++]=f[_];return p}return co.default=r,co}var bd={},Q1;function GC(){if(Q1)return bd;Q1=1,Object.defineProperty(bd,"__esModule",{value:!0});const i=Nf(),e=Os();function t(n){const a=typeof n=="string"?(0,i.default)(n):n,c=r(a);return typeof n=="string"?(0,e.unsafeStringify)(c):c}bd.default=t;function r(n){return Uint8Array.of((n[6]&15)<<4|n[7]>>4&15,(n[7]&15)<<4|(n[4]&240)>>4,(n[4]&15)<<4|(n[5]&240)>>4,(n[5]&15)<<4|(n[0]&240)>>4,(n[0]&15)<<4|(n[1]&240)>>4,(n[1]&15)<<4|(n[2]&240)>>4,96|n[2]&15,n[3],n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15])}return bd}var Z1={},_d={},J1;function S5(){if(J1)return _d;J1=1,Object.defineProperty(_d,"__esModule",{value:!0});function i(v){const E=n(v),g=r(E,v.length*8);return e(g)}function e(v){const E=new Uint8Array(v.length*4);for(let g=0;g<v.length*4;g++)E[g]=v[g>>2]>>>g%4*8&255;return E}function t(v){return(v+64>>>9<<4)+14+1}function r(v,E){const g=new Uint32Array(t(E)).fill(0);g.set(v),g[E>>5]|=128<<E%32,g[g.length-1]=E,v=g;let _=1732584193,m=-271733879,y=-1732584194,b=271733878;for(let R=0;R<v.length;R+=16){const T=_,w=m,C=y,A=b;_=d(_,m,y,b,v[R],7,-680876936),b=d(b,_,m,y,v[R+1],12,-389564586),y=d(y,b,_,m,v[R+2],17,606105819),m=d(m,y,b,_,v[R+3],22,-1044525330),_=d(_,m,y,b,v[R+4],7,-176418897),b=d(b,_,m,y,v[R+5],12,1200080426),y=d(y,b,_,m,v[R+6],17,-1473231341),m=d(m,y,b,_,v[R+7],22,-45705983),_=d(_,m,y,b,v[R+8],7,1770035416),b=d(b,_,m,y,v[R+9],12,-1958414417),y=d(y,b,_,m,v[R+10],17,-42063),m=d(m,y,b,_,v[R+11],22,-1990404162),_=d(_,m,y,b,v[R+12],7,1804603682),b=d(b,_,m,y,v[R+13],12,-40341101),y=d(y,b,_,m,v[R+14],17,-1502002290),m=d(m,y,b,_,v[R+15],22,1236535329),_=u(_,m,y,b,v[R+1],5,-165796510),b=u(b,_,m,y,v[R+6],9,-1069501632),y=u(y,b,_,m,v[R+11],14,643717713),m=u(m,y,b,_,v[R],20,-373897302),_=u(_,m,y,b,v[R+5],5,-701558691),b=u(b,_,m,y,v[R+10],9,38016083),y=u(y,b,_,m,v[R+15],14,-660478335),m=u(m,y,b,_,v[R+4],20,-405537848),_=u(_,m,y,b,v[R+9],5,568446438),b=u(b,_,m,y,v[R+14],9,-1019803690),y=u(y,b,_,m,v[R+3],14,-187363961),m=u(m,y,b,_,v[R+8],20,1163531501),_=u(_,m,y,b,v[R+13],5,-1444681467),b=u(b,_,m,y,v[R+2],9,-51403784),y=u(y,b,_,m,v[R+7],14,1735328473),m=u(m,y,b,_,v[R+12],20,-1926607734),_=f(_,m,y,b,v[R+5],4,-378558),b=f(b,_,m,y,v[R+8],11,-2022574463),y=f(y,b,_,m,v[R+11],16,1839030562),m=f(m,y,b,_,v[R+14],23,-35309556),_=f(_,m,y,b,v[R+1],4,-1530992060),b=f(b,_,m,y,v[R+4],11,1272893353),y=f(y,b,_,m,v[R+7],16,-155497632),m=f(m,y,b,_,v[R+10],23,-1094730640),_=f(_,m,y,b,v[R+13],4,681279174),b=f(b,_,m,y,v[R],11,-358537222),y=f(y,b,_,m,v[R+3],16,-722521979),m=f(m,y,b,_,v[R+6],23,76029189),_=f(_,m,y,b,v[R+9],4,-640364487),b=f(b,_,m,y,v[R+12],11,-421815835),y=f(y,b,_,m,v[R+15],16,530742520),m=f(m,y,b,_,v[R+2],23,-995338651),_=p(_,m,y,b,v[R],6,-198630844),b=p(b,_,m,y,v[R+7],10,1126891415),y=p(y,b,_,m,v[R+14],15,-1416354905),m=p(m,y,b,_,v[R+5],21,-57434055),_=p(_,m,y,b,v[R+12],6,1700485571),b=p(b,_,m,y,v[R+3],10,-1894986606),y=p(y,b,_,m,v[R+10],15,-1051523),m=p(m,y,b,_,v[R+1],21,-2054922799),_=p(_,m,y,b,v[R+8],6,1873313359),b=p(b,_,m,y,v[R+15],10,-30611744),y=p(y,b,_,m,v[R+6],15,-1560198380),m=p(m,y,b,_,v[R+13],21,1309151649),_=p(_,m,y,b,v[R+4],6,-145523070),b=p(b,_,m,y,v[R+11],10,-1120210379),y=p(y,b,_,m,v[R+2],15,718787259),m=p(m,y,b,_,v[R+9],21,-343485551),_=a(_,T),m=a(m,w),y=a(y,C),b=a(b,A)}return Uint32Array.of(_,m,y,b)}function n(v){if(v.length===0)return new Uint32Array;const E=new Uint32Array(t(v.length*8)).fill(0);for(let g=0;g<v.length;g++)E[g>>2]|=(v[g]&255)<<g%4*8;return E}function a(v,E){const g=(v&65535)+(E&65535);return(v>>16)+(E>>16)+(g>>16)<<16|g&65535}function c(v,E){return v<<E|v>>>32-E}function l(v,E,g,_,m,y){return a(c(a(a(E,v),a(_,y)),m),g)}function d(v,E,g,_,m,y,b){return l(E&g|~E&_,v,E,m,y,b)}function u(v,E,g,_,m,y,b){return l(E&_|g&~_,v,E,m,y,b)}function f(v,E,g,_,m,y,b){return l(E^g^_,v,E,m,y,b)}function p(v,E,g,_,m,y,b){return l(g^(E|~_),v,E,m,y,b)}return _d.default=i,_d}var dn={},eR;function ff(){if(eR)return dn;eR=1,Object.defineProperty(dn,"__esModule",{value:!0}),dn.URL=dn.DNS=dn.stringToBytes=void 0;const i=Nf(),e=Os();function t(n){n=unescape(encodeURIComponent(n));const a=new Uint8Array(n.length);for(let c=0;c<n.length;++c)a[c]=n.charCodeAt(c);return a}dn.stringToBytes=t,dn.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",dn.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function r(n,a,c,l,d,u){const f=typeof c=="string"?t(c):c,p=typeof l=="string"?(0,i.default)(l):l;if(typeof l=="string"&&(l=(0,i.default)(l)),(l==null?void 0:l.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let v=new Uint8Array(16+f.length);if(v.set(p),v.set(f,p.length),v=a(v),v[6]=v[6]&15|n,v[8]=v[8]&63|128,d){u=u||0;for(let E=0;E<16;++E)d[u+E]=v[E];return d}return(0,e.unsafeStringify)(v)}return dn.default=r,dn}var tR;function E5(){return tR||(tR=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.URL=i.DNS=void 0;const e=S5(),t=ff();var r=ff();Object.defineProperty(i,"DNS",{enumerable:!0,get:function(){return r.DNS}}),Object.defineProperty(i,"URL",{enumerable:!0,get:function(){return r.URL}});function n(a,c,l,d){return(0,t.default)(48,e.default,a,c,l,d)}n.DNS=t.DNS,n.URL=t.URL,i.default=n}(Z1)),Z1}var Sd={},Ed={},rR;function R5(){if(rR)return Ed;rR=1,Object.defineProperty(Ed,"__esModule",{value:!0});const i=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);return Ed.default={randomUUID:i},Ed}var iR;function w5(){if(iR)return Sd;iR=1,Object.defineProperty(Sd,"__esModule",{value:!0});const i=R5(),e=$v(),t=Os();function r(n,a,c){var l;if(i.default.randomUUID&&!a&&!n)return i.default.randomUUID();n=n||{};const d=n.random??((l=n.rng)==null?void 0:l.call(n))??(0,e.default)();if(d.length<16)throw new Error("Random bytes length must be >= 16");if(d[6]=d[6]&15|64,d[8]=d[8]&63|128,a){if(c=c||0,c<0||c+16>a.length)throw new RangeError(`UUID byte range ${c}:${c+15} is out of buffer bounds`);for(let u=0;u<16;++u)a[c+u]=d[u];return a}return(0,t.unsafeStringify)(d)}return Sd.default=r,Sd}var nR={},Rd={},sR;function T5(){if(sR)return Rd;sR=1,Object.defineProperty(Rd,"__esModule",{value:!0});function i(r,n,a,c){switch(r){case 0:return n&a^~n&c;case 1:return n^a^c;case 2:return n&a^n&c^a&c;case 3:return n^a^c}}function e(r,n){return r<<n|r>>>32-n}function t(r){const n=[1518500249,1859775393,2400959708,3395469782],a=[1732584193,4023233417,2562383102,271733878,3285377520],c=new Uint8Array(r.length+1);c.set(r),c[r.length]=128,r=c;const l=r.length/4+2,d=Math.ceil(l/16),u=new Array(d);for(let f=0;f<d;++f){const p=new Uint32Array(16);for(let v=0;v<16;++v)p[v]=r[f*64+v*4]<<24|r[f*64+v*4+1]<<16|r[f*64+v*4+2]<<8|r[f*64+v*4+3];u[f]=p}u[d-1][14]=(r.length-1)*8/Math.pow(2,32),u[d-1][14]=Math.floor(u[d-1][14]),u[d-1][15]=(r.length-1)*8&4294967295;for(let f=0;f<d;++f){const p=new Uint32Array(80);for(let y=0;y<16;++y)p[y]=u[f][y];for(let y=16;y<80;++y)p[y]=e(p[y-3]^p[y-8]^p[y-14]^p[y-16],1);let v=a[0],E=a[1],g=a[2],_=a[3],m=a[4];for(let y=0;y<80;++y){const b=Math.floor(y/20),R=e(v,5)+i(b,E,g,_)+m+n[b]+p[y]>>>0;m=_,_=g,g=e(E,30)>>>0,E=v,v=R}a[0]=a[0]+v>>>0,a[1]=a[1]+E>>>0,a[2]=a[2]+g>>>0,a[3]=a[3]+_>>>0,a[4]=a[4]+m>>>0}return Uint8Array.of(a[0]>>24,a[0]>>16,a[0]>>8,a[0],a[1]>>24,a[1]>>16,a[1]>>8,a[1],a[2]>>24,a[2]>>16,a[2]>>8,a[2],a[3]>>24,a[3]>>16,a[3]>>8,a[3],a[4]>>24,a[4]>>16,a[4]>>8,a[4])}return Rd.default=t,Rd}var aR;function C5(){return aR||(aR=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.URL=i.DNS=void 0;const e=T5(),t=ff();var r=ff();Object.defineProperty(i,"DNS",{enumerable:!0,get:function(){return r.DNS}}),Object.defineProperty(i,"URL",{enumerable:!0,get:function(){return r.URL}});function n(a,c,l,d){return(0,t.default)(80,e.default,a,c,l,d)}n.DNS=t.DNS,n.URL=t.URL,i.default=n}(nR)),nR}var wd={},oR;function A5(){if(oR)return wd;oR=1,Object.defineProperty(wd,"__esModule",{value:!0});const i=Os(),e=zC(),t=GC();function r(n,a,c){n??(n={}),c??(c=0);let l=(0,e.default)({...n,_v6:!0},new Uint8Array(16));if(l=(0,t.default)(l),a){for(let d=0;d<16;d++)a[c+d]=l[d];return a}return(0,i.unsafeStringify)(l)}return wd.default=r,wd}var Td={},cR;function x5(){if(cR)return Td;cR=1,Object.defineProperty(Td,"__esModule",{value:!0});const i=Nf(),e=Os();function t(n){const a=typeof n=="string"?(0,i.default)(n):n,c=r(a);return typeof n=="string"?(0,e.unsafeStringify)(c):c}Td.default=t;function r(n){return Uint8Array.of((n[3]&15)<<4|n[4]>>4&15,(n[4]&15)<<4|(n[5]&240)>>4,(n[5]&15)<<4|n[6]&15,n[7],(n[1]&15)<<4|(n[2]&240)>>4,(n[2]&15)<<4|(n[3]&240)>>4,16|(n[0]&240)>>4,(n[0]&15)<<4|(n[1]&240)>>4,n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15])}return Td}var lo={},lR;function D5(){if(lR)return lo;lR=1,Object.defineProperty(lo,"__esModule",{value:!0}),lo.updateV7State=void 0;const i=$v(),e=Os(),t={};function r(c,l,d){var u;let f;if(c)f=a(c.random??((u=c.rng)==null?void 0:u.call(c))??(0,i.default)(),c.msecs,c.seq,l,d);else{const p=Date.now(),v=(0,i.default)();n(t,p,v),f=a(v,t.msecs,t.seq,l,d)}return l??(0,e.unsafeStringify)(f)}function n(c,l,d){return c.msecs??(c.msecs=-1/0),c.seq??(c.seq=0),l>c.msecs?(c.seq=d[6]<<23|d[7]<<16|d[8]<<8|d[9],c.msecs=l):(c.seq=c.seq+1|0,c.seq===0&&c.msecs++),c}lo.updateV7State=n;function a(c,l,d,u,f=0){if(c.length<16)throw new Error("Random bytes length must be >= 16");if(!u)u=new Uint8Array(16),f=0;else if(f<0||f+16>u.length)throw new RangeError(`UUID byte range ${f}:${f+15} is out of buffer bounds`);return l??(l=Date.now()),d??(d=c[6]*127<<24|c[7]<<16|c[8]<<8|c[9]),u[f++]=l/1099511627776&255,u[f++]=l/4294967296&255,u[f++]=l/16777216&255,u[f++]=l/65536&255,u[f++]=l/256&255,u[f++]=l&255,u[f++]=112|d>>>28&15,u[f++]=d>>>20&255,u[f++]=128|d>>>14&63,u[f++]=d>>>6&255,u[f++]=d<<2&255|c[10]&3,u[f++]=c[11],u[f++]=c[12],u[f++]=c[13],u[f++]=c[14],u[f++]=c[15],u}return lo.default=r,lo}var Cd={},uR;function L5(){if(uR)return Cd;uR=1,Object.defineProperty(Cd,"__esModule",{value:!0});const i=Mf();function e(t){if(!(0,i.default)(t))throw TypeError("Invalid UUID");return parseInt(t.slice(14,15),16)}return Cd.default=e,Cd}var dR;function O5(){return dR||(dR=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.version=i.validate=i.v7=i.v6ToV1=i.v6=i.v5=i.v4=i.v3=i.v1ToV6=i.v1=i.stringify=i.parse=i.NIL=i.MAX=void 0;var e=y5();Object.defineProperty(i,"MAX",{enumerable:!0,get:function(){return e.default}});var t=b5();Object.defineProperty(i,"NIL",{enumerable:!0,get:function(){return t.default}});var r=Nf();Object.defineProperty(i,"parse",{enumerable:!0,get:function(){return r.default}});var n=Os();Object.defineProperty(i,"stringify",{enumerable:!0,get:function(){return n.default}});var a=zC();Object.defineProperty(i,"v1",{enumerable:!0,get:function(){return a.default}});var c=GC();Object.defineProperty(i,"v1ToV6",{enumerable:!0,get:function(){return c.default}});var l=E5();Object.defineProperty(i,"v3",{enumerable:!0,get:function(){return l.default}});var d=w5();Object.defineProperty(i,"v4",{enumerable:!0,get:function(){return d.default}});var u=C5();Object.defineProperty(i,"v5",{enumerable:!0,get:function(){return u.default}});var f=A5();Object.defineProperty(i,"v6",{enumerable:!0,get:function(){return f.default}});var p=x5();Object.defineProperty(i,"v6ToV1",{enumerable:!0,get:function(){return p.default}});var v=D5();Object.defineProperty(i,"v7",{enumerable:!0,get:function(){return v.default}});var E=Mf();Object.defineProperty(i,"validate",{enumerable:!0,get:function(){return E.default}});var g=L5();Object.defineProperty(i,"version",{enumerable:!0,get:function(){return g.default}})}(z1)),z1}var ol={},fR;function I5(){if(fR)return ol;fR=1,Object.defineProperty(ol,"__esModule",{value:!0}),ol.FakeEventTarget=void 0;let i=class{constructor(){K(this,"listeners",{})}addEventListener(e,t,r={}){var n;t&&((n=this.listeners)[e]??(n[e]=[]),this.listeners[e].push({callback:t,once:r.once===!0}))}removeEventListener(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter(r=>r.callback!==t))}dispatchEvent(e){if(!e||typeof e.type!="string")throw new Error("invalid event object");const t=this.listeners[e.type];if(!t)return!0;for(const r of[...t]){try{r.callback.call(this,e)}catch(n){setTimeout(()=>{throw n},0)}r.once&&this.removeEventListener(e.type,r.callback)}return!e.defaultPrevented}};return ol.FakeEventTarget=i,ol}var Ad={},hR;function P5(){if(hR)return Ad;hR=1,Object.defineProperty(Ad,"__esModule",{value:!0}),Ad.clone=i;function i(e){if(e!==void 0)return Number.isNaN(e)?NaN:typeof structuredClone=="function"?structuredClone(e):JSON.parse(JSON.stringify(e))}return Ad}var pR;function k5(){var i,e,t,r,n,a,c,l,d,u,f,p,v,E,g,_;if(pR)return al;pR=1,Object.defineProperty(al,"__esModule",{value:!0}),al.FakeMediaStreamTrack=void 0;const m=O5(),y=I5(),b=P5(),R=class HC extends y.FakeEventTarget{constructor({kind:C,id:A,label:L,contentHint:D,enabled:P,muted:k,readyState:M,capabilities:I,constraints:F,settings:$,data:N}){super(),Ur(this,i),Ur(this,e),Ur(this,t),Ur(this,r),Ur(this,n),Ur(this,a),Ur(this,c),Ur(this,l),Ur(this,d),Ur(this,u),Ur(this,f),Ur(this,p,null),Ur(this,v,null),Ur(this,E,null),Ur(this,g,null),Ur(this,_,null),qt(this,i,A??(0,m.v4)()),qt(this,e,C),qt(this,t,L??""),qt(this,c,D??""),qt(this,n,P??!0),qt(this,a,k??!1),qt(this,r,M??"live"),qt(this,l,I??{}),qt(this,d,F??{}),qt(this,u,$??{}),qt(this,f,N??{})}get id(){return at(this,i)}get kind(){return at(this,e)}get label(){return at(this,t)}get contentHint(){return at(this,c)}set contentHint(C){qt(this,c,C)}get enabled(){return at(this,n)}set enabled(C){const A=at(this,n)!==C;qt(this,n,C),A&&this.dispatchEvent(new Event("enabledchange"))}get muted(){return at(this,a)}get readyState(){return at(this,r)}get data(){return at(this,f)}set data(C){qt(this,f,C)}get onmute(){return at(this,p)}set onmute(C){at(this,p)&&this.removeEventListener("mute",at(this,p)),qt(this,p,C),C&&this.addEventListener("mute",C)}get onunmute(){return at(this,v)}set onunmute(C){at(this,v)&&this.removeEventListener("unmute",at(this,v)),qt(this,v,C),C&&this.addEventListener("unmute",C)}get onended(){return at(this,E)}set onended(C){at(this,E)&&this.removeEventListener("ended",at(this,E)),qt(this,E,C),C&&this.addEventListener("ended",C)}get onenabledchange(){return at(this,g)}set onenabledchange(C){at(this,g)&&this.removeEventListener("enabledchange",at(this,g)),qt(this,g,C),C&&this.addEventListener("enabledchange",C)}get onstopped(){return at(this,_)}set onstopped(C){at(this,_)&&this.removeEventListener("stopped",at(this,_)),qt(this,_,C),C&&this.addEventListener("stopped",C)}addEventListener(C,A,L){super.addEventListener(C,A,L)}removeEventListener(C,A){super.removeEventListener(C,A)}stop(){at(this,r)!=="ended"&&(qt(this,r,"ended"),this.dispatchEvent(new Event("stopped")))}clone({id:C,data:A}={}){return new HC({id:C??(0,m.v4)(),kind:at(this,e),label:at(this,t),contentHint:at(this,c),enabled:at(this,n),muted:at(this,a),readyState:at(this,r),capabilities:(0,b.clone)(at(this,l)),constraints:(0,b.clone)(at(this,d)),settings:(0,b.clone)(at(this,u)),data:A??(0,b.clone)(at(this,f))})}getCapabilities(){return at(this,l)}getConstraints(){return at(this,d)}async applyConstraints(C={}){return qt(this,d,C),Promise.resolve()}getSettings(){return at(this,u)}remoteStop(){at(this,r)!=="ended"&&(qt(this,r,"ended"),this.dispatchEvent(new Event("stopped")),this.dispatchEvent(new Event("ended")))}remoteMute(){at(this,a)||(qt(this,a,!0),this.dispatchEvent(new Event("mute")))}remoteUnmute(){at(this,a)&&(qt(this,a,!1),this.dispatchEvent(new Event("unmute")))}};i=new WeakMap,e=new WeakMap,t=new WeakMap,r=new WeakMap,n=new WeakMap,a=new WeakMap,c=new WeakMap,l=new WeakMap,d=new WeakMap,u=new WeakMap,f=new WeakMap,p=new WeakMap,v=new WeakMap,E=new WeakMap,g=new WeakMap,_=new WeakMap;let T=R;return al.FakeMediaStreamTrack=T,al}var mR;function M5(){if(mR)return sl;mR=1,Object.defineProperty(sl,"__esModule",{value:!0}),sl.FakeHandler=void 0;const i=k5(),e=Ds(),t=sr(),r=br(),n=Hr(),a=Gr(),c=ii(),l=new t.Logger("FakeHandler"),d="FakeHandler";class u extends e.EnhancedEventEmitter{constructor({id:v,ordered:E,maxPacketLifeTime:g,maxRetransmits:_,label:m,protocol:y}){super(),K(this,"id"),K(this,"ordered"),K(this,"maxPacketLifeTime"),K(this,"maxRetransmits"),K(this,"label"),K(this,"protocol"),this.id=v,this.ordered=E,this.maxPacketLifeTime=g,this.maxRetransmits=_,this.label=m,this.protocol=y}close(){this.safeEmit("close"),this.emit("@close")}send(v){this.safeEmit("message",v)}addEventListener(v,E){this.on(v,E)}}let f=class VC extends c.HandlerInterface{constructor(v){super(),K(this,"_closed",!1),K(this,"fakeParameters"),K(this,"_rtpParametersByKind"),K(this,"_cname",`CNAME-${r.generateRandomNumber()}`),K(this,"_transportReady",!1),K(this,"_nextLocalId",1),K(this,"_tracks",new Map),K(this,"_nextSctpStreamId",0),this.fakeParameters=v}static createFactory(v){return()=>new VC(v)}get name(){return d}close(){l.debug("close()"),!this._closed&&(this._closed=!0)}setIceGatheringState(v){this.emit("@icegatheringstatechange",v)}setConnectionState(v){this.emit("@connectionstatechange",v)}async getNativeRtpCapabilities(){return l.debug("getNativeRtpCapabilities()"),this.fakeParameters.generateNativeRtpCapabilities()}async getNativeSctpCapabilities(){return l.debug("getNativeSctpCapabilities()"),this.fakeParameters.generateNativeSctpCapabilities()}run({direction:v,iceParameters:E,iceCandidates:g,dtlsParameters:_,sctpParameters:m,iceServers:y,iceTransportPolicy:b,proprietaryConstraints:R,extendedRtpCapabilities:T}){this.assertNotClosed(),l.debug("run()"),this._rtpParametersByKind={audio:n.getSendingRtpParameters("audio",T),video:n.getSendingRtpParameters("video",T)}}async updateIceServers(v){this.assertNotClosed(),l.debug("updateIceServers()")}async restartIce(v){this.assertNotClosed(),l.debug("restartIce()")}async getTransportStats(){return this.assertNotClosed(),new Map}async send({track:v,encodings:E,codecOptions:g,codec:_}){this.assertNotClosed(),l.debug("send() [kind:%s, track.id:%s]",v.kind,v.id),this._transportReady||await this.setupTransport({localDtlsRole:"server"});const m=r.clone(this._rtpParametersByKind[v.kind]),y=m.codecs.some(R=>/.+\/rtx$/i.test(R.mimeType));m.mid=`mid-${r.generateRandomNumber()}`,E||(E=[{}]);for(const R of E)R.ssrc=r.generateRandomNumber(),y&&(R.rtx={ssrc:r.generateRandomNumber()});m.encodings=E,m.rtcp={cname:this._cname,reducedSize:!0,mux:!0};const b=this._nextLocalId++;return this._tracks.set(b,v),{localId:String(b),rtpParameters:m}}async stopSending(v){if(l.debug("stopSending() [localId:%s]",v),!this._closed){if(!this._tracks.has(Number(v)))throw new Error("local track not found");this._tracks.delete(Number(v))}}async pauseSending(v){this.assertNotClosed()}async resumeSending(v){this.assertNotClosed()}async replaceTrack(v,E){this.assertNotClosed(),E?l.debug("replaceTrack() [localId:%s, track.id:%s]",v,E.id):l.debug("replaceTrack() [localId:%s, no track]",v),this._tracks.delete(Number(v)),this._tracks.set(Number(v),E)}async setMaxSpatialLayer(v,E){this.assertNotClosed(),l.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",v,E)}async setRtpEncodingParameters(v,E){this.assertNotClosed(),l.debug("setRtpEncodingParameters() [localId:%s, params:%o]",v,E)}async getSenderStats(v){return this.assertNotClosed(),new Map}async sendDataChannel({ordered:v,maxPacketLifeTime:E,maxRetransmits:g,label:_,protocol:m}){this.assertNotClosed(),this._transportReady||await this.setupTransport({localDtlsRole:"server"}),l.debug("sendDataChannel()");const y=new u({id:this._nextSctpStreamId++,ordered:v,maxPacketLifeTime:E,maxRetransmits:g,label:_,protocol:m}),b={streamId:this._nextSctpStreamId,ordered:v,maxPacketLifeTime:E,maxRetransmits:g};return{dataChannel:y,sctpStreamParameters:b}}async receive(v){this.assertNotClosed();const E=[];for(const g of v){const{trackId:_,kind:m}=g;this._transportReady||await this.setupTransport({localDtlsRole:"client"}),l.debug("receive() [trackId:%s, kind:%s]",_,m);const y=this._nextLocalId++,b=new i.FakeMediaStreamTrack({kind:m});this._tracks.set(y,b),E.push({localId:String(y),track:b})}return E}async stopReceiving(v){if(!this._closed)for(const E of v)l.debug("stopReceiving() [localId:%s]",E),this._tracks.delete(Number(E))}async pauseReceiving(v){this.assertNotClosed()}async resumeReceiving(v){this.assertNotClosed()}async getReceiverStats(v){return this.assertNotClosed(),new Map}async receiveDataChannel({sctpStreamParameters:v,label:E,protocol:g}){return this.assertNotClosed(),this._transportReady||await this.setupTransport({localDtlsRole:"client"}),l.debug("receiveDataChannel()"),{dataChannel:new u({id:v.streamId,ordered:v.ordered,maxPacketLifeTime:v.maxPacketLifeTime,maxRetransmits:v.maxRetransmits,label:E,protocol:g})}}async setupTransport({localDtlsRole:v,localSdpObject:E}){const g=r.clone(this.fakeParameters.generateLocalDtlsParameters());v&&(g.role=v),this.emit("@connectionstatechange","connecting"),await new Promise((_,m)=>this.emit("@connect",{dtlsParameters:g},_,m)),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new a.InvalidStateError("method called in a closed handler")}};return sl.FakeHandler=f,sl}var ki={},gR;function N5(){if(gR)return ki;gR=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.generateRouterRtpCapabilities=t,ki.generateNativeRtpCapabilities=r,ki.generateNativeSctpCapabilities=n,ki.generateLocalDtlsParameters=a,ki.generateTransportRemoteParameters=c,ki.generateProducerRemoteParameters=l,ki.generateConsumerRemoteParameters=d,ki.generateDataProducerRemoteParameters=u,ki.generateDataConsumerRemoteParameters=f;const i=br();function e(){return String(i.generateRandomNumber())}function t(){return i.deepFreeze({codecs:[{mimeType:"audio/opus",kind:"audio",preferredPayloadType:100,clockRate:48e3,channels:2,rtcpFeedback:[{type:"transport-cc"}],parameters:{useinbandfec:1,foo:"bar"}},{mimeType:"video/VP8",kind:"video",preferredPayloadType:101,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"x-google-start-bitrate":1500}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:102,clockRate:9e4,rtcpFeedback:[],parameters:{apt:101}},{mimeType:"video/H264",kind:"video",preferredPayloadType:103,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"level-asymmetry-allowed":1,"packetization-mode":1,"profile-level-id":"42e01f"}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:104,clockRate:9e4,rtcpFeedback:[],parameters:{apt:103}},{mimeType:"video/VP9",kind:"video",preferredPayloadType:105,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"profile-id":0,"x-google-start-bitrate":1500}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:106,clockRate:9e4,rtcpFeedback:[],parameters:{apt:105}}],headerExtensions:[{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id",preferredId:2,preferredEncrypt:!1,direction:"recvonly"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:repaired-rtp-stream-id",preferredId:3,preferredEncrypt:!1,direction:"recvonly"},{kind:"audio",uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",preferredId:4,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",preferredId:4,preferredEncrypt:!1,direction:"sendrecv"},{kind:"audio",uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",preferredId:5,preferredEncrypt:!1,direction:"recvonly"},{kind:"video",uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",preferredId:5,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"http://tools.ietf.org/html/draft-ietf-avtext-framemarking-07",preferredId:6,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:framemarking",preferredId:7,preferredEncrypt:!1,direction:"sendrecv"},{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:ssrc-audio-level",preferredId:10,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:3gpp:video-orientation",preferredId:11,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:toffset",preferredId:12,preferredEncrypt:!1,direction:"sendrecv"}]})}function r(){return i.deepFreeze({codecs:[{mimeType:"audio/opus",kind:"audio",preferredPayloadType:111,clockRate:48e3,channels:2,rtcpFeedback:[{type:"transport-cc"}],parameters:{minptime:10,useinbandfec:1}},{mimeType:"audio/ISAC",kind:"audio",preferredPayloadType:103,clockRate:16e3,channels:1,rtcpFeedback:[{type:"transport-cc"}],parameters:{}},{mimeType:"audio/CN",kind:"audio",preferredPayloadType:106,clockRate:32e3,channels:1,rtcpFeedback:[{type:"transport-cc"}],parameters:{}},{mimeType:"video/VP8",kind:"video",preferredPayloadType:96,clockRate:9e4,rtcpFeedback:[{type:"goog-remb"},{type:"transport-cc"},{type:"ccm",parameter:"fir"},{type:"nack"},{type:"nack",parameter:"pli"}],parameters:{baz:"1234abcd"}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:97,clockRate:9e4,rtcpFeedback:[],parameters:{apt:96}},{mimeType:"video/VP9",kind:"video",preferredPayloadType:98,clockRate:9e4,rtcpFeedback:[{type:"goog-remb"},{type:"transport-cc"},{type:"ccm",parameter:"fir"},{type:"nack"},{type:"nack",parameter:"pli"}],parameters:{"profile-id":0}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:99,clockRate:9e4,rtcpFeedback:[],parameters:{apt:98}}],headerExtensions:[{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:toffset",preferredId:2},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",preferredId:3},{kind:"video",uri:"urn:3gpp:video-orientation",preferredId:4},{kind:"video",uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",preferredId:5},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/playout-delay",preferredId:6},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/video-content-type",preferredId:7},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/video-timing",preferredId:8},{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:ssrc-audio-level",preferredId:10}]})}function n(){return i.deepFreeze({numStreams:{OS:2048,MIS:2048}})}function a(){return i.deepFreeze({fingerprints:[{algorithm:"sha-256",value:"82:5A:68:3D:36:C3:0A:DE:AF:E7:32:43:D2:88:83:57:AC:2D:65:E5:80:C4:B6:FB:AF:1A:A0:21:9F:6D:0C:AD"}],role:"auto"})}function c(){return{id:e(),iceParameters:i.deepFreeze({iceLite:!0,password:"yku5ej8nvfaor28lvtrabcx0wkrpkztz",usernameFragment:"h3hk1iz6qqlnqlne"}),iceCandidates:i.deepFreeze([{foundation:"udpcandidate",address:"9.9.9.9",ip:"9.9.9.9",port:40533,priority:1078862079,protocol:"udp",type:"host",tcpType:"passive"},{foundation:"udpcandidate",address:"9.9.9.9",ip:"9:9:9:9:9:9",port:41333,priority:1078862089,protocol:"udp",type:"host",tcpType:"passive"}]),dtlsParameters:i.deepFreeze({fingerprints:[{algorithm:"sha-256",value:"A9:F4:E0:D2:74:D3:0F:D9:CA:A5:2F:9F:7F:47:FA:F0:C4:72:DD:73:49:D0:3B:14:90:20:51:30:1B:90:8E:71"},{algorithm:"sha-384",value:"03:D9:0B:87:13:98:F6:6D:BC:FC:92:2E:39:D4:E1:97:32:61:30:56:84:70:81:6E:D1:82:97:EA:D9:C1:21:0F:6B:C5:E7:7F:E1:97:0C:17:97:6E:CF:B3:EF:2E:74:B0"},{algorithm:"sha-512",value:"84:27:A4:28:A4:73:AF:43:02:2A:44:68:FF:2F:29:5C:3B:11:9A:60:F4:A8:F0:F5:AC:A0:E3:49:3E:B1:34:53:A9:85:CE:51:9B:ED:87:5E:B8:F4:8E:3D:FA:20:51:B8:96:EE:DA:56:DC:2F:5C:62:79:15:23:E0:21:82:2B:2C"}],role:"auto"}),sctpParameters:i.deepFreeze({port:5e3,OS:2048,MIS:2048,maxMessageSize:2e6})}}function l(){return i.deepFreeze({id:e()})}function d({id:p,codecMimeType:v}={}){switch(v){case"audio/opus":return{id:p??e(),producerId:e(),kind:"audio",rtpParameters:i.deepFreeze({codecs:[{mimeType:"audio/opus",payloadType:100,clockRate:48e3,channels:2,rtcpFeedback:[{type:"transport-cc"}],parameters:{useinbandfec:1,foo:"bar"}}],encodings:[{ssrc:46687003}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5},{uri:"urn:ietf:params:rtp-hdrext:ssrc-audio-level",id:10}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};case"audio/ISAC":return{id:p??e(),producerId:e(),kind:"audio",rtpParameters:i.deepFreeze({codecs:[{mimeType:"audio/ISAC",payloadType:111,clockRate:16e3,channels:1,rtcpFeedback:[{type:"transport-cc"}],parameters:{}}],encodings:[{ssrc:46687004}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};case"video/VP8":return{id:p??e(),producerId:e(),kind:"video",rtpParameters:i.deepFreeze({codecs:[{mimeType:"video/VP8",payloadType:101,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"x-google-start-bitrate":1500}},{mimeType:"video/rtx",payloadType:102,clockRate:9e4,rtcpFeedback:[],parameters:{apt:101}}],encodings:[{ssrc:99991111,rtx:{ssrc:99991112}}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",id:4},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5},{uri:"urn:3gpp:video-orientation",id:11},{uri:"urn:ietf:params:rtp-hdrext:toffset",id:12}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};case"video/H264":return{id:p??e(),producerId:e(),kind:"video",rtpParameters:i.deepFreeze({codecs:[{mimeType:"video/H264",payloadType:103,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"level-asymmetry-allowed":1,"packetization-mode":1,"profile-level-id":"42e01f"}},{mimeType:"video/rtx",payloadType:104,clockRate:9e4,rtcpFeedback:[],parameters:{apt:103}}],encodings:[{ssrc:99991113,rtx:{ssrc:99991114}}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",id:4},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5},{uri:"urn:3gpp:video-orientation",id:11},{uri:"urn:ietf:params:rtp-hdrext:toffset",id:12}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};default:throw new TypeError(`unknown codecMimeType '${v}'`)}}function u(){return i.deepFreeze({id:e()})}function f({id:p}={}){return{id:p??e(),dataProducerId:e(),sctpStreamParameters:i.deepFreeze({streamId:666,maxPacketLifeTime:5e3,maxRetransmits:void 0})}}return ki}var vR;function B5(){return vR||(vR=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.debug=i.testFakeParameters=i.FakeHandler=i.ortc=i.parseScalabilityMode=i.detectDeviceAsync=i.detectDevice=i.Device=i.version=i.types=void 0;const e=If();i.debug=e.default,i.types=v5(),i.version="3.11.0";var t=jC();Object.defineProperty(i,"Device",{enumerable:!0,get:function(){return t.Device}}),Object.defineProperty(i,"detectDevice",{enumerable:!0,get:function(){return t.detectDevice}}),Object.defineProperty(i,"detectDeviceAsync",{enumerable:!0,get:function(){return t.detectDeviceAsync}});var r=Ls();Object.defineProperty(i,"parseScalabilityMode",{enumerable:!0,get:function(){return r.parse}}),i.ortc=Hr();var n=M5();Object.defineProperty(i,"FakeHandler",{enumerable:!0,get:function(){return n.FakeHandler}}),i.testFakeParameters=N5()}(WE)),WE}B5();class F5{constructor(){this.playUrls=[],this.pullZLMRes=[],this.eventEmitter=new bM,this.allocatedRTCPeerConnNums=0,this.zlmPullRetryTimers=new Map,this.zlmOngoingHttpRequests=new Map,this.pushUrls=[],this.pushZLMRes=[],this.zlmPushRetryTimers=new Map}on(e,t){this.eventEmitter.on(e,t)}off(e){this.eventEmitter.off(e)}emit(e,...t){this.eventEmitter.emit(e,...t)}_maybeInvokeGc(){this.allocatedRTCPeerConnNums%20||queueMicrotask(()=>{let e=document.createElement("img");e.src=window.URL.createObjectURL(new Blob([new ArrayBuffer(5e7)])),e.onerror=function(){window.URL.revokeObjectURL(this.src),e=null}})}startZLMediakitRtcPlay(e,t,r){this.playUrls.push(...e);for(let n=0;n<e.length;n++){const a=e[n],c=t[n];let l=new RTCPeerConnection({bundlePolicy:"max-bundle"});this.allocatedRTCPeerConnNums++,this._maybeInvokeGc(),l.oniceconnectionstatechange=()=>{if(l&&(l.iceConnectionState==="disconnected"||l.iceConnectionState==="failed")&&(this.emit("PlayStreamStateChange","SubscribeFailed",a),r&&r.autoRetry&&this.playUrls.includes(a))){this.stopZLMediakitRtcPlay(a);let u=setTimeout(()=>{this.startZLMediakitRtcPlay(a,c,r)},1e3);this.zlmPullRetryTimers.set(a,u)}},l.ontrack=u=>{if(u&&u.track){const f=()=>{this.emit("PlayStreamStateChange","Subscribed",a)};c.mediaStream===void 0&&(c.mediaStream=new MediaStream,c.srcObject=c.mediaStream,c.addEventListener("loadedmetadata",f)),u.track.onended=()=>{c.mediaStream&&(c.mediaStream.removeTrack(u.track),c.mediaStream.getTracks().length===0&&(c.removeEventListener("loadedmetadata",f),c.mediaStream=void 0,c.srcObject=null))},c.mediaStream.addTrack(u.track)}};const d={offerToReceiveAudio:!0,offerToReceiveVideo:!0};l.createOffer(d).then(u=>{u.sdp=u.sdp.replace("useinbandfec=1","useinbandfec=1;stereo=1"),l.setLocalDescription(u).then(()=>{const f=new XMLHttpRequest;f.open("POST",a),f.setRequestHeader("Content-Type","text/plain"),f.onerror=()=>{if(f.abort(),this.playUrls.includes(a)){this.stopZLMediakitRtcPlay(a);let p=setTimeout(()=>{this.startZLMediakitRtcPlay(a,c,r)},1e3);this.zlmPullRetryTimers.set(a,p)}this.zlmOngoingHttpRequests.delete(a)},f.onreadystatechange=()=>{if(this.zlmOngoingHttpRequests.delete(a),f.readyState===4&&f.status===200&&f.responseText!==""){const p=JSON.parse(f.responseText);if(p.sdp===void 0){if(this.playUrls.includes(a)&&(console.log("remote sdp empty",f.responseText),this.emit("PlayStreamStateChange","SubscribeFailed",a,f.responseText)),r&&r.autoRetry&&this.playUrls.includes(a)){if(this.stopZLMediakitRtcPlay(a),r.maxRetryTimes===void 0){let g=setTimeout(()=>{this.startZLMediakitRtcPlay(a,c,r)},1e3);this.zlmPullRetryTimers.set(a,g)}else if(r.maxRetryTimes){r.maxRetryTimes-=1;let g=setTimeout(()=>{this.startZLMediakitRtcPlay(a,c,r)},1e3);this.zlmPullRetryTimers.set(a,g)}}return}const v=new RTCSessionDescription({sdp:p.sdp,type:p.type}).sdp,E=new RTCSessionDescription({sdp:v.replace("useinbandfec=1","useinbandfec=1;stereo=1"),type:p.type});l.setRemoteDescription(E).then(()=>{this.emit("PlayStreamStateChange","Subscribed (Waiting frame...)",a)}).catch(g=>{console.log("zlmRtcPeerConn setRemoteDescription failed",g,E)})}},f.send(u.sdp),this.zlmOngoingHttpRequests.set(a,f),this.emit("PlayStreamStateChange","Subscribed (Waiting sdp...)",a)}).catch(f=>{console.log(`zlmRtcPeerConn setLocalDescription failed, ${f}`)})}).catch(u=>{console.log(`zlmRtcPeerConn createOffer failed, ${u}`)}),this.pullZLMRes.push({zlmRtcPeerConn:l,playUrl:a})}}stopZLMediakitRtcPlay(e){console.log("stopZLMediakitRtcPlay ",e),this.pullZLMRes=this.pullZLMRes.filter(a=>e&&a!==e?!0:(a.zlmRtcPeerConn&&a.zlmRtcPeerConn.close(),this.emit("PlayStreamStateChange","UnSubscribed",e),!1));let t=this.zlmPullRetryTimers.get(e);t&&(clearTimeout(t),this.zlmPullRetryTimers.delete(e));let r=this.zlmOngoingHttpRequests.get(e);r&&(r.abort(),this.zlmOngoingHttpRequests.delete(e));const n=this.playUrls.findIndex(a=>e===a);n>-1&&this.playUrls.splice(n,1)}startZLMediakitRtcPush(e,t,r,n){this.pushUrls.push(e);let a=new RTCPeerConnection;this.allocatedRTCPeerConnNums++,this._maybeInvokeGc(),a.oniceconnectionstatechange=()=>{if(a&&(a.iceConnectionState==="disconnected"||a.iceConnectionState==="failed")&&(this.emit("PushStreamStateChange","PublishFailed",e),this.pushUrls.includes(e))){this.stopZLMediakitRtcPush(e);let l=setTimeout(()=>{this.startZLMediakitRtcPush(e,t,r)},1e3);this.zlmPushRetryTimers.set(e,l)}},t.forEach(l=>{a.addTrack(l)}),a.createOffer().then(l=>{let d=l.sdp,u=new RTCSessionDescription({sdp:d.replace("useinbandfec=1","useinbandfec=1;stereo=1"),type:""});a.setLocalDescription(u);let f=u.sdp.split(`\r
`);if(r&&r.length>0){let E=-1;for(let g=0;g<f.length;g++)if(f[g].includes("msid:")){f[g].includes("a=msid:")&&++E;let _=f[g].split(" ");_[_.length-1]=r[E],f[g]=_.join(" ")}}let p=f.join(`\r
`);const v=new XMLHttpRequest;v.open("POST",e),v.setRequestHeader("Content-Type","text/plain"),v.onerror=()=>{if(this.emit("PushStreamStateChange","PublishFailed",e),v.abort(),this.zlmOngoingHttpRequests.delete(e),this.pushUrls.includes(e)){this.stopZLMediakitRtcPush(e);let E=setTimeout(()=>{this.startZLMediakitRtcPush(e,t,r)},1e3);this.zlmPushRetryTimers.set(e,E)}},v.onreadystatechange=()=>{if(this.zlmOngoingHttpRequests.delete(e),v.readyState===4&&v.status===200&&v.responseText!==""){const g=JSON.parse(v.responseText);if(g.sdp===void 0){if(console.log("remote sdp empty",v.responseText),this.emit("PushStreamStateChange","PublishFailed",e),this.pushUrls.includes(e)){this.stopZLMediakitRtcPush(e);let _=setTimeout(()=>{this.startZLMediakitRtcPush(e,t,r)},1e3);this.zlmPushRetryTimers.set(e,_)}return}var E=new RTCSessionDescription({sdp:g.sdp,type:g.type});E.sdp=E.sdp.replace("useinbandfec=1","useinbandfec=1;stereo=1"),a.setRemoteDescription(E).then(()=>{if(this.emit("PushStreamStateChange","Published",e),n){const _=a.getSenders()[0],m=_.getParameters();m.encodings||(m.encodings=[{}]),n.maxBitrate&&(m.encodings[0].maxBitrate=n.maxBitrate*1e3),_.setParameters(m)}}).catch(_=>{console.log("push zlmRtcPeerConn setRemoteDescription failed",_)})}},v.send(p),this.zlmOngoingHttpRequests.set(e,v)}).catch(l=>{console.log(`push zlmRtcPeerConn createOffer failed, ${l}`)});var c=setInterval(async()=>{if(a&&a.iceConnectionState==="connected"){const d=await a.getStats(null);var l=null;if(d.forEach(u=>{u.type==="candidate-pair"&&u.state==="succeeded"&&u.nominated&&(l=u)}),l){if(a.localCandidateId&&a.remoteCandidateId&&(l.localCandidateId!==a.localCandidateId||l.remoteCandidateId!==a.remoteCandidateId)&&this.pushUrls.includes(e)){this.stopZLMediakitRtcPush(e);let u=setTimeout(()=>{this.startZLMediakitRtcPush(e,t,r)},1e3);this.zlmPushRetryTimers.set(e,u)}a.localCandidateId=l.localCandidateId,a.remoteCandidateId=l.remoteCandidateId}}},1e3);this.pushZLMRes.push({zlmRtcPeerConn:a,pushUrl:e,checkNetworkReconnectTimer:c})}stopZLMediakitRtcPush(e){this.pushZLMRes=this.pushZLMRes.filter(a=>e&&a.pushUrl!==e?!0:(a.zlmRtcPeerConn&&(a.zlmRtcPeerConn.close(),a.zlmRtcPeerConn=null),a.checkNetworkReconnectTimer&&(clearInterval(a.checkNetworkReconnectTimer),a.checkNetworkReconnectTimer=null),this.emit("PushStreamStateChange","UnPublished",a.pushUrl),!1));let t=this.zlmPushRetryTimers.get(e);t&&(clearTimeout(t),this.zlmPushRetryTimers.delete(e));let r=this.zlmOngoingHttpRequests.get(e);r&&(r.abort(),this.zlmOngoingHttpRequests.delete(e));const n=this.pushUrls.findIndex(a=>e===a);n>-1&&this.pushUrls.splice(n,1)}}function U5(){const[i,e]=H.useState(""),t=H.useRef(null),[r,n]=H.useState(""),a=l=>{console.log(l.target.value);const d=l.target.value;e(d)},c=()=>{if(t.current){const l=new F5;l.startZLMediakitRtcPlay(["http://192.168.31.179:8000/rtc_utils/player/input_url_media_player.html"],[t.current],{autoRetry:!0}),l.on("PlayStreamStateChange",(d,u)=>{console.log("State_state",d,u),n(d)})}};return ms.jsxs(ms.Fragment,{children:[ms.jsxs("h1",{children:["2webrtc player-",r]}),ms.jsx(ko,{placeholder:"Basic usage",value:i,onInput:a}),ms.jsx("div",{children:ms.jsx("video",{ref:t,className:"margin-top media-preview",autoPlay:!0,muted:!0,playsInline:!0})}),ms.jsx(Cf,{type:"primary",onClick:c,className:"margin-top",children:"checkFlv"})]})}iD.createRoot(document.getElementById("root")).render(ms.jsx(U5,{}));
